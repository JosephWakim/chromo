

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Code Overview and Structure &mdash; chromo  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="chromo  documentation" href="index.html"/>
        <link rel="next" title="Monte Carlo Simulations" href="mc_sim.html"/>
        <link rel="prev" title="Abstract" href="abstract.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> chromo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="abstract.html">Abstract</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="mc_sim.html">Monte Carlo Simulations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="poly_models.html">Polymer Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Field Theoretic Treatment of Interactions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial_1_unconfined_semiflexible_homopolymer.html">1. Unconfined, Semiflexible Homopolymer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_2_confined_semiflexible_homopolymer.html">2. Confined, Semiflexible Homopolymer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_3_one_mark_chromatin.html">3. Single-Mark Chromatin Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_4_two_mark_chromatin.html">4. Two-Mark Chromatin Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_5_two_mark_chromatin_competitive.html">5. Two-Mark Chromatin Simulation with Competitive Binding</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_6_two_step_refinement.html">6. Simulation with Coarse and Refined Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_7_kinked_chromatin.html">7. Kinked Chromatin Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_8_kinked_chromatin_with_sterics.html">8. Kinked Chromatin Simulation with Sterics</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_snippets.html">Code Snippets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">chromo</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Code Overview and Structure</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/code_structure.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="code-overview-and-structure">
<span id="code-structure"></span><h1>Code Overview and Structure<a class="headerlink" href="#code-overview-and-structure" title="Permalink to this heading">¶</a></h1>
<p>Chromo is implemented with an object-oriented approach to accommodate flexible polymer models at various scales, bound by arbitrary numbers of interacting reader proteins.
The simulator is specifically designed to model chromatin, but can be adapted to model arbitrary block co-polymers with or without confinement.</p>
<p>The hierarchcial organization of chromatin (and block copolymers in general) is reflected by the simulator’s class structure.
At the largest scale, instances of the <code class="code docutils literal notranslate"><span class="pre">Mixture</span></code> class contain all interacting polymers in the system.
Each chromatin strand is instantiated as a <code class="code docutils literal notranslate"><span class="pre">Chromatin</span></code> object, which adopts physical properties of a stretchable, shearable wormlike chain.
<code class="code docutils literal notranslate"><span class="pre">Chromatin</span></code> instances track a sequence of nucleosomes, each of which is instantiated as a <code class="code docutils literal notranslate"><span class="pre">Nucleosome</span></code> object.
The <code class="code docutils literal notranslate"><span class="pre">Chromatin</span></code> class also stores patterns of chemical modifications and associated reader protein binding states.
Physical properties of the reader proteins, which define how reader proteins interact, are specified as attributes of the <code class="code docutils literal notranslate"><span class="pre">ReaderProtein</span></code> class.
An instance of the <code class="code docutils literal notranslate"><span class="pre">UniformDensityField</span></code> class maintains a discrete density field for the polymer and all its reader proteins.
This field is used to efficiently evaluate the interaction energy of components in the simulation.</p>
<p>To enable convenient adaption of our software for different polymer models, we defined abstract classes for each component of our system, and we leveraged a hierarchy of subclasses with increasing levels of detail.
For example, the <code class="code docutils literal notranslate"><span class="pre">Chromatin</span></code> class inherits from a <code class="code docutils literal notranslate"><span class="pre">SSWLC</span></code> class that defines physical properties of a stretchable, shearable wormlike chains, including methods for evaluating elastic energy.
The <code class="code docutils literal notranslate"><span class="pre">SSWLC</span></code> class inherits from a <code class="code docutils literal notranslate"><span class="pre">PolymerBase</span></code> class that includes required attributes and bookkeeping methods for any polymer.
Below is a schematic of hierarchical organization of our simulator.</p>
<img alt="_images/chromo_UML.png" src="_images/chromo_UML.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The software is written in Python, providing interpretable code and access to a broad library of published packages.
However, as an interpreted language, Python code is notoriously slow to run.
To work around this limitation, parts of the codebase were written in “Cython,” a variation of Python that allows for direct translation to C code.
All parts of the codebase involved in the inner-loop of the Monte Carlo algorithm have been translated to Cython.</p>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mc_sim.html" class="btn btn-neutral float-right" title="Monte Carlo Simulations" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="abstract.html" class="btn btn-neutral" title="Abstract" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2024, Joseph Wakim, Bruno Beltran, Andrew Spakowitz.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/documentation_options.js"></script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>