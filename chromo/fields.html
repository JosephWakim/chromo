<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: fields.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="fields.cpp">fields.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c"># cython: profile=True</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="sd">&quot;&quot;&quot;Fields discretize space to efficiently calculate change in binder energy.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="sd">Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="sd">-----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: <span class="sd">Creates a field object that contains parameters for the field calculations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="sd">and functions to generate the densities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="sd">Cythonized to accomodate expensive `compute_dE` method.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="sd">To profile runtime of cython functions, add the following comment to the top of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: <span class="sd">this file: # cython: profile=True</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0014</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0015</span>: <span class="k">import</span> <span class="nn">pyximport</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyximport, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pyximport, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0016</span>: <span class="n">pyximport</span><span class="o">.</span><span class="n">install</span><span class="p">()</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pyximport);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_install);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0018</span>: <span class="c"># Built-in Modules</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0019</span>: <span class="k">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Path);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Path);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pathlib, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Path);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Path, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0020</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">floor</span><span class="p">,</span> <span class="n">sqrt</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="c"># External Modules</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0023</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0025</span>: <span class="k">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pandas, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="c"># Custom Modules</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>: <span class="k">import</span> <span class="nn">chromo.polymers</span> <span class="k">as</span> <span class="nn">poly</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__49);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s__49);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_polymers, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_poly, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="k">from</span> <span class="nn">chromo.util.linalg</span> <span class="k">cimport</span> <span class="n">vec_dot3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0032</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E_HUGE</span> <span class="o">=</span> <span class="mf">1E99</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6chromo_6fields_E_HUGE = 1E99;
</pre><pre class="cython line score-0">&#xA0;<span class="">0033</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0034</span>: <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_field_descriptors</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-30 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_x_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_x_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_x_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_nx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_nx);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_nx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_y_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_y_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_y_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ny);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_ny);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_z_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_z_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_s_z_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_nz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_nz);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_n_s_nz);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_confine_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_confine_type);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, __pyx_n_s_confine_type);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_confine_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_confine_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, __pyx_n_s_confine_length);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chi);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chi);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, __pyx_n_s_chi);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_assume_fully_accessible);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_assume_fully_accessible);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, __pyx_n_s_assume_fully_accessible);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_vf_limit);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_vf_limit);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, __pyx_n_s_vf_limit);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_fast_field);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_fast_field);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, __pyx_n_s_fast_field);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_6fields__field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_6fields__field_descriptors, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0035</span>:     <span class="s">&#39;x_width&#39;</span><span class="p">,</span> <span class="s">&#39;nx&#39;</span><span class="p">,</span> <span class="s">&#39;y_width&#39;</span><span class="p">,</span> <span class="s">&#39;ny&#39;</span><span class="p">,</span> <span class="s">&#39;z_width&#39;</span><span class="p">,</span> <span class="s">&#39;nz&#39;</span><span class="p">,</span> <span class="s">&#39;confine_type&#39;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:     <span class="s">&#39;confine_length&#39;</span><span class="p">,</span> <span class="s">&#39;chi&#39;</span><span class="p">,</span> <span class="s">&#39;assume_fully_accessible&#39;</span><span class="p">,</span> <span class="s">&#39;vf_limit&#39;</span><span class="p">,</span> <span class="s">&#39;fast_field&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="p">]</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0038</span>: <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_int_field_descriptors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;nx&#39;</span><span class="p">,</span> <span class="s">&#39;ny&#39;</span><span class="p">,</span> <span class="s">&#39;nz&#39;</span><span class="p">,</span> <span class="s">&#39;n_points&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_nx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_nx);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_nx);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ny);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ny);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_ny);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_nz);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_nz);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_nz);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_n_points);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_n_points);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_n_points);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_6fields__int_field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_6fields__int_field_descriptors, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0039</span>: <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_str_field_descriptors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;confine_type&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_confine_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_confine_type);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_confine_type);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_6fields__str_field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_6fields__str_field_descriptors, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0040</span>: <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_float_field_descriptors</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-18 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_x_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_x_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_x_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_y_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_y_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_y_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_z_width);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_z_width);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_z_width);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_confine_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_confine_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_confine_length);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_vf_limit);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_vf_limit);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_s_vf_limit);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chi);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chi);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_n_s_chi);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_6fields__float_field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_6fields__float_field_descriptors, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0041</span>:     <span class="s">&#39;x_width&#39;</span><span class="p">,</span> <span class="s">&#39;y_width&#39;</span><span class="p">,</span> <span class="s">&#39;z_width&#39;</span><span class="p">,</span> <span class="s">&#39;confine_length&#39;</span><span class="p">,</span> <span class="s">&#39;vf_limit&#39;</span><span class="p">,</span> <span class="s">&#39;chi&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="p">]</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0043</span>: <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">_bool_field_descriptors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;assume_fully_accessible&#39;</span><span class="p">,</span> <span class="s">&#39;fast_field&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_assume_fully_accessible);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_assume_fully_accessible);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_assume_fully_accessible);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_fast_field);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_fast_field);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_fast_field);
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_6fields__bool_field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_6fields__bool_field_descriptors, ((PyObject*)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0046</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">FieldBase</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_6fields_FieldBase {
  double (*compute_dE)(struct __pyx_obj_6chromo_6fields_FieldBase *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, long, int);
  void (*update_affected_densities)(struct __pyx_obj_6chromo_6fields_FieldBase *);
  double (*get_confinement_dE)(struct __pyx_obj_6chromo_6fields_FieldBase *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, int);
};
static struct __pyx_vtabstruct_6chromo_6fields_FieldBase *__pyx_vtabptr_6chromo_6fields_FieldBase;

</pre><pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;A discretization of space for computing energies.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="sd">    Must be subclassed to be useful.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">    As implemented so far, this codebase accepts only one polymer in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="sd">    Attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="sd">    polymers : List[PolymerBase]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>: <span class="sd">        Polymers contained in the field; for now, this codebase accepts only</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">        one polymer in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: <span class="sd">    n_polymers : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: <span class="sd">        Number of polymers in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: <span class="sd">    binders : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>: <span class="sd">        Table containing reader proteins bound to the polymer and their</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: <span class="sd">        relevant properties</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>:     <span class="nd">@property</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0068</span>:     <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_9FieldBase_4name_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6chromo_6fields_9FieldBase_4name_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_9FieldBase_4name___get__(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_9FieldBase_4name___get__(struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__get__", __pyx_f[0], 68, 0, <span class='error_goto'>__PYX_ERR(0, 68, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.FieldBase.name.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the name of the field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="sd">        For now, there&#39;s only one field per sim, so classname works.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_class);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">):</span></pre>
<pre class='cython code score-27 '>/* Python wrapper */
static int __pyx_pw_6chromo_6fields_9FieldBase_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_9FieldBase___init__[] = "Construct a field holding no polymers, tracking no reader proteins.\n\n        Parameters\n        ----------\n         polymers : List[PolymerBase]\n            List of polymers contained in the field\n        binders : pd.DataFrame\n            Output of `chromo.binders.make_binder_collection` applied to the\n            list of `Binder` objects contained in the field\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_9FieldBase___init__;
#endif
static int __pyx_pw_6chromo_6fields_9FieldBase_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_binders = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_binders,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binders)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_polymers = values[0];
    __pyx_v_binders = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.FieldBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_9FieldBase___init__(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), __pyx_v_polymers, __pyx_v_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_6fields_9FieldBase___init__(struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self, PyObject *__pyx_v_polymers, PyObject *__pyx_v_binders) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 77, 0, <span class='error_goto'>__PYX_ERR(0, 77, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.FieldBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0078</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a field holding no polymers, tracking no reader proteins.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="sd">         polymers : List[PolymerBase]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="sd">            List of polymers contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="sd">        binders : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: <span class="sd">            Output of `chromo.binders.make_binder_collection` applied to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="sd">            list of `Binder` objects contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">polymers</span> <span class="o">=</span> <span class="n">polymers</span></pre>
<pre class='cython code score-12 '>  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_polymers))||((__pyx_v_polymers) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_v_polymers)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_v_polymers;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;polymers);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;polymers);
  __pyx_v_self-&gt;polymers = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_polymers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymers</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_polymers);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  __pyx_v_self-&gt;n_polymers = __pyx_t_2;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">binders</span> <span class="o">=</span> <span class="n">binders</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_binders);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;binders);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;binders);
  __pyx_v_self-&gt;binders = __pyx_v_binders;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">=</span> <span class="s">&quot;&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;confine_type);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;confine_type);
  __pyx_v_self-&gt;confine_type = __pyx_kp_s_;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0092</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;confine_length = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0093</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0094</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_9FieldBase_3__str__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_6chromo_6fields_9FieldBase_2__str__[] = "Print representation of empty field.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_9FieldBase_2__str__;
#endif
static PyObject *__pyx_pw_6chromo_6fields_9FieldBase_3__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_9FieldBase_2__str__(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_9FieldBase_2__str__(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__str__", __pyx_f[0], 94, 0, <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.FieldBase.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Print representation of empty field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0097</span>:         <span class="k">return</span> <span class="s">&quot;Field&lt;&gt;&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_Field);
  __pyx_r = __pyx_kp_s_Field;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0098</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0099</span>:     <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static int __pyx_pw_6chromo_6fields_9FieldBase_5__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
static char __pyx_doc_6chromo_6fields_9FieldBase_4__contains__[] = "Check if a polymer is currently set to interact with this field.\n\n        Notes\n        -----\n        No polymers interact with the base field object.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_9FieldBase_4__contains__;
#endif
static int __pyx_pw_6chromo_6fields_9FieldBase_5__contains__(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__contains__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_9FieldBase_4__contains__(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), ((PyObject *)__pyx_v_poly));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_6fields_9FieldBase_4__contains__(struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self, PyObject *__pyx_v_poly) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__contains__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__contains__", __pyx_f[0], 99, 0, <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.FieldBase.__contains__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a polymer is currently set to interact with this field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span class="sd">        No polymers interact with the base field object.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">polymers</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;polymers, __pyx_n_s_contains);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_poly) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_poly);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0107</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_6fields_9FieldBase_compute_dE(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self, CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_inds, CYTHON_UNUSED long __pyx_v_n_inds, CYTHON_UNUSED long __pyx_v_packet_size, CYTHON_UNUSED int __pyx_v_state_change) {
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("compute_dE", __pyx_f[0], 108, 0, <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.FieldBase.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0109</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>:         <span class="nb">long</span> <span class="n">packet_size</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the change in field energy due to a proposed move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0114</span>:         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="s">&quot;Reading compute_dE from base class&quot;</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_builtin_NotImplementedError, __pyx_kp_s_Reading_compute_dE_from_base_cla, 0, 0);
  <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0115</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0116</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">update_affected_densities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_9FieldBase_update_affected_densities(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_affected_densities", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_affected_densities", __pyx_f[0], 116, 0, <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.FieldBase.update_affected_densities", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0117</span>:         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">,</span> <span class="w">\</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_builtin_NotImplementedError, __pyx_kp_s_Reading_update_affected_densitie, 0, 0);
  <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0118</span>:             <span class="s">&quot;Reading update_affected_densities from base class&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">get_confinement_dE</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>static double __pyx_f_6chromo_6fields_9FieldBase_get_confinement_dE(struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_beads, int __pyx_v_trial) {
  long __pyx_v_i;
  long __pyx_v_num_out_of_bounds;
  double __pyx_v_dist;
  long __pyx_v_j;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_confinement_dE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_confinement_dE", __pyx_f[0], 121, 0, <span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.FieldBase.get_confinement_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0122</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_beads</span><span class="p">,</span> <span class="nb">int</span> <span class="n">trial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate the energy associated with a confining boundary.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="sd">        A large energy is assigned to any point lies outside the confinement;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="sd">        otherwise, an energy contribution of zero is returned.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">        This method is where different confinement types can be defined.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">        However, if a non-spherical confinement is defined, adjustments need</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: <span class="sd">        to be made to `self.get_accessible_volumes()`, which currently supports</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: <span class="sd">        spherical confinements.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>: <span class="sd">            The polymer which has been moved.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: <span class="sd">        inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: <span class="sd">            Vector of bead indices for which to evaluate confinement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>: <span class="sd">        n_beads : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>: <span class="sd">            Number of beads for which to evaluate confinement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>: <span class="sd">        trial : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: <span class="sd">            Indicator of whether to evaluate confinement on trial positions (1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>: <span class="sd">            or current positions (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>: <span class="sd">            Energy contribution of the confinement; either zero if all points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>: <span class="sd">            lie inside the confinement or some large value ensuring the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: <span class="sd">            gets rejected if any point lies outside the confinement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">num_out_of_bounds</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_out_of_bounds = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0157</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dist</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>:         <span class="c"># No Confinement</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">==</span> <span class="s">&quot;&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;confine_type, __pyx_kp_s_, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0161</span>:             <span class="k">return</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0.;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:         <span class="c"># Spherical confinement</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">==</span> <span class="s">&quot;Spherical&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;confine_type, __pyx_n_s_Spherical, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 164, __pyx_L1_error)</span>
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0165</span>:             <span class="k">if</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_trial) {
      case 1:
/* … */
      break;
      case 0:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_3 = __pyx_v_n_beads;
      __pyx_t_4 = __pyx_t_3;
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
        __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0167</span>:                     <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_dist = sqrt(__pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_t_8, __pyx_t_9));
/* … */
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
        __pyx_t_8.memview = NULL;
        __pyx_t_8.data = NULL;
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
        __pyx_t_9.memview = NULL;
        __pyx_t_9.data = NULL;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:                         <span class="n">vec_dot3</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span></pre>
<pre class='cython code score-24 '>        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>}
        __pyx_t_6 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>
        }
        __pyx_t_8.data = __pyx_v_poly-&gt;r_trial.data;
        __pyx_t_8.memview = __pyx_v_poly-&gt;r_trial.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
        {
    Py_ssize_t __pyx_tmp_idx = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_poly-&gt;r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_poly-&gt;r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>
        }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_poly-&gt;r_trial.shape[1];
__pyx_t_8.strides[0] = __pyx_v_poly-&gt;r_trial.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>}
        __pyx_t_6 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>
        }
        __pyx_t_9.data = __pyx_v_poly-&gt;r_trial.data;
        __pyx_t_9.memview = __pyx_v_poly-&gt;r_trial.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
        {
    Py_ssize_t __pyx_tmp_idx = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_poly-&gt;r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_poly-&gt;r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_poly-&gt;r_trial.shape[1];
__pyx_t_9.strides[0] = __pyx_v_poly-&gt;r_trial.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0170</span>:                     <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = ((__pyx_v_dist &gt; __pyx_v_self-&gt;confine_length) != 0);
        if (__pyx_t_1) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0171</span>:                         <span class="n">num_out_of_bounds</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_num_out_of_bounds = (__pyx_v_num_out_of_bounds + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:             <span class="k">elif</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_3 = __pyx_v_n_beads;
      __pyx_t_4 = __pyx_t_3;
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
        __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:                     <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">vec_dot3</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]))</span></pre>
<pre class='cython code score-24 '>        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>}
        __pyx_t_6 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_9.data = __pyx_v_poly-&gt;r.data;
        __pyx_t_9.memview = __pyx_v_poly-&gt;r.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
        {
    Py_ssize_t __pyx_tmp_idx = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_poly-&gt;r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_poly-&gt;r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_poly-&gt;r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_poly-&gt;r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>}
        __pyx_t_6 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_8.data = __pyx_v_poly-&gt;r.data;
        __pyx_t_8.memview = __pyx_v_poly-&gt;r.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
        {
    Py_ssize_t __pyx_tmp_idx = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_poly-&gt;r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_poly-&gt;r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 174, __pyx_L1_error)</span>
        }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_poly-&gt;r.shape[1];
__pyx_t_8.strides[0] = __pyx_v_poly-&gt;r.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_v_dist = sqrt(__pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_t_9, __pyx_t_8));
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
        __pyx_t_9.memview = NULL;
        __pyx_t_9.data = NULL;
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
        __pyx_t_8.memview = NULL;
        __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:                     <span class="k">if</span> <span class="n">dist</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = ((__pyx_v_dist &gt; __pyx_v_self-&gt;confine_length) != 0);
        if (__pyx_t_1) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:                         <span class="n">num_out_of_bounds</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_num_out_of_bounds = (__pyx_v_num_out_of_bounds + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Trial flag &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; not found.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_trial);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Trial_flag, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_kp_s_not_found);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_10, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
      break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>:             <span class="k">return</span> <span class="n">num_out_of_bounds</span> <span class="o">*</span> <span class="n">E_HUGE</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_num_out_of_bounds * __pyx_v_6chromo_6fields_E_HUGE);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0180</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0181</span>:         <span class="c"># Cubical confinement</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">==</span> <span class="s">&quot;Cubical&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;confine_type, __pyx_n_s_Cubical, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (likely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0183</span>:             <span class="k">if</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    switch (__pyx_v_trial) {
      case 1:
/* … */
      break;
      case 0:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_3 = __pyx_v_n_beads;
      __pyx_t_4 = __pyx_t_3;
      for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
        __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
          __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:                         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">/</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-49 '>          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>}
          __pyx_t_6 = __pyx_v_i;
          __pyx_t_7 = -1;
          if (__pyx_t_6 &lt; 0) {
            __pyx_t_6 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
          }
          __pyx_t_14 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
          __pyx_t_15 = __pyx_v_j;
          __pyx_t_7 = -1;
          if (__pyx_t_14 &lt; 0) {
            __pyx_t_14 += __pyx_v_poly-&gt;r_trial.shape[0];
            if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_7 = 0;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_poly-&gt;r_trial.shape[1];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 1;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_7 = 1;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
          }
          __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_14 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_15)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_16 = NULL;
          if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
            __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
            if (likely(__pyx_t_16)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
            }
          }
          __pyx_t_10 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_16, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;confine_length / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_10, __pyx_t_13, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_11); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (__pyx_t_2) {
/* … */
          }
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:                             <span class="n">num_out_of_bounds</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_v_num_out_of_bounds = (__pyx_v_num_out_of_bounds + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:             <span class="k">elif</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      break;
      default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:                 <span class="k">if</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_trial == 1) != 0);
      if (__pyx_t_2) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_3 = __pyx_v_n_beads;
        __pyx_t_4 = __pyx_t_3;
        for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
          __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:                         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
            __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0192</span>:                             <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">/</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-49 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
            __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 192, __pyx_L1_error)</span>}
            __pyx_t_6 = __pyx_v_i;
            __pyx_t_7 = -1;
            if (__pyx_t_6 &lt; 0) {
              __pyx_t_6 += __pyx_v_inds.shape[0];
              if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 192, __pyx_L1_error)</span>
            }
            __pyx_t_15 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
            __pyx_t_14 = __pyx_v_j;
            __pyx_t_7 = -1;
            if (__pyx_t_15 &lt; 0) {
              __pyx_t_15 += __pyx_v_poly-&gt;r.shape[0];
              if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_14 &lt; 0) {
              __pyx_t_14 += __pyx_v_poly-&gt;r.shape[1];
              if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_7 = 1;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 192, __pyx_L1_error)</span>
            }
            __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_15 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_14)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
            __pyx_t_16 = NULL;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
              __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
              if (likely(__pyx_t_16)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
              }
            }
            __pyx_t_11 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_16, __pyx_t_13) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;confine_length / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            __pyx_t_13 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_11, __pyx_t_10, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_13); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 192, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            if (__pyx_t_2) {
/* … */
            }
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>:                                 <span class="n">num_out_of_bounds</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>              __pyx_v_num_out_of_bounds = (__pyx_v_num_out_of_bounds + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0194</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0195</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Trial flag &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; not found.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_trial);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Trial_flag, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_kp_s_not_found);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_13, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
      break;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0196</span>:             <span class="k">return</span> <span class="n">num_out_of_bounds</span> <span class="o">*</span> <span class="n">E_HUGE</span></pre>
<pre class='cython code score-0 '>    __pyx_r = (__pyx_v_num_out_of_bounds * __pyx_v_6chromo_6fields_E_HUGE);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>:         <span class="c"># Confinement type not found</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>  /*else*/ {
/* … */
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 200, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_13, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:                 <span class="s">&quot;Confinement type &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">+</span> <span class="s">&quot; not found.&quot;</span></pre>
<pre class='cython code score-11 '>    __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Confinement_type, __pyx_v_self-&gt;confine_type);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_13, __pyx_kp_s_not_found);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0202</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0204</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>: <span class="k">class</span> <span class="nc">Reconstructor</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_empty_tuple, __pyx_n_s_Reconstructor, __pyx_n_s_Reconstructor, (PyObject *) NULL, __pyx_n_s_chromo_fields, __pyx_kp_s_Defer_defining_Field_until_after);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_2 = __Pyx_Py3ClassCreate(((PyObject*)&amp;__Pyx_DefaultClassType), __pyx_n_s_Reconstructor, __pyx_empty_tuple, __pyx_t_1, NULL, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Reconstructor, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Defer defining `Field` until after `PolymerBase`/`Binder` instances.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>: <span class="sd">    Constructs a kwargs object that can be re-passed to the appropriate `Field`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>: <span class="sd">    constructor when they become available.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: <span class="sd">    field_constructor : cls</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>: <span class="sd">        Class from which the field will be instantiated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>: <span class="sd">    kwargs : Dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>: <span class="sd">        Keyword arguments used to instantiate the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0221</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre>
<pre class='cython code score-46 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_13Reconstructor_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_13Reconstructor___init__[] = "Construct our Reconstructor.\n\n        Parameters\n        ----------\n        field_constructor : cls\n            Class from which the field will be instantiated\n        ";
static PyMethodDef __pyx_mdef_6chromo_6fields_13Reconstructor_1__init__ = {"__init__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_6fields_13Reconstructor_1__init__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_6fields_13Reconstructor___init__};
static PyObject *__pyx_pw_6chromo_6fields_13Reconstructor_1__init__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_cls,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cls)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_cls = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_13Reconstructor___init__(__pyx_self, __pyx_v_self, __pyx_v_cls, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_13Reconstructor___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_cls, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__2)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 221, 0, <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__50 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_self, __pyx_n_s_cls, __pyx_n_s_kwargs);<span class='error_goto'> if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__50);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__50);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6chromo_6fields_13Reconstructor_1__init__, 0, __pyx_n_s_Reconstructor___init, NULL, __pyx_n_s_chromo_fields, __pyx_d, ((PyObject *)__pyx_codeobj__2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_1, __pyx_n_s_init, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__2 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_fields_pyx, __pyx_n_s_init, 221, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 221, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0222</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct our Reconstructor.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0224</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0225</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0226</span>: <span class="sd">        field_constructor : cls</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>: <span class="sd">            Class from which the field will be instantiated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0228</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">field_constructor</span> <span class="o">=</span> <span class="n">cls</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_field_constructor, __pyx_v_cls) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span></pre>
<pre class='cython code score-2 '>  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_kwargs, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:     <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FieldBase</span><span class="p">:</span></pre>
<pre class='cython code score-57 '>/* Python wrapper */
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_3finalize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_13Reconstructor_2finalize[] = "Finish construction of appropriate `Field` object.\n\n        Parameters\n        ----------\n        polymers : List[PolymerBase]\n            List of polymers contained in the field\n        binders : pd.DataFrame\n            Table representing reader proteins bound to polymers in the field\n\n        Returns\n        -------\n        FieldBase\n            Field representation of discretized space containing polymers\n        ";
static PyMethodDef __pyx_mdef_6chromo_6fields_13Reconstructor_3finalize = {"finalize", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_6fields_13Reconstructor_3finalize, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_6fields_13Reconstructor_2finalize};
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_3finalize(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_binders = 0;
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("finalize (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_binders,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("finalize", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binders)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("finalize", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "finalize") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_self = values[0];
    __pyx_v_polymers = values[1];
    __pyx_v_binders = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("finalize", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.finalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_13Reconstructor_2finalize(__pyx_self, __pyx_v_self, __pyx_v_polymers, __pyx_v_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pf_6chromo_6fields_13Reconstructor_2finalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_polymers, PyObject *__pyx_v_binders) {
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__3)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("finalize", 0);
  <span class='trace'>__Pyx_TraceCall</span>("finalize", __pyx_f[0], 232, 0, <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.finalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_self, __pyx_n_s_polymers, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_u_FieldBase) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6chromo_6fields_13Reconstructor_3finalize, 0, __pyx_n_s_Reconstructor_finalize, NULL, __pyx_n_s_chromo_fields, __pyx_d, ((PyObject *)__pyx_codeobj__3));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_1, __pyx_n_s_finalize, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__3 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_fields_pyx, __pyx_n_s_finalize, 232, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0233</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finish construction of appropriate `Field` object.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="sd">        polymers : List[PolymerBase]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: <span class="sd">            List of polymers contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: <span class="sd">        binders : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: <span class="sd">            Table representing reader proteins bound to polymers in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: <span class="sd">        FieldBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>: <span class="sd">            Field representation of discretized space containing polymers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0247</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_constructor</span><span class="p">(</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_field_constructor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_6chromo_6fields_FieldBase))))) <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
  __pyx_r = ((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:             <span class="n">polymers</span><span class="o">=</span><span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="o">=</span><span class="n">binders</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span></pre>
<pre class='cython code score-22 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_polymers, __pyx_v_polymers) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_binders, __pyx_v_binders) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(__pyx_t_3 == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  }
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_2, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0249</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0251</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-6 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_1, __pyx_n_s_from_file_2, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:     <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FieldBase</span><span class="p">:</span></pre>
<pre class='cython code score-59 '>/* Python wrapper */
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_5from_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_13Reconstructor_4from_file[] = "Assume class name is encoded in file name.\n\n        Parameters\n        ----------\n        path : Path\n            File path object directed to the file defining the field\n\n        Returns\n        -------\n        FieldBase\n            Field representation of discretized space containing polymers\n        ";
static PyMethodDef __pyx_mdef_6chromo_6fields_13Reconstructor_5from_file = {"from_file", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_6fields_13Reconstructor_5from_file, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_6fields_13Reconstructor_4from_file};
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_5from_file(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_cls = 0;
  PyObject *__pyx_v_path = 0;
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_cls,&amp;__pyx_n_s_path,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cls)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "from_file") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_cls = values[0];
    __pyx_v_path = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_13Reconstructor_4from_file(__pyx_self, __pyx_v_cls, __pyx_v_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pf_6chromo_6fields_13Reconstructor_4from_file(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_cls, PyObject *__pyx_v_path) {
  PyObject *__pyx_v_constructor = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__4)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file", 0);
  <span class='trace'>__Pyx_TraceCall</span>("from_file", __pyx_f[0], 252, 0, <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_constructor);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__52 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_cls, __pyx_n_s_path, __pyx_n_s_constructor, __pyx_n_s_kwargs);<span class='error_goto'> if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__52);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__52);
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_Path);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_path, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_u_FieldBase) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 252, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6chromo_6fields_13Reconstructor_5from_file, __Pyx_CYFUNCTION_CLASSMETHOD, __pyx_n_s_Reconstructor_from_file, NULL, __pyx_n_s_chromo_fields, __pyx_d, ((PyObject *)__pyx_codeobj__4));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__4 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_fields_pyx, __pyx_n_s_from_file_2, 252, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 252, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0253</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Assume class name is encoded in file name.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0257</span>: <span class="sd">        path : Path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0258</span>: <span class="sd">            File path object directed to the file defining the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>: <span class="sd">        FieldBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>: <span class="sd">            Field representation of discretized space containing polymers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:         <span class="n">constructor</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="n">path</span><span class="o">.</span><span class="n">name</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Globals</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_path, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_constructor = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:         <span class="n">kwargs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></pre>
<pre class='cython code score-44 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_read_csv);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_v_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_dict);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_kwargs = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">constructor</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_constructor);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_constructor);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_constructor);
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    <span class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
  }
  if (likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_v_kwargs))) {
    __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  } else {
    __pyx_t_4 = <span class='py_c_api'>PyObject_CallFunctionObjArgs</span>((PyObject*)&amp;PyDict_Type, __pyx_v_kwargs, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_cls, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_6chromo_6fields_FieldBase))))) <span class='error_goto'>__PYX_ERR(0, 267, __pyx_L1_error)</span>
  __pyx_r = ((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_t_2);
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0268</span>: </pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0269</span>:     <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FieldBase</span><span class="p">:</span></pre>
<pre class='cython code score-58 '>/* Python wrapper */
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_7__call__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_13Reconstructor_6__call__[] = "Synonym for `Reconstructor.finalize()`.\n\n        Notes\n        -----\n        See documentation for `Reconstructor.finalize()` for additional\n        details and parameter/returns definitions.\n        ";
static PyMethodDef __pyx_mdef_6chromo_6fields_13Reconstructor_7__call__ = {"__call__", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_6fields_13Reconstructor_7__call__, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_6fields_13Reconstructor_6__call__};
static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pw_6chromo_6fields_13Reconstructor_7__call__(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_binders = 0;
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_binders,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binders)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__call__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_self = values[0];
    __pyx_v_polymers = values[1];
    __pyx_v_binders = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__call__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_13Reconstructor_6__call__(__pyx_self, __pyx_v_self, __pyx_v_polymers, __pyx_v_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_pf_6chromo_6fields_13Reconstructor_6__call__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_polymers, PyObject *__pyx_v_binders) {
  struct __pyx_obj_6chromo_6fields_FieldBase *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__5)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__call__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__call__", __pyx_f[0], 269, 0, <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.Reconstructor.__call__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__53 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_self, __pyx_n_s_polymers, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__53);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__53);
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_u_FieldBase) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6chromo_6fields_13Reconstructor_7__call__, 0, __pyx_n_s_Reconstructor___call, NULL, __pyx_n_s_chromo_fields, __pyx_d, ((PyObject *)__pyx_codeobj__5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_1, __pyx_n_s_call, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 269, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__5 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_fields_pyx, __pyx_n_s_call, 269, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 269, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0270</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Synonym for `Reconstructor.finalize()`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>: <span class="sd">        See documentation for `Reconstructor.finalize()` for additional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: <span class="sd">        details and parameter/returns definitions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_finalize);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_polymers, __pyx_v_binders};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_polymers, __pyx_v_binders};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_polymers);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_polymers);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_polymers);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_binders);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_binders);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_binders);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_6chromo_6fields_FieldBase))))) <span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>
  __pyx_r = ((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0280</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">NullField</span><span class="p">(</span><span class="n">FieldBase</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_6fields_NullField {
  struct __pyx_vtabstruct_6chromo_6fields_FieldBase __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_6fields_NullField *__pyx_vtabptr_6chromo_6fields_NullField;

</pre><pre class="cython line score-0">&#xA0;<span class="">0281</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;A field with no energy contributions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0282</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0283</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">polymers</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">confine_type</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">confine_length</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span></pre>
<pre class='cython code score-36 '>/* Python wrapper */
static int __pyx_pw_6chromo_6fields_9NullField_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6chromo_6fields_9NullField_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_confine_type = 0;
  PyObject *__pyx_v_confine_length = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_confine_type,&amp;__pyx_n_s_confine_length,0};
    PyObject* values[3] = {0,0,0};
    values[0] = ((PyObject *)Py_None);
    values[1] = ((PyObject *)__pyx_kp_s_);
    values[2] = ((PyObject *)__pyx_float_0_0);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers);
          if (value) { values[0] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_type);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_length);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_polymers = values[0];
    __pyx_v_confine_type = values[1];
    __pyx_v_confine_length = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 0, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.NullField.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_9NullField___init__(((struct __pyx_obj_6chromo_6fields_NullField *)__pyx_v_self), __pyx_v_polymers, __pyx_v_confine_type, __pyx_v_confine_length);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_6fields_9NullField___init__(struct __pyx_obj_6chromo_6fields_NullField *__pyx_v_self, PyObject *__pyx_v_polymers, PyObject *__pyx_v_confine_type, PyObject *__pyx_v_confine_length) {
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 284, 0, <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_polymers);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.NullField.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_polymers);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:         <span class="k">if</span> <span class="n">polymers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_polymers == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:             <span class="n">polymers</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-6 '>    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_polymers, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0287</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">NullField</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-28 '>  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_6fields_NullField));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_6fields_NullField));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_ptype_6chromo_6fields_NullField));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_polymers);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_polymers);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_polymers);
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:             <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
    }
  }
  __pyx_t_6 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_binders, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0289</span>:         <span class="p">)</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">=</span> <span class="n">confine_type</span></pre>
<pre class='cython code score-12 '>  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_confine_type))||((__pyx_v_confine_type) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_confine_type)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>
  __pyx_t_6 = __pyx_v_confine_type;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.confine_type);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.confine_type);
  __pyx_v_self-&gt;__pyx_base.confine_type = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0291</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">=</span> <span class="n">confine_length</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_confine_length); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>
  __pyx_v_self-&gt;__pyx_base.confine_length = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0292</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:     <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_9NullField_3to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_6fields_9NullField_2to_file[] = "Save Field description.\n        ";
static PyObject *__pyx_pw_6chromo_6fields_9NullField_3to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_9NullField_2to_file(((struct __pyx_obj_6chromo_6fields_NullField *)__pyx_v_self), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_9NullField_2to_file(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_NullField *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file", 0);
  <span class='trace'>__Pyx_TraceCall</span>("to_file", __pyx_f[0], 293, 0, <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.NullField.to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0294</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Save Field description.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:         <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">):</span></pre>
<pre class='cython code score-44 '>  /*with:*/ {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_path);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_w);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_w);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_w);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_open, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_2, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_2, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_1 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    /*try:*/ {
      {
        /*try:*/ {
        }
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_3) {
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__6, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    goto __pyx_L13;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L1_error;
    __pyx_L13:;
  }
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-0">&#xA0;<span class="">0297</span>:             <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_6fields_NullField-&gt;tp_dict, __pyx_n_s_from_file_2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_6fields_NullField);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:     <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_9NullField_5from_file(PyObject *__pyx_v_cls, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_6fields_9NullField_4from_file[] = "Load Field description.\n        ";
static PyObject *__pyx_pw_6chromo_6fields_9NullField_5from_file(PyObject *__pyx_v_cls, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_9NullField_4from_file(((PyTypeObject*)__pyx_v_cls), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_9NullField_4from_file(PyTypeObject *__pyx_v_cls, CYTHON_UNUSED PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file", 0);
  <span class='trace'>__Pyx_TraceCall</span>("from_file", __pyx_f[0], 300, 0, <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.NullField.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_6fields_NullField, __pyx_n_s_from_file_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0301</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Load Field description.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">()</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(((PyObject *)__pyx_v_cls));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0304</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0305</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_6fields_9NullField_compute_dE(struct __pyx_obj_6chromo_6fields_NullField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, CYTHON_UNUSED long __pyx_v_packet_size, CYTHON_UNUSED int __pyx_v_state_change) {
  double __pyx_v_dE;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("compute_dE", __pyx_f[0], 305, 0, <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.NullField.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0306</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>:         <span class="nb">long</span> <span class="n">packet_size</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the change in energy associated with the null field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: <span class="sd">        The field energy change associated with the null field can only come</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: <span class="sd">        from the confinement.        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:         <span class="n">dE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_confinement_dE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = ((struct __pyx_vtabstruct_6chromo_6fields_NullField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.get_confinement_dE(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:         <span class="n">dE</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_confinement_dE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = (__pyx_v_dE - ((struct __pyx_vtabstruct_6chromo_6fields_NullField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.get_confinement_dE(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:         <span class="k">return</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_dE;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0319</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">update_affected_densities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_9NullField_update_affected_densities(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_NullField *__pyx_v_self) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_affected_densities", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_affected_densities", __pyx_f[0], 320, 0, <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.NullField.update_affected_densities", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0321</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">UniformDensityField</span><span class="p">(</span><span class="n">FieldBase</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField {
  struct __pyx_vtabstruct_6chromo_6fields_FieldBase __pyx_base;
  void (*precompute_ind_xyz_to_super)(struct __pyx_obj_6chromo_6fields_UniformDensityField *);
  void (*init_fast_field)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, long);
  PyObject *(*get_accessible_volumes)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, long, int, int __pyx_skip_dispatch);
  __Pyx_memviewslice (*get_voxel_coords)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, __Pyx_memviewslice);
  __Pyx_memviewslice (*get_split_voxels)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, __Pyx_memviewslice, double);
  __Pyx_memviewslice (*define_voxel_subgrid)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, long);
  double (*get_frac_accessible)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, __Pyx_memviewslice, __Pyx_memviewslice);
  __Pyx_memviewslice (*get_change_in_density)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, int);
  __Pyx_memviewslice (*get_change_in_density_quickly)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, int);
  void (*_generate_weight_vector_with_trial)(struct __pyx_obj_6chromo_6fields_UniformDensityField *);
  void (*_generate_index_vector_with_trial)(struct __pyx_obj_6chromo_6fields_UniformDensityField *);
  double (*get_dE_binders_and_beads)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, __Pyx_memviewslice, int);
  double (*nonspecific_interact_dE)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long);
  __Pyx_memviewslice (*get_volume_fractions_with_trial)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, double, __Pyx_memviewslice, long);
  void (*count_doubly_bound)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long, int, int);
  double (*compute_E)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, int __pyx_skip_dispatch);
  void (*update_all_densities)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice &amp;, long, int __pyx_skip_dispatch);
  void (*update_all_densities_for_all_polymers)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, int __pyx_skip_dispatch);
  void (*_generate_weight_vector)(struct __pyx_obj_6chromo_6fields_UniformDensityField *);
  void (*_generate_index_vector)(struct __pyx_obj_6chromo_6fields_UniformDensityField *);
  double (*get_E_binders_and_beads)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long);
  double (*nonspecific_interact_E)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, int __pyx_skip_dispatch);
  __Pyx_memviewslice (*get_volume_fractions)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, double);
  __Pyx_memviewslice (*get_coordinates_at_inds)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, __Pyx_memviewslice &amp;, __Pyx_memviewslice &amp;, long &amp;);
  __Pyx_memviewslice (*get_states_at_inds)(struct __pyx_obj_6chromo_6fields_UniformDensityField *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, long);
};
static struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *__pyx_vtabptr_6chromo_6fields_UniformDensityField;

</pre><pre class="cython line score-0">&#xA0;<span class="">0325</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Rectilinear discretization of space as a rectangular box.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: <span class="sd">    Each bead contributes &quot;mass&quot; to the eight nearest voxels containing it.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: <span class="sd">    The mass is linearly interpolated based on the distance of the bead from</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: <span class="sd">    the center of each voxel. This is much more stable numerically than just</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: <span class="sd">    using the voxels as &quot;bins,&quot; as would be done in e.g., finite-difference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>: <span class="sd">    discretization.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: <span class="sd">    Many attributes are updated during each calculation of field energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: <span class="sd">    change. We choose to track and update these attributes to avoid costly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: <span class="sd">    array initialization during each iteration of the MC simulation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="sd">    Affected attributes are identified with the &quot;TEMP&quot; flag in their</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: <span class="sd">    description.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>: <span class="sd">    Attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: <span class="sd">    _field_descriptors : List[str]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: <span class="sd">        Names of attributes which describe the geometric layout of the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>: <span class="sd">        as a grid of voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>: <span class="sd">    x_width, y_width, z_width : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>: <span class="sd">        Dimensions of the discretized field in the x, y, and z directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>: <span class="sd">    width_xyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: <span class="sd">        Vectorized representation of the x, y, and z widths of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: <span class="sd">        discretized field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: <span class="sd">    nx, ny, nz : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>: <span class="sd">        Number of voxels in each of the x, y, and z directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: <span class="sd">    dx, dy, dz : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: <span class="sd">        Width of each voxel in the x, y, and z directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>: <span class="sd">    dxyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="sd">        Vectorized representation of the voxel widths in the x, y, and z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: <span class="sd">        directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="sd">    n_bins : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: <span class="sd">        Number of voxels in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: <span class="sd">    vol_bin : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>: <span class="sd">        Volume of each voxel; equal to `dx*dy*dz`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="sd">    bin_index : long[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="sd">        For each of the `nx*ny*nz` voxels in the field, stores indices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="sd">        identifying eight vertices at the corners of the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>: <span class="sd">    nbr_indices_with_trial : long[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: <span class="sd">        Super-indices of eight neighboring voxels containing a bead&#39;s</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>: <span class="sd">        position in space (dim1) from the polymer&#39;s current configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>: <span class="sd">        (dim1=0) and proposed configuration (dim1=1); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>: <span class="sd">    nbr_inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>: <span class="sd">        Super-indices of eight neighboring voxels containing a bead&#39;s</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0371</span>: <span class="sd">        position in space; TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>: <span class="sd">    index_xyz_with_trial : long[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>: <span class="sd">        Vector containing a bead&#39;s bin index in the x, y, and z directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0374</span>: <span class="sd">        (dim1) for the polymer&#39;s current configuration (dim0=0) and trial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>: <span class="sd">        configuration (dim0=1); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0376</span>: <span class="sd">    index_xyz : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0377</span>: <span class="sd">        Vector containing a bead&#39;s bin index in the x, y, z directions; TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0378</span>: <span class="sd">    wt_vec_with_trial : double [:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>: <span class="sd">        Bead&#39;s weight linearly interpolated between the eight nearest voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0380</span>: <span class="sd">        surrounding it (dim1) for a polymer&#39;s current configuration (dim0=0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>: <span class="sd">        and trial configuration (dim0=1); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>: <span class="sd">    wt_vec : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span class="sd">        Vector containing a bead&#39;s weight linearly interpolated between the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: <span class="sd">        eight nearest voxels surrounding it; TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: <span class="sd">    xyz_with_trial : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>: <span class="sd">        Position of the bead in the x, y, z directions (dim1), shifted during</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="sd">        linear interpolation of voxel weights for the polymer&#39;s current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: <span class="sd">        configuration (dim0=0) and trial configuration (dim0=1); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>: <span class="sd">    xyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>: <span class="sd">        Position of the bead in the x, y, z directions, shifted during linear</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>: <span class="sd">        interpolation of voxel weights; TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: <span class="sd">    weight_xyz_with_trial : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: <span class="sd">        Vector of a bead&#39;s linearly interpolated weights in a voxel in the x,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: <span class="sd">        y, z directions as determined for the voxel surrounding the bead with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>: <span class="sd">        the lowest x, y, z indices (dim1) for the polymer&#39;s current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: <span class="sd">        configuration (dim0=0) and tiral configuration (dim0=1); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: <span class="sd">    weight_xyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0398</span>: <span class="sd">        Vector of a bead&#39;s linearly interpolated weights in a voxel in the x,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: <span class="sd">        y, z directions as determined for the voxel surrounding the bead with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>: <span class="sd">        the lowest x, y, z indices; TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: <span class="sd">    num_binders : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0402</span>: <span class="sd">        Number of reader proteins bound to the polymer in the simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0403</span>: <span class="sd">    doubly_bound, doubly_bound_trial : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: <span class="sd">        Vectors indicating whether or not a bead is doubly bound by each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span class="sd">        tracked reader protein in the current polymer configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span class="sd">        (`doubly_bond`) and trial configuration (`doubly_bound_trial`); TEMP</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: <span class="sd">    confine_type : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: <span class="sd">        Name of the confining boundary around the polymer; if the polymer is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">        unconfined, `confine_type` is a blank string</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: <span class="sd">    confine_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span class="sd">        Length scale of the confining boundary</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">    density, density_trial : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>: <span class="sd">        Current (`density`) and proposed change (`density_trial`) in density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>: <span class="sd">        of beads (column 0) and each reader protein (columns 1...) in each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>: <span class="sd">        voxel of the discretized space; voxels are sorted by super-index and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>: <span class="sd">        arranged down the rows the the density arrays</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: <span class="sd">    access_vols : Dict[long, double]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: <span class="sd">        Mapping of voxel super-index (keys) to volume of the voxel inside the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="sd">        confining boundary (values).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="sd">    chi : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>: <span class="sd">        Negative local Flory-Huggins parameter dictating non-specific bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>: <span class="sd">        interaction, in units of (kT / bead vol. nondim. by bin vol.)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: <span class="sd">    dict_ : dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>: <span class="sd">        Dictionary of key attributes defining the field and their values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: <span class="sd">    binder_dict : dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: <span class="sd">        Dictionary representation of each reader protein and their properties</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>: <span class="sd">    half_width_xyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: <span class="sd">        Half the width of the full discretized space in the x, y,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>: <span class="sd">        and z directions; equivalent to `np.array([self.x_width/2,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: <span class="sd">        self.y_width/2, self.z_width/2])`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: <span class="sd">    half_step_xyz : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: <span class="sd">        Half the length of the voxel in single x, y, and z directions;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>: <span class="sd">        equivalent to `np.array([self.dx/2, self.dy/2, self.dz/2])`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>: <span class="sd">    n_xyz_m1 : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>: <span class="sd">        One less than the number of voxels that fit in the x, y, and z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>: <span class="sd">        directions of the  field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: <span class="sd">    inds_xyz_to_super : long[:, :, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: <span class="sd">        Array containing the super-index of each voxel (stored in the array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="sd">        values) for each combination of x-voxel position (dim0), y-voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>: <span class="sd">        position (dim1) and z-voxel position (dim2).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>: <span class="sd">    vf_limit : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>: <span class="sd">            Volume fraction limit in a voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>: <span class="sd">    fast_field : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>: <span class="sd">        If this value is `1`, a coarse-grained density field will be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>: <span class="sd">        evaluated using pre-computed sub-bin weightings; otherwise, bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0446</span>: <span class="sd">        weightings will be interpolated from bead positions during each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>: <span class="sd">        iteration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>: <span class="sd">    n_points : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0449</span>: <span class="sd">        Number of sub-bins to precompute in each dimension when the ``fast</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0450</span>: <span class="sd">        field&#39;&#39; is active; should be an even number</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0451</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0452</span>: </pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-95 '>/* Python wrapper */
static int __pyx_pw_6chromo_6fields_19UniformDensityField_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField___init__[] = "Construct a `UniformDensityField` containing polymers.\n\n        Parameters\n        ----------\n        polymers : List[PolymerBase]\n            List of polymers contained in the field\n        binders : pd.DataFrame\n            Output of `chromo.binders.make_binder_collection` applied to the\n            list of `Binder` objects contained in the field\n        x_width, y_width, z_width : double\n            Width of the box containing the field in the x, y, and z-directions\n        nx, ny, nz : long\n            Number of bins in the x, y, and z-directions\n        confine_type : str\n            Name of the confining boundary; to indicate model w/o confinement,\n            enter a blank string for this argument\n        confine_length : double\n            The lengthscale associated with the confining boundary; length\n            representation specified in function associated w/ `confine_type`\n        chi : double\n            Negative local Flory-Huggins parameter dictating non-specific bead\n            interaction (default = 1)\n        assume_fully_accessible : bint\n            Flag indicating whether to assume all voxels are fully accessible.\n            Assume voxels are fully accessible if the voxel volumes are far less\n            than the confinement volume. Value of `1` indicates that all voxels\n            are assumed to be fully accessible, bypassing the calculation of\n            accessible volume (default = 1).\n        vf_limit : Optional[float]\n            Volume fraction limit in a voxel (default = 0.5)\n        fast_field : Optional[bint]\n            If this value is `1`, a coarse-grained density field will be\n            evaluated using pre-computed sub-bin weightings; otherwise, bin\n            weightings will be interpolated from bead positions during each\n            iteration (default = 0)\n        n_points : Optional[long]\n            Number of sub-bins to precompute in each dimension when the ``fast\n            field''"" is active; should be an even number (default = 1000)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_19UniformDensityField___init__;
#endif
static int __pyx_pw_6chromo_6fields_19UniformDensityField_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_binders = 0;
  PyObject *__pyx_v_x_width = 0;
  PyObject *__pyx_v_nx = 0;
  PyObject *__pyx_v_y_width = 0;
  PyObject *__pyx_v_ny = 0;
  PyObject *__pyx_v_z_width = 0;
  PyObject *__pyx_v_nz = 0;
  PyObject *__pyx_v_confine_type = 0;
  PyObject *__pyx_v_confine_length = 0;
  PyObject *__pyx_v_chi = 0;
  PyObject *__pyx_v_assume_fully_accessible = 0;
  PyObject *__pyx_v_vf_limit = 0;
  PyObject *__pyx_v_fast_field = 0;
  PyObject *__pyx_v_n_points = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_binders,&amp;__pyx_n_s_x_width,&amp;__pyx_n_s_nx,&amp;__pyx_n_s_y_width,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_z_width,&amp;__pyx_n_s_nz,&amp;__pyx_n_s_confine_type,&amp;__pyx_n_s_confine_length,&amp;__pyx_n_s_chi,&amp;__pyx_n_s_assume_fully_accessible,&amp;__pyx_n_s_vf_limit,&amp;__pyx_n_s_fast_field,&amp;__pyx_n_s_n_points,0};
    PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[8] = ((PyObject *)__pyx_kp_s_);
    values[9] = ((PyObject *)__pyx_float_0_0);
    values[10] = ((PyObject *)__pyx_float_1_0);
    values[11] = ((PyObject *)__pyx_int_1);
    values[12] = ((PyObject *)__pyx_float_0_5);
    values[13] = ((PyObject *)__pyx_int_0);
    values[14] = ((PyObject *)__pyx_int_1000);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binders)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 1); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 2); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 3); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 4); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 5); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 6); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, 7); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_type);
          if (value) { values[8] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_length);
          if (value) { values[9] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_chi);
          if (value) { values[10] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_assume_fully_accessible);
          if (value) { values[11] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vf_limit);
          if (value) { values[12] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fast_field);
          if (value) { values[13] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_points);
          if (value) { values[14] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case 15: values[14] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_polymers = values[0];
    __pyx_v_binders = values[1];
    __pyx_v_x_width = values[2];
    __pyx_v_nx = values[3];
    __pyx_v_y_width = values[4];
    __pyx_v_ny = values[5];
    __pyx_v_z_width = values[6];
    __pyx_v_nz = values[7];
    __pyx_v_confine_type = values[8];
    __pyx_v_confine_length = values[9];
    __pyx_v_chi = values[10];
    __pyx_v_assume_fully_accessible = values[11];
    __pyx_v_vf_limit = values[12];
    __pyx_v_fast_field = values[13];
    __pyx_v_n_points = values[14];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 8, 15, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField___init__(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), __pyx_v_polymers, __pyx_v_binders, __pyx_v_x_width, __pyx_v_nx, __pyx_v_y_width, __pyx_v_ny, __pyx_v_z_width, __pyx_v_nz, __pyx_v_confine_type, __pyx_v_confine_length, __pyx_v_chi, __pyx_v_assume_fully_accessible, __pyx_v_vf_limit, __pyx_v_fast_field, __pyx_v_n_points);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_6fields_19UniformDensityField___init__(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, PyObject *__pyx_v_polymers, PyObject *__pyx_v_binders, PyObject *__pyx_v_x_width, PyObject *__pyx_v_nx, PyObject *__pyx_v_y_width, PyObject *__pyx_v_ny, PyObject *__pyx_v_z_width, PyObject *__pyx_v_nz, PyObject *__pyx_v_confine_type, PyObject *__pyx_v_confine_length, PyObject *__pyx_v_chi, PyObject *__pyx_v_assume_fully_accessible, PyObject *__pyx_v_vf_limit, PyObject *__pyx_v_fast_field, PyObject *__pyx_v_n_points) {
  PyObject *__pyx_v_poly = NULL;
  int __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 453, 0, <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_poly);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">,</span> <span class="n">x_width</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">y_width</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">z_width</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:         <span class="n">confine_type</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">confine_length</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">chi</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:         <span class="n">assume_fully_accessible</span> <span class="o">=</span> <span class="mf">1</span><span class="p">,</span> <span class="n">vf_limit</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">fast_field</span> <span class="o">=</span> <span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>:         <span class="n">n_points</span> <span class="o">=</span> <span class="mf">1000</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a `UniformDensityField` containing polymers.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">        polymers : List[PolymerBase]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">            List of polymers contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">        binders : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: <span class="sd">            Output of `chromo.binders.make_binder_collection` applied to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: <span class="sd">            list of `Binder` objects contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: <span class="sd">        x_width, y_width, z_width : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: <span class="sd">            Width of the box containing the field in the x, y, and z-directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>: <span class="sd">        nx, ny, nz : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>: <span class="sd">            Number of bins in the x, y, and z-directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>: <span class="sd">        confine_type : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0473</span>: <span class="sd">            Name of the confining boundary; to indicate model w/o confinement,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: <span class="sd">            enter a blank string for this argument</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>: <span class="sd">        confine_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>: <span class="sd">            The lengthscale associated with the confining boundary; length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>: <span class="sd">            representation specified in function associated w/ `confine_type`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>: <span class="sd">        chi : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>: <span class="sd">            Negative local Flory-Huggins parameter dictating non-specific bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>: <span class="sd">            interaction (default = 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>: <span class="sd">        assume_fully_accessible : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0482</span>: <span class="sd">            Flag indicating whether to assume all voxels are fully accessible.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: <span class="sd">            Assume voxels are fully accessible if the voxel volumes are far less</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>: <span class="sd">            than the confinement volume. Value of `1` indicates that all voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>: <span class="sd">            are assumed to be fully accessible, bypassing the calculation of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>: <span class="sd">            accessible volume (default = 1).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: <span class="sd">        vf_limit : Optional[float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>: <span class="sd">            Volume fraction limit in a voxel (default = 0.5)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span class="sd">        fast_field : Optional[bint]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: <span class="sd">            If this value is `1`, a coarse-grained density field will be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: <span class="sd">            evaluated using pre-computed sub-bin weightings; otherwise, bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: <span class="sd">            weightings will be interpolated from bead positions during each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>: <span class="sd">            iteration (default = 0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>: <span class="sd">        n_points : Optional[long]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>: <span class="sd">            Number of sub-bins to precompute in each dimension when the ``fast</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="sd">            field&#39;&#39; is active; should be an even number (default = 1000)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0498</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">UniformDensityField</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-20 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0499</span>:             <span class="n">polymers</span> <span class="o">=</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span> <span class="o">=</span> <span class="n">binders</span></pre>
<pre class='cython code score-12 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_polymers, __pyx_v_polymers) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 499, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binders, __pyx_v_binders) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 499, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0500</span>:         <span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0501</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_field_descriptors</span> <span class="o">=</span> <span class="n">_field_descriptors</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_6chromo_6fields__field_descriptors);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_6fields__field_descriptors);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_field_descriptors);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;_field_descriptors);
  __pyx_v_self-&gt;_field_descriptors = __pyx_v_6chromo_6fields__field_descriptors;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0502</span>:         <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polymers</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_polymers)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_polymers)) {
    __pyx_t_3 = __pyx_v_polymers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_polymers);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 502, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_poly, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0503</span>:             <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binders</span><span class="p">):</span></pre>
<pre class='cython code score-22 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_poly, __pyx_n_s_num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binders);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 503, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__pyx_t_8)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0504</span>:                 <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_NotImplementedError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 504, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 504, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_For_now_all_polymers_must_use_al);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 504, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0">&#xA0;<span class="">0505</span>:                     <span class="s">&quot;For now, all polymers must use all of the same binders.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span> <span class="o">=</span> <span class="n">x_width</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_x_width); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
  __pyx_v_self-&gt;x_width = __pyx_t_9;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span> <span class="o">=</span> <span class="n">y_width</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_y_width); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 508, __pyx_L1_error)</span>
  __pyx_v_self-&gt;y_width = __pyx_t_9;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0509</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span> <span class="o">=</span> <span class="n">z_width</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_z_width); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 509, __pyx_L1_error)</span>
  __pyx_v_self-&gt;z_width = __pyx_t_9;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0510</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">=</span> <span class="n">nx</span></pre>
<pre class='cython code score-7 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_nx); if (unlikely((__pyx_t_10 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 510, __pyx_L1_error)</span>
  __pyx_v_self-&gt;nx = __pyx_t_10;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0511</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">=</span> <span class="n">ny</span></pre>
<pre class='cython code score-7 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_ny); if (unlikely((__pyx_t_10 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span>
  __pyx_v_self-&gt;ny = __pyx_t_10;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0512</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">nz</span></pre>
<pre class='cython code score-7 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_nz); if (unlikely((__pyx_t_10 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 512, __pyx_L1_error)</span>
  __pyx_v_self-&gt;nz = __pyx_t_10;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0513</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">init_grid</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_init_grid);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0514</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binders</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binders);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 514, __pyx_L1_error)</span>
  __pyx_v_self-&gt;num_binders = __pyx_t_4;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0515</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 515, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 515, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;doubly_bound, 0);
  __pyx_v_self-&gt;doubly_bound = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 516, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 516, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;doubly_bound_trial, 0);
  __pyx_v_self-&gt;doubly_bound_trial = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0517</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">init_field_energy_prefactors</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_init_field_energy_prefactors);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_7 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 517, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0518</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;num_binders + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
  __pyx_t_7 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 518, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 518, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;density, 0);
  __pyx_v_self-&gt;density = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0519</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 519, __pyx_L1_error)</span>}
  __pyx_t_12 = __pyx_memoryview_copy_slice_d_dc_double_c(__pyx_v_self-&gt;density);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 519, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;density_trial, 0);
  __pyx_v_self-&gt;density_trial = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0520</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">=</span> <span class="n">confine_type</span></pre>
<pre class='cython code score-12 '>  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_v_confine_type))||((__pyx_v_confine_type) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_confine_type)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  __pyx_t_7 = __pyx_v_confine_type;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.confine_type);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.confine_type);
  __pyx_v_self-&gt;__pyx_base.confine_type = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">=</span> <span class="n">confine_length</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_confine_length); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 521, __pyx_L1_error)</span>
  __pyx_v_self-&gt;__pyx_base.confine_length = __pyx_t_9;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0522</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">assume_fully_accessible</span> <span class="o">=</span> <span class="n">assume_fully_accessible</span></pre>
<pre class='cython code score-7 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_assume_fully_accessible); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
  __pyx_v_self-&gt;assume_fully_accessible = __pyx_t_8;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0523</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_accessible_volumes</span><span class="p">(</span></pre>
<pre class='cython code score-1 '>  __pyx_t_7 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_accessible_volumes(__pyx_v_self, 20, __pyx_t_8, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;access_vols);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;access_vols);
  __pyx_v_self-&gt;access_vols = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:             <span class="n">n_side</span><span class="o">=</span><span class="mf">20</span><span class="p">,</span> <span class="n">assume_fully_accessible</span><span class="o">=</span><span class="n">assume_fully_accessible</span></pre>
<pre class='cython code score-7 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_assume_fully_accessible); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 524, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0525</span>:         <span class="p">)</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">chi</span> <span class="o">=</span> <span class="n">chi</span></pre>
<pre class='cython code score-10 '>  __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_chi); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>
  __pyx_v_self-&gt;chi = __pyx_t_9;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vf_limit</span> <span class="o">=</span> <span class="n">vf_limit</span></pre>
<pre class='cython code score-10 '>  __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_vf_limit); if (unlikely((__pyx_t_13 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>
  __pyx_v_self-&gt;vf_limit = __pyx_t_13;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">binder_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s">&#39;records&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_to_dict);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_orient, __pyx_n_s_records) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_2)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;binder_dict);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;binder_dict);
  __pyx_v_self-&gt;binder_dict = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">fast_field</span> <span class="o">=</span> <span class="n">fast_field</span></pre>
<pre class='cython code score-7 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_fast_field); if (unlikely((__pyx_t_8 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>
  __pyx_v_self-&gt;fast_field = __pyx_t_8;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:         <span class="k">if</span> <span class="n">fast_field</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_fast_field, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">init_fast_field</span><span class="p">(</span><span class="n">n_points</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_v_n_points); if (unlikely((__pyx_t_10 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;init_fast_field(__pyx_v_self, __pyx_t_10);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0532</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">update_all_densities_for_all_polymers</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;update_all_densities_for_all_polymers(__pyx_v_self, 0);
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">affected_bins_last_move</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 533, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;affected_bins_last_move, 0);
  __pyx_v_self-&gt;affected_bins_last_move = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0534</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dict</span><span class="p">()</span></pre>
<pre class='cython code score-29 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_dict);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_3 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_3)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 534, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;dict_);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;dict_);
  __pyx_v_self-&gt;dict_ = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0535</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0536</span>:     <span class="k">def</span> <span class="nf">init_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_3init_grid(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_2init_grid[] = "Initialize the discrete grid containing the field.\n\n        Notes\n        -----\n        The field will be represented by a grid of rectangular prism (typically\n        cubical) voxels, each of dimensions `dx` by `dy` by `dz`. To calculate\n        interaction energies, density will be determined inside each voxel and\n        a mean field approach will be applied.\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_3init_grid(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_grid (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_2init_grid(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_2init_grid(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_grid", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_grid", __pyx_f[0], 536, 0, <span class='error_goto'>__PYX_ERR(0, 536, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.init_grid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the discrete grid containing the field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">        The field will be represented by a grid of rectangular prism (typically</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">        cubical) voxels, each of dimensions `dx` by `dy` by `dz`. To calculate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        interaction energies, density will be determined inside each voxel and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">        a mean field approach will be applied.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0546</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;nx == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 546, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;dx = (__pyx_v_self-&gt;x_width / __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0547</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;ny == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;dy = (__pyx_v_self-&gt;y_width / __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0548</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_self-&gt;nz == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 548, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;dz = (__pyx_v_self-&gt;z_width / __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0549</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">])</span></pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dz);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 549, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;dxyz, 0);
  __pyx_v_self-&gt;dxyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0550</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_bins = ((__pyx_v_self-&gt;nx * __pyx_v_self-&gt;ny) * __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0551</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span></pre>
<pre class='cython code score-5 '>  __pyx_t_8 = ((__pyx_v_self-&gt;x_width * __pyx_v_self-&gt;y_width) * __pyx_v_self-&gt;z_width);
  if (unlikely(__pyx_v_self-&gt;n_bins == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 551, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;vol_bin = (__pyx_t_8 / __pyx_v_self-&gt;n_bins);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bin_index</span> <span class="o">=</span> <span class="n">UniformDensityField</span><span class="o">.</span><span class="n">_get_corner_bin_index</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField), __pyx_n_s_get_corner_bin_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;bin_index, 0);
  __pyx_v_self-&gt;bin_index = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0553</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-48 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;ny);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nz);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_9 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_6, __pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_6, __pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_t_4);
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0554</span>:         <span class="p">)</span></pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0555</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">width_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span><span class="p">])</span></pre>
<pre class='cython code score-46 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;x_width);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;y_width);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;z_width);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_5);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;width_xyz, 0);
  __pyx_v_self-&gt;width_xyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0556</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;half_width_xyz, 0);
  __pyx_v_self-&gt;half_width_xyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0557</span>:             <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span><span class="p">]</span></pre>
<pre class='cython code score-38 '>  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;x_width));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;y_width));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;z_width));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_4);
  __pyx_t_10 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0558</span>:         <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0559</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">half_step_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;half_step_xyz, 0);
  __pyx_v_self-&gt;half_step_xyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0560</span>:             <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">]</span></pre>
<pre class='cython code score-38 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;dx));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;dy));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((0.5 * __pyx_v_self-&gt;dz));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 560, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_5);
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_10) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0561</span>:         <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0562</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_xyz_m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;n_xyz_m1, 0);
  __pyx_v_self-&gt;n_xyz_m1 = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0563</span>:             <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">-</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-29 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;nx - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;ny - 1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;nz - 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_4);
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0564</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0565</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">precompute_ind_xyz_to_super</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;precompute_ind_xyz_to_super(__pyx_v_self);
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0566</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">8</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_8);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_tuple__9, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;nbr_inds, 0);
  __pyx_v_self-&gt;nbr_inds = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__8);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0567</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_8);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__11, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_10, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;nbr_inds_with_trial, 0);
  __pyx_v_self-&gt;nbr_inds_with_trial = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__10);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0568</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">8</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wt_vec, 0);
  __pyx_v_self-&gt;wt_vec = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_tuple__11, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wt_vec_with_trial, 0);
  __pyx_v_self-&gt;wt_vec_with_trial = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0570</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 570, __pyx_L1_error)</span>
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__13, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_10, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xyz, 0);
  __pyx_v_self-&gt;xyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__12);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_2, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 571, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__15, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;xyz_with_trial, 0);
  __pyx_v_self-&gt;xyz_with_trial = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__14);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 571, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_tuple__13, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;weight_xyz, 0);
  __pyx_v_self-&gt;weight_xyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__15, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_10, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;weight_xyz_with_trial, 0);
  __pyx_v_self-&gt;weight_xyz_with_trial = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0574</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__13, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;index_xyz, 0);
  __pyx_v_self-&gt;index_xyz = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_tuple__15, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;index_xyz_with_trial, 0);
  __pyx_v_self-&gt;index_xyz_with_trial = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0576</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0577</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">init_fast_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_points</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>static void __pyx_f_6chromo_6fields_19UniformDensityField_init_fast_field(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, long __pyx_v_n_points) {
  long __pyx_v_i;
  long __pyx_v_ind;
  long __pyx_v_lower_bin_ind;
  long __pyx_v_upper_bin_ind;
  double __pyx_v_lower_weight;
  double __pyx_v_upper_weight;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_fast_field", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_fast_field", __pyx_f[0], 577, 0, <span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.init_fast_field", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Precompute grid of sub-bins for efficiently interpolating densities.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="sd">        We will discretize the positions inside each voxel (forming &quot;sub-bins&quot;) </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: <span class="sd">        and precompute the voxel weightings inside each sub-bin. We will map</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="sd">        each sub-bin to a position in Cartesian space and to a pair of voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="sd">        splitting weight.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: <span class="sd">        With this discrete approach, we will no longer need to identify voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: <span class="sd">        containing beads and calculate associated weights from scratch during</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: <span class="sd">        the inner loop of the MC algorithm. We will identify the x, y, z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: <span class="sd">        sub-bins containing a point and we will look up the pre-computed voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: <span class="sd">        weightings. This is expected to reduce the runtime of the field energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: <span class="sd">        calculation, which accounts for the majority of the overall simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="sd">        runtime.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: <span class="sd">        This approach is only active when `fast_field` is set equal to `1` when</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: <span class="sd">        initializing the uniform density field. It is recommended to use this</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>: <span class="sd">        ``fast field&#39;&#39; approach when simulations involve more than one</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>: <span class="sd">        epigenetic mark or full chromosomes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>: <span class="sd">        n_points : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>: <span class="sd">            Number of sub-bins to precompute in each dimension when the ``fast</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: <span class="sd">            field&#39;&#39; is active; should be an even number</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">half_n_points</span><span class="p">,</span> <span class="nf">lower_bin_ind</span><span class="p">,</span> <span class="nf">upper_bin_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">lower_weight</span><span class="p">,</span> <span class="nf">upper_weight</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0610</span>:         <span class="n">n_points</span> <span class="o">=</span> <span class="n">n_points</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">%</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_points = (__pyx_v_n_points + __Pyx_mod_long(__pyx_v_n_points, 2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span> <span class="o">=</span> <span class="n">n_points</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_points = __pyx_v_n_points;
</pre><pre class="cython line score-0">&#xA0;<span class="">0612</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0613</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">n_points</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_points == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;sub_bin_width_x = (__pyx_v_self-&gt;dx / __pyx_v_n_points);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">/</span> <span class="n">n_points</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_points == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 614, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;sub_bin_width_y = (__pyx_v_self-&gt;dy / __pyx_v_n_points);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">/</span> <span class="n">n_points</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_points == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L1_error)</span>
  }
  __pyx_v_self-&gt;sub_bin_width_z = (__pyx_v_self-&gt;dz / __pyx_v_n_points);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_sub_bins_x = (__pyx_v_n_points * __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0617</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_sub_bins_y = (__pyx_v_n_points * __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_z</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_sub_bins_z = (__pyx_v_n_points * __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0619</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>:         <span class="c"># Map sub-bins to bins; map sub_bins to weights</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_x</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_x);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_x);
  __pyx_v_self-&gt;sub_bins_to_bins_x = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_y</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_y);
  __pyx_v_self-&gt;sub_bins_to_bins_y = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_z</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_z);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_bins_z);
  __pyx_v_self-&gt;sub_bins_to_bins_z = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_x</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_x);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_x);
  __pyx_v_self-&gt;sub_bins_to_weights_x = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_y</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_y);
  __pyx_v_self-&gt;sub_bins_to_weights_y = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_z</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-3 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_z);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;sub_bins_to_weights_z);
  __pyx_v_self-&gt;sub_bins_to_weights_z = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_x</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;n_sub_bins_x;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0629</span>:             <span class="n">ind</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_x</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-45 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_x);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>}
    __pyx_t_8 = 0;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
    }
    __pyx_t_10 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_10 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_7 / __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_11, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ind = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:             <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = ((__pyx_v_ind == -1L) != 0);
    if (__pyx_t_13) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_lower_bin_ind = (__pyx_v_self-&gt;nx - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0633</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_lower_bin_ind = __pyx_v_ind;
    }
    __pyx_L5:;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:             <span class="n">upper_bin_ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span></pre>
<pre class='cython code score-5 '>    __pyx_t_12 = (__pyx_v_ind + 1);
    if (unlikely(__pyx_v_self-&gt;nx == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
    }
    __pyx_v_upper_bin_ind = __Pyx_mod_long(__pyx_t_12, __pyx_v_self-&gt;nx);
</pre><pre class="cython line score-0">&#xA0;<span class="">0636</span>:             <span class="n">upper_weight</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:                 <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_x</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span></pre>
<pre class='cython code score-12 '>    __pyx_t_10 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_x);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>}
    __pyx_t_8 = 0;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_7 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    }
    __pyx_v_upper_weight = ((__pyx_t_10 / __pyx_t_7) - __pyx_v_ind);
</pre><pre class="cython line score-0">&#xA0;<span class="">0638</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:             <span class="n">lower_weight</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">upper_weight</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lower_weight = (1.0 - __pyx_v_upper_weight);
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0640</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_bin_ind</span><span class="p">,</span> <span class="n">upper_bin_ind</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_lower_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_upper_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
    __pyx_t_1 = 0;
    __pyx_t_6 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_x, __pyx_t_6, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_weight</span><span class="p">,</span> <span class="n">upper_weight</span><span class="p">]</span></pre>
<pre class='cython code score-31 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lower_weight);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_upper_weight);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_x, __pyx_t_6, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0642</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_y</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;n_sub_bins_y;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0644</span>:             <span class="n">ind</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0645</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_y</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-45 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_7 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_y);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>}
    __pyx_t_8 = 1;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
    }
    __pyx_t_10 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_10 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_7 / __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_1 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_11, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ind = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:             <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = ((__pyx_v_ind == -1L) != 0);
    if (__pyx_t_13) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_lower_bin_ind = (__pyx_v_self-&gt;ny - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0648</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_lower_bin_ind = __pyx_v_ind;
    }
    __pyx_L8:;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:             <span class="n">upper_bin_ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-5 '>    __pyx_t_12 = (__pyx_v_ind + 1);
    if (unlikely(__pyx_v_self-&gt;ny == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
    }
    __pyx_v_upper_bin_ind = __Pyx_mod_long(__pyx_t_12, __pyx_v_self-&gt;ny);
</pre><pre class="cython line score-0">&#xA0;<span class="">0651</span>:             <span class="n">upper_weight</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0652</span>:                 <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_y</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span></pre>
<pre class='cython code score-12 '>    __pyx_t_10 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_y);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 652, __pyx_L1_error)</span>}
    __pyx_t_8 = 1;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_7 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L1_error)</span>
    }
    __pyx_v_upper_weight = ((__pyx_t_10 / __pyx_t_7) - __pyx_v_ind);
</pre><pre class="cython line score-0">&#xA0;<span class="">0653</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0654</span>:             <span class="n">lower_weight</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">upper_weight</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lower_weight = (1.0 - __pyx_v_upper_weight);
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0655</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_bin_ind</span><span class="p">,</span> <span class="n">upper_bin_ind</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_lower_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_upper_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
    __pyx_t_1 = 0;
    __pyx_t_5 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_y, __pyx_t_5, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_weight</span><span class="p">,</span> <span class="n">upper_weight</span><span class="p">]</span></pre>
<pre class='cython code score-31 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lower_weight);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_upper_weight);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
    __pyx_t_6 = 0;
    __pyx_t_5 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_y, __pyx_t_5, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0657</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_z</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;n_sub_bins_z;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0659</span>:             <span class="n">ind</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_z</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-45 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_z);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>}
    __pyx_t_8 = 2;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
    }
    __pyx_t_10 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_10 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_7 / __pyx_t_10));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_11, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ind = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:             <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = ((__pyx_v_ind == -1L) != 0);
    if (__pyx_t_13) {
/* … */
      goto __pyx_L11;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_lower_bin_ind = (__pyx_v_self-&gt;nz - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0663</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:                 <span class="n">lower_bin_ind</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_lower_bin_ind = __pyx_v_ind;
    }
    __pyx_L11:;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:             <span class="n">upper_bin_ind</span> <span class="o">=</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span></pre>
<pre class='cython code score-5 '>    __pyx_t_12 = (__pyx_v_ind + 1);
    if (unlikely(__pyx_v_self-&gt;nz == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>
    }
    __pyx_v_upper_bin_ind = __Pyx_mod_long(__pyx_t_12, __pyx_v_self-&gt;nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">0666</span>:             <span class="n">upper_weight</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:                 <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">n_points</span><span class="o">/</span><span class="mf">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_z</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span></pre>
<pre class='cython code score-12 '>    __pyx_t_10 = ((__pyx_v_i - __Pyx_div_long(__pyx_v_n_points, 2)) * __pyx_v_self-&gt;sub_bin_width_z);
    if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>}
    __pyx_t_8 = 2;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
    if (unlikely(__pyx_t_7 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>
    }
    __pyx_v_upper_weight = ((__pyx_t_10 / __pyx_t_7) - __pyx_v_ind);
</pre><pre class="cython line score-0">&#xA0;<span class="">0668</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:             <span class="n">lower_weight</span> <span class="o">=</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">upper_weight</span></pre>
<pre class='cython code score-0 '>    __pyx_v_lower_weight = (1.0 - __pyx_v_upper_weight);
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_bin_ind</span><span class="p">,</span> <span class="n">upper_bin_ind</span><span class="p">]</span></pre>
<pre class='cython code score-25 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_lower_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_upper_bin_ind);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_6);
    __pyx_t_1 = 0;
    __pyx_t_6 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_z, __pyx_t_6, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lower_weight</span><span class="p">,</span> <span class="n">upper_weight</span><span class="p">]</span></pre>
<pre class='cython code score-31 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lower_weight);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_upper_weight);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6);
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_z, __pyx_t_6, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">precompute_ind_xyz_to_super</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>static void __pyx_f_6chromo_6fields_19UniformDensityField_precompute_ind_xyz_to_super(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("precompute_ind_xyz_to_super", 0);
  <span class='trace'>__Pyx_TraceCall</span>("precompute_ind_xyz_to_super", __pyx_f[0], 673, 0, <span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.precompute_ind_xyz_to_super", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0674</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Precompute how voxel (x, y, z) indices translate to superindices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0677</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_long</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;inds_xyz_to_super, 0);
  __pyx_v_self-&gt;inds_xyz_to_super = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span></pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;nx + 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;ny + 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_self-&gt;nz + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0679</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_v_self-&gt;nx + 1);
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = (__pyx_v_self-&gt;ny + 1);
    __pyx_t_11 = __pyx_t_10;
    for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0682</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (__pyx_v_self-&gt;nz + 1);
      __pyx_t_14 = __pyx_t_13;
      for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
        __pyx_v_k = __pyx_t_15;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inds_to_super_ind</span><span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_i;
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_18 = __pyx_v_k;
        __pyx_t_19 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_19 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_19 = 0;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_19 = 1;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_19 = 1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_19 = 2;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_19 = 2;
        if (unlikely(__pyx_t_19 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_19);
          <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_16 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_17 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_18)) )) = __pyx_f_6chromo_6fields_inds_to_super_ind(__Pyx_mod_long(__pyx_v_i, __pyx_v_self-&gt;nx), __Pyx_mod_long(__pyx_v_j, __pyx_v_self-&gt;ny), __Pyx_mod_long(__pyx_v_k, __pyx_v_self-&gt;nz), __pyx_v_self-&gt;nx, __pyx_v_self-&gt;ny);
      }
    }
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:                     <span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">j</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="n">k</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span></pre>
<pre class='cython code score-15 '>        if (unlikely(__pyx_v_self-&gt;nx == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
          <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
        }
        if (unlikely(__pyx_v_self-&gt;ny == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
          <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
        }
        if (unlikely(__pyx_v_self-&gt;nz == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
          <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0685</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:     <span class="k">def</span> <span class="nf">init_field_energy_prefactors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-11 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_5init_field_energy_prefactors(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_4init_field_energy_prefactors[] = "Initialize the field energy prefactor for each reader protein.\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_5init_field_energy_prefactors(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_field_energy_prefactors (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_4init_field_energy_prefactors(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_4init_field_energy_prefactors(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  PyObject *__pyx_v_binder_names = NULL;
  long __pyx_v_i;
  PyObject *__pyx_v_binder_name = NULL;
  PyObject *__pyx_v_next_binder = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_field_energy_prefactors", 0);
  <span class='trace'>__Pyx_TraceCall</span>("init_field_energy_prefactors", __pyx_f[0], 687, 0, <span class='error_goto'>__PYX_ERR(0, 687, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.init_field_energy_prefactors", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_next_binder);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0688</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the field energy prefactor for each reader protein.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:         <span class="n">binder_names</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_binder_names = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0691</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;num_binders;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:             <span class="n">binder_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">&quot;name&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_loc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_name_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_name_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_n_s_name_2);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder_name, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:             <span class="n">binder_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binder_name</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_binder_names, __pyx_v_binder_name);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 693, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0694</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_self-&gt;num_binders;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;field_energy_prefactor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-20 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_at);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_field_energy_prefactor);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_field_energy_prefactor);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_n_s_field_energy_prefactor);
    __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_5, __pyx_t_8, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:                 <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span></pre>
<pre class='cython code score-14 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_0_5, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:                 <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_volume</span></pre>
<pre class='cython code score-15 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_interaction_volume);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:                 <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span></pre>
<pre class='cython code score-12 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vol_bin);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0699</span>:             <span class="p">)</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;interaction_energy_intranucleosome&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-20 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_at);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_interaction_energy_intranucleoso);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_interaction_energy_intranucleoso);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_n_s_interaction_energy_intranucleoso);
    __pyx_t_6 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_5, __pyx_t_8, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 700, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span></pre>
<pre class='cython code score-8 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:                 <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_volume</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_interaction_volume);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vol_bin);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0703</span>:             <span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0704</span>:             <span class="k">for</span> <span class="n">next_binder</span> <span class="ow">in</span> <span class="n">binder_names</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>    __pyx_t_1 = __pyx_v_binder_names; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_9 = 0;
    for (;;) {
      if (__pyx_t_9 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_9++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 704, __pyx_L1_error)</span>
      #else
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 704, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_next_binder, __pyx_t_8);
      __pyx_t_8 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0705</span>:                 <span class="k">if</span> <span class="n">next_binder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span></pre>
<pre class='cython code score-30 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_keys);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_8 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_next_binder, __pyx_t_8, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 705, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_11 = (__pyx_t_10 != 0);
      if (__pyx_t_11) {
/* … */
        goto __pyx_L9;
      }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0706</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;cross_talk_field_energy_prefactor&#39;</span><span class="p">][</span><span class="n">next_binder</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-23 '>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_at);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cross_talk_field_energy_prefacto);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cross_talk_field_energy_prefacto);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_n_s_cross_talk_field_energy_prefacto);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_8, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_5, __pyx_v_next_binder, __pyx_t_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 706, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0707</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span><span class="n">next_binder</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_8, __pyx_v_next_binder);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 707, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0708</span>:                         <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_volume</span></pre>
<pre class='cython code score-15 '>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_interaction_volume);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 708, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0709</span>:                         <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span></pre>
<pre class='cython code score-12 '>        __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vol_bin);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0710</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s">&#39;cross_talk_field_energy_prefactor&#39;</span><span class="p">][</span><span class="n">next_binder</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-22 '>      /*else*/ {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_at);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cross_talk_field_energy_prefacto);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cross_talk_field_energy_prefacto);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_n_s_cross_talk_field_energy_prefacto);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_6, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_5, __pyx_v_next_binder, __pyx_int_0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 712, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_L9:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-112" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:     <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">get_accessible_volumes</span><span class="p">(</span></pre>
<pre class='cython code score-112 '>static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_7get_accessible_volumes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6chromo_6fields_19UniformDensityField_get_accessible_volumes(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, long __pyx_v_n_side, int __pyx_v_assume_fully_accessible, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  __Pyx_memviewslice __pyx_v_split_voxels = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz_coords = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dxyz_point = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_access_vols = 0;
  PyObject *__pyx_v_buffer_dist = NULL;
  long __pyx_7genexpr__pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_accessible_volumes", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_accessible_volumes", __pyx_f[0], 714, 0, <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_accessible_volumes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_6fields_19UniformDensityField_7get_accessible_volumes)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_side);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_assume_fully_accessible);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_7 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (__pyx_t_6) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_2)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>
        __pyx_r = ((PyObject*)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_accessible_volumes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_split_voxels, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz_inds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz_coords, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dxyz_point, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_access_vols);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_buffer_dist);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_7get_accessible_volumes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_6get_accessible_volumes[] = "Numerically find accessible volume of voxels at confinement edge.\n        \n        Notes\n        -----\n        Right now, accessible volume calculations are only relevant to spherical\n        confinements.\n\n        Parameters\n        ----------\n        n_side : long\n            When a voxel is determined to be partially contained by the\n            confinement, we will numerically determine the accessible volume in\n            that voxel. To do this, we will place a cubic grid of points within\n            the voxel, and we will count the number of grid points within the\n            confinement. The parameter `n_side` gives the number of grid points\n            to include on each side of the cubic grid. For example, if n_side =\n            10, then we will place a 10x10x10 grid of points in every partially\n            contained voxel to determine the accessible volume of that voxel.\n        assume_fully_accessible : bint\n            Flag indicating whether to assume all voxels are fully accessible.\n            Assume voxels are fully accessible if the voxel volumes are far less\n            than the confinement volume. Value of `1` indicates that all voxels\n            are assumed to be fully accessible, bypassing the calculation of\n            accessible volume.\n\n        Returns\n        -------\n        access_vol : dict\n            Mapping of bin super index to accessible volume inside the \n            confining boundary\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_7get_accessible_volumes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_n_side;
  int __pyx_v_assume_fully_accessible;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_accessible_volumes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n_side,&amp;__pyx_n_s_assume_fully_accessible,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_side)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_assume_fully_accessible)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_accessible_volumes", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_accessible_volumes") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_n_side = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_n_side == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L3_error)</span>
    __pyx_v_assume_fully_accessible = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[1]); if (unlikely((__pyx_v_assume_fully_accessible == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 715, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_accessible_volumes", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_accessible_volumes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_6get_accessible_volumes(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), __pyx_v_n_side, __pyx_v_assume_fully_accessible);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_6get_accessible_volumes(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, long __pyx_v_n_side, int __pyx_v_assume_fully_accessible) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_accessible_volumes", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_accessible_volumes (wrapper)", __pyx_f[0], 714, 0, <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_6fields_19UniformDensityField_get_accessible_volumes(__pyx_v_self, __pyx_v_n_side, __pyx_v_assume_fully_accessible, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_accessible_volumes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0715</span>:             <span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_side</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">assume_fully_accessible</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Numerically find accessible volume of voxels at confinement edge.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="sd">        Right now, accessible volume calculations are only relevant to spherical</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="sd">        confinements.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: <span class="sd">        n_side : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: <span class="sd">            When a voxel is determined to be partially contained by the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: <span class="sd">            confinement, we will numerically determine the accessible volume in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>: <span class="sd">            that voxel. To do this, we will place a cubic grid of points within</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>: <span class="sd">            the voxel, and we will count the number of grid points within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>: <span class="sd">            confinement. The parameter `n_side` gives the number of grid points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: <span class="sd">            to include on each side of the cubic grid. For example, if n_side =</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>: <span class="sd">            10, then we will place a 10x10x10 grid of points in every partially</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>: <span class="sd">            contained voxel to determine the accessible volume of that voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>: <span class="sd">        assume_fully_accessible : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>: <span class="sd">            Flag indicating whether to assume all voxels are fully accessible.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>: <span class="sd">            Assume voxels are fully accessible if the voxel volumes are far less</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>: <span class="sd">            than the confinement volume. Value of `1` indicates that all voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>: <span class="sd">            are assumed to be fully accessible, bypassing the calculation of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>: <span class="sd">            accessible volume.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0744</span>: <span class="sd">        access_vol : dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>: <span class="sd">            Mapping of bin super index to accessible volume inside the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>: <span class="sd">            confining boundary</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">split_voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xyz_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xyz_coords</span><span class="p">,</span> <span class="n">dxyz_point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0752</span>:         <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">access_vols</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:         <span class="n">access_vols</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">)}</span></pre>
<pre class='cython code score-19 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = __pyx_v_self-&gt;n_bins;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_7genexpr__pyx_v_i = __pyx_t_11;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_7genexpr__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vol_bin);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_t_2, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
  } /* exit inner scope */
  __pyx_v_access_vols = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:         <span class="k">if</span> <span class="n">assume_fully_accessible</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = ((__pyx_v_assume_fully_accessible == 1) != 0);
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0755</span>:             <span class="k">return</span> <span class="n">access_vols</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_access_vols);
    __pyx_r = __pyx_v_access_vols;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span> <span class="o">==</span> <span class="s">&quot;Spherical&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;__pyx_base.confine_type, __pyx_n_s_Spherical, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
/* … */
  }
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:             <span class="n">xyz_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_8, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_xyz_inds = __pyx_t_14;
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;n_bins;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:                 <span class="n">xyz_inds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">super_ind_to_inds</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>      __pyx_t_15 = __pyx_f_6chromo_6fields_super_ind_to_inds(__pyx_v_i, __pyx_v_self-&gt;nx, __pyx_v_self-&gt;ny, 0);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
      __pyx_t_16.data = __pyx_v_xyz_inds.data;
      __pyx_t_16.memview = __pyx_v_xyz_inds.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_16, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_xyz_inds.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xyz_inds.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
        }
        __pyx_t_16.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_16.shape[0] = __pyx_v_xyz_inds.shape[1];
__pyx_t_16.strides[0] = __pyx_v_xyz_inds.strides[1];
    __pyx_t_16.suboffsets[0] = -1;

if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_15, __pyx_t_16, 1, 1, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
      __pyx_t_16.memview = NULL;
      __pyx_t_16.data = NULL;
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
      __pyx_t_15.memview = NULL;
      __pyx_t_15.data = NULL;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:             <span class="n">xyz_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_voxel_coords</span><span class="p">(</span><span class="n">xyz_inds</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_voxel_coords(__pyx_v_self, __pyx_v_xyz_inds);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
    __pyx_v_xyz_coords = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:             <span class="n">buffer_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_8 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_int_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_int_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_18 = __pyx_v_self-&gt;dy;
    __pyx_t_19 = __pyx_v_self-&gt;dz;
    __pyx_t_20 = __pyx_v_self-&gt;dx;
    if (((__pyx_t_18 &gt; __pyx_t_20) != 0)) {
      __pyx_t_21 = __pyx_t_18;
    } else {
      __pyx_t_21 = __pyx_t_20;
    }
    __pyx_t_20 = __pyx_t_21;
    if (((__pyx_t_19 &gt; __pyx_t_20) != 0)) {
      __pyx_t_21 = __pyx_t_19;
    } else {
      __pyx_t_21 = __pyx_t_20;
    }
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_buffer_dist = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0762</span>:             <span class="n">split_voxels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_split_voxels</span><span class="p">(</span><span class="n">xyz_coords</span><span class="p">,</span> <span class="n">buffer_dist</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_21 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_buffer_dist); if (unlikely((__pyx_t_21 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    __pyx_t_15 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_split_voxels(__pyx_v_self, __pyx_v_xyz_coords, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    __pyx_v_split_voxels = __pyx_t_15;
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:             <span class="n">dxyz_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">define_voxel_subgrid</span><span class="p">(</span><span class="n">n_side</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;define_voxel_subgrid(__pyx_v_self, __pyx_v_n_side);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
    __pyx_v_dxyz_point = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;n_bins;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:                 <span class="k">if</span> <span class="n">split_voxels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>
      /* "chromo/fields.pyx":765
 *             dxyz_point = self.define_voxel_subgrid(n_side)
 *             for i in range(self.n_bins):
 *                 if split_voxels[i] == 1:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                     access_vols[i] = (
 *                         self.vol_bin *
 */
      __pyx_t_22 = __pyx_v_i;
      __pyx_t_7 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_split_voxels.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_split_voxels.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
      }
      __pyx_t_13 = (((*((long *) ( /* dim=0 */ (__pyx_v_split_voxels.data + __pyx_t_22 * __pyx_v_split_voxels.strides[0]) ))) == 1) != 0);
      if (__pyx_t_13) {

        /* "chromo/fields.pyx":765
 *             dxyz_point = self.define_voxel_subgrid(n_side)
 *             for i in range(self.n_bins):
 *                 if split_voxels[i] == 1:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                     access_vols[i] = (
 *                         self.vol_bin *
 */
      }
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:                     <span class="n">access_vols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-9 '>        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 766, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_access_vols, __pyx_t_8, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 766, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">vol_bin</span> <span class="o">*</span></pre>
<pre class='cython code score-5 '>__pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;vol_bin * ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_frac_accessible(__pyx_v_self, __pyx_t_23, __pyx_v_dxyz_point)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
/* … */
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_23, 1);
        __pyx_t_23.memview = NULL;
        __pyx_t_23.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">get_frac_accessible</span><span class="p">(</span><span class="n">xyz_coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dxyz_point</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>        __pyx_t_23.data = __pyx_v_xyz_coords.data;
        __pyx_t_23.memview = __pyx_v_xyz_coords.memview;
        __PYX_INC_MEMVIEW(&amp;__pyx_t_23, 0);
        {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_xyz_coords.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_xyz_coords.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
        }
        __pyx_t_23.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_23.shape[0] = __pyx_v_xyz_coords.shape[1];
__pyx_t_23.strides[0] = __pyx_v_xyz_coords.strides[1];
    __pyx_t_23.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">0769</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:         <span class="k">return</span> <span class="n">access_vols</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_access_vols);
  __pyx_r = __pyx_v_access_vols;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0771</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">get_voxel_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xyz_inds</span><span class="p">):</span></pre>
<pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_voxel_coords(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, __Pyx_memviewslice __pyx_v_xyz_inds) {
  long __pyx_v_i;
  long __pyx_v_j;
  __Pyx_memviewslice __pyx_v_nxyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dxyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_centralized_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz_coords = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_voxel_coords", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_voxel_coords", __pyx_f[0], 772, 0, <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_voxel_coords", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nxyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dxyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centralized_inds, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz_coords, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0773</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get voxel coordinates from xyz bin indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0774</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0775</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0776</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0777</span>: <span class="sd">        Get the (x, y, z) coordinates at the center of each voxel. Start by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: <span class="sd">        converting voxel super-indices to x, y, and z indices. Then, multiply</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>: <span class="sd">        the x, y, and z indices by voxel widths dx, dy, and dz to get the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: <span class="sd">        coordinates at the center of each voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0781</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0782</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>: <span class="sd">        xyz_inds : long[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>: <span class="sd">            Indices in the x, y, and z directions for each bin, where rows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>: <span class="sd">            represent individual bins and columns indicate the index position</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: <span class="sd">            of the bin in the x, y, and z directions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>: <span class="sd">        double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>: <span class="sd">            Coordinates in the x, y, and z directions for each bin, where rows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: <span class="sd">            represent individual bins and columns indicate coordinates in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: <span class="sd">            x, y, and z directions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">nxyz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">dxyz</span><span class="p">,</span> <span class="n">centralized_inds</span><span class="p">,</span> <span class="n">xyz_coords</span></pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0799</span>:         <span class="n">nxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">])</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;ny);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nz);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_nxyz = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:         <span class="n">dxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_2);
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dxyz = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:                 <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-15 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dx);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 801, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_int_0);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0802</span>:                 <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-15 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 802, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_int_0);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0803</span>:                 <span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="p">]</span></pre>
<pre class='cython code score-15 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;dz);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0804</span>:         <span class="p">])</span></pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:         <span class="n">centralized_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 805, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_centralized_inds = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0806</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_self-&gt;n_bins;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0808</span>:                 <span class="n">centralized_inds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">xyz_inds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">nxyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-6 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_xyz_inds.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_15 = 0;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_xyz_inds.shape[1];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_15 = 1;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_xyz_inds.shape[1])) __pyx_t_15 = 1;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>__PYX_ERR(0, 808, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_15 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_nxyz.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_nxyz.shape[0])) __pyx_t_15 = 0;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>__PYX_ERR(0, 808, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_v_i;
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_15 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_centralized_inds.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_centralized_inds.shape[0])) __pyx_t_15 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_centralized_inds.shape[1];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_15 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_centralized_inds.shape[1])) __pyx_t_15 = 1;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>__PYX_ERR(0, 808, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_centralized_inds.data + __pyx_t_17 * __pyx_v_centralized_inds.strides[0]) )) + __pyx_t_18)) )) = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_13 * __pyx_v_xyz_inds.strides[0]) )) + __pyx_t_14)) ))) - __Pyx_div_long(((*((long *) ( /* dim=0 */ (__pyx_v_nxyz.data + __pyx_t_16 * __pyx_v_nxyz.strides[0]) ))) - 1), 2));
    }
  }
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:         <span class="n">xyz_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">centralized_inds</span><span class="p">,</span> <span class="n">dxyz</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_matmul);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_centralized_inds, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_dxyz, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = NULL;
  __pyx_t_15 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_15 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_15, 2+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_15, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_15, __pyx_t_6);
    __pyx_t_3 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_xyz_coords = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0810</span>:         <span class="k">return</span> <span class="n">xyz_coords</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_xyz_coords, 0);
  __pyx_r = __pyx_v_xyz_coords;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0811</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0812</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">get_split_voxels</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_split_voxels(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, __Pyx_memviewslice __pyx_v_xyz_coords, double __pyx_v_buffer_dist) {
  __Pyx_memviewslice __pyx_v_split_voxels = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_i;
  double __pyx_v_dist;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_split_voxels", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_split_voxels", __pyx_f[0], 812, 0, <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_split_voxels", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_split_voxels, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0813</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">xyz_coords</span><span class="p">,</span> <span class="n">double</span> <span class="n">buffer_dist</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify voxels intersecting with the confinement boundary.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: <span class="sd">        Flag each voxel as split to begin with. Then, for each voxel, calculate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>: <span class="sd">        the distance from the origin to the center of the voxel. For voxels</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: <span class="sd">        which fall within +/- one `buffer_dist` of the confining length, flag</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>: <span class="sd">        that voxel as split.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>: <span class="sd">        Accessible volumes are only relevant for spherical confinements. In a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>: <span class="sd">        cubical confinement, all voxels are entirely accessible.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>: <span class="sd">        xyz_coords : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>: <span class="sd">            Cartesian coordinates identifying the center of each voxel, where</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>: <span class="sd">            rows represent individual voxels and columns indicate x, y, and z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>: <span class="sd">            positions at the center of the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>: <span class="sd">        buffer_dist : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>: <span class="sd">            Distance from confining boundary at which a voxel is marked as </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0835</span>: <span class="sd">            &quot;split&quot; and is assessed as potentially intersecting the boundary</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0839</span>: <span class="sd">        long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>: <span class="sd">            Array of super-indices cooresponding to voxels that intersect with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>: <span class="sd">            the confinement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">split_voxels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 843, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 843, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_split_voxels = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0844</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0845</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;n_bins;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0846</span>:             <span class="n">dist</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dist = sqrt(((pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xyz_coords.data + __pyx_t_9 * __pyx_v_xyz_coords.strides[0]) )) + __pyx_t_10)) ))), 2.0) + pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xyz_coords.data + __pyx_t_12 * __pyx_v_xyz_coords.strides[0]) )) + __pyx_t_13)) ))), 2.0)) + pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_xyz_coords.data + __pyx_t_14 * __pyx_v_xyz_coords.strides[0]) )) + __pyx_t_15)) ))), 2.0)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0847</span>:                 <span class="n">xyz_coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_xyz_coords.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_xyz_coords.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_xyz_coords.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_xyz_coords.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 847, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>:                 <span class="n">xyz_coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span></pre>
<pre class='cython code score-2 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 1;
    __pyx_t_11 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_xyz_coords.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_xyz_coords.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_xyz_coords.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_xyz_coords.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0849</span>:                 <span class="n">xyz_coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-2 '>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 2;
    __pyx_t_11 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_xyz_coords.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_xyz_coords.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_xyz_coords.shape[1];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_xyz_coords.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0850</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:             <span class="k">if</span> <span class="p">(</span><span class="n">dist</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">-</span> <span class="n">buffer_dist</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = ((__pyx_v_dist &lt; (__pyx_v_self-&gt;__pyx_base.confine_length - __pyx_v_buffer_dist)) != 0);
    if (!__pyx_t_17) {
    } else {
      __pyx_t_16 = __pyx_t_17;
      goto __pyx_L6_bool_binop_done;
    }
/* … */
    if (__pyx_t_16) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:                 <span class="n">dist</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span> <span class="o">+</span> <span class="n">buffer_dist</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_17 = ((__pyx_v_dist &gt; (__pyx_v_self-&gt;__pyx_base.confine_length + __pyx_v_buffer_dist)) != 0);
    __pyx_t_16 = __pyx_t_17;
    __pyx_L6_bool_binop_done:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:                 <span class="n">split_voxels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>      __pyx_t_15 = __pyx_v_i;
      __pyx_t_11 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_split_voxels.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_split_voxels.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
      }
      *((long *) ( /* dim=0 */ (__pyx_v_split_voxels.data + __pyx_t_15 * __pyx_v_split_voxels.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:         <span class="k">return</span> <span class="n">split_voxels</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_split_voxels, 0);
  __pyx_r = __pyx_v_split_voxels;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">define_voxel_subgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_pt_side</span><span class="p">):</span></pre>
<pre class='cython code score-15 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_define_voxel_subgrid(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, long __pyx_v_n_pt_side) {
  long __pyx_v_total_points;
  double __pyx_v_dx_point;
  double __pyx_v_dy_point;
  double __pyx_v_dz_point;
  __Pyx_memviewslice __pyx_v_dxyz_point = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_i;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("define_voxel_subgrid", 0);
  <span class='trace'>__Pyx_TraceCall</span>("define_voxel_subgrid", __pyx_f[0], 856, 0, <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.define_voxel_subgrid", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dxyz_point, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Define voxel subgrid for accessible volume calculation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">        When a voxel is split by a confining boundary, we determine the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">        accessible volume in that voxel using a numerical approach. We</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: <span class="sd">        initialize an cubical array of points of dimensions `n_pt_side` by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">        `n_pt_side` by `n_pt_side` inside the voxel. We then calculate the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        radial distance of each point in this array. We determine the fraction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: <span class="sd">        of points which fall inside the confinement, and we use this as an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: <span class="sd">        estimate of the fraction voxel volume that is accessible. We multiply</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>: <span class="sd">        this fraction by the full voxel volume to get the accessible volume in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">        the voxel.   </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: <span class="sd">        n_pt_side : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>: <span class="sd">            When a voxel is determined to be partially contained by the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>: <span class="sd">            confinement, we will numerically determine the accessible volume in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>: <span class="sd">            that voxel. To do this, we will place a cubic grid of points within</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: <span class="sd">            the voxel, and we will count the number of grid points within the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: <span class="sd">            confinement. The parameter `n_side` gives the number of grid points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: <span class="sd">            to include on each side of the cubic grid. For example, if n_side =</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: <span class="sd">            10, then we will place a 10x10x10 grid of points in every partially</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: <span class="sd">            contained voxel to determine the accessible volume of that voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>: <span class="sd">        double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>: <span class="sd">            Array of subgrid points (relative to origin) for determination of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>: <span class="sd">            voxel accessible volume. Rows indicate individual points, and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>: <span class="sd">            columns indicate x, y, z coordinates for each point.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">total_points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dx_point</span><span class="p">,</span> <span class="nf">dy_point</span><span class="p">,</span> <span class="nf">dz_point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">dxyz_point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>:         <span class="n">total_points</span> <span class="o">=</span> <span class="n">n_pt_side</span> <span class="o">**</span> <span class="mf">3</span></pre>
<pre class='cython code score-0 '>  __pyx_v_total_points = __Pyx_pow_long(__pyx_v_n_pt_side, 3);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:         <span class="n">dx_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">/</span> <span class="n">n_pt_side</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_pt_side == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 895, __pyx_L1_error)</span>
  }
  __pyx_v_dx_point = (__pyx_v_self-&gt;dx / __pyx_v_n_pt_side);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0896</span>:         <span class="n">dy_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span> <span class="o">/</span> <span class="n">n_pt_side</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_pt_side == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 896, __pyx_L1_error)</span>
  }
  __pyx_v_dy_point = (__pyx_v_self-&gt;dy / __pyx_v_n_pt_side);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0897</span>:         <span class="n">dz_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span> <span class="o">/</span> <span class="n">n_pt_side</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_pt_side == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 897, __pyx_L1_error)</span>
  }
  __pyx_v_dz_point = (__pyx_v_self-&gt;dz / __pyx_v_n_pt_side);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0898</span>:         <span class="n">dxyz_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0899</span>:             <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span></pre>
<pre class='cython code score-35 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_mgrid);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_6 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_7 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_8 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_0, __pyx_t_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_8);
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>:                 <span class="mf">0</span><span class="p">:</span><span class="n">n_pt_side</span><span class="p">,</span><span class="mf">0</span><span class="p">:</span><span class="n">n_pt_side</span><span class="p">,</span> <span class="mf">0</span><span class="p">:</span><span class="n">n_pt_side</span></pre>
<pre class='cython code score-6 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_pt_side);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_pt_side);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_pt_side);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0901</span>:             <span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">total_points</span><span class="p">,</span> <span class="mf">3</span><span class="p">)</span></pre>
<pre class='cython code score-52 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_total_points);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 901, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_9 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
    PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_3, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_9, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_9, __pyx_t_5);
    __pyx_t_3 = 0;
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0902</span>:         <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-20 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&amp;PyFloat_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 902, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_dxyz_point = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_points</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_total_points;
  __pyx_t_12 = __pyx_t_11;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:             <span class="n">dxyz_point</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">dx_point</span></pre>
<pre class='cython code score-2 '>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 0;
    __pyx_t_9 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_dxyz_point.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dxyz_point.shape[0])) __pyx_t_9 = 0;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_dxyz_point.shape[1];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_9 = 1;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dxyz_point.shape[1])) __pyx_t_9 = 1;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_dxyz_point.data + __pyx_t_14 * __pyx_v_dxyz_point.strides[0]) )) + __pyx_t_15)) )) *= __pyx_v_dx_point;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:             <span class="n">dxyz_point</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">dy_point</span></pre>
<pre class='cython code score-2 '>    __pyx_t_15 = __pyx_v_i;
    __pyx_t_14 = 1;
    __pyx_t_9 = -1;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_dxyz_point.shape[0];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dxyz_point.shape[0])) __pyx_t_9 = 0;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_dxyz_point.shape[1];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_9 = 1;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dxyz_point.shape[1])) __pyx_t_9 = 1;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 905, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_dxyz_point.data + __pyx_t_15 * __pyx_v_dxyz_point.strides[0]) )) + __pyx_t_14)) )) *= __pyx_v_dy_point;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0906</span>:             <span class="n">dxyz_point</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">*=</span> <span class="n">dz_point</span></pre>
<pre class='cython code score-2 '>    __pyx_t_14 = __pyx_v_i;
    __pyx_t_15 = 2;
    __pyx_t_9 = -1;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_dxyz_point.shape[0];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_dxyz_point.shape[0])) __pyx_t_9 = 0;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_dxyz_point.shape[1];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_9 = 1;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_dxyz_point.shape[1])) __pyx_t_9 = 1;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 906, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_dxyz_point.data + __pyx_t_14 * __pyx_v_dxyz_point.strides[0]) )) + __pyx_t_15)) )) *= __pyx_v_dz_point;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:         <span class="k">return</span> <span class="n">dxyz_point</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_dxyz_point, 0);
  __pyx_r = __pyx_v_dxyz_point;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0908</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">get_frac_accessible</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>static double __pyx_f_6chromo_6fields_19UniformDensityField_get_frac_accessible(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, __Pyx_memviewslice __pyx_v_coords, __Pyx_memviewslice __pyx_v_dxyz_point) {
  long __pyx_v_i;
  long __pyx_v_n_points;
  double __pyx_v_n_points_dbl;
  double __pyx_v_count_true;
  double __pyx_v_frac_accessible;
  __Pyx_memviewslice __pyx_v_dists = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_points = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_frac_accessible", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_frac_accessible", __pyx_f[0], 909, 0, <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.get_frac_accessible", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dists, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_points, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0910</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">coords</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">dxyz_point</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the fraction of a bin which is accessible inside a confinement.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: <span class="sd">        See notes in `self.define_voxel_subgrid()` for implementation details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0919</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0920</span>: <span class="sd">        coords : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: <span class="sd">            Cartesian coordinates in the form (x, y, z) identifying the center</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>: <span class="sd">            of the bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: <span class="sd">        dxyz_point : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>: <span class="sd">            Array of subgrid points (relative to origin) for determination of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>: <span class="sd">            voxel accessible volume. Rows indicate individual points, and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>: <span class="sd">            columns indicate x, y, z coordinates for each point.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: <span class="sd">            Fraction of the bin which is accessible inside the confinement</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">n_points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">n_points_dbl</span><span class="p">,</span> <span class="nf">count_true</span><span class="p">,</span> <span class="nf">frac_accessible</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dists</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">points</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0938</span>:         <span class="n">n_points</span> <span class="o">=</span> <span class="n">dxyz_point</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_points = (__pyx_v_dxyz_point.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0939</span>:         <span class="n">n_points_dbl</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n_points</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_points_dbl = ((double)__pyx_v_n_points);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>:         <span class="n">points</span> <span class="o">=</span> <span class="n">dxyz_point</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_memoryview_copy_slice_d_dc_double_c(__pyx_v_dxyz_point);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
  __pyx_v_points = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n_points;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0942</span>:             <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">coords</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="o">/</span><span class="mf">2</span></pre>
<pre class='cython code score-4 '>    __pyx_t_5 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_coords.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_coords.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 942, __pyx_L1_error)</span>
    }
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 0;
    __pyx_t_6 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_points.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_points.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_points.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_points.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 942, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_points.data + __pyx_t_7 * __pyx_v_points.strides[0]) )) + __pyx_t_8)) )) += ((*((double *) ( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_5 * __pyx_v_coords.strides[0]) ))) - (__pyx_v_self-&gt;dx / 2.0));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0943</span>:             <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">coords</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="o">/</span><span class="mf">2</span></pre>
<pre class='cython code score-4 '>    __pyx_t_5 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_coords.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_coords.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>
    }
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 1;
    __pyx_t_6 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_points.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_points.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_points.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_points.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_points.data + __pyx_t_8 * __pyx_v_points.strides[0]) )) + __pyx_t_7)) )) += ((*((double *) ( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_5 * __pyx_v_coords.strides[0]) ))) - (__pyx_v_self-&gt;dy / 2.0));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0944</span>:             <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">coords</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dz</span><span class="o">/</span><span class="mf">2</span></pre>
<pre class='cython code score-4 '>    __pyx_t_5 = 2;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_coords.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_coords.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L1_error)</span>
    }
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_6 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_points.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_points.shape[0])) __pyx_t_6 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_points.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_6 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_points.shape[1])) __pyx_t_6 = 1;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_points.data + __pyx_t_7 * __pyx_v_points.strides[0]) )) + __pyx_t_8)) )) += ((*((double *) ( /* dim=0 */ (__pyx_v_coords.data + __pyx_t_5 * __pyx_v_coords.strides[0]) ))) - (__pyx_v_self-&gt;dz / 2.0));
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0945</span>:         <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_points, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 945, __pyx_L1_error)</span>
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_12, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 945, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_v_dists = __pyx_t_13;
  __pyx_t_13.memview = NULL;
  __pyx_t_13.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0946</span>:         <span class="n">count_true</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count_true = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0947</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n_points;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0948</span>:             <span class="k">if</span> <span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_dists.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_6 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_dists.shape[0])) __pyx_t_6 = 0;
    if (unlikely(__pyx_t_6 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_6);
      <span class='error_goto'>__PYX_ERR(0, 948, __pyx_L1_error)</span>
    }
    __pyx_t_14 = (((*((double *) ( /* dim=0 */ (__pyx_v_dists.data + __pyx_t_5 * __pyx_v_dists.strides[0]) ))) &lt; __pyx_v_self-&gt;__pyx_base.confine_length) != 0);
    if (__pyx_t_14) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0949</span>:                 <span class="n">count_true</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_count_true = (__pyx_v_count_true + 1.0);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0950</span>:         <span class="n">frac_accessible</span> <span class="o">=</span> <span class="n">count_true</span> <span class="o">/</span> <span class="n">n_points_dbl</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_n_points_dbl == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 950, __pyx_L1_error)</span>
  }
  __pyx_v_frac_accessible = (__pyx_v_count_true / __pyx_v_n_points_dbl);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0951</span>:         <span class="k">return</span> <span class="n">frac_accessible</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_frac_accessible;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0953</span>:     <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-12 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_9to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_8to_file[] = "Save Field description + Polymer/ReaderProtein names to CSV.\n\n        Parameters\n        ----------\n        path : str\n            File path at which to save the CSV file representing the field\n\n        Returns\n        -------\n        None or str\n            Returns `None` if `path` is not `None`; otherwise returns the CSV\n            representing the field as a string\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_9to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_8to_file(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_8to_file(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_v_rows = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_polymer = NULL;
  PyObject *__pyx_v_binder = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_name = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file", 0);
  <span class='trace'>__Pyx_TraceCall</span>("to_file", __pyx_f[0], 953, 0, <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rows);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_polymer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Save Field description + Polymer/ReaderProtein names to CSV.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: <span class="sd">        path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: <span class="sd">            File path at which to save the CSV file representing the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>: <span class="sd">        None or str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span class="sd">            Returns `None` if `path` is not `None`; otherwise returns the CSV</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: <span class="sd">            representing the field as a string</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:         <span class="n">rows</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_field_descriptors</span><span class="p">}</span></pre>
<pre class='cython code score-63 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_self-&gt;_field_descriptors)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_self-&gt;_field_descriptors)) {
      __pyx_t_2 = __pyx_v_self-&gt;_field_descriptors; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_self-&gt;_field_descriptors);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L5_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L5_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L5_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_name, __pyx_t_5);
      __pyx_t_5 = 0;
      if (unlikely(__pyx_v_self-&gt;dict_ == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L5_error)</span>
      }
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;dict_, __pyx_8genexpr1__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr1__pyx_v_name, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L5_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name); __pyx_8genexpr1__pyx_v_name = 0;
    goto __pyx_L8_exit_scope;
    __pyx_L5_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name); __pyx_8genexpr1__pyx_v_name = 0;
    goto __pyx_L1_error;
    __pyx_L8_exit_scope:;
  } /* exit inner scope */
  __pyx_v_rows = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0968</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">polymer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polymers</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  __pyx_t_2 = __pyx_v_self-&gt;__pyx_base.polymers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 968, __pyx_L1_error)</span>
    #else
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 968, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_polymer, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 968, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_5;
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0969</span>:             <span class="n">rows</span><span class="p">[</span><span class="n">polymer</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;polymer&#39;</span></pre>
<pre class='cython code score-8 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_polymer, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 969, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_rows, __pyx_t_5, __pyx_n_s_polymer) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 969, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0970</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">binder</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span></pre>
<pre class='cython code score-107 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_iterrows);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_8 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_5)) goto __pyx_L13_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 1; __pyx_t_6 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L13_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
      __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L14_unpacking_done;
      __pyx_L13_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 970, __pyx_L1_error)</span>
      __pyx_L14_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder, __pyx_t_6);
    __pyx_t_6 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0971</span>:             <span class="c"># careful! binder.name is the Series.name attribute</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0972</span>:             <span class="n">rows</span><span class="p">[</span><span class="n">binder</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="s">&#39;binder&#39;</span></pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_binder, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_rows, __pyx_t_1, __pyx_n_s_binder) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 972, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0973</span>:         <span class="c"># prints just key,value for each key in rows</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0974</span>:         <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_rows) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_rows);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_csv);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_path);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_header, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 974, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0975</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0976</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField-&gt;tp_dict, __pyx_n_s_from_file_2, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_6fields_UniformDensityField);
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0977</span>:     <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_11from_file(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_10from_file[] = "Recover field saved with `.to_file()`.\n\n        Notes\n        -----\n        The zeroths column is an index column, and the first column stores the\n        data specifying the field.\n\n        Parameters\n        ----------\n        path : str\n            Path to the CSV file representing the field\n        polymers : List[PolymerBase]\n            Polymers contained in the field\n        binders : pd.DataFrame\n            Table describing reader proteins affecting the field\n\n        Returns\n        -------\n        UniformDensityField\n            Discrete density field represented by the CSV file\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_11from_file(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_path = 0;
  PyObject *__pyx_v_polymers = 0;
  PyObject *__pyx_v_binders = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_path,&amp;__pyx_n_s_polymers,&amp;__pyx_n_s_binders,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_polymers)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binders)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "from_file") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_path = values[0];
    __pyx_v_polymers = values[1];
    __pyx_v_binders = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_10from_file(((PyTypeObject*)__pyx_v_cls), __pyx_v_path, __pyx_v_polymers, __pyx_v_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_10from_file(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_path, PyObject *__pyx_v_polymers, PyObject *__pyx_v_binders) {
  PyObject *__pyx_v_field_series = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_polymer_names = NULL;
  PyObject *__pyx_v_binder_names = NULL;
  PyObject *__pyx_v_err_prefix = NULL;
  PyObject *__pyx_v_polymer = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_binder = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file", 0);
  <span class='trace'>__Pyx_TraceCall</span>("from_file", __pyx_f[0], 977, 0, <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_field_series);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_polymer_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_err_prefix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_polymer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_2, (PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField, __pyx_n_s_from_file_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">0978</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Recover field saved with `.to_file()`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>: <span class="sd">        The zeroths column is an index column, and the first column stores the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>: <span class="sd">        data specifying the field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: <span class="sd">        path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>: <span class="sd">            Path to the CSV file representing the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: <span class="sd">        polymers : List[PolymerBase]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: <span class="sd">            Polymers contained in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>: <span class="sd">        binders : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>: <span class="sd">            Table describing reader proteins affecting the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: <span class="sd">        UniformDensityField</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: <span class="sd">            Discrete density field represented by the CSV file</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0999</span>:         <span class="n">field_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mf">0</span><span class="p">)[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_read_csv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_path);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_header, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 999, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_index_col, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 999, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_field_series = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1000</span>:         <span class="n">kwargs</span> <span class="o">=</span> <span class="n">field_series</span><span class="p">[</span><span class="n">_field_descriptors</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_field_series, __pyx_v_6chromo_6fields__field_descriptors);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_to_dict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1000, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_kwargs = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>:         <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span></pre>
<pre class='cython code score-62 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_kwargs, __pyx_n_s_keys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:             <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_int_field_descriptors</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_6chromo_6fields__int_field_descriptors, Py_EQ)); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L1_error)</span>
    __pyx_t_8 = (__pyx_t_7 != 0);
    if (__pyx_t_8) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1003</span>:                 <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span></pre>
<pre class='cython code score-11 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1003, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_kwargs, __pyx_v_key, __pyx_t_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1003, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1004</span>:             <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_float_field_descriptors</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_6chromo_6fields__float_field_descriptors, Py_EQ)); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1004, __pyx_L1_error)</span>
    __pyx_t_7 = (__pyx_t_8 != 0);
    if (__pyx_t_7) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>:                 <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span></pre>
<pre class='cython code score-11 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1005, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_kwargs, __pyx_v_key, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1005, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1006</span>:             <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_str_field_descriptors</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]):</span></pre>
<pre class='cython code score-27 '>    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_6chromo_6fields__str_field_descriptors, Py_EQ)); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
    __pyx_t_9 = (__pyx_t_8 != 0);
    if (__pyx_t_9) {
    } else {
      __pyx_t_7 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_isna);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __pyx_t_9;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_7) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:                 <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;&quot;</span></pre>
<pre class='cython code score-5 '>      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_kwargs, __pyx_v_key, __pyx_kp_s_) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1007, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1008</span>:             <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_bool_field_descriptors</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_6chromo_6fields__bool_field_descriptors, Py_EQ)); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>
    __pyx_t_9 = (__pyx_t_7 != 0);
    if (__pyx_t_9) {
/* … */
    }
    __pyx_L5:;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:                 <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;True&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_key, __pyx_n_s_True, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_kwargs, __pyx_v_key, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>:         <span class="n">polymer_names</span> <span class="o">=</span> <span class="n">field_series</span><span class="p">[</span><span class="n">field_series</span> <span class="o">==</span> <span class="s">&#39;polymer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_field_series, __pyx_n_s_polymer, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_field_series, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_polymer_names = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1011</span>:         <span class="n">binder_names</span> <span class="o">=</span> <span class="n">field_series</span><span class="p">[</span><span class="n">field_series</span> <span class="o">==</span> <span class="s">&#39;binder&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_field_series, __pyx_n_s_binder, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_field_series, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_binder_names = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1012</span>:         <span class="n">err_prefix</span> <span class="o">=</span> <span class="n">f</span><span class="s">&quot;Tried to instantiate class:{cls} from file:{path} with &quot;</span></pre>
<pre class='cython code score-32 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_11 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Tried_to_instantiate_class);
  __pyx_t_5 += 27;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Tried_to_instantiate_class);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Tried_to_instantiate_class);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(((PyObject *)__pyx_v_cls), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_11;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_from_file);
  __pyx_t_5 += 11;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_from_file);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_from_file);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_path, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_11;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_with);
  __pyx_t_5 += 6;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_with);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u_with);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_5, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_err_prefix = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymers</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">polymer_names</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_polymers);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1014, __pyx_L1_error)</span>
  __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_polymer_names);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1014, __pyx_L1_error)</span>
  __pyx_t_9 = ((__pyx_t_5 != __pyx_t_12) != 0);
  if (unlikely(__pyx_t_9)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:                 <span class="n">err_prefix</span> <span class="o">+</span> <span class="n">f</span><span class="s">&quot;{len(polymers)} polymers, but &quot;</span></pre>
<pre class='cython code score-23 '>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_12 = 0;
    __pyx_t_11 = 127;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_polymers);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_polymers_but_there_are);
    __pyx_t_12 += 26;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_polymers_but_there_are);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_kp_u_polymers_but_there_are);
/* … */
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 4, __pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_err_prefix, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:                 <span class="n">f</span><span class="s">&quot; there are {len(polymer_names)} listed.&quot;</span></pre>
<pre class='cython code score-12 '>    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_polymer_names);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1017, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1017, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_listed);
    __pyx_t_12 += 8;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_listed);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_kp_u_listed);
</pre><pre class="cython line score-0">&#xA0;<span class="">1018</span>:             <span class="p">)</span></pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1019</span>:         <span class="k">for</span> <span class="n">polymer</span> <span class="ow">in</span> <span class="n">polymers</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_polymers)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_polymers)) {
    __pyx_t_1 = __pyx_v_polymers; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_12 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_polymers);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1019, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1019, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_12++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1019, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_12++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1019, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1019, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_polymer, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1020</span>:             <span class="k">if</span> <span class="n">polymer</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">polymer_names</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_polymer, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_t_3, __pyx_v_polymer_names, Py_NE)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1020, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = (__pyx_t_9 != 0);
    if (unlikely(__pyx_t_7)) {
/* … */
    }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1021, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L1_error)</span>
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>:                     <span class="n">err_prefix</span> <span class="o">+</span> <span class="n">f</span><span class="s">&quot;polymer:{polymer.name}, but &quot;</span></pre>
<pre class='cython code score-27 '>      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      __pyx_t_11 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_polymer_2);
      __pyx_t_5 += 8;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_polymer_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_polymer_2);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_polymer, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_2, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_11;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_but_this_polymer_was_not_presen);
      __pyx_t_5 += 44;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_but_this_polymer_was_not_presen);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_but_this_polymer_was_not_presen);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 3, __pyx_t_5, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_err_prefix, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>:                     <span class="s">&quot; this polymer was not present in file.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">binders</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binder_names</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>  __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binders);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binder_names);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  __pyx_t_7 = ((__pyx_t_12 != __pyx_t_5) != 0);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1026</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1026, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1026, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:                 <span class="n">err_prefix</span> <span class="o">+</span> <span class="n">f</span><span class="s">&quot;{len(binders)} binders, but &quot;</span></pre>
<pre class='cython code score-23 '>    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_11 = 127;
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binders);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1027, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_12, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_binders_but_there_are);
    __pyx_t_5 += 25;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_binders_but_there_are);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_kp_u_binders_but_there_are);
/* … */
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_5, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_err_prefix, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1028</span>:                 <span class="n">f</span><span class="s">&quot; there are {len(binder_names)} listed.&quot;</span></pre>
<pre class='cython code score-12 '>    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_binder_names);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1028, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_12, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1028, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_listed);
    __pyx_t_5 += 8;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_listed);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_kp_u_listed);
</pre><pre class="cython line score-0">&#xA0;<span class="">1029</span>:             <span class="p">)</span></pre>
<pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">binder</span> <span class="ow">in</span> <span class="n">binders</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span></pre>
<pre class='cython code score-107 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_binders, __pyx_n_s_iterrows);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_4 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
      PyObject* sequence = __pyx_t_4;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_10); if (unlikely(!__pyx_t_3)) goto __pyx_L15_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_13(__pyx_t_10); if (unlikely(!__pyx_t_2)) goto __pyx_L15_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_10), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
      __pyx_t_13 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L16_unpacking_done;
      __pyx_L15_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_13 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span>
      __pyx_L16_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1031</span>:             <span class="k">if</span> <span class="n">binder</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">binder_names</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_binder, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_t_4, __pyx_v_binder_names, Py_NE)); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1031, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = (__pyx_t_7 != 0);
    if (unlikely(__pyx_t_9)) {
/* … */
    }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1032, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L1_error)</span>
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:                     <span class="n">err_prefix</span> <span class="o">+</span> <span class="n">f</span><span class="s">&quot;binder:{binder}, but &quot;</span></pre>
<pre class='cython code score-24 '>      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = 0;
      __pyx_t_11 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_binder_2);
      __pyx_t_12 += 7;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_binder_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_binder_2);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_binder, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_11;
      __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_but_this_binder_was_not_present);
      __pyx_t_12 += 43;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_but_this_binder_was_not_present);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_but_this_binder_was_not_present);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 3, __pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_v_err_prefix, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1034</span>:                     <span class="s">&quot; this binder was not present in file.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1036</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">polymers</span><span class="o">=</span><span class="n">polymers</span><span class="p">,</span> <span class="n">binders</span><span class="o">=</span><span class="n">binders</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_polymers, __pyx_v_polymers) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1036, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binders, __pyx_v_binders) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1036, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_2;
  __pyx_t_2 = 0;
  if (unlikely(__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
    <span class='error_goto'>__PYX_ERR(0, 1036, __pyx_L1_error)</span>
  }
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_1, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1036, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1037</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:     <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_13__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_12__eq__[] = "Check if two `UniformDensityField` objects are equivalent.\n\n        Parameters\n        ----------\n        other : UniformDensityField\n            Field being compared to the current field.\n\n        Returns\n        -------\n        bool\n            True if two fields are equivalent, else false.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_19UniformDensityField_12__eq__;
#endif
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_13__eq__(PyObject *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__eq__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_12__eq__(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), ((PyObject *)__pyx_v_other));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_12__eq__(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, PyObject *__pyx_v_other) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__eq__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__eq__", __pyx_f[0], 1038, 0, <span class='error_goto'>__PYX_ERR(0, 1038, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.__eq__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1039</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if two `UniformDensityField` objects are equivalent.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>: <span class="sd">        other : UniformDensityField</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: <span class="sd">            Field being compared to the current field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>: <span class="sd">        bool</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>: <span class="sd">            True if two fields are equivalent, else false.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1051</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_all);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1052</span>:             <span class="p">[</span></pre>
<pre class='cython code score-28 '>  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1052, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, __pyx_t_12);
  __pyx_t_4 = 0;
  __pyx_t_2 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_11 = 0;
  __pyx_t_12 = 0;
  __pyx_t_12 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1051, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1053</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">polymers</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">polymers</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_polymers);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_self-&gt;__pyx_base.polymers, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1053, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1054</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">binders</span><span class="p">),</span></pre>
<pre class='cython code score-19 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;__pyx_base.binders, __pyx_n_s_equals);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1054, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1054, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1055</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">nx</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nx);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1055, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_nx);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1055, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_6, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1055, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1056</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">x_width</span><span class="p">,</span></pre>
<pre class='cython code score-14 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;x_width);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1056, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_x_width);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1056, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1056, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1057</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">ny</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;ny);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_ny);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_6, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1057, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y_width</span><span class="p">,</span></pre>
<pre class='cython code score-14 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;y_width);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_y_width);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1059</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">nz</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nz);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1059, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_nz);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1059, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_6, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1059, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">z_width</span></pre>
<pre class='cython code score-14 '>  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;z_width);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_z_width);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1060, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1061</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:     <span class="nd">@staticmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_staticmethod, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField-&gt;tp_dict, __pyx_n_s_get_corner_bin_index, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_6fields_UniformDensityField);
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>:     <span class="k">def</span> <span class="nf">_get_corner_bin_index</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span></pre>
<pre class='cython code score-73 '>/* Python wrapper */
static PyArrayObject *__pyx_pw_6chromo_6fields_19UniformDensityField_15_get_corner_bin_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_14_get_corner_bin_index[] = "Set up the index array for density bins corners.\n\n        Notes\n        -----\n        TODO: this should just be a higher-dimensional array to avoid having to\n        do any of this math.\n\n        Parameters\n        ----------\n        nx, ny, nz :  long\n            Number of voxels in the x, y, and z direction of the field\n\n        Returns\n        -------\n        array_like (nx*ny*nz, 8) of long\n            For each of the `nx*ny*nz` voxels in the field, stores indices\n            identifying eight vertices at the corners of the voxel\n        ";
static PyMethodDef __pyx_mdef_6chromo_6fields_19UniformDensityField_15_get_corner_bin_index = {"_get_corner_bin_index", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_6fields_19UniformDensityField_15_get_corner_bin_index, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_6fields_19UniformDensityField_14_get_corner_bin_index};
static PyArrayObject *__pyx_pw_6chromo_6fields_19UniformDensityField_15_get_corner_bin_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_nx = 0;
  PyObject *__pyx_v_ny = 0;
  PyObject *__pyx_v_nz = 0;
  PyArrayObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_get_corner_bin_index (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_nz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_corner_bin_index", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_corner_bin_index", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_corner_bin_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_nx = values[0];
    __pyx_v_ny = values[1];
    __pyx_v_nz = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_corner_bin_index", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField._get_corner_bin_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_14_get_corner_bin_index(__pyx_v_nx, __pyx_v_ny, __pyx_v_nz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyArrayObject *__pyx_pf_6chromo_6fields_19UniformDensityField_14_get_corner_bin_index(PyObject *__pyx_v_nx, PyObject *__pyx_v_ny, PyObject *__pyx_v_nz) {
  PyObject *__pyx_v_bin_index = NULL;
  PyObject *__pyx_v_count = NULL;
  PyObject *__pyx_v_index_z = NULL;
  PyObject *__pyx_v_index_zp1 = NULL;
  PyObject *__pyx_v_index_y = NULL;
  PyObject *__pyx_v_index_yp1 = NULL;
  PyObject *__pyx_v_index_x = NULL;
  PyObject *__pyx_v_index_xp1 = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__16)
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_get_corner_bin_index", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_get_corner_bin_index", __pyx_f[0], 1065, 0, <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField._get_corner_bin_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_zp1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_yp1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index_xp1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__54 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_nx, __pyx_n_s_ny, __pyx_n_s_nz, __pyx_n_s_bin_index, __pyx_n_s_count, __pyx_n_s_index_z, __pyx_n_s_index_zp1, __pyx_n_s_index_y, __pyx_n_s_index_yp1, __pyx_n_s_index_x, __pyx_n_s_index_xp1);<span class='error_goto'> if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1065, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__54);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__54);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_6chromo_6fields_19UniformDensityField_15_get_corner_bin_index, NULL, __pyx_n_s_chromo_fields);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField-&gt;tp_dict, __pyx_n_s_get_corner_bin_index, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_6fields_UniformDensityField);
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_6fields_UniformDensityField, __pyx_n_s_get_corner_bin_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_codeobj__16 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_fields_pyx, __pyx_n_s_get_corner_bin_index, 1065, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 1065, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1066</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the index array for density bins corners.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>: <span class="sd">        TODO: this should just be a higher-dimensional array to avoid having to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>: <span class="sd">        do any of this math.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>: <span class="sd">        nx, ny, nz :  long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1076</span>: <span class="sd">            Number of voxels in the x, y, and z direction of the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>: <span class="sd">        array_like (nx*ny*nz, 8) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>: <span class="sd">            For each of the `nx*ny*nz` voxels in the field, stores indices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>: <span class="sd">            identifying eight vertices at the corners of the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:         <span class="n">bin_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">nz</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_nz);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_8);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1084, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_bin_index = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>:         <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_count = __pyx_int_0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1086</span>:         <span class="k">for</span> <span class="n">index_z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span></pre>
<pre class='cython code score-46 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_nz);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_z, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:             <span class="k">if</span> <span class="n">index_z</span> <span class="o">==</span> <span class="n">nz</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nz, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_index_z, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_7) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:                 <span class="n">index_zp1</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_zp1, __pyx_int_0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1089</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:                 <span class="n">index_zp1</span> <span class="o">=</span> <span class="n">index_z</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>    /*else*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_index_z, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_zp1, __pyx_t_3);
      __pyx_t_3 = 0;
    }
    __pyx_L5:;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:             <span class="k">for</span> <span class="n">index_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ny</span><span class="p">):</span></pre>
<pre class='cython code score-46 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1091, __pyx_L1_error)</span>
          #else
          __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          #endif
        } else {
          if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1091, __pyx_L1_error)</span>
          #else
          __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_9(__pyx_t_4);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1091, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_y, __pyx_t_3);
      __pyx_t_3 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:                 <span class="k">if</span> <span class="n">index_y</span> <span class="o">==</span> <span class="n">ny</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_ny, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_index_y, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_7) {
/* … */
        goto __pyx_L8;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:                     <span class="n">index_yp1</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_yp1, __pyx_int_0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1094</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:                     <span class="n">index_yp1</span> <span class="o">=</span> <span class="n">index_y</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>      /*else*/ {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_index_y, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1095, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_yp1, __pyx_t_2);
        __pyx_t_2 = 0;
      }
      __pyx_L8:;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:                 <span class="k">for</span> <span class="n">index_x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span></pre>
<pre class='cython code score-46 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_nx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_11 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
            if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          } else {
            if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_11(__pyx_t_3);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_x, __pyx_t_2);
        __pyx_t_2 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:                     <span class="k">if</span> <span class="n">index_x</span> <span class="o">==</span> <span class="n">nx</span> <span class="o">-</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_nx, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_index_x, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        if (__pyx_t_7) {
/* … */
          goto __pyx_L11;
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:                         <span class="n">index_xp1</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_xp1, __pyx_int_0);
</pre><pre class="cython line score-0">&#xA0;<span class="">1099</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:                         <span class="n">index_xp1</span> <span class="o">=</span> <span class="n">index_x</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>        /*else*/ {
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_index_x, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_index_xp1, __pyx_t_12);
          __pyx_t_12 = 0;
        }
        __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>:                     <span class="c"># Populate the bin_index array with the 8 corner bins</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>:                     <span class="n">bin_index</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-19 '>        __pyx_t_20 = <span class='py_c_api'>PyList_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 0, __pyx_t_12);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_13);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 2, __pyx_t_14);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 3, __pyx_t_15);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 4, __pyx_t_16);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 5, __pyx_t_17);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 6, __pyx_t_18);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
        <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_20, 7, __pyx_t_19);
        __pyx_t_12 = 0;
        __pyx_t_13 = 0;
        __pyx_t_14 = 0;
        __pyx_t_15 = 0;
        __pyx_t_16 = 0;
        __pyx_t_17 = 0;
        __pyx_t_18 = 0;
        __pyx_t_19 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_bin_index, __pyx_v_count, __pyx_t_20) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:                         <span class="n">index_x</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_y</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_z</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_y);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_x, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_v_index_z);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:                         <span class="n">index_xp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_y</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_z</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_y);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_xp1, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_v_index_z);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        __pyx_t_13 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:                         <span class="n">index_x</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_yp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_z</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_yp1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_x, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_v_index_z);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        __pyx_t_14 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:                         <span class="n">index_xp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_yp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_z</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_yp1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_xp1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_16 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_v_index_z);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_15 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1106, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:                         <span class="n">index_x</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_y</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_zp1</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_16 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_y);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_x, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        __pyx_t_16 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_16, __pyx_v_index_zp1);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        __pyx_t_16 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:                         <span class="n">index_xp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_y</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_zp1</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_y);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_xp1, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_v_index_zp1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        __pyx_t_17 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:                         <span class="n">index_x</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_yp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_zp1</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>        __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_yp1);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_x, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_18, __pyx_v_index_zp1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
        __pyx_t_18 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:                         <span class="n">index_xp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_yp1</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_zp1</span></pre>
<pre class='cython code score-29 '>        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_index_yp1);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_index_xp1, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_nx, __pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_v_index_zp1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
        __pyx_t_19 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1111</span>:                     <span class="p">]</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:                     <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>        __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_count, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_count, __pyx_t_20);
        __pyx_t_20 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:         <span class="k">return</span> <span class="n">bin_index</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_bin_index) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_bin_index, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1113, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bin_index);
  __pyx_r = ((PyArrayObject *)__pyx_v_bin_index);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1115</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_17__str__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_16__str__[] = "Print summary of the UniformDensityField.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_6fields_19UniformDensityField_16__str__;
#endif
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_17__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_16__str__(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_16__str__(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  Py_ssize_t __pyx_v_n_poly;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
  <span class='trace'>__Pyx_TraceCall</span>("__str__", __pyx_f[0], 1115, 0, <span class='error_goto'>__PYX_ERR(0, 1115, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1116</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Print summary of the UniformDensityField.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:         <span class="n">n_poly</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polymers</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.polymers;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  if (unlikely(__pyx_t_1 == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>__PYX_ERR(0, 1118, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1118, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n_poly = __pyx_t_2;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:         <span class="k">return</span> <span class="n">f</span><span class="s">&quot;UniformDensityField&lt;nx={self.nx},ny={self.ny},nz={self.nz},&quot;</span> <span class="w">\</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_UniformDensityField_nx);
  __pyx_t_2 += 23;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_UniformDensityField_nx);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_UniformDensityField_nx);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_long</span>(__pyx_v_self-&gt;nx, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_ny_2);
  __pyx_t_2 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_ny_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_ny_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_long</span>(__pyx_v_self-&gt;ny, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_nz_2);
  __pyx_t_2 += 4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_nz_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u_nz_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_long</span>(__pyx_v_self-&gt;nz, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_npoly);
  __pyx_t_2 += 7;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_npoly);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 6, __pyx_kp_u_npoly);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 9, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1120</span>:                <span class="n">f</span><span class="s">&quot;npoly={n_poly}&gt;&quot;</span></pre>
<pre class='cython code score-7 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_v_n_poly, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 7, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__17);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__17);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 8, __pyx_kp_u__17);
</pre><pre class="cython line score-0">&#xA0;<span class="">1121</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1122</span>:     <span class="k">def</span> <span class="nf">get_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_19get_dict(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_18get_dict[] = "Dictionary representation of the `UniformDensityField` object.\n\n        Returns\n        -------\n        dict\n            Dictionary of key attributes representing the field\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_19get_dict(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dict (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_18get_dict(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_18get_dict(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dict", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_dict", __pyx_f[0], 1122, 0, <span class='error_goto'>__PYX_ERR(0, 1122, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_dict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1123</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Dictionary representation of the `UniformDensityField` object.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1125</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1126</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>: <span class="sd">        dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>: <span class="sd">            Dictionary of key attributes representing the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:         <span class="k">return</span> <span class="p">{</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:             <span class="s">&quot;x_width&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_width</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(16);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;x_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_x_width, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:             <span class="s">&quot;y_width&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_width</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;y_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_y_width, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:             <span class="s">&quot;z_width&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_width</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;z_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_z_width, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:             <span class="s">&quot;nx&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nx);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_nx, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1135</span>:             <span class="s">&quot;ny&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;ny);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_ny, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:             <span class="s">&quot;nz&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nz</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;nz);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_nz, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:             <span class="s">&quot;num_binders&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_num_binders, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:             <span class="s">&quot;n_bins&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_bins, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:             <span class="s">&quot;density&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;density, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_density, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:             <span class="s">&quot;confine_type&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_type</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_confine_type, __pyx_v_self-&gt;__pyx_base.confine_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:             <span class="s">&quot;confine_length&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">confine_length</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.confine_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_confine_length, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:             <span class="s">&quot;chi&quot;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;chi);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_chi, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1143</span>:             <span class="s">&quot;assume_fully_accessible&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">assume_fully_accessible</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;assume_fully_accessible);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_assume_fully_accessible, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:             <span class="s">&quot;vf_limit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_limit</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vf_limit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1144, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_vf_limit, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1145</span>:             <span class="s">&quot;fast_field&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_field</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_self-&gt;fast_field);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_fast_field, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1146</span>:             <span class="s">&quot;n_points&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_points);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_points, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1147</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1149</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>static double __pyx_f_6chromo_6fields_19UniformDensityField_compute_dE(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, CYTHON_UNUSED long __pyx_v_packet_size, int __pyx_v_state_change) {
  long __pyx_v_i;
  long __pyx_v_bin_ind;
  __Pyx_memviewslice __pyx_v_bin_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_dE;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("compute_dE", __pyx_f[0], 1149, 0, <span class='error_goto'>__PYX_ERR(0, 1149, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bin_inds, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1150</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>:         <span class="nb">long</span> <span class="n">packet_size</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute field contribution of energy change for proposed MC move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>: <span class="sd">        For polymer affected by a move, compare the field energy of the new </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: <span class="sd">        and old configurations.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>: <span class="sd">        First verify all points lie inside the specified confining boundary.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>: <span class="sd">        If a point lies outside the boundary, return a high energy to reject</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>: <span class="sd">        the move and stop field energy calculation. If all beads affected by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1163</span>: <span class="sd">        the move lie inside the confinement, do the following:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>: <span class="sd">        Load the current position and states for the polymer. Using this data,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>: <span class="sd">        identify the density of the polymer and binders in each bin in space.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>: <span class="sd">        Repeat this density calculation for the trial polymer and binders</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>: <span class="sd">        configuration. Determine the self-interaction energy based on the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>: <span class="sd">        interpolated densities between each bin using the approach described</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1170</span>: <span class="sd">        by MacPherson et al [1]. For each binder on the chain, add its</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1171</span>: <span class="sd">        contribution to the field energy based on interactions with like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1172</span>: <span class="sd">        binders.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1174</span>: <span class="sd">        References</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1175</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1176</span>: <span class="sd">        [1] MacPherson, Q.; Beltran, B.; Spakowitz, A. J. Bottom–up Modeling of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1177</span>: <span class="sd">            Chromatin Segregation Due to Epigenetic Modifications. PNAS 2018,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>: <span class="sd">            115 (50), 12739–12744. https://doi.org/10.1073/pnas.1812268115.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1182</span>: <span class="sd">        poly : `chromo.PolymerBase`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1183</span>: <span class="sd">            The polymer which has been moved.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>: <span class="sd">        inds : array_like (N,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>: <span class="sd">            Indices of beads being moved</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: <span class="sd">            Number of beads affected by the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1188</span>: <span class="sd">        packet_size : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1189</span>: <span class="sd">            Number of points to average together when calculating the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>: <span class="sd">            energy change of a move; done to reduce the computational expense</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>: <span class="sd">            of the field energy calculation (at the expense of precision).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1192</span>: <span class="sd">            Currently this does nothing. Packet size is a consideration for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1193</span>: <span class="sd">            later on if the simulation is too slow.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1194</span>: <span class="sd">        state_change : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1195</span>: <span class="sd">            Indicator for whether the MC move involved a change in binding state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>: <span class="sd">            (1) or not (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1199</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: <span class="sd">        dE : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>: <span class="sd">            Change in field energy assocaited with the change in polymer </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: <span class="sd">            configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">ind</span><span class="p">,</span> <span class="nf">bin_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">delta_ind_xyz</span><span class="p">,</span> <span class="n">bin_inds</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1206</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dE</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>:         <span class="c"># Verify that move does not violate the hard confinement</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1209</span>:         <span class="k">if</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_state_change == 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1210</span>:             <span class="n">dE</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_confinement_dE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dE = (__pyx_v_dE + ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.get_confinement_dE(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:             <span class="n">dE</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_confinement_dE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dE = (__pyx_v_dE - ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.get_confinement_dE(((struct __pyx_obj_6chromo_6fields_FieldBase *)__pyx_v_self), __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>:         <span class="c"># Find changes in polymer density in affected voxels</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1214</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fast_field</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;fast_field == 1) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1215</span>:             <span class="n">bin_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_change_in_density_quickly</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_change_in_density_quickly(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_state_change);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1215, __pyx_L1_error)</span>
    __pyx_v_bin_inds = __pyx_t_2;
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1216</span>:                 <span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1219</span>:             <span class="n">bin_inds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_change_in_density</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
/* … */
    __pyx_t_2 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_change_in_density(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_state_change);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1219, __pyx_L1_error)</span>
    __pyx_v_bin_inds = __pyx_t_2;
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1220</span>:                 <span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1223</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = __pyx_v_self-&gt;n_bins;
  __pyx_t_4 = __pyx_t_3;
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_4; __pyx_t_5+=1) {
    __pyx_v_i = __pyx_t_5;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">affected_bins_last_move</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;affected_bins_last_move.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_7 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;affected_bins_last_move.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;affected_bins_last_move.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;affected_bins_last_move.data + __pyx_t_6 * __pyx_v_self-&gt;affected_bins_last_move.strides[0]) )) = 0;
  }
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1225</span>:         <span class="k">for</span> <span class="n">bin_ind</span> <span class="ow">in</span> <span class="n">bin_inds</span><span class="p">:</span></pre>
<pre class='cython code score-51 '>  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_bin_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
    __pyx_t_9 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_10 = 0;
    __pyx_t_11 = NULL;
  } else {
    __pyx_t_10 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_11 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  for (;;) {
    if (likely(!__pyx_t_11)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
        if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
        #else
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        #endif
      } else {
        if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
        #else
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_11(__pyx_t_9);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_8); if (unlikely((__pyx_t_3 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_bin_ind = __pyx_t_3;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1226</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">affected_bins_last_move</span><span class="p">[</span><span class="n">bin_ind</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;affected_bins_last_move.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1226, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_bin_ind;
    __pyx_t_7 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;affected_bins_last_move.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;affected_bins_last_move.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 1226, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;affected_bins_last_move.data + __pyx_t_6 * __pyx_v_self-&gt;affected_bins_last_move.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1227</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>:         <span class="c"># Get change in energy based on differences in bead and binder densities</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1229</span>:         <span class="n">dE</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dE_binders_and_beads</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = (__pyx_v_dE + ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_dE_binders_and_beads(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_bin_inds, __pyx_v_state_change));
</pre><pre class="cython line score-0">&#xA0;<span class="">1230</span>:             <span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1233</span>:         <span class="k">return</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_dE;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1234</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1235</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">get_change_in_density_quickly</span><span class="p">(</span></pre>
<pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_change_in_density_quickly(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_state_change) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  long __pyx_v_l;
  long __pyx_v_m;
  long __pyx_v_sub_bin_x;
  long __pyx_v_sub_bin_y;
  long __pyx_v_sub_bin_z;
  long __pyx_v_sub_bin_x_trial;
  long __pyx_v_sub_bin_y_trial;
  long __pyx_v_sub_bin_z_trial;
  double __pyx_v_prefactor;
  PyObject *__pyx_v_bins_found = 0;
  PyObject *__pyx_v_temp = NULL;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_change_in_density_quickly", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_change_in_density_quickly", __pyx_f[0], 1235, 0, <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_27, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_change_in_density_quickly", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins_found);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1236</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>:         <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the density in bins affected by the MC move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">        See notes for `self.get_change_in_density()`. Uses pre-computed sub-bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">        weightings. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">m</span><span class="p">,</span> <span class="nf">sub_bin_x</span><span class="p">,</span> <span class="nf">sub_bin_y</span><span class="p">,</span> <span class="nf">sub_bin_z</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">sub_bin_x_trial</span><span class="p">,</span> <span class="nf">sub_bin_y_trial</span><span class="p">,</span> <span class="nf">sub_bin_z_trial</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">prefactor</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">densities</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>:         <span class="k">cdef</span> <span class="kt">set</span> <span class="nf">bins_found</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1251</span>:         <span class="n">bins_found</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1251, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_bins_found = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1252</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1253</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n_inds;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1254</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:             <span class="c"># Get sub-bin indices</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:             <span class="n">sub_bin_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:                 <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>    if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>
    }
    __pyx_t_9 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_7 * __pyx_v_inds.strides[0]) )));
    __pyx_t_10 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_poly-&gt;r.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_poly-&gt;r.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>}
    __pyx_t_11 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;half_width_xyz.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>
    }
    __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_9 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_11 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
    if (unlikely(__pyx_v_self-&gt;sub_bin_width_x == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>
    }
/* … */
    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_x));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1257, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_1 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1256, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1258</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_x</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:             <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_x</span></pre>
<pre class='cython code score-17 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_x);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_5); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_sub_bin_x = __pyx_t_14;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1260</span>:             <span class="n">sub_bin_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:                 <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>    if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>}
    __pyx_t_11 = __pyx_v_i;
    __pyx_t_8 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>
    }
    __pyx_t_7 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_11 * __pyx_v_inds.strides[0]) )));
    __pyx_t_10 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_poly-&gt;r.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_poly-&gt;r.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>}
    __pyx_t_9 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;half_width_xyz.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>
    }
    __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_7 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_9 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
    if (unlikely(__pyx_v_self-&gt;sub_bin_width_y == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>
    }
/* … */
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_y));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1261, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_13, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1262</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_y</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:             <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_y</span></pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_6); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_sub_bin_y = __pyx_t_14;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:             <span class="n">sub_bin_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:                 <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>    if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_9 * __pyx_v_inds.strides[0]) )));
    __pyx_t_10 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_poly-&gt;r.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_poly-&gt;r.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>}
    __pyx_t_7 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;half_width_xyz.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_11 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
    if (unlikely(__pyx_v_self-&gt;sub_bin_width_z == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_z));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1265, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_6 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_13, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1266</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_z</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:             <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_z</span></pre>
<pre class='cython code score-17 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_z);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_sub_bin_z = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1268</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1269</span>:             <span class="c"># Identify sub-bin weights in x, y, z directions</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>}
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_x</span><span class="p">[</span><span class="n">sub_bin_x</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_x, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1271, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1272</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1272, __pyx_L1_error)</span>}
    __pyx_t_9 = 0;
    __pyx_t_7 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1272, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_y</span><span class="p">[</span><span class="n">sub_bin_y</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1273, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_y, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1273, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1274</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>}
    __pyx_t_7 = 0;
    __pyx_t_9 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_z</span><span class="p">[</span><span class="n">sub_bin_z</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1275, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_z);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1275, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_z, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1275, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1275, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1275, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1276</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:             <span class="k">if</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = ((__pyx_v_state_change == 0) != 0);
    if (__pyx_t_15) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1278</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1279</span>:                 <span class="n">sub_bin_x_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1279, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1279, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1280</span>:                     <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>      if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>}
      __pyx_t_9 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>
      }
      __pyx_t_7 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_9 * __pyx_v_inds.strides[0]) )));
      __pyx_t_10 = 0;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_poly-&gt;r_trial.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_8 = 0;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_poly-&gt;r_trial.shape[1];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_8 = 1;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>}
      __pyx_t_11 = 0;
      __pyx_t_8 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_self-&gt;half_width_xyz.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>
      }
      __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_7 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_11 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
      if (unlikely(__pyx_v_self-&gt;sub_bin_width_x == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_x));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1280, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_1 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_13, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1279, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1281</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_x</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>:                 <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_x</span></pre>
<pre class='cython code score-17 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_x);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1282, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_5); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1282, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_sub_bin_x_trial = __pyx_t_14;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1283</span>:                 <span class="n">sub_bin_y_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1283, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1283, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:                     <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>      if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>}
      __pyx_t_11 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>
      }
      __pyx_t_9 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_11 * __pyx_v_inds.strides[0]) )));
      __pyx_t_10 = 1;
      __pyx_t_8 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_poly-&gt;r_trial.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_8 = 0;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_poly-&gt;r_trial.shape[1];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_8 = 1;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>}
      __pyx_t_7 = 1;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_self-&gt;half_width_xyz.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>
      }
      __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_9 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
      if (unlikely(__pyx_v_self-&gt;sub_bin_width_y == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_y));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1284, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_13, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1283, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1285</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_y</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1286</span>:                 <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_y</span></pre>
<pre class='cython code score-17 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1286, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1286, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_6); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1286, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_v_sub_bin_y_trial = __pyx_t_14;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1287</span>:                 <span class="n">sub_bin_z_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1287, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1287, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1288</span>:                     <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">2</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span> <span class="o">/</span></pre>
<pre class='cython code score-41 '>      if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>}
      __pyx_t_7 = __pyx_v_i;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>
      }
      __pyx_t_11 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_7 * __pyx_v_inds.strides[0]) )));
      __pyx_t_10 = 2;
      __pyx_t_8 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_poly-&gt;r_trial.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_8 = 0;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_poly-&gt;r_trial.shape[1];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 1;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_8 = 1;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>}
      __pyx_t_9 = 2;
      __pyx_t_8 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;half_width_xyz.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>
      }
      __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_11 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_9 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
      if (unlikely(__pyx_v_self-&gt;sub_bin_width_z == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 1288, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_12 / __pyx_v_self-&gt;sub_bin_width_z));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1288, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      __pyx_t_6 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_13, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1287, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1289</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">sub_bin_width_z</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1290</span>:                 <span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sub_bins_z</span></pre>
<pre class='cython code score-17 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_sub_bins_z);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1290, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1290, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1290, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_sub_bin_z_trial = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1293</span>:                 <span class="n">sub_bin_x_trial</span> <span class="o">=</span> <span class="n">sub_bin_x</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_sub_bin_x_trial = __pyx_v_sub_bin_x;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1294</span>:                 <span class="n">sub_bin_y_trial</span> <span class="o">=</span> <span class="n">sub_bin_y</span></pre>
<pre class='cython code score-0 '>      __pyx_v_sub_bin_y_trial = __pyx_v_sub_bin_y;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1295</span>:                 <span class="n">sub_bin_z_trial</span> <span class="o">=</span> <span class="n">sub_bin_z</span></pre>
<pre class='cython code score-0 '>      __pyx_v_sub_bin_z_trial = __pyx_v_sub_bin_z;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1296</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_14 = 0; __pyx_t_14 &lt; 3; __pyx_t_14+=1) {
        __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1297</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1297, __pyx_L1_error)</span>}
        __pyx_t_9 = 0;
        __pyx_t_7 = __pyx_v_j;
        __pyx_t_8 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_7 &lt; 0) {
          __pyx_t_7 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_8 = 1;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1297, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1297, __pyx_L1_error)</span>}
        __pyx_t_10 = 1;
        __pyx_t_11 = __pyx_v_j;
        __pyx_t_8 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_8 = 1;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1297, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_11)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_7)) )));
      }
    }
    __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1299, __pyx_L1_error)</span>}
    __pyx_t_7 = 1;
    __pyx_t_9 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1299, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1300</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_x</span><span class="p">[</span><span class="n">sub_bin_x_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1300, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_x_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1300, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_x, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1300, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1300, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1300, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1301</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1301, __pyx_L1_error)</span>}
    __pyx_t_9 = 1;
    __pyx_t_7 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1301, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1302</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_y</span><span class="p">[</span><span class="n">sub_bin_y_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1302, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_y_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_y, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1302, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1303</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1303, __pyx_L1_error)</span>}
    __pyx_t_7 = 1;
    __pyx_t_9 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1303, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_12;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1304</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_weights_z</span><span class="p">[</span><span class="n">sub_bin_z_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_weights_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1304, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_z_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_weights_z, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1304, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1305</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1306</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1306, __pyx_L1_error)</span>}
    __pyx_t_9 = 0;
    __pyx_t_7 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1306, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1307</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_x</span><span class="p">[</span><span class="n">sub_bin_x</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1307, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_x, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1307, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1308</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span>}
    __pyx_t_7 = 0;
    __pyx_t_9 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1308, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1309</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_y</span><span class="p">[</span><span class="n">sub_bin_y</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_y, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1309, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1310</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1310, __pyx_L1_error)</span>}
    __pyx_t_9 = 0;
    __pyx_t_7 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1310, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1311</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_z</span><span class="p">[</span><span class="n">sub_bin_z</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_z);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_z, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1311, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1312</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1312, __pyx_L1_error)</span>}
    __pyx_t_7 = 1;
    __pyx_t_9 = 0;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1312, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1313</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_x</span><span class="p">[</span><span class="n">sub_bin_x_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_x == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1313, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_x_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_x, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1313, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1314</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1314, __pyx_L1_error)</span>}
    __pyx_t_9 = 1;
    __pyx_t_7 = 1;
    __pyx_t_8 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1314, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1315</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_y</span><span class="p">[</span><span class="n">sub_bin_y_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_y == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1315, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_y_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_y, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1315, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1316</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1316, __pyx_L1_error)</span>}
    __pyx_t_7 = 1;
    __pyx_t_9 = 2;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_8 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_8 = 1;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1316, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_14;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">sub_bins_to_bins_z</span><span class="p">[</span><span class="n">sub_bin_z_trial</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;sub_bins_to_bins_z == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_sub_bin_z_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;sub_bins_to_bins_z, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_14 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1318</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1319</span>:             <span class="c"># Get weights and super-indices of eight bins containing bead</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_weight_vector_with_trial</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_weight_vector_with_trial(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1321</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_index_vector_with_trial</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_index_vector_with_trial(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">1322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1323</span>:             <span class="c"># Distribute weights into bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1324</span>:             <span class="c"># k indicates current (0) or trial (1) configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1325</span>:             <span class="c"># l indicates for which of eight bins density is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1326</span>:             <span class="c"># m indicates polymer (0) or which protein (1 to n_binders)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_14 = 0; __pyx_t_14 &lt; 2; __pyx_t_14+=1) {
      __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1328</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_16 = 0; __pyx_t_16 &lt; 8; __pyx_t_16+=1) {
        __pyx_v_l = __pyx_t_16;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_7 = 0;
        __pyx_t_11 = __pyx_v_l;
        __pyx_t_8 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_7 &lt; 0) {
          __pyx_t_7 += __pyx_v_poly-&gt;densities_temp.shape[1];
          if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_poly-&gt;densities_temp.shape[2];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 2;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_7 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_11)) )) = __pyx_t_12;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1330</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">/</span></pre>
<pre class='cython code score-27 '>        if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_7 = __pyx_v_l;
        __pyx_t_8 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_7 &lt; 0) {
          __pyx_t_7 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
          if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_8 = 1;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>
        }
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_7)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1330, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1330, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_5); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]]</span></pre>
<pre class='cython code score-17 '>        if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
          <span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L1_error)</span>}
        __pyx_t_7 = __pyx_v_k;
        __pyx_t_9 = __pyx_v_l;
        __pyx_t_8 = -1;
        if (__pyx_t_7 &lt; 0) {
          __pyx_t_7 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
          if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_8 = 1;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L1_error)</span>
        }
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1331, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1331, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1332</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1333</span>:                     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
        __pyx_t_18 = __pyx_t_17;
        for (__pyx_t_19 = 1; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
          __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-0">&#xA0;<span class="">1334</span>:                         <span class="c"># Current Configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:                         <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_20 = ((__pyx_v_k == 0) != 0);
          if (!__pyx_t_20) {
          } else {
            __pyx_t_15 = __pyx_t_20;
            goto __pyx_L15_bool_binop_done;
          }
          __pyx_t_20 = ((__pyx_v_state_change == 0) != 0);
          __pyx_t_15 = __pyx_t_20;
          __pyx_L15_bool_binop_done:;
          if (__pyx_t_15) {
/* … */
            goto __pyx_L14;
          }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>}
            __pyx_t_23 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_m;
            __pyx_t_25 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_23 &lt; 0) {
              __pyx_t_23 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_24 &lt; 0) {
              __pyx_t_24 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_25 &lt; 0) {
              __pyx_t_25 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_23 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_24 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_25)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_11 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_7 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_9)) ))) * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_21 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_22)) )))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1337</span>:                                 <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1337, __pyx_L1_error)</span>}
            __pyx_t_11 = __pyx_v_k;
            __pyx_t_7 = 0;
            __pyx_t_9 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_11 &lt; 0) {
              __pyx_t_11 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1337, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:                                 <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1338, __pyx_L1_error)</span>}
            __pyx_t_10 = __pyx_v_i;
            __pyx_t_8 = -1;
            if (__pyx_t_10 &lt; 0) {
              __pyx_t_10 += __pyx_v_inds.shape[0];
              if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1338, __pyx_L1_error)</span>
            }
            __pyx_t_21 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_10 * __pyx_v_inds.strides[0]) )));
            __pyx_t_22 = (__pyx_v_m - 1);
            __pyx_t_8 = -1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;states.shape[0];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_22 &lt; 0) {
              __pyx_t_22 += __pyx_v_poly-&gt;states.shape[1];
              if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1338, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1339</span>:                         <span class="c"># Trial Configuration of State Change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1340</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>}
            __pyx_t_25 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_m;
            __pyx_t_23 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_25 &lt; 0) {
              __pyx_t_25 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_24 &lt; 0) {
              __pyx_t_24 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_23 &lt; 0) {
              __pyx_t_23 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_25 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_24 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_23)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_10 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_22 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_21)) ))) * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states_trial.data + __pyx_t_7 * __pyx_v_poly-&gt;states_trial.strides[0]) )) + __pyx_t_11)) )))));
          }
          __pyx_L14:;
        }
      }
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1342</span>:                                 <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-7 '>          /*else*/ {
            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1342, __pyx_L1_error)</span>}
            __pyx_t_10 = __pyx_v_k;
            __pyx_t_22 = 0;
            __pyx_t_21 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_10 &lt; 0) {
              __pyx_t_10 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_22 &lt; 0) {
              __pyx_t_22 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1342, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:                                 <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_poly-&gt;states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>}
            __pyx_t_9 = __pyx_v_i;
            __pyx_t_8 = -1;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_inds.shape[0];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_inds.shape[0])) __pyx_t_8 = 0;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>
            }
            __pyx_t_7 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_9 * __pyx_v_inds.strides[0]) )));
            __pyx_t_11 = (__pyx_v_m - 1);
            __pyx_t_8 = -1;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_poly-&gt;states_trial.shape[0];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;states_trial.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_11 &lt; 0) {
              __pyx_t_11 += __pyx_v_poly-&gt;states_trial.shape[1];
              if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;states_trial.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1344</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1345</span>:             <span class="c"># Combine repeating elements, stored in poly.density_trial</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_14 = 0; __pyx_t_14 &lt; 2; __pyx_t_14+=1) {
      __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1347</span>:                 <span class="c"># Subtract if current configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:                 <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = ((__pyx_v_k == 0) != 0);
      if (__pyx_t_15) {
/* … */
        goto __pyx_L19;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1349</span>:                     <span class="n">prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span></pre>
<pre class='cython code score-0 '>        __pyx_v_prefactor = -1.;
</pre><pre class="cython line score-0">&#xA0;<span class="">1350</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:                     <span class="n">prefactor</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_prefactor = 1.;
      }
      __pyx_L19:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1352</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1353</span>:                 <span class="c"># Accumulate densities</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1354</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_16 = 0; __pyx_t_16 &lt; 8; __pyx_t_16+=1) {
        __pyx_v_l = __pyx_t_16;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="ow">in</span> <span class="n">bins_found</span><span class="p">:</span></pre>
<pre class='cython code score-12 '>        if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_11 = __pyx_v_l;
        __pyx_t_8 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_8 = 0;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 1;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_8 = 1;
        if (unlikely(__pyx_t_8 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
          <span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>
        }
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_11)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1355, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PySet_ContainsTF</span>(__pyx_t_5, __pyx_v_bins_found, Py_EQ)); if (unlikely(__pyx_t_15 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_20 = (__pyx_t_15 != 0);
        if (__pyx_t_20) {
/* … */
          goto __pyx_L22;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:                         <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
          __pyx_t_18 = __pyx_t_17;
          for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1357</span>:                             <span class="n">temp</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1357, __pyx_L1_error)</span>}
            __pyx_t_11 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_m;
            __pyx_t_7 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_11 &lt; 0) {
              __pyx_t_11 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1357, __pyx_L1_error)</span>
            }
            __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_prefactor * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_11 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_7)) )))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1357, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_temp, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1358</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span></pre>
<pre class='cython code score-5 '>            if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>}
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1359</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="n">m</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>}
            __pyx_t_7 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>
            }
            __pyx_t_11 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) )));
            __pyx_t_21 = __pyx_v_m;
            __pyx_t_8 = -1;
            if (__pyx_t_11 &lt; 0) {
              __pyx_t_11 += __pyx_v_self-&gt;density_trial.shape[0];
              if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_self-&gt;density_trial.shape[1];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_11 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_21)) )) += __pyx_t_12;
          }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1360</span>:                             <span class="p">]</span> <span class="o">+=</span> <span class="n">temp</span></pre>
<pre class='cython code score-10 '>            __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_temp); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1360, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1361</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1362</span>:                         <span class="n">bins_found</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">])</span></pre>
<pre class='cython code score-15 '>        /*else*/ {
          if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1362, __pyx_L1_error)</span>}
          __pyx_t_9 = __pyx_v_k;
          __pyx_t_7 = __pyx_v_l;
          __pyx_t_8 = -1;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_8 = 0;
          if (__pyx_t_7 &lt; 0) {
            __pyx_t_7 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
            if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 1;
          } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_8 = 1;
          if (unlikely(__pyx_t_8 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
            <span class='error_goto'>__PYX_ERR(0, 1362, __pyx_L1_error)</span>
          }
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_7)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_26 = <span class='py_c_api'>PySet_Add</span>(__pyx_v_bins_found, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_26 == ((int)-1))) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1363</span>:                         <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
          __pyx_t_18 = __pyx_t_17;
          for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1364</span>:                             <span class="n">temp</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1364, __pyx_L1_error)</span>}
            __pyx_t_7 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_m;
            __pyx_t_21 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_8 = 1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_8 = 2;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_8 = 2;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1364, __pyx_L1_error)</span>
            }
            __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_prefactor * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_7 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_21)) )))));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1364, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_temp, __pyx_t_5);
            __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1365</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span></pre>
<pre class='cython code score-5 '>            if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1365, __pyx_L1_error)</span>}
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1366</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="n">m</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1366, __pyx_L1_error)</span>}
            __pyx_t_21 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_l;
            __pyx_t_8 = -1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1366, __pyx_L1_error)</span>
            }
            __pyx_t_7 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_21 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) )));
            __pyx_t_11 = __pyx_v_m;
            __pyx_t_8 = -1;
            if (__pyx_t_7 &lt; 0) {
              __pyx_t_7 += __pyx_v_self-&gt;density_trial.shape[0];
              if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
            } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_8 = 0;
            if (__pyx_t_11 &lt; 0) {
              __pyx_t_11 += __pyx_v_self-&gt;density_trial.shape[1];
              if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_8 = 1;
            } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_8 = 1;
            if (unlikely(__pyx_t_8 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
              <span class='error_goto'>__PYX_ERR(0, 1365, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_7 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_11)) )) = __pyx_t_12;
          }
        }
        __pyx_L22:;
      }
    }
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1367</span>:                             <span class="p">]</span> <span class="o">=</span> <span class="n">temp</span></pre>
<pre class='cython code score-10 '>            __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_temp); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1367, __pyx_L1_error)</span>
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1368</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bins_found</span><span class="p">))</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_bins_found);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_13 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_13)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_13, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_27.memview)) __PYX_ERR(0, 1368, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_27;
  __pyx_t_27.memview = NULL;
  __pyx_t_27.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1369</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">get_change_in_density</span><span class="p">(</span></pre>
<pre class='cython code score-13 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_change_in_density(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_state_change) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  long __pyx_v_l;
  long __pyx_v_m;
  long __pyx_v_ind;
  double __pyx_v_prefactor;
  PyObject *__pyx_v_bins_found = 0;
  PyObject *__pyx_v_temp = NULL;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_change_in_density", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_change_in_density", __pyx_f[0], 1370, 0, <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_28, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_change_in_density", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins_found);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_temp);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1371</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1372</span>:         <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the density in bins affected by the MC move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1375</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>: <span class="sd">        This method takes in a polymer configuration (either current or trial,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>: <span class="sd">        as dectated by the `trial` argument) and updates a field density map.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: <span class="sd">        The method operates by the following steps:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>: <span class="sd">        (1) Begin by generating weights and indices affected by the MC move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="sd">            - Start by identifying the (0, 0, 0) bins for the affected beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: <span class="sd">            and the associated weights.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1387</span>: <span class="sd">            - Then generate a weight array for all bins containing affected</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1388</span>: <span class="sd">            beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1389</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>: <span class="sd">            - Finally, generate an index vector identifying the affected bins.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>: <span class="sd">        (2) Then initialize a density vector and loop through binders and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1393</span>: <span class="sd">        corner bin indices to fill in the density vector.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>: <span class="sd">            - Values in arrays are determined element-by-element to improve</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1396</span>: <span class="sd">            speed once compiled.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>: <span class="sd">        (3) Combine repeated entries in the density array, and return the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1399</span>: <span class="sd">        affected densities and bin indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>: <span class="sd">        TODO: Replace dict with set (once I figure out how to get that working)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1402</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>: <span class="sd">        NOTE: Replacing k-loops with direct statements improves speed by approx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: <span class="sd">        0.7% -- we opt for clean code instead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="sd">            Polymer object undergoing transformation in field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="sd">        inds : array_like (N, ) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">            Ordered indices of N beads involved in the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: <span class="sd">            Number of bead indices affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">        state_change : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>: <span class="sd">            Indicator for whether the MC move involved a change in binding state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">            (1) or not (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span class="sd">        long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>: <span class="sd">            Array of unique bin indices affected by the proposed MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">m</span><span class="p">,</span> <span class="nf">ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">prefactor</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">densities</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1427</span>:         <span class="k">cdef</span> <span class="kt">set</span> <span class="nf">bins_found</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1428</span>:         <span class="n">bins_found</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_bins_found = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1429</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_n_inds;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1431</span>:             <span class="c"># Shift positions so all positive, apply periodic boundaries</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1432</span>:             <span class="c"># Get the lower neighboring bin index</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1433</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1434</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_5 = 0; __pyx_t_5 &lt; 3; __pyx_t_5+=1) {
      __pyx_v_j = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">1435</span>:                 <span class="c"># Load current and trial configuration of the polymer (current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1436</span>:                 <span class="c"># in row 0; trial in row 1)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>}
      __pyx_t_6 = 0;
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_6 &lt; 0) {
        __pyx_t_6 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
        if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = (__Pyx_mod_double(__pyx_t_11, __pyx_t_12) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_step_xyz.data + __pyx_t_10 * __pyx_v_self-&gt;half_step_xyz.strides[0]) ))));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:                     <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span></pre>
<pre class='cython code score-21 '>      if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>}
      __pyx_t_6 = __pyx_v_i;
      __pyx_t_7 = -1;
      if (__pyx_t_6 &lt; 0) {
        __pyx_t_6 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>
      }
      __pyx_t_8 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_6 * __pyx_v_inds.strides[0]) )));
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_poly-&gt;r.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_poly-&gt;r.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>}
      __pyx_t_10 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_self-&gt;half_width_xyz.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>
      }
      __pyx_t_11 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_8 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_9)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_10 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
      if (unlikely(__pyx_t_12 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float divmod()");
        <span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>}
      __pyx_t_10 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_self-&gt;width_xyz.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;width_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>
      }
      __pyx_t_12 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;width_xyz.data + __pyx_t_10 * __pyx_v_self-&gt;width_xyz.strides[0]) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>:                 <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_step_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;half_step_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1440, __pyx_L1_error)</span>}
      __pyx_t_10 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_self-&gt;half_step_xyz.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;half_step_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 1440, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>:                 <span class="k">if</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = ((__pyx_v_state_change == 0) != 0);
      if (__pyx_t_13) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1442</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>}
        __pyx_t_10 = 1;
        __pyx_t_6 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1442, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_6)) )) = (__Pyx_mod_double(__pyx_t_12, __pyx_t_11) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_step_xyz.data + __pyx_t_8 * __pyx_v_self-&gt;half_step_xyz.strides[0]) ))));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:                         <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span></pre>
<pre class='cython code score-21 '>        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>}
        __pyx_t_10 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>
        }
        __pyx_t_9 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_10 * __pyx_v_inds.strides[0]) )));
        __pyx_t_6 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_poly-&gt;r_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_poly-&gt;r_trial.shape[1];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;half_width_xyz.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>
        }
        __pyx_t_12 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_9 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_6)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_8 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
        if (unlikely(__pyx_t_11 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float divmod()");
          <span class='error_goto'>__PYX_ERR(0, 1443, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;width_xyz.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;width_xyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L1_error)</span>
        }
        __pyx_t_11 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;width_xyz.data + __pyx_t_8 * __pyx_v_self-&gt;width_xyz.strides[0]) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1445</span>:                     <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_step_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;half_step_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1445, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;half_step_xyz.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;half_step_xyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1445, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1446</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1447</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>      /*else*/ {
        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>}
        __pyx_t_8 = 0;
        __pyx_t_6 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>}
        __pyx_t_10 = 1;
        __pyx_t_9 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_6)) )));
      }
      __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1448</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1449</span>:                 <span class="c"># Get the lower neighboring bin index</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1450</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_14 = 0; __pyx_t_14 &lt; 2; __pyx_t_14+=1) {
        __pyx_v_k = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1451</span>:                     <span class="n">ind</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>        __pyx_v_ind = ((long)floor((__pyx_t_11 / __pyx_t_12)));
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1452</span>:                         <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>}
        __pyx_t_6 = __pyx_v_k;
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>
        }
        __pyx_t_11 = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_8)) )));
        if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>
        }
        __pyx_t_12 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
        if (unlikely(__pyx_t_12 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1453</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1454</span>:                     <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = ((__pyx_v_ind == -1L) != 0);
        if (__pyx_t_13) {
/* … */
          goto __pyx_L10;
        }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1455</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_xyz_m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;n_xyz_m1.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1455, __pyx_L1_error)</span>}
          __pyx_t_8 = __pyx_v_j;
          __pyx_t_7 = -1;
          if (__pyx_t_8 &lt; 0) {
            __pyx_t_8 += __pyx_v_self-&gt;n_xyz_m1.shape[0];
            if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;n_xyz_m1.shape[0])) __pyx_t_7 = 0;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 1455, __pyx_L1_error)</span>
          }
          if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1455, __pyx_L1_error)</span>}
          __pyx_t_6 = __pyx_v_k;
          __pyx_t_9 = __pyx_v_j;
          __pyx_t_7 = -1;
          if (__pyx_t_6 &lt; 0) {
            __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
            if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_7 = 0;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_7 = 1;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 1455, __pyx_L1_error)</span>
          }
          *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;n_xyz_m1.data + __pyx_t_8 * __pyx_v_self-&gt;n_xyz_m1.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1456</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1457</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-7 '>        /*else*/ {
          if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>}
          __pyx_t_8 = __pyx_v_k;
          __pyx_t_9 = __pyx_v_j;
          __pyx_t_7 = -1;
          if (__pyx_t_8 &lt; 0) {
            __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
            if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_7 = 0;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_7 = 1;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>
          }
          *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_v_ind;
        }
        __pyx_L10:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1459</span>:                     <span class="c"># Get weight in the lower bin index</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1460</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_k;
        __pyx_t_9 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1460, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_9)) )) = (1.0 - ((__pyx_t_12 / __pyx_t_11) - __pyx_v_ind));
      }
    }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1461</span>:                         <span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>        if (unlikely(!__pyx_v_self-&gt;xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;xyz_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;xyz_with_trial.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;xyz_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>
        }
        __pyx_t_12 = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;xyz_with_trial.strides[0]) )) + __pyx_t_8)) )));
        if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;dxyz.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>
        }
        __pyx_t_11 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_8 * __pyx_v_self-&gt;dxyz.strides[0]) )));
        if (unlikely(__pyx_t_11 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1462</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1463</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1464</span>:             <span class="c"># Get weights and superindices of eight bins containing bead</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1465</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_weight_vector_with_trial</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_weight_vector_with_trial(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1466</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_index_vector_with_trial</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_index_vector_with_trial(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">1467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1468</span>:             <span class="c"># Distribute weights into bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1469</span>:             <span class="c"># k indicates current (0) or trial (1) configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1470</span>:             <span class="c"># l indicates for which of eight bins density is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1471</span>:             <span class="c"># m indicates polymer (0) or which protein (1 to n_binders)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1472</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_5 = 0; __pyx_t_5 &lt; 2; __pyx_t_5+=1) {
      __pyx_v_k = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1473</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_14 = 0; __pyx_t_14 &lt; 8; __pyx_t_14+=1) {
        __pyx_v_l = __pyx_t_14;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1474</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_8 = 0;
        __pyx_t_6 = __pyx_v_l;
        __pyx_t_7 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_poly-&gt;densities_temp.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_poly-&gt;densities_temp.shape[2];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 2;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_8 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_6)) )) = __pyx_t_11;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1475</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">/</span></pre>
<pre class='cython code score-27 '>        if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1475, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_8 = __pyx_v_l;
        __pyx_t_7 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1475, __pyx_L1_error)</span>
        }
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_8)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1475, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
        __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_15); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1475, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1476</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]]</span></pre>
<pre class='cython code score-17 '>        if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
          <span class='error_goto'>__PYX_ERR(0, 1476, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1476, __pyx_L1_error)</span>}
        __pyx_t_8 = __pyx_v_k;
        __pyx_t_9 = __pyx_v_l;
        __pyx_t_7 = -1;
        if (__pyx_t_8 &lt; 0) {
          __pyx_t_8 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
          if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1476, __pyx_L1_error)</span>
        }
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1476, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1476, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1477</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1478</span>:                     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
        __pyx_t_18 = __pyx_t_17;
        for (__pyx_t_19 = 1; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
          __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-0">&#xA0;<span class="">1479</span>:                         <span class="c"># Current Configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1480</span>:                         <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_20 = ((__pyx_v_k == 0) != 0);
          if (!__pyx_t_20) {
          } else {
            __pyx_t_13 = __pyx_t_20;
            goto __pyx_L18_bool_binop_done;
          }
          __pyx_t_20 = ((__pyx_v_state_change == 0) != 0);
          __pyx_t_13 = __pyx_t_20;
          __pyx_L18_bool_binop_done:;
          if (__pyx_t_13) {
/* … */
            goto __pyx_L17;
          }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1481</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span><span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1481, __pyx_L1_error)</span>}
            __pyx_t_23 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_m;
            __pyx_t_25 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_23 &lt; 0) {
              __pyx_t_23 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_24 &lt; 0) {
              __pyx_t_24 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_25 &lt; 0) {
              __pyx_t_25 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1481, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_23 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_24 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_25)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_6 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_8 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_9)) ))) * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_21 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_22)) )))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1482</span>:                                 <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1482, __pyx_L1_error)</span>}
            __pyx_t_6 = __pyx_v_k;
            __pyx_t_8 = 0;
            __pyx_t_9 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_6 &lt; 0) {
              __pyx_t_6 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_8 &lt; 0) {
              __pyx_t_8 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1482, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1483</span>:                                 <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>}
            __pyx_t_10 = __pyx_v_i;
            __pyx_t_7 = -1;
            if (__pyx_t_10 &lt; 0) {
              __pyx_t_10 += __pyx_v_inds.shape[0];
              if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>
            }
            __pyx_t_21 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_10 * __pyx_v_inds.strides[0]) )));
            __pyx_t_22 = (__pyx_v_m - 1);
            __pyx_t_7 = -1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;states.shape[0];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_22 &lt; 0) {
              __pyx_t_22 += __pyx_v_poly-&gt;states.shape[1];
              if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_7 = 1;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1484</span>:                         <span class="c"># Trial Configuration of State Change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1485</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1486</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span><span class="w">\</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>}
            __pyx_t_25 = __pyx_v_k;
            __pyx_t_24 = __pyx_v_m;
            __pyx_t_23 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_25 &lt; 0) {
              __pyx_t_25 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_24 &lt; 0) {
              __pyx_t_24 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_23 &lt; 0) {
              __pyx_t_23 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>
            }
            *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_25 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_24 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_23)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_10 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_22 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_21)) ))) * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states_trial.data + __pyx_t_8 * __pyx_v_poly-&gt;states_trial.strides[0]) )) + __pyx_t_6)) )))));
          }
          __pyx_L17:;
        }
      }
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1487</span>:                                 <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-7 '>          /*else*/ {
            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>}
            __pyx_t_10 = __pyx_v_k;
            __pyx_t_22 = 0;
            __pyx_t_21 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_10 &lt; 0) {
              __pyx_t_10 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_22 &lt; 0) {
              __pyx_t_22 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1488</span>:                                 <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>            if (unlikely(!__pyx_v_poly-&gt;states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>}
            __pyx_t_9 = __pyx_v_i;
            __pyx_t_7 = -1;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_inds.shape[0];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>
            }
            __pyx_t_8 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_9 * __pyx_v_inds.strides[0]) )));
            __pyx_t_6 = (__pyx_v_m - 1);
            __pyx_t_7 = -1;
            if (__pyx_t_8 &lt; 0) {
              __pyx_t_8 += __pyx_v_poly-&gt;states_trial.shape[0];
              if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;states_trial.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_6 &lt; 0) {
              __pyx_t_6 += __pyx_v_poly-&gt;states_trial.shape[1];
              if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_poly-&gt;states_trial.shape[1])) __pyx_t_7 = 1;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>
            }
</pre><pre class="cython line score-0">&#xA0;<span class="">1489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1490</span>:             <span class="c"># Combine repeating elements, stored in poly.density_trial</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1491</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_5 = 0; __pyx_t_5 &lt; 2; __pyx_t_5+=1) {
      __pyx_v_k = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">1492</span>:                 <span class="c"># Subtract if current configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:                 <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = ((__pyx_v_k == 0) != 0);
      if (__pyx_t_13) {
/* … */
        goto __pyx_L22;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:                     <span class="n">prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span></pre>
<pre class='cython code score-0 '>        __pyx_v_prefactor = -1.;
</pre><pre class="cython line score-0">&#xA0;<span class="">1495</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1496</span>:                     <span class="n">prefactor</span> <span class="o">=</span> <span class="mf">1.</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_prefactor = 1.;
      }
      __pyx_L22:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1498</span>:                 <span class="c"># Accumulate densities</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1499</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_14 = 0; __pyx_t_14 &lt; 8; __pyx_t_14+=1) {
        __pyx_v_l = __pyx_t_14;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="ow">in</span> <span class="n">bins_found</span><span class="p">:</span></pre>
<pre class='cython code score-12 '>        if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>}
        __pyx_t_9 = __pyx_v_k;
        __pyx_t_6 = __pyx_v_l;
        __pyx_t_7 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_6 &lt; 0) {
          __pyx_t_6 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
          if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>
        }
        __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_6)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PySet_ContainsTF</span>(__pyx_t_15, __pyx_v_bins_found, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        __pyx_t_20 = (__pyx_t_13 != 0);
        if (__pyx_t_20) {
/* … */
          goto __pyx_L25;
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1501</span>:                         <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
          __pyx_t_18 = __pyx_t_17;
          for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1502</span>:                             <span class="n">temp</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1502, __pyx_L1_error)</span>}
            __pyx_t_6 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_m;
            __pyx_t_8 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_6 &lt; 0) {
              __pyx_t_6 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_8 &lt; 0) {
              __pyx_t_8 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1502, __pyx_L1_error)</span>
            }
            __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_prefactor * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_6 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_8)) )))));<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_temp, __pyx_t_15);
            __pyx_t_15 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1503</span>:                             <span class="c"># Fix rounding error</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1504</span>:                             <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1E-18</span><span class="p">:</span></pre>
<pre class='cython code score-28 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_16, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1504, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_16, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1504, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = NULL;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
              __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
              if (likely(__pyx_t_16)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
              }
            }
            __pyx_t_15 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_16, __pyx_v_temp) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_temp);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            if (unlikely(!__pyx_t_15)) <span class='error_goto'>__PYX_ERR(0, 1504, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_15, __pyx_float_1Eneg_18, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1504, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_20 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1504, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            if (__pyx_t_20) {
/* … */
            }
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1505</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span></pre>
<pre class='cython code score-5 '>              if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>}
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1506</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="n">m</span></pre>
<pre class='cython code score-9 '>              if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L1_error)</span>}
              __pyx_t_8 = __pyx_v_k;
              __pyx_t_9 = __pyx_v_l;
              __pyx_t_7 = -1;
              if (__pyx_t_8 &lt; 0) {
                __pyx_t_8 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
                if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_9 &lt; 0) {
                __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
                if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L1_error)</span>
              }
              __pyx_t_6 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) )));
              __pyx_t_21 = __pyx_v_m;
              __pyx_t_7 = -1;
              if (__pyx_t_6 &lt; 0) {
                __pyx_t_6 += __pyx_v_self-&gt;density_trial.shape[0];
                if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_21 &lt; 0) {
                __pyx_t_21 += __pyx_v_self-&gt;density_trial.shape[1];
                if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
              }
              *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_6 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_21)) )) += __pyx_t_11;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1507</span>:                                 <span class="p">]</span> <span class="o">+=</span> <span class="n">temp</span></pre>
<pre class='cython code score-10 '>              __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_temp); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1507, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1508</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1509</span>:                         <span class="n">bins_found</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">])</span></pre>
<pre class='cython code score-15 '>        /*else*/ {
          if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>}
          __pyx_t_9 = __pyx_v_k;
          __pyx_t_8 = __pyx_v_l;
          __pyx_t_7 = -1;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
          if (__pyx_t_8 &lt; 0) {
            __pyx_t_8 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
            if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
          } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
          if (unlikely(__pyx_t_7 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
            <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_8)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_26 = <span class='py_c_api'>PySet_Add</span>(__pyx_v_bins_found, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_26 == ((int)-1))) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1510</span>:                         <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_poly-&gt;n_binders_p1;
          __pyx_t_18 = __pyx_t_17;
          for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_m = __pyx_t_19;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1511</span>:                             <span class="n">temp</span> <span class="o">=</span> <span class="n">prefactor</span> <span class="o">*</span> <span class="n">poly</span><span class="o">.</span><span class="n">densities_temp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>            if (unlikely(!__pyx_v_poly-&gt;densities_temp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1511, __pyx_L1_error)</span>}
            __pyx_t_8 = __pyx_v_k;
            __pyx_t_9 = __pyx_v_m;
            __pyx_t_21 = __pyx_v_l;
            __pyx_t_7 = -1;
            if (__pyx_t_8 &lt; 0) {
              __pyx_t_8 += __pyx_v_poly-&gt;densities_temp.shape[0];
              if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
            } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_poly-&gt;densities_temp.shape[0])) __pyx_t_7 = 0;
            if (__pyx_t_9 &lt; 0) {
              __pyx_t_9 += __pyx_v_poly-&gt;densities_temp.shape[1];
              if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
            } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;densities_temp.shape[1])) __pyx_t_7 = 1;
            if (__pyx_t_21 &lt; 0) {
              __pyx_t_21 += __pyx_v_poly-&gt;densities_temp.shape[2];
              if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 2;
            } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_poly-&gt;densities_temp.shape[2])) __pyx_t_7 = 2;
            if (unlikely(__pyx_t_7 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
              <span class='error_goto'>__PYX_ERR(0, 1511, __pyx_L1_error)</span>
            }
            __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_prefactor * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_poly-&gt;densities_temp.data + __pyx_t_8 * __pyx_v_poly-&gt;densities_temp.strides[0]) ) + __pyx_t_9 * __pyx_v_poly-&gt;densities_temp.strides[1]) )) + __pyx_t_21)) )))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1511, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_temp, __pyx_t_1);
            __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1512</span>:                             <span class="c"># Fix rounding error</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1513</span>:                             <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1E-18</span><span class="p">:</span></pre>
<pre class='cython code score-28 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
            __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            __pyx_t_15 = NULL;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
              __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
              if (likely(__pyx_t_15)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
              }
            }
            __pyx_t_1 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_16, __pyx_t_15, __pyx_v_temp) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_16, __pyx_v_temp);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1513, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_float_1Eneg_18, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_16); if (unlikely(__pyx_t_20 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1513, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            if (__pyx_t_20) {
/* … */
              goto __pyx_L31;
            }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1514</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span></pre>
<pre class='cython code score-5 '>              if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1514, __pyx_L1_error)</span>}
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1515</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="n">m</span></pre>
<pre class='cython code score-9 '>              if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1515, __pyx_L1_error)</span>}
              __pyx_t_21 = __pyx_v_k;
              __pyx_t_9 = __pyx_v_l;
              __pyx_t_7 = -1;
              if (__pyx_t_21 &lt; 0) {
                __pyx_t_21 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
                if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_9 &lt; 0) {
                __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
                if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1515, __pyx_L1_error)</span>
              }
              __pyx_t_8 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_21 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_9)) )));
              __pyx_t_6 = __pyx_v_m;
              __pyx_t_7 = -1;
              if (__pyx_t_8 &lt; 0) {
                __pyx_t_8 += __pyx_v_self-&gt;density_trial.shape[0];
                if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_6 &lt; 0) {
                __pyx_t_6 += __pyx_v_self-&gt;density_trial.shape[1];
                if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1514, __pyx_L1_error)</span>
              }
              *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_8 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_6)) )) = __pyx_t_11;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1516</span>:                                 <span class="p">]</span> <span class="o">=</span> <span class="n">temp</span></pre>
<pre class='cython code score-10 '>              __pyx_t_11 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_temp); if (unlikely((__pyx_t_11 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1516, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1517</span>:                             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1518</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span></pre>
<pre class='cython code score-5 '>              if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1518, __pyx_L1_error)</span>}
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1519</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">],</span> <span class="n">m</span></pre>
<pre class='cython code score-9 '>              if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1519, __pyx_L1_error)</span>}
              __pyx_t_9 = __pyx_v_k;
              __pyx_t_21 = __pyx_v_l;
              __pyx_t_7 = -1;
              if (__pyx_t_9 &lt; 0) {
                __pyx_t_9 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
                if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_21 &lt; 0) {
                __pyx_t_21 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
                if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1519, __pyx_L1_error)</span>
              }
              __pyx_t_6 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_21)) )));
              __pyx_t_8 = __pyx_v_m;
              __pyx_t_7 = -1;
              if (__pyx_t_6 &lt; 0) {
                __pyx_t_6 += __pyx_v_self-&gt;density_trial.shape[0];
                if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_7 = 0;
              } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_7 = 0;
              if (__pyx_t_8 &lt; 0) {
                __pyx_t_8 += __pyx_v_self-&gt;density_trial.shape[1];
                if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_7 = 1;
              } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_7 = 1;
              if (unlikely(__pyx_t_7 != -1)) {
                <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
                <span class='error_goto'>__PYX_ERR(0, 1518, __pyx_L1_error)</span>
              }
              *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_6 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_8)) )) = 0.0;
            }
            __pyx_L31:;
          }
        }
        __pyx_L25:;
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1520</span>:                                 <span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
</pre><pre class="cython line score-0">&#xA0;<span class="">1521</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1522</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bins_found</span><span class="p">))</span></pre>
<pre class='cython code score-28 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_bins_found);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_27 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_27 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    if (likely(__pyx_t_27)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_27);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
    }
  }
  __pyx_t_16 = (__pyx_t_27) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_27, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_27); __pyx_t_27 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_16)) <span class='error_goto'>__PYX_ERR(0, 1522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_16, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  __pyx_r = __pyx_t_28;
  __pyx_t_28.memview = NULL;
  __pyx_t_28.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1523</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1524</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_generate_weight_vector_with_trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_19UniformDensityField__generate_weight_vector_with_trial(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_generate_weight_vector_with_trial", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_generate_weight_vector_with_trial", __pyx_f[0], 1524, 0, <span class='error_goto'>__PYX_ERR(0, 1524, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField._generate_weight_vector_with_trial", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1525</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate weight array for eight bins containing the bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1526</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1527</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1528</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1529</span>: <span class="sd">        The weight vector contains the fraction of a point&#39;s weight distributed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1530</span>: <span class="sd">        to each of the eight voxels containing the point. To determine weights,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1531</span>: <span class="sd">        we calculating distances between a point and the centers of the two</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1532</span>: <span class="sd">        nearest voxels containing it in each the x, y, and z directions. The</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1533</span>: <span class="sd">        weight is determined from these distances using the lever rule.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1534</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1535</span>: <span class="sd">        The values stored in `self.weight_xyz_with_trial` indicate the weights</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1536</span>: <span class="sd">        in the *lower* voxels contianing the point, in each the x, y, and z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1537</span>: <span class="sd">        directions. The first dimension of `self.weight_xyz_with_trial`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1538</span>: <span class="sd">        indicates whether we are working with a current configuration (row 0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1539</span>: <span class="sd">        or trial configuration (row 1).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1540</span>: <span class="sd">         </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1541</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1542</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1543</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 2; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1544</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1545</span>:             <span class="c"># lower_x, lower_y, lower_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1546</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1546
 * 
 *             # lower_x, lower_y, lower_z
 *             self.wt_vec_with_trial[i, 0] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 self.weight_xyz_with_trial[i, 0] *
 *                 self.weight_xyz_with_trial[i, 1] *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1546, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1546, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_10)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_3)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_6)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_8)) ))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1547</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1547, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1547, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1548</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1548, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1548, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1549</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1549, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1549, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1550</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>:             <span class="c"># upper_x, lower_y, lower_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1553</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1553
 * 
 *             # upper_x, lower_y, lower_z
 *             self.wt_vec_with_trial[i, 1] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 (1-self.weight_xyz_with_trial[i, 0]) *
 *                 self.weight_xyz_with_trial[i, 1] *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_9)) )) = (((1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_5)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_2)) ))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1554</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1554, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1554, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1555</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1555, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1555, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1556</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1556, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1556, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1557</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>:             <span class="c"># lower_x, upper_y, lower_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1560</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1560
 * 
 *             # lower_x, upper_y, lower_z
 *             self.wt_vec_with_trial[i, 2] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 self.weight_xyz_with_trial[i, 0] *
 *                 (1-self.weight_xyz_with_trial[i, 1]) *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1560, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1560, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_10)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_3)) ))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_6)) ))))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_8)) ))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1561</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1561, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1561, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1562</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1562, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1562, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1563</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1563, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1563, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1564</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>:             <span class="c"># upper_x, upper_y, lower_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1567</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1567
 * 
 *             # upper_x, upper_y, lower_z
 *             self.wt_vec_with_trial[i, 3] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 (1-self.weight_xyz_with_trial[i, 0]) *
 *                 (1-self.weight_xyz_with_trial[i, 1]) *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1567, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = 3;
    __pyx_t_4 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1567, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_9)) )) = (((1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_5)) ))))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_2)) ))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1568</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1568, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1568, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1569</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1569, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1569, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1570</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1570, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1570, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1571</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1572</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1573</span>:             <span class="c"># lower_x, lower_y, upper_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1574</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1574
 * 
 *             # lower_x, lower_y, upper_z
 *             self.wt_vec_with_trial[i, 4] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 self.weight_xyz_with_trial[i, 0] *
 *                 self.weight_xyz_with_trial[i, 1] *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1574, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 4;
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1574, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_10)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_3)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_6)) )))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_8)) )))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1575</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1575, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1575, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1576</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1576, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1576, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1577</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1578</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1580</span>:             <span class="c"># upper_x, lower_y, upper_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1581</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1581
 * 
 *             # upper_x, lower_y, upper_z
 *             self.wt_vec_with_trial[i, 5] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 (1-self.weight_xyz_with_trial[i, 0]) *
 *                 self.weight_xyz_with_trial[i, 1] *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = 5;
    __pyx_t_4 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_9)) )) = (((1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_5)) )))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_2)) )))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1583</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1583, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1583, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1584</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1584, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1584, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1585</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1587</span>:             <span class="c"># lower_x, upper_y, upper_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1588
 * 
 *             # lower_x, upper_y, upper_z
 *             self.wt_vec_with_trial[i, 6] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 self.weight_xyz_with_trial[i, 0] *
 *                 (1-self.weight_xyz_with_trial[i, 1]) *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 6;
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_9 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_10)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_3)) ))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_6)) ))))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_8)) )))));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1589</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1590</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1590, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1590, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1591</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1591, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1591, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1592</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1593</span>:             <span class="c"># upper_x, upper_y, upper_z</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1594</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>
    /* "chromo/fields.pyx":1594
 *             )
 *             # upper_x, upper_y, upper_z
 *             self.wt_vec_with_trial[i, 7] = (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 (1-self.weight_xyz_with_trial[i, 0]) *
 *                 (1-self.weight_xyz_with_trial[i, 1]) *
 */
    if (unlikely(!__pyx_v_self-&gt;wt_vec_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1594, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = 7;
    __pyx_t_4 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;wt_vec_with_trial.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;wt_vec_with_trial.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;wt_vec_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1594, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec_with_trial.data + __pyx_t_10 * __pyx_v_self-&gt;wt_vec_with_trial.strides[0]) )) + __pyx_t_9)) )) = (((1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_7)) )))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_5)) ))))) * (1.0 - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;weight_xyz_with_trial.strides[0]) )) + __pyx_t_2)) )))));
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1595</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1596</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1597</span>:                 <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;weight_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1597, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;weight_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;weight_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1597, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1598</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1599</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1600</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_generate_index_vector_with_trial</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_19UniformDensityField__generate_index_vector_with_trial(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  int __pyx_v_i;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_generate_index_vector_with_trial", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_generate_index_vector_with_trial", __pyx_f[0], 1600, 0, <span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField._generate_index_vector_with_trial", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1601</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate vector of eight superindices containing a bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1602</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1603</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1604</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1605</span>: <span class="sd">        This is a cleaner form of the method, but is ~70% slower:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1606</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1607</span>: <span class="sd">        for i in range(2):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>: <span class="sd">            for j in range(8):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>: <span class="sd">                ind_x = ((j % 2) + index_xyz[i, 0]) % self.nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1610</span>: <span class="sd">                ind_y = (((int(floor(j/2))) % 2) + index_xyz[i, 1]) % self.ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1611</span>: <span class="sd">                ind_z = (((int(floor(j/4))) % 2) + index_xyz[i, 2]) % self.nz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1612</span>: <span class="sd">                self.nbr_inds_with_trial[i, j] = inds_to_super_ind(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>: <span class="sd">                    ind_x, ind_y, ind_z, self.nx, self.ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1614</span>: <span class="sd">                )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1615</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1616</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1617</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 2; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1618</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1619</span>:             <span class="c"># lower_x, lower_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1620</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_3)) )));
    __pyx_t_10 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_6)) )));
    __pyx_t_11 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_8)) )));
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>}
    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_12 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_13)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_9 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_11)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1621</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1621, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1621, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1622</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1623</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1623, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1623, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1624</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1625</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1626</span>:             <span class="c"># upper_x, lower_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1627</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1627, __pyx_L1_error)</span>}
/* … */
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) ))));
    __pyx_t_10 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_5)) )));
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_2)) )));
    __pyx_t_4 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1627, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1627, __pyx_L1_error)</span>}
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_12 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1627, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_13 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_12)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_11 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_9)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1628</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1628, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1628, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1629</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1630</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1630, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1630, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1631</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1632</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1633</span>:             <span class="c"># lower_x, upper_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1634</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_3)) )));
    __pyx_t_10 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_6)) ))));
    __pyx_t_11 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_8)) )));
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>}
    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_12 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_13)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_9 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_11)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1635</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1635, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1635, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1636</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1636, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1636, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1637</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1638</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1640</span>:             <span class="c"># upper_x, upper_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1641</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1641, __pyx_L1_error)</span>}
/* … */
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) ))));
    __pyx_t_10 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_5)) ))));
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_2)) )));
    __pyx_t_4 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1641, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1641, __pyx_L1_error)</span>}
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_12 = 3;
    __pyx_t_4 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1641, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_13 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_12)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_11 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_9)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1642</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1642, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1642, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1643</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1643, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1643, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1644</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1644, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1644, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1645</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1646</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1647</span>:             <span class="c"># lower_x, lower_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1648</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1648, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_3)) )));
    __pyx_t_10 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_6)) )));
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_8)) ))));
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1648, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1648, __pyx_L1_error)</span>}
    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 4;
    __pyx_t_4 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1648, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_12 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_13)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_9 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_11)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1649</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1650</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1650, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1650, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1651</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1651, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1651, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1652</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1653</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1654</span>:             <span class="c"># upper_x, lower_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1655</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>}
/* … */
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) ))));
    __pyx_t_10 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_5)) )));
    __pyx_t_9 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_2)) ))));
    __pyx_t_4 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>}
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_12 = 5;
    __pyx_t_4 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_13 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_12)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_11 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_9)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1656</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1656, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1656, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1657</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1657, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1657, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1658</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1658, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1658, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1659</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1661</span>:             <span class="c"># lower_x, upper_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1662</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9 = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_2 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_3)) )));
    __pyx_t_10 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_5 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_6)) ))));
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_7 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_8)) ))));
    __pyx_t_4 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>}
    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 6;
    __pyx_t_4 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_12 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_13)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_9 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_11)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1663</span>:                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1663, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1663, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1664</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1664, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_6 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1664, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1665</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1665, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_8 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1665, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1666</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1667</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1668</span>:             <span class="c"># upper_x, upper_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1669</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>    if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1669, __pyx_L1_error)</span>}
/* … */
    __pyx_t_11 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_8 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_7)) ))));
    __pyx_t_10 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_6 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_5)) ))));
    __pyx_t_9 = (1 + (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz_with_trial.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz_with_trial.strides[0]) )) + __pyx_t_2)) ))));
    __pyx_t_4 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_4 = 1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_4 = 2;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_4 = 2;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1669, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;nbr_inds_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1669, __pyx_L1_error)</span>}
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_12 = 7;
    __pyx_t_4 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;nbr_inds_with_trial.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1669, __pyx_L1_error)</span>
    }
    *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds_with_trial.data + __pyx_t_13 * __pyx_v_self-&gt;nbr_inds_with_trial.strides[0]) )) + __pyx_t_12)) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_11 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_10 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_9)) )));
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1670</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_7 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1671</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1671, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_4 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1671, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1672</span>:                 <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz_with_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;index_xyz_with_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>}
    __pyx_t_3 = __pyx_v_i;
    __pyx_t_2 = 2;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_self-&gt;index_xyz_with_trial.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[0])) __pyx_t_4 = 0;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;index_xyz_with_trial.shape[1];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_4 = 1;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;index_xyz_with_trial.shape[1])) __pyx_t_4 = 1;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1672, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1673</span>:             <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1674</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">get_dE_binders_and_beads</span><span class="p">(</span></pre>
<pre class='cython code score-13 '>static double __pyx_f_6chromo_6fields_19UniformDensityField_get_dE_binders_and_beads(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, __Pyx_memviewslice __pyx_v_bin_inds, int __pyx_v_state_change) {
  long __pyx_v_n_bins;
  long __pyx_v_i;
  long __pyx_v_j;
  double __pyx_v_tot_density_change;
  double __pyx_v_dE_binders_beads;
  __Pyx_memviewslice __pyx_v_delta_rho_squared = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_delta_rho_interact_squared = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_binder_info = 0;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_n_double_bound = NULL;
  PyObject *__pyx_v_next_binder_info = NULL;
  PyObject *__pyx_v_tot_density_change_interact = NULL;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dE_binders_and_beads", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_dE_binders_and_beads", __pyx_f[0], 1675, 0, <span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_45);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.get_dE_binders_and_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_delta_rho_squared, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_delta_rho_interact_squared, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_double_bound);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_next_binder_info);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tot_density_change_interact);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1676</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1677</span>:         <span class="nb">long</span><span class="p">[:]</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1678</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1679</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the change in energy associated with reconfiguration of binders.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1680</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1681</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1682</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1683</span>: <span class="sd">        The scale of the oligomerization energy is constant for each reader</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1684</span>: <span class="sd">        protein. While it does not affect runtime too much, this method can be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1685</span>: <span class="sd">        optimized by precomputing the scale.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1686</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1687</span>: <span class="sd">        TODO: Remove enumerate call -- that carries ogverhead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1689</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1690</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1691</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1692</span>: <span class="sd">            Polymer object undergoing transformation in field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>: <span class="sd">        inds : array_like (N, ) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>: <span class="sd">            Indices of N beads involved in the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1696</span>: <span class="sd">            Number of bead indices affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1697</span>: <span class="sd">        bin_inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1698</span>: <span class="sd">            Bin indices affected by the MC move either through loss or addition</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1699</span>: <span class="sd">            of density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>: <span class="sd">        state_change : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1701</span>: <span class="sd">            Indicator for whether the MC move involved a change in binding state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1702</span>: <span class="sd">            (1) or not (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1705</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1706</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1707</span>: <span class="sd">            Change in energy associated with reconfiguration of binders based</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1708</span>: <span class="sd">            on binder interaction energies, as well as nonspecific bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1709</span>: <span class="sd">            interactions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1710</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1711</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">n_bins</span><span class="p">,</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">kn_double_bound</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1712</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">tot_density_change</span><span class="p">,</span> <span class="nf">dE_binders_beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1713</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">delta_rho_squared</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1714</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">delta_rho_interact_squared</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1715</span>:         <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">binder_info</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1716</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1717</span>:         <span class="c"># Change in squared density for each binder</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1718</span>:         <span class="n">n_bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bin_inds</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bin_inds); 
  __pyx_v_n_bins = __pyx_t_1;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1719</span>:         <span class="n">delta_rho_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1719, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_delta_rho_squared = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1720</span>:         <span class="n">delta_rho_interact_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_7);
  __pyx_t_7 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1720, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1720, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_delta_rho_interact_squared = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1721</span>:             <span class="p">(</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span></pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_3);
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1721, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1722</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1723</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n_bins;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1724</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_poly-&gt;num_binders;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">1725</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1726</span>:                 <span class="n">delta_rho_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-2 '>      __pyx_t_25 = __pyx_v_i;
      __pyx_t_26 = __pyx_v_j;
      __pyx_t_16 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_delta_rho_squared.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_delta_rho_squared.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_delta_rho_squared.shape[1];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_delta_rho_squared.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1726, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_delta_rho_squared.data + __pyx_t_25 * __pyx_v_delta_rho_squared.strides[0]) )) + __pyx_t_26)) )) = (pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_17 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_18)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_20 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_21)) )))), 2.0) - pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_23 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_24)) ))), 2.0));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1727</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-9 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1727, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_bin_inds.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1727, __pyx_L1_error)</span>
      }
      __pyx_t_17 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_15 * __pyx_v_bin_inds.strides[0]) )));
      __pyx_t_18 = (__pyx_v_j + 1);
      __pyx_t_16 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1727, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1728</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>      if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L1_error)</span>}
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_bin_inds.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L1_error)</span>
      }
      __pyx_t_20 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_19 * __pyx_v_bin_inds.strides[0]) )));
      __pyx_t_21 = (__pyx_v_j + 1);
      __pyx_t_16 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;density_trial.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_self-&gt;density_trial.shape[1];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1729</span>:                 <span class="p">)</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-9 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>}
      __pyx_t_22 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_bin_inds.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>
      }
      __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_22 * __pyx_v_bin_inds.strides[0]) )));
      __pyx_t_24 = (__pyx_v_j + 1);
      __pyx_t_16 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1730</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1731</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_4 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_27 = 0;
        __pyx_t_28 = NULL;
      } else {
        __pyx_t_27 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_28 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_28)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
            if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1731, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1731, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1731, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_28(__pyx_t_4);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 1731, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_7);
        __pyx_t_7 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1732</span>:                     <span class="n">delta_rho_interact_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span></pre>
<pre class='cython code score-9 '>        __pyx_t_39 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_39 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1732, __pyx_L1_error)</span>
        __pyx_t_40 = __pyx_v_i;
        __pyx_t_41 = __pyx_v_j;
        __pyx_t_42 = __pyx_t_39;
        __pyx_t_16 = -1;
        if (__pyx_t_40 &lt; 0) {
          __pyx_t_40 += __pyx_v_delta_rho_interact_squared.shape[0];
          if (unlikely(__pyx_t_40 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_40 &gt;= __pyx_v_delta_rho_interact_squared.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_41 &lt; 0) {
          __pyx_t_41 += __pyx_v_delta_rho_interact_squared.shape[1];
          if (unlikely(__pyx_t_41 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_41 &gt;= __pyx_v_delta_rho_interact_squared.shape[1])) __pyx_t_16 = 1;
        if (__pyx_t_42 &lt; 0) {
          __pyx_t_42 += __pyx_v_delta_rho_interact_squared.shape[2];
          if (unlikely(__pyx_t_42 &lt; 0)) __pyx_t_16 = 2;
        } else if (unlikely(__pyx_t_42 &gt;= __pyx_v_delta_rho_interact_squared.shape[2])) __pyx_t_16 = 2;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1732, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_rho_interact_squared.data + __pyx_t_40 * __pyx_v_delta_rho_interact_squared.strides[0]) ) + __pyx_t_41 * __pyx_v_delta_rho_interact_squared.strides[1]) )) + __pyx_t_42)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_24 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_23)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_21 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_20)) )))) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_18 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_17)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_25 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_31)) ))))) - ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_33 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_34)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_37 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_38)) )))));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1733</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-9 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1733, __pyx_L1_error)</span>}
        __pyx_t_22 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1733, __pyx_L1_error)</span>
        }
        __pyx_t_24 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_22 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_23 = (__pyx_v_j + 1);
        __pyx_t_16 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1733, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1734</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>        if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1734, __pyx_L1_error)</span>}
        __pyx_t_19 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1734, __pyx_L1_error)</span>
        }
        __pyx_t_21 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_19 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_20 = (__pyx_v_j + 1);
        __pyx_t_16 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_self-&gt;density_trial.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_v_self-&gt;density_trial.shape[1];
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1734, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1735</span>:                     <span class="p">)</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1736</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span></pre>
<pre class='cython code score-19 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1736, __pyx_L1_error)</span>}
        __pyx_t_15 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1736, __pyx_L1_error)</span>
        }
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1736, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_29 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_7); if (unlikely((__pyx_t_29 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1736, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_18 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_15 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_17 = __pyx_t_29;
        __pyx_t_16 = -1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1736, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1737</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>
        /* "chromo/fields.pyx":1737
 *                     ) * (
 *                         self.density[bin_inds[i], k+1] +
 *                         self.density_trial[bin_inds[i], k+1]             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                     )) - (
 *                         self.density[bin_inds[i], j+1] *
 */
        if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1737, __pyx_L1_error)</span>}
        __pyx_t_26 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1737, __pyx_L1_error)</span>
        }
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1737, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_7); if (unlikely((__pyx_t_30 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1737, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_26 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_31 = __pyx_t_30;
        __pyx_t_16 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_self-&gt;density_trial.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_31 &lt; 0) {
          __pyx_t_31 += __pyx_v_self-&gt;density_trial.shape[1];
          if (unlikely(__pyx_t_31 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_31 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1737, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1738</span>:                     <span class="p">))</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1739</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-9 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>}
        __pyx_t_32 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_32 &lt; 0) {
          __pyx_t_32 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_32 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_32 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>
        }
        __pyx_t_33 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_32 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_34 = (__pyx_v_j + 1);
        __pyx_t_16 = -1;
        if (__pyx_t_33 &lt; 0) {
          __pyx_t_33 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_33 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_33 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_34 &lt; 0) {
          __pyx_t_34 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_34 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_34 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1740</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>}
        __pyx_t_35 = __pyx_v_i;
        __pyx_t_16 = -1;
        if (__pyx_t_35 &lt; 0) {
          __pyx_t_35 += __pyx_v_bin_inds.shape[0];
          if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_16 = 0;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>
        }
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1740, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_36 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_7); if (unlikely((__pyx_t_36 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_37 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_35 * __pyx_v_bin_inds.strides[0]) )));
        __pyx_t_38 = __pyx_t_36;
        __pyx_t_16 = -1;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_38 &lt; 0) {
          __pyx_t_38 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1740, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1741</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1742</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1743</span>:         <span class="c"># Fix rounding error</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1744</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n_bins;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1745</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_poly-&gt;num_binders;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1746</span>:                 <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta_rho_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1E-18</span><span class="p">:</span></pre>
<pre class='cython code score-36 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_35 = __pyx_v_i;
      __pyx_t_38 = __pyx_v_j;
      __pyx_t_16 = -1;
      if (__pyx_t_35 &lt; 0) {
        __pyx_t_35 += __pyx_v_delta_rho_squared.shape[0];
        if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_squared.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_38 &lt; 0) {
        __pyx_t_38 += __pyx_v_delta_rho_squared.shape[1];
        if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_squared.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1746, __pyx_L1_error)</span>
      }
      __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_delta_rho_squared.data + __pyx_t_35 * __pyx_v_delta_rho_squared.strides[0]) )) + __pyx_t_38)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_5 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_float_1Eneg_18, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_43 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_43 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1746, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_43) {
/* … */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1747</span>:                     <span class="n">delta_rho_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>        __pyx_t_38 = __pyx_v_i;
        __pyx_t_35 = __pyx_v_j;
        __pyx_t_16 = -1;
        if (__pyx_t_38 &lt; 0) {
          __pyx_t_38 += __pyx_v_delta_rho_squared.shape[0];
          if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_squared.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_35 &lt; 0) {
          __pyx_t_35 += __pyx_v_delta_rho_squared.shape[1];
          if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_squared.shape[1])) __pyx_t_16 = 1;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1747, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_delta_rho_squared.data + __pyx_t_38 * __pyx_v_delta_rho_squared.strides[0]) )) + __pyx_t_35)) )) = 0.0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1748</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        __pyx_t_3 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_27 = 0;
        __pyx_t_28 = NULL;
      } else {
        __pyx_t_27 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_28 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_28)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
            if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
            #else
            __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          } else {
            if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
            #else
            __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_28(__pyx_t_3);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_4);
        __pyx_t_4 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
  }
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1749</span>:                     <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta_rho_interact_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1E-18</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_36 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_36 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
        __pyx_t_35 = __pyx_v_i;
        __pyx_t_38 = __pyx_v_j;
        __pyx_t_37 = __pyx_t_36;
        __pyx_t_16 = -1;
        if (__pyx_t_35 &lt; 0) {
          __pyx_t_35 += __pyx_v_delta_rho_interact_squared.shape[0];
          if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_interact_squared.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_38 &lt; 0) {
          __pyx_t_38 += __pyx_v_delta_rho_interact_squared.shape[1];
          if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_interact_squared.shape[1])) __pyx_t_16 = 1;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_delta_rho_interact_squared.shape[2];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_16 = 2;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_delta_rho_interact_squared.shape[2])) __pyx_t_16 = 2;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
        }
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_rho_interact_squared.data + __pyx_t_35 * __pyx_v_delta_rho_interact_squared.strides[0]) ) + __pyx_t_38 * __pyx_v_delta_rho_interact_squared.strides[1]) )) + __pyx_t_37)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_2 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_2)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          }
        }
        __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_float_1Eneg_18, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_43 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_43 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (__pyx_t_43) {
/* … */
        }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1750</span>:                         <span class="n">delta_rho_interact_squared</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-9 '>          __pyx_t_36 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_36 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1750, __pyx_L1_error)</span>
          __pyx_t_37 = __pyx_v_i;
          __pyx_t_38 = __pyx_v_j;
          __pyx_t_35 = __pyx_t_36;
          __pyx_t_16 = -1;
          if (__pyx_t_37 &lt; 0) {
            __pyx_t_37 += __pyx_v_delta_rho_interact_squared.shape[0];
            if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_16 = 0;
          } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_delta_rho_interact_squared.shape[0])) __pyx_t_16 = 0;
          if (__pyx_t_38 &lt; 0) {
            __pyx_t_38 += __pyx_v_delta_rho_interact_squared.shape[1];
            if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
          } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_interact_squared.shape[1])) __pyx_t_16 = 1;
          if (__pyx_t_35 &lt; 0) {
            __pyx_t_35 += __pyx_v_delta_rho_interact_squared.shape[2];
            if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 2;
          } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_interact_squared.shape[2])) __pyx_t_16 = 2;
          if (unlikely(__pyx_t_16 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
            <span class='error_goto'>__PYX_ERR(0, 1750, __pyx_L1_error)</span>
          }
          *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_rho_interact_squared.data + __pyx_t_37 * __pyx_v_delta_rho_interact_squared.strides[0]) ) + __pyx_t_38 * __pyx_v_delta_rho_interact_squared.strides[1]) )) + __pyx_t_35)) )) = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1752</span>:         <span class="c"># Count num. nucleosomes bound by reader proteins at both histone tails</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1753</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count_doubly_bound</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;count_doubly_bound(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 1, __pyx_v_state_change);
</pre><pre class="cython line score-0">&#xA0;<span class="">1754</span>:             <span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">state_change</span><span class="o">=</span><span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1755</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1756</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count_doubly_bound</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;count_doubly_bound(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 0, __pyx_v_state_change);
</pre><pre class="cython line score-0">&#xA0;<span class="">1757</span>:             <span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">state_change</span><span class="o">=</span><span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1758</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1759</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1760</span>:         <span class="n">dE_binders_beads</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE_binders_beads = 0.0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1761</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">binder_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_dict</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>  __pyx_t_9 = 0;
  __pyx_t_3 = __pyx_v_self-&gt;binder_dict; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_27 = 0;
  for (;;) {
    if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1761, __pyx_L1_error)</span>
    #else
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 1761, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder_info, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
    __pyx_v_i = __pyx_t_9;
    __pyx_t_9 = (__pyx_t_9 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1762</span>:             <span class="c"># Calculate total density change</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1763</span>:             <span class="n">tot_density_change</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tot_density_change = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1764</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_n_bins;
    __pyx_t_11 = __pyx_t_10;
    for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1765</span>:                 <span class="n">tot_density_change</span> <span class="o">+=</span> <span class="n">delta_rho_squared</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_35 = __pyx_v_j;
      __pyx_t_38 = __pyx_v_i;
      __pyx_t_16 = -1;
      if (__pyx_t_35 &lt; 0) {
        __pyx_t_35 += __pyx_v_delta_rho_squared.shape[0];
        if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
      } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_squared.shape[0])) __pyx_t_16 = 0;
      if (__pyx_t_38 &lt; 0) {
        __pyx_t_38 += __pyx_v_delta_rho_squared.shape[1];
        if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
      } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_squared.shape[1])) __pyx_t_16 = 1;
      if (unlikely(__pyx_t_16 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
        <span class='error_goto'>__PYX_ERR(0, 1765, __pyx_L1_error)</span>
      }
      __pyx_v_tot_density_change = (__pyx_v_tot_density_change + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_delta_rho_squared.data + __pyx_t_35 * __pyx_v_delta_rho_squared.strides[0]) )) + __pyx_t_38)) ))));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1766</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1767</span>:             <span class="c"># Oligomerization</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1768</span>:             <span class="n">dE_binders_beads</span> <span class="o">+=</span><span class="w">\</span></pre>
<pre class='cython code score-23 '>    __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE_binders_beads);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
    __pyx_t_7 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_44 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_7); if (unlikely((__pyx_t_44 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_dE_binders_beads = __pyx_t_44;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1769</span>:                 <span class="n">binder_info</span><span class="p">[</span><span class="s">&#39;field_energy_prefactor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">tot_density_change</span></pre>
<pre class='cython code score-19 '>    if (unlikely(__pyx_v_binder_info == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_binder_info, __pyx_n_s_field_energy_prefactor);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tot_density_change);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1771</span>:             <span class="c"># Intranucleosome interaction</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1772</span>:             <span class="n">n_double_bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-17 '>    if (unlikely(!__pyx_v_self-&gt;doubly_bound_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>}
    __pyx_t_38 = __pyx_v_i;
    __pyx_t_16 = -1;
    if (__pyx_t_38 &lt; 0) {
      __pyx_t_38 += __pyx_v_self-&gt;doubly_bound_trial.shape[0];
      if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 0;
    } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_self-&gt;doubly_bound_trial.shape[0])) __pyx_t_16 = 0;
    if (unlikely(__pyx_t_16 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
      <span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;doubly_bound.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>}
    __pyx_t_35 = __pyx_v_i;
    __pyx_t_16 = -1;
    if (__pyx_t_35 &lt; 0) {
      __pyx_t_35 += __pyx_v_self-&gt;doubly_bound.shape[0];
      if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
    } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_self-&gt;doubly_bound.shape[0])) __pyx_t_16 = 0;
    if (unlikely(__pyx_t_16 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
      <span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>
    }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound_trial.data + __pyx_t_38 * __pyx_v_self-&gt;doubly_bound_trial.strides[0]) ))) - (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound.data + __pyx_t_35 * __pyx_v_self-&gt;doubly_bound.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_n_double_bound, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1773</span>:             <span class="n">dE_binders_beads</span> <span class="o">+=</span><span class="w">\</span></pre>
<pre class='cython code score-23 '>    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE_binders_beads);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/* … */
    __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_44 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_44 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1773, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_dE_binders_beads = __pyx_t_44;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1774</span>:                 <span class="n">binder_info</span><span class="p">[</span><span class="s">&#39;interaction_energy_intranucleosome&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_double_bound</span></pre>
<pre class='cython code score-13 '>    if (unlikely(__pyx_v_binder_info == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1774, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_binder_info, __pyx_n_s_interaction_energy_intranucleoso);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_n_double_bound);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1775</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1776</span>:         <span class="c"># Cross-talk Interaction</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1777</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">binder_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_dict</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>  __pyx_t_9 = 0;
  __pyx_t_3 = __pyx_v_self-&gt;binder_dict; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_27 = 0;
  for (;;) {
    if (__pyx_t_27 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_27); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_27++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_27); __pyx_t_27++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_2)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder_info, ((PyObject*)__pyx_t_2));
    __pyx_t_2 = 0;
    __pyx_v_i = __pyx_t_9;
    __pyx_t_9 = (__pyx_t_9 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1778</span>:             <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">next_binder_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_dict</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>    __pyx_t_10 = 0;
    __pyx_t_2 = __pyx_v_self-&gt;binder_dict; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_36 = 0;
    for (;;) {
      if (__pyx_t_36 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_36); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_36++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1778, __pyx_L1_error)</span>
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_36); __pyx_t_36++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1778, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_next_binder_info, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_v_j = __pyx_t_10;
      __pyx_t_10 = (__pyx_t_10 + 1);
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1779</span>:                 <span class="n">tot_density_change_interact</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-2 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_tot_density_change_interact, __pyx_int_0);
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1780</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_5 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_30 = 0;
        __pyx_t_28 = NULL;
      } else {
        __pyx_t_30 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_28 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_28)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
            if (__pyx_t_30 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_30); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_30++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1780, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_30); __pyx_t_30++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_30 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_30); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_30++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1780, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_30); __pyx_t_30++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_28(__pyx_t_5);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 1780, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_7);
        __pyx_t_7 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1781</span>:                     <span class="n">tot_density_change_interact</span> <span class="o">+=</span> <span class="n">delta_rho_interact_squared</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>        __pyx_t_29 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_29 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
        __pyx_t_35 = __pyx_t_29;
        __pyx_t_38 = __pyx_v_i;
        __pyx_t_37 = __pyx_v_j;
        __pyx_t_16 = -1;
        if (__pyx_t_35 &lt; 0) {
          __pyx_t_35 += __pyx_v_delta_rho_interact_squared.shape[0];
          if (unlikely(__pyx_t_35 &lt; 0)) __pyx_t_16 = 0;
        } else if (unlikely(__pyx_t_35 &gt;= __pyx_v_delta_rho_interact_squared.shape[0])) __pyx_t_16 = 0;
        if (__pyx_t_38 &lt; 0) {
          __pyx_t_38 += __pyx_v_delta_rho_interact_squared.shape[1];
          if (unlikely(__pyx_t_38 &lt; 0)) __pyx_t_16 = 1;
        } else if (unlikely(__pyx_t_38 &gt;= __pyx_v_delta_rho_interact_squared.shape[1])) __pyx_t_16 = 1;
        if (__pyx_t_37 &lt; 0) {
          __pyx_t_37 += __pyx_v_delta_rho_interact_squared.shape[2];
          if (unlikely(__pyx_t_37 &lt; 0)) __pyx_t_16 = 2;
        } else if (unlikely(__pyx_t_37 &gt;= __pyx_v_delta_rho_interact_squared.shape[2])) __pyx_t_16 = 2;
        if (unlikely(__pyx_t_16 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_16);
          <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
        }
        __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_delta_rho_interact_squared.data + __pyx_t_35 * __pyx_v_delta_rho_interact_squared.strides[0]) ) + __pyx_t_38 * __pyx_v_delta_rho_interact_squared.strides[1]) )) + __pyx_t_37)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_tot_density_change_interact, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tot_density_change_interact, __pyx_t_4);
        __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1782</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1783</span>:                 <span class="n">dE_binders_beads</span> <span class="o">+=</span><span class="w">\</span></pre>
<pre class='cython code score-23 '>      __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE_binders_beads);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
      __pyx_t_45 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_44 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_45); if (unlikely((__pyx_t_44 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_45); __pyx_t_45 = 0;
      __pyx_v_dE_binders_beads = __pyx_t_44;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1784</span>:                     <span class="n">binder_info</span><span class="p">[</span><span class="s">&quot;cross_talk_field_energy_prefactor&quot;</span><span class="p">][</span><span class="n">next_binder_info</span><span class="p">[</span><span class="s">&quot;name&quot;</span><span class="p">]]</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-19 '>      if (unlikely(__pyx_v_binder_info == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
      }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_binder_info, __pyx_n_s_cross_talk_field_energy_prefacto);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_next_binder_info, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_45 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_45);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_45, __pyx_v_tot_density_change_interact);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_45); __pyx_t_45 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1785</span>:                     <span class="n">tot_density_change_interact</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1786</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1787</span>:         <span class="c"># Nonspecific bead interaction energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1788</span>:         <span class="n">dE_binders_beads</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonspecific_interact_dE</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE_binders_beads = (__pyx_v_dE_binders_beads + ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;nonspecific_interact_dE(__pyx_v_self, __pyx_v_poly, __pyx_v_bin_inds, __pyx_v_n_bins));
</pre><pre class="cython line score-0">&#xA0;<span class="">1789</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1790</span>:         <span class="k">return</span> <span class="n">dE_binders_beads</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_dE_binders_beads;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1791</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1792</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">nonspecific_interact_dE</span><span class="p">(</span></pre>
<pre class='cython code score-4 '>static double __pyx_f_6chromo_6fields_19UniformDensityField_nonspecific_interact_dE(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_bin_inds, long __pyx_v_n_bins) {
  double __pyx_v_bead_V;
  double __pyx_v_nonspecific_dE;
  double __pyx_v_access_vol;
  __Pyx_memviewslice __pyx_v_vol_fracs = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_i;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonspecific_interact_dE", 0);
  <span class='trace'>__Pyx_TraceCall</span>("nonspecific_interact_dE", __pyx_f[0], 1792, 0, <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.nonspecific_interact_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vol_fracs, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1793</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1794</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1795</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get nonspecific interaction energy for an affected polymer segment.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1797</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1798</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>: <span class="sd">        This method assumes that all beads are of the same volume.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1800</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1801</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1802</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1803</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1804</span>: <span class="sd">            Polymer affected by the current MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1805</span>: <span class="sd">        bin_inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1806</span>: <span class="sd">            Bin indices affected by the MC move either through loss or addition</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1807</span>: <span class="sd">            of density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1808</span>: <span class="sd">        n_bins : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1809</span>: <span class="sd">            Number of bins affected by an MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1810</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1811</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1812</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1813</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1814</span>: <span class="sd">            Change in energy associated with the nonspecific interactions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1815</span>: <span class="sd">            between segments of the polymer chain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1816</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1817</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_V</span><span class="p">,</span> <span class="nf">nonspecific_dE</span><span class="p">,</span> <span class="nf">access_vol</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1818</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">vol_fracs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1819</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1820</span>:         <span class="n">bead_V</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">vol</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_poly-&gt;beads, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_vol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1820, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bead_V = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1821</span>:         <span class="n">vol_fracs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume_fractions_with_trial</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_volume_fractions_with_trial(__pyx_v_self, __pyx_v_bead_V, __pyx_v_bin_inds, __pyx_v_n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1821, __pyx_L1_error)</span>
  __pyx_v_vol_fracs = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1822</span>:             <span class="n">bead_V</span><span class="p">,</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="n">n_bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1823</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1824</span>:         <span class="n">nonspecific_dE</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nonspecific_dE = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1825</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_n_bins;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1826</span>:             <span class="n">access_vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-23 '>    if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1826, __pyx_L1_error)</span>
    }
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_bin_inds.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_9 = 0;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 1826, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_8 * __pyx_v_bin_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1826, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1826, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1826, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_access_vol = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">1827</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1828</span>:             <span class="c"># Trial Volume Fractions</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1829</span>:             <span class="k">if</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_limit</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_8 = 1;
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_9 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_vol_fracs.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 1829, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_8 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_10)) ))) &gt; __pyx_v_self-&gt;vf_limit) != 0);
    if (__pyx_t_11) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1830</span>:                 <span class="n">nonspecific_dE</span> <span class="o">+=</span> <span class="n">E_HUGE</span> <span class="o">*</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_10 = 1;
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_vol_fracs.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 1;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
      if (unlikely(__pyx_t_9 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
        <span class='error_goto'>__PYX_ERR(0, 1830, __pyx_L1_error)</span>
      }
      __pyx_v_nonspecific_dE = (__pyx_v_nonspecific_dE + (__pyx_v_6chromo_6fields_E_HUGE * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_8)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1831</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1832</span>:                 <span class="n">nonspecific_dE</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi</span> <span class="o">*</span> <span class="p">(</span><span class="n">access_vol</span> <span class="o">/</span> <span class="n">bead_V</span><span class="p">)</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-5 '>    /*else*/ {
      if (unlikely(__pyx_v_bead_V == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 1832, __pyx_L1_error)</span>
      }
/* … */
      __pyx_v_nonspecific_dE = (__pyx_v_nonspecific_dE + ((__pyx_v_self-&gt;chi * (__pyx_v_access_vol / __pyx_v_bead_V)) * pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_8 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_10)) ))), 2.0)));
    }
    __pyx_L5:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1833</span>:                                   <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-2 '>      __pyx_t_8 = 1;
      __pyx_t_10 = __pyx_v_i;
      __pyx_t_9 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[1];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 1;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
      if (unlikely(__pyx_t_9 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
        <span class='error_goto'>__PYX_ERR(0, 1833, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1834</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1835</span>:             <span class="c"># Current volume fractions</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1836</span>:             <span class="k">if</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_limit</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_10 = 0;
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_vol_fracs.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
    if (unlikely(__pyx_t_9 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
      <span class='error_goto'>__PYX_ERR(0, 1836, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_8)) ))) &gt; __pyx_v_self-&gt;vf_limit) != 0);
    if (__pyx_t_11) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1837</span>:                 <span class="n">nonspecific_dE</span> <span class="o">-=</span> <span class="n">E_HUGE</span> <span class="o">*</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_8 = 0;
      __pyx_t_10 = __pyx_v_i;
      __pyx_t_9 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[1];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 1;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
      if (unlikely(__pyx_t_9 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
        <span class='error_goto'>__PYX_ERR(0, 1837, __pyx_L1_error)</span>
      }
      __pyx_v_nonspecific_dE = (__pyx_v_nonspecific_dE - (__pyx_v_6chromo_6fields_E_HUGE * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_8 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_10)) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1838</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1839</span>:                 <span class="n">nonspecific_dE</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi</span> <span class="o">*</span> <span class="p">(</span><span class="n">access_vol</span> <span class="o">/</span> <span class="n">bead_V</span><span class="p">)</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-5 '>    /*else*/ {
      if (unlikely(__pyx_v_bead_V == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
      }
/* … */
      __pyx_v_nonspecific_dE = (__pyx_v_nonspecific_dE - ((__pyx_v_self-&gt;chi * (__pyx_v_access_vol / __pyx_v_bead_V)) * pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_8)) ))), 2.0)));
    }
    __pyx_L6:;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1840</span>:                                   <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-2 '>      __pyx_t_10 = 0;
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_9 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_9 = 0;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_vol_fracs.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_9 = 1;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_9 = 1;
      if (unlikely(__pyx_t_9 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);
        <span class='error_goto'>__PYX_ERR(0, 1840, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1841</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1842</span>:         <span class="k">return</span> <span class="n">nonspecific_dE</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_nonspecific_dE;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1843</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1844</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">get_volume_fractions_with_trial</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_volume_fractions_with_trial(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, double __pyx_v_bead_V, __Pyx_memviewslice __pyx_v_bin_inds, long __pyx_v_n_bins) {
  long __pyx_v_j;
  double __pyx_v_density;
  double __pyx_v_change_in_density;
  __Pyx_memviewslice __pyx_v_vol_fracs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_volume_fractions_with_trial", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_volume_fractions_with_trial", __pyx_f[0], 1844, 0, <span class='error_goto'>__PYX_ERR(0, 1844, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_volume_fractions_with_trial", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vol_fracs, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1845</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">bead_V</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">bin_inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1846</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1847</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the volume frac. of beads in each bin of discretized space.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1848</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1849</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1850</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1851</span>: <span class="sd">        bead_V : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1852</span>: <span class="sd">            Volume of an individual bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1853</span>: <span class="sd">        bin_inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1854</span>: <span class="sd">            Bin indices affected by the MC move either through loss or addition</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1855</span>: <span class="sd">            of density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>: <span class="sd">        n_bins : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1857</span>: <span class="sd">            Number of bins affected by an MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1858</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1859</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1860</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1861</span>: <span class="sd">        double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1862</span>: <span class="sd">            Array of bead volume fractions for each bin; first row corresponds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1863</span>: <span class="sd">            to current configuration of the polymer, and the second row</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1864</span>: <span class="sd">            corresponds to the trial configuration of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1865</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1866</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1867</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">density</span><span class="p">,</span> <span class="nf">change_in_density</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1868</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">vol_fracs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_vol_fracs = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1869</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1870</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_n_bins;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1871</span>:             <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>    if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_j;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_bin_inds.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_9 * __pyx_v_bin_inds.strides[0]) )));
    __pyx_t_12 = 0;
    __pyx_t_10 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;density.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;density.shape[1];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>
    }
    __pyx_v_density = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_11 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_12)) )));
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1872</span>:             <span class="n">change_in_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">bin_inds</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-9 '>    if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_j;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_bin_inds.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_bin_inds.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    }
    __pyx_t_12 = (*((long *) ( /* dim=0 */ (__pyx_v_bin_inds.data + __pyx_t_9 * __pyx_v_bin_inds.strides[0]) )));
    __pyx_t_11 = 0;
    __pyx_t_10 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;density_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_self-&gt;density_trial.shape[1];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    }
    __pyx_v_change_in_density = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_12 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_11)) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1873</span>:             <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">density</span> <span class="o">*</span> <span class="n">bead_V</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = 0;
    __pyx_t_11 = __pyx_v_j;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_vol_fracs.shape[1];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_9 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_11)) )) = (__pyx_v_density * __pyx_v_bead_V);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1874</span>:             <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">change_in_density</span> <span class="o">*</span> <span class="n">bead_V</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    __pyx_t_11 = 0;
    __pyx_t_9 = __pyx_v_j;
    __pyx_t_10 = -1;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_vol_fracs.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1874, __pyx_L1_error)</span>
    }
    __pyx_t_12 = 1;
    __pyx_t_13 = __pyx_v_j;
    __pyx_t_10 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_vol_fracs.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_vol_fracs.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 1874, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_12 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_13)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_11 * __pyx_v_vol_fracs.strides[0]) )) + __pyx_t_9)) ))) + (__pyx_v_change_in_density * __pyx_v_bead_V));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1875</span>:         <span class="k">return</span> <span class="n">vol_fracs</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_vol_fracs, 0);
  __pyx_r = __pyx_v_vol_fracs;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1876</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1877</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">count_doubly_bound</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_6chromo_6fields_19UniformDensityField_count_doubly_bound(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_trial, int __pyx_v_state_change) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("count_doubly_bound", 0);
  <span class='trace'>__Pyx_TraceCall</span>("count_doubly_bound", __pyx_f[0], 1877, 0, <span class='error_goto'>__PYX_ERR(0, 1877, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.count_doubly_bound", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1878</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">trial</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1879</span>:         <span class="nb">bint</span> <span class="n">state_change</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1880</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1881</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;For each reader protein, count the number of doubly bound beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1882</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1883</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1884</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1885</span>: <span class="sd">        We refer to nucleosomes with two histone tails bound by a reader</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1886</span>: <span class="sd">        protein as being doubly bound.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1887</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1888</span>: <span class="sd">        When both histone tails of a nucleosome are bound by the same</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1889</span>: <span class="sd">        reader protein, there is an additional intranucleosome interaction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1890</span>: <span class="sd">        energy contributing to the binding energy.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1891</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1892</span>: <span class="sd">        This function counts the number of doubly bounded nucleosomes for each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1893</span>: <span class="sd">        reader protein.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1894</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1895</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1896</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1897</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1898</span>: <span class="sd">            Polymer object undergoing transformation in field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1899</span>: <span class="sd">        inds : array_like (N,) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1900</span>: <span class="sd">            Indices of N beads involved in the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1901</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1902</span>: <span class="sd">            Number of bead indices affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1903</span>: <span class="sd">        trial : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1904</span>: <span class="sd">            Indicator for whether to count doubly bound beads for the current</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1905</span>: <span class="sd">            configuration (0) or trial configuration (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1906</span>: <span class="sd">        state_change : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1907</span>: <span class="sd">            Indicator for whether the MC move involved a change in binding state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1908</span>: <span class="sd">            (1) or not (0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1909</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1910</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1911</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1912</span>:         <span class="c"># Count doubly-bound beads for current configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1913</span>:         <span class="k">if</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  switch (__pyx_v_trial) {
    case 0:
/* … */
    break;
    case 1:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1914</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_poly-&gt;num_binders;
    __pyx_t_2 = __pyx_t_1;
    for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
      __pyx_v_j = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1915</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;doubly_bound.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1915, __pyx_L1_error)</span>}
      __pyx_t_4 = __pyx_v_j;
      __pyx_t_5 = -1;
      if (__pyx_t_4 &lt; 0) {
        __pyx_t_4 += __pyx_v_self-&gt;doubly_bound.shape[0];
        if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
      } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound.shape[0])) __pyx_t_5 = 0;
      if (unlikely(__pyx_t_5 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
        <span class='error_goto'>__PYX_ERR(0, 1915, __pyx_L1_error)</span>
      }
      *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1916</span>:                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = __pyx_v_n_inds;
      __pyx_t_7 = __pyx_t_6;
      for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
        __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1917</span>:                     <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-9 '>        if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1917, __pyx_L1_error)</span>}
        __pyx_t_4 = __pyx_v_i;
        __pyx_t_5 = -1;
        if (__pyx_t_4 &lt; 0) {
          __pyx_t_4 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_inds.shape[0])) __pyx_t_5 = 0;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1917, __pyx_L1_error)</span>
        }
        __pyx_t_9 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_4 * __pyx_v_inds.strides[0]) )));
        __pyx_t_10 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_9 &lt; 0) {
          __pyx_t_9 += __pyx_v_poly-&gt;states.shape[0];
          if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_5 = 0;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_poly-&gt;states.shape[1];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 1;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_5 = 1;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1917, __pyx_L1_error)</span>
        }
        __pyx_t_11 = (((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_9 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_10)) ))) == 2) != 0);
        if (__pyx_t_11) {
/* … */
        }
      }
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1918</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-7 '>          if (unlikely(!__pyx_v_self-&gt;doubly_bound.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1918, __pyx_L1_error)</span>}
          __pyx_t_4 = __pyx_v_j;
          __pyx_t_5 = -1;
          if (__pyx_t_4 &lt; 0) {
            __pyx_t_4 += __pyx_v_self-&gt;doubly_bound.shape[0];
            if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
          } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound.shape[0])) __pyx_t_5 = 0;
          if (unlikely(__pyx_t_5 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
            <span class='error_goto'>__PYX_ERR(0, 1918, __pyx_L1_error)</span>
          }
          *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound.strides[0]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1919</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1920</span>:         <span class="c"># Count doubly-bound beads for trial configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1921</span>:         <span class="k">elif</span> <span class="n">trial</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    break;
    default:
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1922</span>:             <span class="k">if</span> <span class="n">state_change</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = ((__pyx_v_state_change == 1) != 0);
    if (__pyx_t_11) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1923</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_1 = __pyx_v_poly-&gt;num_binders;
      __pyx_t_2 = __pyx_t_1;
      for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
        __pyx_v_j = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1924</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;doubly_bound_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1924, __pyx_L1_error)</span>}
        __pyx_t_4 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_4 &lt; 0) {
          __pyx_t_4 += __pyx_v_self-&gt;doubly_bound_trial.shape[0];
          if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound_trial.shape[0])) __pyx_t_5 = 0;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1924, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound_trial.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound_trial.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1925</span>:                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_6 = __pyx_v_n_inds;
        __pyx_t_7 = __pyx_t_6;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1926</span>:                         <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-9 '>          if (unlikely(!__pyx_v_poly-&gt;states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1926, __pyx_L1_error)</span>}
          __pyx_t_4 = __pyx_v_i;
          __pyx_t_5 = -1;
          if (__pyx_t_4 &lt; 0) {
            __pyx_t_4 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
          } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_inds.shape[0])) __pyx_t_5 = 0;
          if (unlikely(__pyx_t_5 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
            <span class='error_goto'>__PYX_ERR(0, 1926, __pyx_L1_error)</span>
          }
          __pyx_t_10 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_4 * __pyx_v_inds.strides[0]) )));
          __pyx_t_9 = __pyx_v_j;
          __pyx_t_5 = -1;
          if (__pyx_t_10 &lt; 0) {
            __pyx_t_10 += __pyx_v_poly-&gt;states_trial.shape[0];
            if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
          } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;states_trial.shape[0])) __pyx_t_5 = 0;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_poly-&gt;states_trial.shape[1];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_5 = 1;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;states_trial.shape[1])) __pyx_t_5 = 1;
          if (unlikely(__pyx_t_5 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
            <span class='error_goto'>__PYX_ERR(0, 1926, __pyx_L1_error)</span>
          }
          __pyx_t_11 = (((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states_trial.data + __pyx_t_10 * __pyx_v_poly-&gt;states_trial.strides[0]) )) + __pyx_t_9)) ))) == 2) != 0);
          if (__pyx_t_11) {
/* … */
          }
        }
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1927</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_self-&gt;doubly_bound_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1927, __pyx_L1_error)</span>}
            __pyx_t_4 = __pyx_v_j;
            __pyx_t_5 = -1;
            if (__pyx_t_4 &lt; 0) {
              __pyx_t_4 += __pyx_v_self-&gt;doubly_bound_trial.shape[0];
              if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
            } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound_trial.shape[0])) __pyx_t_5 = 0;
            if (unlikely(__pyx_t_5 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
              <span class='error_goto'>__PYX_ERR(0, 1927, __pyx_L1_error)</span>
            }
            *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound_trial.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound_trial.strides[0]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1928</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1929</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_1 = __pyx_v_poly-&gt;num_binders;
      __pyx_t_2 = __pyx_t_1;
      for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
        __pyx_v_j = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1930</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;doubly_bound_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1930, __pyx_L1_error)</span>}
        __pyx_t_4 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_4 &lt; 0) {
          __pyx_t_4 += __pyx_v_self-&gt;doubly_bound_trial.shape[0];
          if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound_trial.shape[0])) __pyx_t_5 = 0;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1930, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound_trial.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound_trial.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1931</span>:                     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_6 = __pyx_v_n_inds;
        __pyx_t_7 = __pyx_t_6;
        for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
          __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1932</span>:                         <span class="k">if</span> <span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-9 '>          if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1932, __pyx_L1_error)</span>}
          __pyx_t_4 = __pyx_v_i;
          __pyx_t_5 = -1;
          if (__pyx_t_4 &lt; 0) {
            __pyx_t_4 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
          } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_inds.shape[0])) __pyx_t_5 = 0;
          if (unlikely(__pyx_t_5 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
            <span class='error_goto'>__PYX_ERR(0, 1932, __pyx_L1_error)</span>
          }
          __pyx_t_9 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_4 * __pyx_v_inds.strides[0]) )));
          __pyx_t_10 = __pyx_v_j;
          __pyx_t_5 = -1;
          if (__pyx_t_9 &lt; 0) {
            __pyx_t_9 += __pyx_v_poly-&gt;states.shape[0];
            if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_5 = 0;
          } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_5 = 0;
          if (__pyx_t_10 &lt; 0) {
            __pyx_t_10 += __pyx_v_poly-&gt;states.shape[1];
            if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 1;
          } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_5 = 1;
          if (unlikely(__pyx_t_5 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
            <span class='error_goto'>__PYX_ERR(0, 1932, __pyx_L1_error)</span>
          }
          __pyx_t_11 = (((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_9 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_10)) ))) == 2) != 0);
          if (__pyx_t_11) {
/* … */
          }
        }
      }
    }
    __pyx_L8:;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1933</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound_trial</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-7 '>            if (unlikely(!__pyx_v_self-&gt;doubly_bound_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1933, __pyx_L1_error)</span>}
            __pyx_t_4 = __pyx_v_j;
            __pyx_t_5 = -1;
            if (__pyx_t_4 &lt; 0) {
              __pyx_t_4 += __pyx_v_self-&gt;doubly_bound_trial.shape[0];
              if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
            } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;doubly_bound_trial.shape[0])) __pyx_t_5 = 0;
            if (unlikely(__pyx_t_5 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
              <span class='error_goto'>__PYX_ERR(0, 1933, __pyx_L1_error)</span>
            }
            *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound_trial.data + __pyx_t_4 * __pyx_v_self-&gt;doubly_bound_trial.strides[0]) )) += 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1934</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1935</span>:         <span class="c"># Raise error if invalid `trial` flag is passed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1936</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1937</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Invalid current/trial state indicator.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_12, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1937, __pyx_L1_error)</span>
    break;
  }
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Invalid_current_trial_state_indi);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">1938</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1939</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_E</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_21compute_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
static double __pyx_f_6chromo_6fields_19UniformDensityField_compute_E(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, int __pyx_skip_dispatch) {
  long __pyx_v_n_inds;
  double __pyx_v_E;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  <span class='trace'>__Pyx_TraceCall</span>("compute_E", __pyx_f[0], 1939, 0, <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_6fields_19UniformDensityField_21compute_E)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_poly)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_poly));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_21compute_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_20compute_E[] = "Compute total field energy for the current polymer configuration.\n        \n        Notes\n        -----\n        Load the positions and states of the entire polymer. Then determine the\n        number density of beads in each bin of the field. Use these densities\n        and binder states on each bead to determine an overall field energy.\n\n        Parameters\n        ----------\n        poly : poly.PolymerBase\n            Polymer object undergoing transformation in field\n\n        Returns\n        -------\n        double\n            Total energy associated with the field\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_21compute_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_poly), __pyx_ptype_6chromo_8polymers_PolymerBase, 1, "poly", 0))) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_20compute_E(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_poly));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_20compute_E(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  <span class='trace'>__Pyx_TraceCall</span>("compute_E (wrapper)", __pyx_f[0], 1939, 0, <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_6fields_19UniformDensityField_compute_E(__pyx_v_self, __pyx_v_poly, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1940</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute total field energy for the current polymer configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1941</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1942</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1943</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1944</span>: <span class="sd">        Load the positions and states of the entire polymer. Then determine the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1945</span>: <span class="sd">        number density of beads in each bin of the field. Use these densities</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1946</span>: <span class="sd">        and binder states on each bead to determine an overall field energy.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1948</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1949</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1950</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1951</span>: <span class="sd">            Polymer object undergoing transformation in field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1953</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1954</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1955</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1956</span>: <span class="sd">            Total energy associated with the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1957</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1958</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1959</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1960</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1961</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1962</span>:         <span class="n">n_inds</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_poly-&gt;num_beads;
  __pyx_v_n_inds = __pyx_t_6;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1963</span>:         <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_2, __pyx_int_1};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_2, __pyx_int_1};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_inds = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1964</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">update_all_densities</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;update_all_densities(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1965</span>:         <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_E_binders_and_beads</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_E_binders_and_beads(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1966</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1967</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1968</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">update_affected_densities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_19UniformDensityField_update_affected_densities(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_affected_densities", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_affected_densities", __pyx_f[0], 1968, 0, <span class='error_goto'>__PYX_ERR(0, 1968, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.update_affected_densities", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1969</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update densities in affected bins when a move is accepted.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1970</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1971</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;n_bins;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1972</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">affected_bins_last_move</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;affected_bins_last_move.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1972, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;affected_bins_last_move.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;affected_bins_last_move.shape[0])) __pyx_t_5 = 0;
    if (unlikely(__pyx_t_5 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
      <span class='error_goto'>__PYX_ERR(0, 1972, __pyx_L1_error)</span>
    }
    __pyx_t_6 = (((*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;affected_bins_last_move.data + __pyx_t_4 * __pyx_v_self-&gt;affected_bins_last_move.strides[0]) ))) == 1) != 0);
    if (__pyx_t_6) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1973</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = (__pyx_v_self-&gt;num_binders + 1);
      __pyx_t_8 = __pyx_t_7;
      for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
        __pyx_v_j = __pyx_t_9;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1974</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>}
        __pyx_t_4 = __pyx_v_i;
        __pyx_t_10 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_4 &lt; 0) {
          __pyx_t_4 += __pyx_v_self-&gt;density_trial.shape[0];
          if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_5 = 0;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_self-&gt;density_trial.shape[1];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 1;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_5 = 1;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>}
        __pyx_t_11 = __pyx_v_i;
        __pyx_t_12 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_5 = 0;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_5 = 1;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_5 = 1;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_11 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_12)) )) += (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_4 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_10)) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1975</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1975, __pyx_L1_error)</span>}
        __pyx_t_10 = __pyx_v_i;
        __pyx_t_4 = __pyx_v_j;
        __pyx_t_5 = -1;
        if (__pyx_t_10 &lt; 0) {
          __pyx_t_10 += __pyx_v_self-&gt;density_trial.shape[0];
          if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_5 = 0;
        } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_5 = 0;
        if (__pyx_t_4 &lt; 0) {
          __pyx_t_4 += __pyx_v_self-&gt;density_trial.shape[1];
          if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 1;
        } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_5 = 1;
        if (unlikely(__pyx_t_5 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
          <span class='error_goto'>__PYX_ERR(0, 1975, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_10 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_4)) )) = 0.0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1976</span>: </pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1977</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_all_densities</span><span class="p">(</span></pre>
<pre class='cython code score-105 '>static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_23update_all_densities(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6chromo_6fields_19UniformDensityField_update_all_densities(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice &amp;__pyx_v_inds, long __pyx_v_n_inds, int __pyx_skip_dispatch) {
  double __pyx_v_density;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_l;
  long __pyx_v_m;
  long __pyx_v_ind;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_all_densities", __pyx_f[0], 1977, 0, <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_update_all_densities);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_6fields_19UniformDensityField_23update_all_densities)) {
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_7 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[4] = {__pyx_t_6, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[4] = {__pyx_t_6, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (__pyx_t_6) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_poly));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, ((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.update_all_densities", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_23update_all_densities(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_22update_all_densities[] = "Update the density of the field for a single polymer.\n        \n        Notes\n        -----\n        Updates the voxel densities stored in the field object. See notes for\n        `self.get_change_in_density()` for details on implementation.\n\n        Parameters\n        ----------\n        poly : poly.PolymerBase\n            Polymer for which densities are calculated\n        inds : long[:] by reference\n            Array of bead indices for the entire polymer (to avoid re-computing\n            this)\n        n_inds : long\n            Number of beads in the polymer\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_23update_all_densities(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly = 0;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_n_inds;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_poly,&amp;__pyx_n_s_inds,&amp;__pyx_n_s_n_inds,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_poly)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_all_densities", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_all_densities", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_all_densities") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_poly = ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)values[0]);
    __pyx_v_inds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_inds.memview)) __PYX_ERR(0, 1978, __pyx_L3_error)</span>
    __pyx_v_n_inds = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_n_inds == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_all_densities", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.update_all_densities", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_poly), __pyx_ptype_6chromo_8polymers_PolymerBase, 1, "poly", 0))) <span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_22update_all_densities(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_22update_all_densities(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_all_densities (wrapper)", __pyx_f[0], 1977, 0, <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_6fields_19UniformDensityField_update_all_densities(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.update_all_densities", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1978</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span><span class="o">&amp;</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1979</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1980</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the density of the field for a single polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1981</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1982</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1983</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1984</span>: <span class="sd">        Updates the voxel densities stored in the field object. See notes for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1985</span>: <span class="sd">        `self.get_change_in_density()` for details on implementation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1986</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1987</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1988</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1989</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1990</span>: <span class="sd">            Polymer for which densities are calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1991</span>: <span class="sd">        inds : long[:] by reference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1992</span>: <span class="sd">            Array of bead indices for the entire polymer (to avoid re-computing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1993</span>: <span class="sd">            this)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1994</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1995</span>: <span class="sd">            Number of beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1996</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1997</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1998</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">m</span><span class="p">,</span> <span class="nf">ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1999</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">superindices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2000</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2001</span>:         <span class="c"># Re-initialize all densities</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2002</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_self-&gt;n_bins;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2003</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = (__pyx_v_poly-&gt;num_binders + 1);
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2004</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2004, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2004, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_15 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_16)) )) = 0.0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2005</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2005, __pyx_L1_error)</span>}
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;density_trial.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;density_trial.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2005, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_16 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_15)) )) = 0.0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2007</span>:         <span class="c"># Iterate through beads and add their densities to corresponding bins</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2008</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n_inds;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2009</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">2010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2011</span>:                 <span class="c"># Load current configuration of the polymer</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2012</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2012, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;xyz.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2012, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_15 * __pyx_v_self-&gt;xyz.strides[0]) )) = (__Pyx_mod_double(__pyx_t_19, __pyx_t_20) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_step_xyz.data + __pyx_t_18 * __pyx_v_self-&gt;half_step_xyz.strides[0]) ))));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2013</span>:                     <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span></pre>
<pre class='cython code score-21 '>      if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_7 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
      }
      __pyx_t_16 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_15 * __pyx_v_inds.strides[0]) )));
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_poly-&gt;r.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_poly-&gt;r.shape[1];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;half_width_xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
      }
      __pyx_t_19 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_16 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_17)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_18 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
      if (unlikely(__pyx_t_20 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float divmod()");
        <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2014</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;width_xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;width_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2014, __pyx_L1_error)</span>
      }
      __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;width_xyz.data + __pyx_t_18 * __pyx_v_self-&gt;width_xyz.strides[0]) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2015</span>:                 <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_step_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;half_step_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2015, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;half_step_xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;half_step_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2015, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2017</span>:                 <span class="c"># Get the lower neighboring bin index</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2018</span>:                 <span class="n">ind</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-19 '>      if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>
      }
      __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_18 * __pyx_v_self-&gt;xyz.strides[0]) )));
      if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;dxyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>
      }
      __pyx_t_19 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_18 * __pyx_v_self-&gt;dxyz.strides[0]) )));
      if (unlikely(__pyx_t_19 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>
      }
      __pyx_v_ind = ((long)floor((__pyx_t_20 / __pyx_t_19)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2019</span>:                 <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = ((__pyx_v_ind == -1L) != 0);
      if (__pyx_t_21) {
/* … */
        goto __pyx_L11;
      }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2020</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_xyz_m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;n_xyz_m1.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2020, __pyx_L1_error)</span>}
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_self-&gt;n_xyz_m1.shape[0];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;n_xyz_m1.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2020, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2020, __pyx_L1_error)</span>}
        __pyx_t_15 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;index_xyz.shape[0];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2020, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_15 * __pyx_v_self-&gt;index_xyz.strides[0]) )) = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;n_xyz_m1.data + __pyx_t_18 * __pyx_v_self-&gt;n_xyz_m1.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">2021</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2022</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-7 '>      /*else*/ {
        if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2022, __pyx_L1_error)</span>}
        __pyx_t_18 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_self-&gt;index_xyz.shape[0];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2022, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_18 * __pyx_v_self-&gt;index_xyz.strides[0]) )) = __pyx_v_ind;
      }
      __pyx_L11:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2024</span>:                 <span class="c"># Get weight in the lower bin index</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2025</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span><span class="p">))</span></pre>
<pre class='cython code score-26 '>      if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>
      }
      __pyx_t_19 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_18 * __pyx_v_self-&gt;xyz.strides[0]) )));
      if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;dxyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>
      }
      __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_18 * __pyx_v_self-&gt;dxyz.strides[0]) )));
      if (unlikely(__pyx_t_20 == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;weight_xyz.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_18 * __pyx_v_self-&gt;weight_xyz.strides[0]) )) = (1.0 - ((__pyx_t_19 / __pyx_t_20) - __pyx_v_ind));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2027</span>:             <span class="c"># Get weights and superindices of eight bins containing beads</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2028</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_weight_vector</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_weight_vector(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2029</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">_generate_index_vector</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_index_vector(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">2030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2031</span>:             <span class="c"># Distribute weights into bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2032</span>:             <span class="c"># l indicates for which of eight bins density is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2033</span>:             <span class="c"># m indicates polymer (0) or which protein (1 to n_binders)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2034</span>:             <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 8; __pyx_t_12+=1) {
      __pyx_v_l = __pyx_t_12;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2035</span>:                 <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span></pre>
<pre class='cython code score-44 '>      if (unlikely(!__pyx_v_self-&gt;wt_vec.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_l;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;wt_vec.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;wt_vec.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec.data + __pyx_t_18 * __pyx_v_self-&gt;wt_vec.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2035, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_l;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;nbr_inds.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_18 * __pyx_v_self-&gt;nbr_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2035, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2035, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2035, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_20 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_20 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2035, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_density = __pyx_t_20;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2036</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">density</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2036, __pyx_L1_error)</span>}
      if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2036, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_l;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;nbr_inds.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2036, __pyx_L1_error)</span>
      }
      __pyx_t_15 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_18 * __pyx_v_self-&gt;nbr_inds.strides[0]) )));
      __pyx_t_17 = 0;
      __pyx_t_7 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2036, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_15 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_17)) )) += __pyx_v_density;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2037</span>:                 <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = __pyx_v_poly-&gt;n_binders_p1;
      __pyx_t_14 = __pyx_t_13;
      for (__pyx_t_22 = 1; __pyx_t_22 &lt; __pyx_t_14; __pyx_t_22+=1) {
        __pyx_v_m = __pyx_t_22;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2038</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="n">density</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>}
        if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_l;
        __pyx_t_7 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;nbr_inds.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_16 * __pyx_v_self-&gt;nbr_inds.strides[0]) )));
        __pyx_t_24 = __pyx_v_m;
        __pyx_t_7 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_23 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_24)) )) += (__pyx_v_density * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_17 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_15)) )))));
      }
    }
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2039</span>:                         <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>        if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>}
        __pyx_t_18 = __pyx_v_i;
        __pyx_t_7 = -1;
        if (__pyx_t_18 &lt; 0) {
          __pyx_t_18 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
        }
        __pyx_t_17 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_18 * __pyx_v_inds.strides[0]) )));
        __pyx_t_15 = (__pyx_v_m - 1);
        __pyx_t_7 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_poly-&gt;states.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_poly-&gt;states.shape[1];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">2040</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2041</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_all_densities_for_all_polymers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-33 '>static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_25update_all_densities_for_all_polymers(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static void __pyx_f_6chromo_6fields_19UniformDensityField_update_all_densities_for_all_polymers(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_density;
  long __pyx_v_h;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_l;
  long __pyx_v_m;
  long __pyx_v_ind;
  long __pyx_v_n_binders_p1;
  long __pyx_v_n_inds;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly = 0;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities_for_all_polymers", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_all_densities_for_all_polymers", __pyx_f[0], 2041, 0, <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_update_all_densities_for_all_pol);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_6fields_19UniformDensityField_25update_all_densities_for_all_polymers)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.update_all_densities_for_all_polymers", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_poly);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_25update_all_densities_for_all_polymers(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_24update_all_densities_for_all_polymers[] = "Update the density map for every polymer in the field.\n\n        Notes\n        -----\n        Updates the voxel densities stored in the field object. See notes for\n        `self.get_change_in_density()` for details on implementation.\n        \n        Requires that binders are listed in the same order on each polymer, as\n        listed in `self.binders`.\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_25update_all_densities_for_all_polymers(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities_for_all_polymers (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_24update_all_densities_for_all_polymers(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_24update_all_densities_for_all_polymers(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_all_densities_for_all_polymers", 0);
  <span class='trace'>__Pyx_TraceCall</span>("update_all_densities_for_all_polymers (wrapper)", __pyx_f[0], 2041, 0, <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_6fields_19UniformDensityField_update_all_densities_for_all_polymers(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2041, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.update_all_densities_for_all_polymers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2042</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the density map for every polymer in the field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2044</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2045</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2046</span>: <span class="sd">        Updates the voxel densities stored in the field object. See notes for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2047</span>: <span class="sd">        `self.get_change_in_density()` for details on implementation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2048</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2049</span>: <span class="sd">        Requires that binders are listed in the same order on each polymer, as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2050</span>: <span class="sd">        listed in `self.binders`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2051</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2052</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2053</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">h</span><span class="p">,</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">l</span><span class="p">,</span> <span class="nf">m</span><span class="p">,</span> <span class="nf">ind</span><span class="p">,</span> <span class="nf">n_binders_p1</span><span class="p">,</span> <span class="nf">n_inds</span><span class="p">,</span> <span class="nf">max_binder_count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2054</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">superindices</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">binder_counts</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2055</span>:         <span class="k">cdef</span> <span class="kt">poly</span>.<span class="kt">PolymerBase</span> <span class="nf">poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2057</span>:         <span class="c"># Re-initialize all densities and trial densities</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2058</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;n_bins;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2059</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_self-&gt;num_binders;
    __pyx_t_9 = __pyx_t_8;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_j = __pyx_t_10;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2060</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2060, __pyx_L1_error)</span>}
      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2060, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_11 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_12)) )) = 0.0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2061</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">density_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;density_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2061, __pyx_L1_error)</span>}
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;density_trial.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;density_trial.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_self-&gt;density_trial.shape[1];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density_trial.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2061, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density_trial.data + __pyx_t_12 * __pyx_v_self-&gt;density_trial.strides[0]) )) + __pyx_t_11)) )) = 0.0;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2063</span>:         <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_polymers</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;__pyx_base.n_polymers;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_h = __pyx_t_7;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2064</span>:             <span class="n">poly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polymers</span><span class="p">[</span><span class="n">h</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(__pyx_v_self-&gt;__pyx_base.polymers == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 2064, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_self-&gt;__pyx_base.polymers, __pyx_v_h, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2064, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_6chromo_8polymers_PolymerBase))))) <span class='error_goto'>__PYX_ERR(0, 2064, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_poly, ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2065</span>:             <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2065, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2065, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2065, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2065, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 2065, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
    __pyx_v_inds = __pyx_t_14;
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2066</span>:             <span class="n">n_inds</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_poly-&gt;num_beads;
    __pyx_v_n_inds = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2067</span>:             <span class="n">n_binders_p1</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">n_binders_p1</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_poly-&gt;n_binders_p1;
    __pyx_v_n_binders_p1 = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">2068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2069</span>:             <span class="c"># Iterate through beads and add densities to corresponding bins</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2070</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_n_inds;
    __pyx_t_9 = __pyx_t_8;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2071</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_15 = 0; __pyx_t_15 &lt; 3; __pyx_t_15+=1) {
        __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">2072</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2073</span>:                     <span class="c"># Load current configuration of the polymer</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2074</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2074, __pyx_L1_error)</span>}
        __pyx_t_11 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;xyz.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2074, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_11 * __pyx_v_self-&gt;xyz.strides[0]) )) = (__Pyx_mod_double(__pyx_t_18, __pyx_t_19) - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_step_xyz.data + __pyx_t_17 * __pyx_v_self-&gt;half_step_xyz.strides[0]) ))));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2075</span>:                         <span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span></pre>
<pre class='cython code score-21 '>        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>}
        __pyx_t_11 = __pyx_v_i;
        __pyx_t_13 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_inds.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>
        }
        __pyx_t_12 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_11 * __pyx_v_inds.strides[0]) )));
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_poly-&gt;r.shape[0];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_13 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_poly-&gt;r.shape[1];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_13 = 1;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;half_width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;half_width_xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;half_width_xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>
        }
        __pyx_t_18 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_12 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_16)) ))) + (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;half_width_xyz.data + __pyx_t_17 * __pyx_v_self-&gt;half_width_xyz.strides[0]) ))));
/* … */
        if (unlikely(__pyx_t_19 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float divmod()");
          <span class='error_goto'>__PYX_ERR(0, 2075, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2076</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">width_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;width_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2076, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;width_xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;width_xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2076, __pyx_L1_error)</span>
        }
        __pyx_t_19 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;width_xyz.data + __pyx_t_17 * __pyx_v_self-&gt;width_xyz.strides[0]) )));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2077</span>:                     <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">half_step_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;half_step_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2077, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;half_step_xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;half_step_xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2077, __pyx_L1_error)</span>
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">2078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2079</span>:                     <span class="c"># Get the lower neighboring bin index</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2080</span>:                     <span class="n">ind</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-19 '>        if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2080, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2080, __pyx_L1_error)</span>
        }
        __pyx_t_19 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_17 * __pyx_v_self-&gt;xyz.strides[0]) )));
        if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2080, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;dxyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2080, __pyx_L1_error)</span>
        }
        __pyx_t_18 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_17 * __pyx_v_self-&gt;dxyz.strides[0]) )));
        if (unlikely(__pyx_t_18 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 2080, __pyx_L1_error)</span>
        }
        __pyx_v_ind = ((long)floor((__pyx_t_19 / __pyx_t_18)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2081</span>:                     <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_20 = ((__pyx_v_ind == -1L) != 0);
        if (__pyx_t_20) {
/* … */
          goto __pyx_L13;
        }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2082</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_xyz_m1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;n_xyz_m1.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2082, __pyx_L1_error)</span>}
          __pyx_t_17 = __pyx_v_j;
          __pyx_t_13 = -1;
          if (__pyx_t_17 &lt; 0) {
            __pyx_t_17 += __pyx_v_self-&gt;n_xyz_m1.shape[0];
            if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;n_xyz_m1.shape[0])) __pyx_t_13 = 0;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2082, __pyx_L1_error)</span>
          }
          if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2082, __pyx_L1_error)</span>}
          __pyx_t_11 = __pyx_v_j;
          __pyx_t_13 = -1;
          if (__pyx_t_11 &lt; 0) {
            __pyx_t_11 += __pyx_v_self-&gt;index_xyz.shape[0];
            if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_13 = 0;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2082, __pyx_L1_error)</span>
          }
          *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_11 * __pyx_v_self-&gt;index_xyz.strides[0]) )) = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;n_xyz_m1.data + __pyx_t_17 * __pyx_v_self-&gt;n_xyz_m1.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">2083</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2084</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-7 '>        /*else*/ {
          if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2084, __pyx_L1_error)</span>}
          __pyx_t_17 = __pyx_v_j;
          __pyx_t_13 = -1;
          if (__pyx_t_17 &lt; 0) {
            __pyx_t_17 += __pyx_v_self-&gt;index_xyz.shape[0];
            if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_13 = 0;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2084, __pyx_L1_error)</span>
          }
          *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_17 * __pyx_v_self-&gt;index_xyz.strides[0]) )) = __pyx_v_ind;
        }
        __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2086</span>:                     <span class="c"># Get weight in the lower bin index</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2087</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">ind</span><span class="p">))</span></pre>
<pre class='cython code score-26 '>        if (unlikely(!__pyx_v_self-&gt;xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
        }
        __pyx_t_18 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;xyz.data + __pyx_t_17 * __pyx_v_self-&gt;xyz.strides[0]) )));
        if (unlikely(!__pyx_v_self-&gt;dxyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;dxyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;dxyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
        }
        __pyx_t_19 = (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;dxyz.data + __pyx_t_17 * __pyx_v_self-&gt;dxyz.strides[0]) )));
        if (unlikely(__pyx_t_19 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;weight_xyz.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_17 * __pyx_v_self-&gt;weight_xyz.strides[0]) )) = (1.0 - ((__pyx_t_18 / __pyx_t_19) - __pyx_v_ind));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2088</span>:                 <span class="c"># Get weights and superindices of eight bins containing beads</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2089</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_generate_weight_vector</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_weight_vector(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2090</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">_generate_index_vector</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_generate_index_vector(__pyx_v_self);
</pre><pre class="cython line score-0">&#xA0;<span class="">2091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2092</span>:                 <span class="c"># Distribute weights into bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2093</span>:                 <span class="c"># l indicates for which of 8 bins density is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2094</span>:                 <span class="c"># m indicates polymer (0) or which protein (1 to n_binders)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2095</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">8</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_15 = 0; __pyx_t_15 &lt; 8; __pyx_t_15+=1) {
        __pyx_v_l = __pyx_t_15;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2096</span>:                     <span class="n">density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">]]</span></pre>
<pre class='cython code score-44 '>        if (unlikely(!__pyx_v_self-&gt;wt_vec.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_l;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;wt_vec.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;wt_vec.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
        }
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;wt_vec.data + __pyx_t_17 * __pyx_v_self-&gt;wt_vec.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
          <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_l;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;nbr_inds.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
        }
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_17 * __pyx_v_self-&gt;nbr_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_19 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_19 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_density = __pyx_t_19;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2097</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">density</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>}
        if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>}
        __pyx_t_17 = __pyx_v_l;
        __pyx_t_13 = -1;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;nbr_inds.shape[0];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_13 = 0;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>
        }
        __pyx_t_11 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_17 * __pyx_v_self-&gt;nbr_inds.strides[0]) )));
        __pyx_t_16 = 0;
        __pyx_t_13 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_13 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_13 = 1;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_11 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_16)) )) += __pyx_v_density;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2098</span>:                     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">n_binders_p1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_n_binders_p1;
        __pyx_t_22 = __pyx_t_21;
        for (__pyx_t_23 = 1; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
          __pyx_v_m = __pyx_t_23;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2099</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">m</span><span class="p">]</span> <span class="o">+=</span> <span class="n">density</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>}
          if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>}
          __pyx_t_12 = __pyx_v_l;
          __pyx_t_13 = -1;
          if (__pyx_t_12 &lt; 0) {
            __pyx_t_12 += __pyx_v_self-&gt;nbr_inds.shape[0];
            if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_13 = 0;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>
          }
          __pyx_t_24 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_12 * __pyx_v_self-&gt;nbr_inds.strides[0]) )));
          __pyx_t_25 = __pyx_v_m;
          __pyx_t_13 = -1;
          if (__pyx_t_24 &lt; 0) {
            __pyx_t_24 += __pyx_v_self-&gt;density.shape[0];
            if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_13 = 0;
          if (__pyx_t_25 &lt; 0) {
            __pyx_t_25 += __pyx_v_self-&gt;density.shape[1];
            if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_13 = 1;
          } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_13 = 1;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>
          }
          *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_24 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_25)) )) += (__pyx_v_density * ((double)(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_16 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_11)) )))));
        }
      }
    }
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2100</span>:                             <span class="nb">float</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span></pre>
<pre class='cython code score-9 '>          if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>}
          __pyx_t_17 = __pyx_v_i;
          __pyx_t_13 = -1;
          if (__pyx_t_17 &lt; 0) {
            __pyx_t_17 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_inds.shape[0])) __pyx_t_13 = 0;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>
          }
          __pyx_t_16 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_17 * __pyx_v_inds.strides[0]) )));
          __pyx_t_11 = (__pyx_v_m - 1);
          __pyx_t_13 = -1;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_poly-&gt;states.shape[0];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_13 = 0;
          if (__pyx_t_11 &lt; 0) {
            __pyx_t_11 += __pyx_v_poly-&gt;states.shape[1];
            if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 1;
          } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_13 = 1;
          if (unlikely(__pyx_t_13 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
            <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">2101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2102</span>:         <span class="c"># Fix rounding error</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2103</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;n_bins;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2104</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">+</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = (__pyx_v_self-&gt;num_binders + 1);
    __pyx_t_9 = __pyx_t_8;
    for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_j = __pyx_t_10;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2105</span>:                 <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1E-18</span><span class="p">:</span></pre>
<pre class='cython code score-41 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>}
      __pyx_t_17 = __pyx_v_i;
      __pyx_t_11 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_11 &lt; 0) {
        __pyx_t_11 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>
      }
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_17 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_11)) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_float_1Eneg_18, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_20 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_20) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2106</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L1_error)</span>}
        __pyx_t_11 = __pyx_v_i;
        __pyx_t_17 = __pyx_v_j;
        __pyx_t_13 = -1;
        if (__pyx_t_11 &lt; 0) {
          __pyx_t_11 += __pyx_v_self-&gt;density.shape[0];
          if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_13 = 0;
        } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_13 = 0;
        if (__pyx_t_17 &lt; 0) {
          __pyx_t_17 += __pyx_v_self-&gt;density.shape[1];
          if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 1;
        } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_13 = 1;
        if (unlikely(__pyx_t_13 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
          <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_11 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_17)) )) = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2107</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2108</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_generate_weight_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-13 '>static void __pyx_f_6chromo_6fields_19UniformDensityField__generate_weight_vector(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_generate_weight_vector", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_generate_weight_vector", __pyx_f[0], 2108, 0, <span class='error_goto'>__PYX_ERR(0, 2108, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField._generate_weight_vector", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2109</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate weight array for eight bins containing the bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2110</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2111</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2112</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2113</span>: <span class="sd">        See notes in `self.generate_weight_vector_with_trial` for details on</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2114</span>: <span class="sd">        implementation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2115</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2116</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">wt_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_15 = <span class='py_c_api'>PyList_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 2, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 3, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 4, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 5, __pyx_t_12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 6, __pyx_t_13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_15, 7, __pyx_t_14);
  __pyx_t_2 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_11 = 0;
  __pyx_t_12 = 0;
  __pyx_t_13 = 0;
  __pyx_t_14 = 0;
  __pyx_t_14 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_14, __pyx_t_15) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2116, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;wt_vec, 0);
  __pyx_v_self-&gt;wt_vec = __pyx_t_16;
  __pyx_t_16.memview = NULL;
  __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2118</span>:             <span class="c"># lower_x, lower_y, lower_z</span></pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2119</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-26 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>}
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2119, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">2120</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2121</span>:             <span class="c"># upper_x, lower_y, lower_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2122</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>}
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((((1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2123</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2124</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2125</span>:             <span class="c"># lower_x, upper_y, lower_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2126</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2126, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2126, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2126, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2126, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2127</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2127, __pyx_L1_error)</span>}
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2127, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2129</span>:             <span class="c"># upper_x, upper_y, lower_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2130</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>}
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((((1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2131</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2131, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2131, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2133</span>:             <span class="c"># lower_x, lower_y, upper_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2134</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2134, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2134, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2134, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2134, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2135</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2135, __pyx_L1_error)</span>}
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2135, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2136</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2137</span>:             <span class="c"># upper_x, lower_y, upper_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2138</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2138, __pyx_L1_error)</span>}
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2138, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2138, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2138, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>((((1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2139</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2139, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2139, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2140</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2141</span>:             <span class="c"># lower_x, upper_y, upper_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2142</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2143</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]),</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2143, __pyx_L1_error)</span>}
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2143, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2145</span>:             <span class="c"># upper_x, upper_y, upper_z</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2146</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">*</span></pre>
<pre class='cython code score-19 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2146, __pyx_L1_error)</span>}
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2146, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2146, __pyx_L1_error)</span>}
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2146, __pyx_L1_error)</span>
  }
/* … */
  __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((((1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_7 * __pyx_v_self-&gt;weight_xyz.strides[0]) )))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_6 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;weight_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;weight_xyz.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 2146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2147</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;weight_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2147, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;weight_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;weight_xyz.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 2147, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2149</span>:         <span class="p">])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2150</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2151</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_generate_index_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_6chromo_6fields_19UniformDensityField__generate_index_vector(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self) {
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_generate_index_vector", 0);
  <span class='trace'>__Pyx_TraceCall</span>("_generate_index_vector", __pyx_f[0], 2151, 0, <span class='error_goto'>__PYX_ERR(0, 2151, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField._generate_index_vector", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2152</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate vector of eight superindices containing a bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2153</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2154</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2155</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2156</span>: <span class="sd">        This is a cleaner implementation, but s about 70% slower:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2157</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2158</span>: <span class="sd">        cdef int j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2159</span>: <span class="sd">        cdef long ind_x, ind_y, ind_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2160</span>: <span class="sd">        for j in range(8):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2161</span>: <span class="sd">            ind_x = ((j % 2) + self.index_xyz[0]) % self.nx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2162</span>: <span class="sd">            ind_y = (((int(floor(j/2))) % 2) + self.index_xyz[1]) % self.ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2163</span>: <span class="sd">            ind_z = (((int(floor(j/4))) % 2) + self.index_xyz[2]) % self.nz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2164</span>: <span class="sd">            self.nbr_inds[j] = inds_to_super_ind(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2165</span>: <span class="sd">                ind_x, ind_y, ind_z, self.nx, self.ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2166</span>: <span class="sd">            )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2167</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2168</span>:         <span class="c"># lower_x, lower_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2169</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_6 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_7 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_2 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>}
  __pyx_t_8 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_5 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_7)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2170</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>}
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2170, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2171</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2173</span>:         <span class="c"># upper_x, lower_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2174</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>}
/* … */
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_6 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_2 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>}
  __pyx_t_8 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_7 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2175</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>}
  __pyx_t_1 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2175, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2176</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2178</span>:         <span class="c"># lower_x, upper_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2179</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2179, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_6 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_7 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_2 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2179, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2179, __pyx_L1_error)</span>}
  __pyx_t_8 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2179, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_5 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_7)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2180</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>}
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2180, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2181</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2182</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2183</span>:         <span class="c"># upper_x, upper_y, lower_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2184</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2184, __pyx_L1_error)</span>}
/* … */
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_6 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_2 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2184, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2184, __pyx_L1_error)</span>}
  __pyx_t_8 = 3;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2184, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_7 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2185</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>}
  __pyx_t_1 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2185, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2186</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2188</span>:         <span class="c"># lower_x, lower_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2189</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_6 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_2 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>}
  __pyx_t_8 = 4;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_5 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_7)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2190</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>}
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2191</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2193</span>:         <span class="c"># upper_x, lower_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2194</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2194, __pyx_L1_error)</span>}
/* … */
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_6 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_5 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_2 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2194, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2194, __pyx_L1_error)</span>}
  __pyx_t_8 = 5;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2194, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_7 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2195</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>}
  __pyx_t_1 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2196</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2198</span>:         <span class="c"># lower_x, upper_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2199</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5 = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) )));
  __pyx_t_6 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_2 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L1_error)</span>}
  __pyx_t_8 = 6;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_5 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_7)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2200</span>:             <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>}
  __pyx_t_1 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>}
  __pyx_t_4 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2201</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2203</span>:         <span class="c"># upper_x, upper_y, upper_z</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2204</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nbr_inds</span><span class="p">[</span><span class="mf">7</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inds_xyz_to_super</span><span class="p">[</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;inds_xyz_to_super.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2204, __pyx_L1_error)</span>}
/* … */
  __pyx_t_7 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_4 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_6 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_3 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_5 = (1 + (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;index_xyz.data + __pyx_t_1 * __pyx_v_self-&gt;index_xyz.strides[0]) ))));
  __pyx_t_2 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_self-&gt;inds_xyz_to_super.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[0])) __pyx_t_2 = 0;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_self-&gt;inds_xyz_to_super.shape[1];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_2 = 1;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[1])) __pyx_t_2 = 1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;inds_xyz_to_super.shape[2];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 2;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;inds_xyz_to_super.shape[2])) __pyx_t_2 = 2;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2204, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;nbr_inds.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2204, __pyx_L1_error)</span>}
  __pyx_t_8 = 7;
  __pyx_t_2 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_self-&gt;nbr_inds.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;nbr_inds.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2204, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_self-&gt;nbr_inds.data + __pyx_t_8 * __pyx_v_self-&gt;nbr_inds.strides[0]) )) = (*((long *) ( /* dim=2 */ ((char *) (((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self-&gt;inds_xyz_to_super.data + __pyx_t_7 * __pyx_v_self-&gt;inds_xyz_to_super.strides[0]) ) + __pyx_t_6 * __pyx_v_self-&gt;inds_xyz_to_super.strides[1]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2205</span>:             <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="p">(</span><span class="mf">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">index_xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-21 '>  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>}
  __pyx_t_4 = 0;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>}
  __pyx_t_3 = 1;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;index_xyz.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>}
  __pyx_t_1 = 2;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;index_xyz.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;index_xyz.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2205, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2206</span>:         <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2207</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2208</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">get_E_binders_and_beads</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>static double __pyx_f_6chromo_6fields_19UniformDensityField_get_E_binders_and_beads(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  double __pyx_v_E_binders_beads;
  double __pyx_v_tot_density;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_n_double_bound;
  PyObject *__pyx_v_binder_info = 0;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_E_binders_and_beads", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_E_binders_and_beads", __pyx_f[0], 2208, 0, <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.get_E_binders_and_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_info);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2209</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2210</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2211</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get total energy of polymer associated with configuration and binders.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2213</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2214</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2215</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2216</span>: <span class="sd">            Polymer for which densities are calculated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2217</span>: <span class="sd">        inds : long[:] by reference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2218</span>: <span class="sd">            Array of bead indices for the entire polymer (to avoid re-computing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2219</span>: <span class="sd">            this).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2220</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2221</span>: <span class="sd">            Number of beads in the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2223</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2224</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2225</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2226</span>: <span class="sd">            Field energy associated with the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2227</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2228</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E_binders_beads</span><span class="p">,</span> <span class="nf">tot_density</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2229</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">n_double_bound</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2230</span>:         <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">binder_info</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2232</span>:         <span class="c"># Count num. nucleosomes bound by reader proteins at both histone tails</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2233</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count_doubly_bound</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">,</span> <span class="n">trial</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span> <span class="n">state_change</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;count_doubly_bound(__pyx_v_self, __pyx_v_poly, __pyx_v_inds, __pyx_v_n_inds, 0, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">2234</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2235</span>:         <span class="n">E_binders_beads</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_binders_beads = 0.0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2236</span>:         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">binder_info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_dict</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>  __pyx_t_1 = 0;
  __pyx_t_2 = __pyx_v_self-&gt;binder_dict; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2236, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_4))||((__pyx_t_4) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_4)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binder_info, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
    __pyx_v_i = __pyx_t_1;
    __pyx_t_1 = (__pyx_t_1 + 1);
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2237</span>:             <span class="c"># Calculate the total density</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2238</span>:             <span class="n">tot_density</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tot_density = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2239</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_self-&gt;n_bins;
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_j = __pyx_t_7;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2240</span>:                 <span class="n">tot_density</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span><span class="o">**</span><span class="mf">2</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2240, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_v_j;
      __pyx_t_9 = (__pyx_v_i + 1);
      __pyx_t_10 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;density.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;density.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2240, __pyx_L1_error)</span>
      }
      __pyx_v_tot_density = (__pyx_v_tot_density + pow((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_8 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_9)) ))), 2.0));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2241</span>:             <span class="c"># Oligomerization</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2242</span>:             <span class="n">E_binders_beads</span> <span class="o">+=</span><span class="w">\</span></pre>
<pre class='cython code score-23 '>    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_binders_beads);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2242, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_4, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2242, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_v_E_binders_beads = __pyx_t_14;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2243</span>:                 <span class="n">binder_info</span><span class="p">[</span><span class="s">&#39;field_energy_prefactor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">tot_density</span></pre>
<pre class='cython code score-19 '>    if (unlikely(__pyx_v_binder_info == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 2243, __pyx_L1_error)</span>
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_binder_info, __pyx_n_s_field_energy_prefactor);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2243, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tot_density);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2243, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2243, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2244</span>:             <span class="c"># Intranucleosome interaction</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2245</span>:             <span class="n">n_double_bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doubly_bound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;doubly_bound.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2245, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;doubly_bound.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;doubly_bound.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2245, __pyx_L1_error)</span>
    }
    __pyx_v_n_double_bound = (*((long *) ( /* dim=0 */ (__pyx_v_self-&gt;doubly_bound.data + __pyx_t_9 * __pyx_v_self-&gt;doubly_bound.strides[0]) )));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2246</span>:             <span class="n">E_binders_beads</span> <span class="o">+=</span><span class="w">\</span></pre>
<pre class='cython code score-23 '>    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_binders_beads);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
/* … */
    __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_14 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2246, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_E_binders_beads = __pyx_t_14;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2247</span>:                 <span class="n">binder_info</span><span class="p">[</span><span class="s">&#39;interaction_energy_intranucleosome&#39;</span><span class="p">]</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-14 '>    if (unlikely(__pyx_v_binder_info == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L1_error)</span>
    }
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_binder_info, __pyx_n_s_interaction_energy_intranucleoso);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
/* … */
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2248</span>:                 <span class="n">n_double_bound</span></pre>
<pre class='cython code score-2 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_double_bound);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2248, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-0">&#xA0;<span class="">2249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2250</span>:         <span class="c"># Nonspecific bead interaction energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2251</span>:         <span class="n">E_binders_beads</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonspecific_interact_E</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_binders_beads = (__pyx_v_E_binders_beads + ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;nonspecific_interact_E(__pyx_v_self, __pyx_v_poly, 0));
</pre><pre class="cython line score-0">&#xA0;<span class="">2252</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2253</span>:         <span class="k">return</span> <span class="n">E_binders_beads</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E_binders_beads;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2254</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2255</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">nonspecific_interact_E</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_27nonspecific_interact_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
static double __pyx_f_6chromo_6fields_19UniformDensityField_nonspecific_interact_E(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, int __pyx_skip_dispatch) {
  double __pyx_v_bead_V;
  double __pyx_v_nonspecific_E;
  double __pyx_v_access_vol;
  __Pyx_memviewslice __pyx_v_vol_fracs = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_i;
  double __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonspecific_interact_E", 0);
  <span class='trace'>__Pyx_TraceCall</span>("nonspecific_interact_E", __pyx_f[0], 2255, 0, <span class='error_goto'>__PYX_ERR(0, 2255, __pyx_L1_error)</span>);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_nonspecific_interact_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2255, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_6fields_19UniformDensityField_27nonspecific_interact_E)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)__pyx_v_poly)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_poly));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2255, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2255, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.UniformDensityField.nonspecific_interact_E", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vol_fracs, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_27nonspecific_interact_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly); /*proto*/
static char __pyx_doc_6chromo_6fields_19UniformDensityField_26nonspecific_interact_E[] = "Get nonspecific interaction energy for the full polymer.\n\n        Notes\n        -----\n        This method assumes that all beads are of the same volume.\n\n        Parameters\n        ----------\n        poly : poly.PolymerBase\n            Polymer affected by the current MC move\n\n        Returns\n        -------\n        double\n            Absolute energy associated with the nonspecific interactions\n            between segments of the polymer chain\n        ";
static PyObject *__pyx_pw_6chromo_6fields_19UniformDensityField_27nonspecific_interact_E(PyObject *__pyx_v_self, PyObject *__pyx_v_poly) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonspecific_interact_E (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_poly), __pyx_ptype_6chromo_8polymers_PolymerBase, 1, "poly", 0))) <span class='error_goto'>__PYX_ERR(0, 2255, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_6fields_19UniformDensityField_26nonspecific_interact_E(((struct __pyx_obj_6chromo_6fields_UniformDensityField *)__pyx_v_self), ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_poly));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_19UniformDensityField_26nonspecific_interact_E(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("nonspecific_interact_E", 0);
  <span class='trace'>__Pyx_TraceCall</span>("nonspecific_interact_E (wrapper)", __pyx_f[0], 2255, 0, <span class='error_goto'>__PYX_ERR(0, 2255, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_6fields_19UniformDensityField_nonspecific_interact_E(__pyx_v_self, __pyx_v_poly, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2255, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.nonspecific_interact_E", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2256</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get nonspecific interaction energy for the full polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2257</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2258</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2259</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2260</span>: <span class="sd">        This method assumes that all beads are of the same volume.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2261</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2262</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2263</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2264</span>: <span class="sd">        poly : poly.PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2265</span>: <span class="sd">            Polymer affected by the current MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2266</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2267</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2268</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2269</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2270</span>: <span class="sd">            Absolute energy associated with the nonspecific interactions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2271</span>: <span class="sd">            between segments of the polymer chain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2272</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2273</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_V</span><span class="p">,</span> <span class="nf">nonspecific_E</span><span class="p">,</span> <span class="nf">access_vol</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2274</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">vol_fracs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2275</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2276</span>:         <span class="n">bead_V</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">vol</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_poly-&gt;beads, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_vol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2276, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bead_V = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2277</span>:         <span class="n">vol_fracs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_volume_fractions</span><span class="p">(</span><span class="n">bead_V</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = ((struct __pyx_vtabstruct_6chromo_6fields_UniformDensityField *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;get_volume_fractions(__pyx_v_self, __pyx_v_bead_V);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 2277, __pyx_L1_error)</span>
  __pyx_v_vol_fracs = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2278</span>:         <span class="n">nonspecific_E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nonspecific_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2279</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_self-&gt;n_bins;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2280</span>:             <span class="n">access_vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">access_vols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_self-&gt;access_vols == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_self-&gt;access_vols, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2280, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_access_vol = __pyx_t_5;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2281</span>:             <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">vol_fracs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_limit</span><span class="p">:</span></pre>
<pre class='cython code score-33 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_2);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_round, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;vf_limit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2281, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_12) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2282</span>:                 <span class="n">nonspecific_E</span> <span class="o">+=</span> <span class="n">E_HUGE</span> <span class="o">*</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2282, __pyx_L1_error)</span>
      }
      __pyx_v_nonspecific_E = (__pyx_v_nonspecific_E + (__pyx_v_6chromo_6fields_E_HUGE * (*((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) )))));
</pre><pre class="cython line score-0">&#xA0;<span class="">2283</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2284</span>:                 <span class="n">nonspecific_E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chi</span> <span class="o">*</span> <span class="p">(</span><span class="n">access_vol</span> <span class="o">/</span> <span class="n">bead_V</span><span class="p">)</span> <span class="o">*</span><span class="w">\</span></pre>
<pre class='cython code score-5 '>    /*else*/ {
      if (unlikely(__pyx_v_bead_V == 0)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        <span class='error_goto'>__PYX_ERR(0, 2284, __pyx_L1_error)</span>
      }
/* … */
      __pyx_v_nonspecific_E = (__pyx_v_nonspecific_E + (((__pyx_v_self-&gt;chi * (__pyx_v_access_vol / __pyx_v_bead_V)) * (*((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_10 * __pyx_v_vol_fracs.strides[0]) )))) * (1.0 - (*((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_13 * __pyx_v_vol_fracs.strides[0]) ))))));
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2285</span>:                                  <span class="n">vol_fracs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">vol_fracs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-4 '>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2285, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_11 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_vol_fracs.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2285, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2286</span>:         <span class="k">return</span> <span class="n">nonspecific_E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_nonspecific_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2287</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2288</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">get_volume_fractions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span> <span class="n">bead_V</span><span class="p">):</span></pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_volume_fractions(struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, double __pyx_v_bead_V) {
  long __pyx_v_j;
  __Pyx_memviewslice __pyx_v_vol_fracs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_volume_fractions", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_volume_fractions", __pyx_f[0], 2288, 0, <span class='error_goto'>__PYX_ERR(0, 2288, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_volume_fractions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vol_fracs, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2289</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate all volume fractions of beads in bins.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2290</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2291</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2292</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2293</span>: <span class="sd">        We can obtain a count of beads in a voxel from the density of the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2294</span>: <span class="sd">        multiplied by accessible volume. Using this count of beads in the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2295</span>: <span class="sd">        and the volume of each bead, we can get the total volume of the beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2296</span>: <span class="sd">        in the voxel. Then, dividing the total volume of the beads by the total</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2297</span>: <span class="sd">        volume of the voxel gives us the volume fraction of the beads in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2298</span>: <span class="sd">        voxel. This is equivalent to multiplying the density of the beads by the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2299</span>: <span class="sd">        volume of each bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2301</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2302</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2303</span>: <span class="sd">        bead_V : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2304</span>: <span class="sd">            Volume of an individual bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2306</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2307</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2308</span>: <span class="sd">        double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2309</span>: <span class="sd">            Array of bead volume fractions for each bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2310</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2311</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">j</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2312</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">vol_fracs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_bins);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2312, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_vol_fracs = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2313</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;n_bins;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2314</span>:             <span class="n">vol_fracs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">bead_V</span></pre>
<pre class='cython code score-9 '>    if (unlikely(!__pyx_v_self-&gt;density.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_j;
    __pyx_t_10 = 0;
    __pyx_t_11 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;density.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;density.shape[0])) __pyx_t_11 = 0;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;density.shape[1];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 1;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;density.shape[1])) __pyx_t_11 = 1;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>
    }
    __pyx_t_12 = __pyx_v_j;
    __pyx_t_11 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_vol_fracs.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_vol_fracs.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_vol_fracs.data + __pyx_t_12 * __pyx_v_vol_fracs.strides[0]) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;density.data + __pyx_t_9 * __pyx_v_self-&gt;density.strides[0]) )) + __pyx_t_10)) ))) * __pyx_v_bead_V);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2315</span>:         <span class="k">return</span> <span class="n">vol_fracs</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_vol_fracs, 0);
  __pyx_r = __pyx_v_vol_fracs;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2316</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2317</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">get_coordinates_at_inds</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_coordinates_at_inds(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, __Pyx_memviewslice &amp;__pyx_v_r, __Pyx_memviewslice &amp;__pyx_v_inds, long __pyx_v_n_inds) {
  long __pyx_v_i;
  long __pyx_v_j;
  __Pyx_memviewslice __pyx_v_r_new = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_coordinates_at_inds", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_coordinates_at_inds", __pyx_f[0], 2317, 0, <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_coordinates_at_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_new, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2318</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span><span class="o">&amp;</span> <span class="n">r</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span><span class="o">&amp;</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2319</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2320</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2321</span>: <span class="sd">        Get position of specified beads from current polymer configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2323</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2324</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2325</span>: <span class="sd">        r : array_like (N, 3) of double by reference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2326</span>: <span class="sd">            x, y, z coordinates of every bead in the polymer where rows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2327</span>: <span class="sd">            coorespond to individual beads and columns correspond to </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2328</span>: <span class="sd">            Cartesian (x, y, z) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2329</span>: <span class="sd">        inds : array_like (M,) of long by reference</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2330</span>: <span class="sd">            Indices of M beads involved in the move, where `M=n_inds`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2331</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2332</span>: <span class="sd">            Number of bead indices affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2334</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2335</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2336</span>: <span class="sd">        double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2337</span>: <span class="sd">            Coordinates for specified indicies from current polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2338</span>: <span class="sd">            configuration where rows coorespond to individual beads and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2339</span>: <span class="sd">            columns correspond to Cartesian (x, y, z) coordinates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2340</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2341</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2342</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r_new</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2343</span>:         <span class="n">r_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_inds</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_r_new = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2344</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_n_inds;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2345</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_9 = 0; __pyx_t_9 &lt; 3; __pyx_t_9+=1) {
      __pyx_v_j = __pyx_t_9;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2346</span>:                 <span class="n">r_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>      __pyx_t_10 = __pyx_v_i;
      __pyx_t_11 = -1;
      if (__pyx_t_10 &lt; 0) {
        __pyx_t_10 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
      }
      __pyx_t_12 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_10 * __pyx_v_inds.strides[0]) )));
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_11 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_r.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_r.shape[0])) __pyx_t_11 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_r.shape[1];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_11 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_r.shape[1])) __pyx_t_11 = 1;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
      }
      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_11 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_r_new.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_11 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_r_new.shape[0])) __pyx_t_11 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_r_new.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_11 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_r_new.shape[1])) __pyx_t_11 = 1;
      if (unlikely(__pyx_t_11 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
        <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r_new.data + __pyx_t_14 * __pyx_v_r_new.strides[0]) )) + __pyx_t_15)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_12 * __pyx_v_r.strides[0]) )) + __pyx_t_13)) )));
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2347</span>:         <span class="k">return</span> <span class="n">r_new</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_r_new, 0);
  __pyx_r = __pyx_v_r_new;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2348</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2349</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">get_states_at_inds</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>static __Pyx_memviewslice __pyx_f_6chromo_6fields_19UniformDensityField_get_states_at_inds(CYTHON_UNUSED struct __pyx_obj_6chromo_6fields_UniformDensityField *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  long __pyx_v_i;
  long __pyx_v_j;
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_states_at_inds", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_states_at_inds", __pyx_f[0], 2349, 0, <span class='error_goto'>__PYX_ERR(0, 2349, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.UniformDensityField.get_states_at_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2350</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2351</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2352</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get binding states of specified beads from current polymer config.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2354</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2355</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2356</span>: <span class="sd">        poly : poly,PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2357</span>: <span class="sd">            Polymer object undergoing transformation in field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2358</span>: <span class="sd">        inds : array_like (N, ) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2359</span>: <span class="sd">            Indices of N beads involved in the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2360</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2361</span>: <span class="sd">            Number of bead indices affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2363</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2364</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2365</span>: <span class="sd">        long[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2366</span>: <span class="sd">            Binding states on polymer at specified bead indices, where rows</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2367</span>: <span class="sd">            identify individual beads and columns correspond to binding states</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2368</span>: <span class="sd">            for each reader protein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2369</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2370</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2371</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span></pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2372</span>:         <span class="n">states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_inds</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2372, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2372, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_states = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2373</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_n_inds;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2374</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_poly-&gt;num_binders;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2375</span>:                 <span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>      if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2375, __pyx_L1_error)</span>}
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_inds.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2375, __pyx_L1_error)</span>
      }
      __pyx_t_14 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_12 * __pyx_v_inds.strides[0]) )));
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_poly-&gt;states.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_poly-&gt;states.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2375, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_states.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_states.shape[0])) __pyx_t_13 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_states.shape[1];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_13 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_states.shape[1])) __pyx_t_13 = 1;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 2375, __pyx_L1_error)</span>
      }
      *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_states.data + __pyx_t_16 * __pyx_v_states.strides[0]) )) + __pyx_t_17)) )) = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_14 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_15)) )));
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2376</span>:         <span class="k">return</span> <span class="n">states</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 0);
  __pyx_r = __pyx_v_states;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2377</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2378</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2379</span>: <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">inds_to_super_ind</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static long __pyx_f_6chromo_6fields_inds_to_super_ind(long __pyx_v_ind_x, long __pyx_v_ind_y, long __pyx_v_ind_z, long __pyx_v_nx, long __pyx_v_ny) {
  long __pyx_v_super_ind;
  long __pyx_r;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("inds_to_super_ind", 0);
  <span class='trace'>__Pyx_TraceCall</span>("inds_to_super_ind", __pyx_f[0], 2379, 0, <span class='error_goto'>__PYX_ERR(0, 2379, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.fields.inds_to_super_ind", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2380</span>:     <span class="nb">long</span> <span class="n">ind_x</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind_y</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind_z</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ny</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2381</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2382</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the super index of a voxel based on three dimensional indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2384</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2385</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2386</span>: <span class="sd">    Given the x, y, and z voxel indices and the number of voxels in the x and y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2387</span>: <span class="sd">    dimensions, calculate the super-index of a bin.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2388</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2389</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2390</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2391</span>: <span class="sd">    ind_x, ind_y, ind_z : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2392</span>: <span class="sd">        Voxel index positions in the x, y, and z dimensions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2393</span>: <span class="sd">    nx, ny : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2394</span>: <span class="sd">        Number of bins in the x and y directions of Cartesian space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2396</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2397</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2398</span>: <span class="sd">    long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2399</span>: <span class="sd">        Super-index position of the voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2400</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2401</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">super_ind</span> <span class="o">=</span> <span class="n">ind_x</span> <span class="o">+</span> <span class="n">ind_y</span> <span class="o">*</span> <span class="n">nx</span> <span class="o">+</span> <span class="n">ind_z</span> <span class="o">*</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span></pre>
<pre class='cython code score-0 '>  __pyx_v_super_ind = ((__pyx_v_ind_x + (__pyx_v_ind_y * __pyx_v_nx)) + ((__pyx_v_ind_z * __pyx_v_nx) * __pyx_v_ny));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2402</span>:     <span class="k">return</span> <span class="n">super_ind</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_super_ind;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2404</span>: </pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2405</span>: <span class="k">cpdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">super_ind_to_inds</span><span class="p">(</span><span class="nb">long</span> <span class="n">super_ind</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ny</span><span class="p">):</span></pre>
<pre class='cython code score-66 '>static PyObject *__pyx_pw_6chromo_6fields_1super_ind_to_inds(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6chromo_6fields_super_ind_to_inds(long __pyx_v_super_ind, long __pyx_v_nx, long __pyx_v_ny, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_xyz_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("super_ind_to_inds", 0);
  <span class='trace'>__Pyx_TraceCall</span>("super_ind_to_inds", __pyx_f[0], 2405, 0, <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.super_ind_to_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz_inds, 1);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_1super_ind_to_inds(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_super_ind_to_inds[] = "Calculate the three-dimensional indices from a super-index.\n    \n    Notes\n    -----\n    Given the super-index of a voxel and the number of voxels in the x and y\n    directions, calculate the three-dimensional indices of the voxel.\n\n    Parameters\n    ----------\n    super_ind : long\n        Super-index of a voxel\n    nx : long\n        Number of bins in the x direction\n    ny : long\n        Number of bins in the y direction\n\n    Returns\n    -------\n    long[:]\n        Indices of bin in x, y, and z directions\n    ";
static PyObject *__pyx_pw_6chromo_6fields_1super_ind_to_inds(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_super_ind;
  long __pyx_v_nx;
  long __pyx_v_ny;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("super_ind_to_inds (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_super_ind,&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_super_ind)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("super_ind_to_inds", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("super_ind_to_inds", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "super_ind_to_inds") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_super_ind = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_super_ind == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
    __pyx_v_nx = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_nx == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
    __pyx_v_ny = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_ny == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("super_ind_to_inds", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.super_ind_to_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_super_ind_to_inds(__pyx_self, __pyx_v_super_ind, __pyx_v_nx, __pyx_v_ny);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_super_ind_to_inds(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_super_ind, long __pyx_v_nx, long __pyx_v_ny) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("super_ind_to_inds", 0);
  <span class='trace'>__Pyx_TraceCall</span>("super_ind_to_inds (wrapper)", __pyx_f[0], 2405, 0, <span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_6fields_super_ind_to_inds(__pyx_v_super_ind, __pyx_v_nx, __pyx_v_ny, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 2405, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2405, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.super_ind_to_inds", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2406</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the three-dimensional indices from a super-index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2407</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2408</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2409</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2410</span>: <span class="sd">    Given the super-index of a voxel and the number of voxels in the x and y</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2411</span>: <span class="sd">    directions, calculate the three-dimensional indices of the voxel.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2413</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2414</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2415</span>: <span class="sd">    super_ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2416</span>: <span class="sd">        Super-index of a voxel</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2417</span>: <span class="sd">    nx : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2418</span>: <span class="sd">        Number of bins in the x direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2419</span>: <span class="sd">    ny : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2420</span>: <span class="sd">        Number of bins in the y direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2422</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2423</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2424</span>: <span class="sd">    long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2425</span>: <span class="sd">        Indices of bin in x, y, and z directions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2426</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2427</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">xyz_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2427, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2427, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2427, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2427, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2427, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 2427, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_xyz_inds = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2428</span>:     <span class="n">xyz_inds</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">super_ind</span> <span class="o">/</span> <span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">))</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (__pyx_v_nx * __pyx_v_ny);
  if (unlikely(__pyx_t_5 == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L1_error)</span>
  }
  else if (sizeof(long) == sizeof(long) &amp;&amp; (!(((long)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_t_5 == (long)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_super_ind))) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__Pyx_div_long(__pyx_v_super_ind, __pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = 2;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_7 * __pyx_v_xyz_inds.strides[0]) )) = __pyx_t_5;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2429</span>:     <span class="n">xyz_inds</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">super_ind</span> <span class="o">-</span> <span class="n">xyz_inds</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">)</span> <span class="o">/</span> <span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-44 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_floor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = 2;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  }
  __pyx_t_5 = (__pyx_v_super_ind - (((*((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_7 * __pyx_v_xyz_inds.strides[0]) ))) * __pyx_v_nx) * __pyx_v_ny));
  if (unlikely(__pyx_v_nx == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
    <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  }
  else if (sizeof(long) == sizeof(long) &amp;&amp; (!(((long)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_nx == (long)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_5))) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
    <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__Pyx_div_long(__pyx_t_5, __pyx_v_nx));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = 1;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_7 * __pyx_v_xyz_inds.strides[0]) )) = __pyx_t_5;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2430</span>:     <span class="n">xyz_inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">super_ind</span> <span class="o">-</span> <span class="p">(</span><span class="n">xyz_inds</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">)</span> <span class="o">+</span> <span class="n">xyz_inds</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">nx</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>  __pyx_t_7 = 2;
  __pyx_t_8 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L1_error)</span>
  }
  __pyx_t_9 = 1;
  __pyx_t_8 = -1;
  if (__pyx_t_9 &lt; 0) {
    __pyx_t_9 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L1_error)</span>
  }
  __pyx_t_10 = 0;
  __pyx_t_8 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_xyz_inds.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_8 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_xyz_inds.shape[0])) __pyx_t_8 = 0;
  if (unlikely(__pyx_t_8 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
    <span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L1_error)</span>
  }
  *((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_10 * __pyx_v_xyz_inds.strides[0]) )) = (__pyx_v_super_ind - (((*((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_7 * __pyx_v_xyz_inds.strides[0]) ))) * (__pyx_v_nx * __pyx_v_ny)) + ((*((long *) ( /* dim=0 */ (__pyx_v_xyz_inds.data + __pyx_t_9 * __pyx_v_xyz_inds.strides[0]) ))) * __pyx_v_nx)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2431</span>:     <span class="k">return</span> <span class="n">xyz_inds</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_xyz_inds, 0);
  __pyx_r = __pyx_v_xyz_inds;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2433</span>: </pre>
<pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2434</span>: <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">assign_beads_to_bins</span><span class="p">(</span></pre>
<pre class='cython code score-131 '>static PyObject *__pyx_pw_6chromo_6fields_3assign_beads_to_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6chromo_6fields_assign_beads_to_bins(__Pyx_memviewslice __pyx_v_r_poly, long __pyx_v_n_inds, long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz, double __pyx_v_x_width, double __pyx_v_y_width, double __pyx_v_z_width, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_index_x;
  long __pyx_v_index_y;
  long __pyx_v_index_z;
  long __pyx_v_n_bins;
  PyObject *__pyx_v_bin_map = 0;
  __Pyx_memviewslice __pyx_v_x_poly_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y_poly_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_z_poly_box = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_x_poly_box_minus;
  double __pyx_v_y_poly_box_minus;
  double __pyx_v_z_poly_box_minus;
  double __pyx_v_dx;
  double __pyx_v_dy;
  double __pyx_v_dz;
  long __pyx_v_index_x0y0z0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assign_beads_to_bins", 0);
  <span class='trace'>__Pyx_TraceCall</span>("assign_beads_to_bins", __pyx_f[0], 2434, 0, <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.assign_beads_to_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_map);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_poly_box, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y_poly_box, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_z_poly_box, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_3assign_beads_to_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_2assign_beads_to_bins[] = "Create a mapping from bin indices to list of associated beads.\n    \n    Parameters\n    ----------\n    r_poly : double[:, ::1]\n        Array of bead positions\n    n_inds : long\n        Number of beads - must be equivalent in length to r_poly\n    nx : long\n        Number of bins in the x direction\n    ny : long\n        Number of bins in the y direction\n    nz : long\n        Number of bins in the z direction\n    x_width : double\n        Widths of space in the x direction\n    y_width : double\n        Widths of space in the y direction\n    z_width : double\n        Widths of space in the z direction\n\n    Returns\n    -------\n    dict\n        Mapping of bin indices to associated beads, where keys indicate\n        the bin indices and values are lists of beads contained in the bin\n    ";
static PyObject *__pyx_pw_6chromo_6fields_3assign_beads_to_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_r_poly = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_n_inds;
  long __pyx_v_nx;
  long __pyx_v_ny;
  long __pyx_v_nz;
  double __pyx_v_x_width;
  double __pyx_v_y_width;
  double __pyx_v_z_width;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assign_beads_to_bins (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_r_poly,&amp;__pyx_n_s_n_inds,&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_nz,&amp;__pyx_n_s_x_width,&amp;__pyx_n_s_y_width,&amp;__pyx_n_s_z_width,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r_poly)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 1); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 2); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 3); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 4); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_x_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 5); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 6); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_z_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, 7); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "assign_beads_to_bins") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_r_poly = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r_poly.memview)) __PYX_ERR(0, 2435, __pyx_L3_error)</span>
    __pyx_v_n_inds = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_n_inds == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L3_error)</span>
    __pyx_v_nx = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_nx == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L3_error)</span>
    __pyx_v_ny = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[3]); if (unlikely((__pyx_v_ny == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L3_error)</span>
    __pyx_v_nz = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[4]); if (unlikely((__pyx_v_nz == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L3_error)</span>
    __pyx_v_x_width = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_x_width == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2436, __pyx_L3_error)</span>
    __pyx_v_y_width = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_y_width == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2436, __pyx_L3_error)</span>
    __pyx_v_z_width = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]); if (unlikely((__pyx_v_z_width == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2436, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("assign_beads_to_bins", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.assign_beads_to_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_2assign_beads_to_bins(__pyx_self, __pyx_v_r_poly, __pyx_v_n_inds, __pyx_v_nx, __pyx_v_ny, __pyx_v_nz, __pyx_v_x_width, __pyx_v_y_width, __pyx_v_z_width);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_2assign_beads_to_bins(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_r_poly, long __pyx_v_n_inds, long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz, double __pyx_v_x_width, double __pyx_v_y_width, double __pyx_v_z_width) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assign_beads_to_bins", 0);
  <span class='trace'>__Pyx_TraceCall</span>("assign_beads_to_bins (wrapper)", __pyx_f[0], 2434, 0, <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_r_poly.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("r_poly"); <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span> }
  __pyx_t_1 = __pyx_f_6chromo_6fields_assign_beads_to_bins(__pyx_v_r_poly, __pyx_v_n_inds, __pyx_v_nx, __pyx_v_ny, __pyx_v_nz, __pyx_v_x_width, __pyx_v_y_width, __pyx_v_z_width, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2434, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.assign_beads_to_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_poly, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2435</span>:     <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r_poly</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ny</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nz</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2436</span>:     <span class="n">double</span> <span class="n">x_width</span><span class="p">,</span> <span class="n">double</span> <span class="n">y_width</span><span class="p">,</span> <span class="n">double</span> <span class="n">z_width</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2437</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2438</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a mapping from bin indices to list of associated beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2439</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2440</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2441</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2442</span>: <span class="sd">    r_poly : double[:, ::1]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2443</span>: <span class="sd">        Array of bead positions</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2444</span>: <span class="sd">    n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2445</span>: <span class="sd">        Number of beads - must be equivalent in length to r_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2446</span>: <span class="sd">    nx : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2447</span>: <span class="sd">        Number of bins in the x direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2448</span>: <span class="sd">    ny : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2449</span>: <span class="sd">        Number of bins in the y direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2450</span>: <span class="sd">    nz : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2451</span>: <span class="sd">        Number of bins in the z direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2452</span>: <span class="sd">    x_width : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2453</span>: <span class="sd">        Widths of space in the x direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2454</span>: <span class="sd">    y_width : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2455</span>: <span class="sd">        Widths of space in the y direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2456</span>: <span class="sd">    z_width : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2457</span>: <span class="sd">        Widths of space in the z direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2459</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2460</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2461</span>: <span class="sd">    dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2462</span>: <span class="sd">        Mapping of bin indices to associated beads, where keys indicate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2463</span>: <span class="sd">        the bin indices and values are lists of beads contained in the bin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2464</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2465</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">index_x</span><span class="p">,</span> <span class="nf">index_y</span><span class="p">,</span> <span class="nf">index_z</span><span class="p">,</span> <span class="nf">n_bins</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2466</span>:     <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">bin_map</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_bin_map = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2467</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_i</span><span class="p">,</span> <span class="n">x_poly_box</span><span class="p">,</span> <span class="n">y_poly_box</span><span class="p">,</span> <span class="n">z_poly_box</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2468</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">x_poly_box_minus</span><span class="p">,</span> <span class="nf">y_poly_box_minus</span><span class="p">,</span> <span class="nf">z_poly_box_minus</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2469</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dx</span><span class="p">,</span> <span class="nf">dy</span><span class="p">,</span> <span class="nf">dz</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2470</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2471</span>:     <span class="n">x_poly_box</span> <span class="o">=</span> <span class="n">r_poly</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_r_poly.data;
  __pyx_t_2.memview = __pyx_v_r_poly.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_r_poly.shape[0];
__pyx_t_2.strides[0] = __pyx_v_r_poly.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_r_poly.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_r_poly.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 2471, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 2471, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_v_x_poly_box = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2472</span>:     <span class="n">y_poly_box</span> <span class="o">=</span> <span class="n">r_poly</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_r_poly.data;
  __pyx_t_2.memview = __pyx_v_r_poly.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_r_poly.shape[0];
__pyx_t_2.strides[0] = __pyx_v_r_poly.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_r_poly.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_r_poly.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 2472, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 2472, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_v_y_poly_box = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2473</span>:     <span class="n">z_poly_box</span> <span class="o">=</span> <span class="n">r_poly</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2.data = __pyx_v_r_poly.data;
  __pyx_t_2.memview = __pyx_v_r_poly.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  __pyx_t_2.shape[0] = __pyx_v_r_poly.shape[0];
__pyx_t_2.strides[0] = __pyx_v_r_poly.strides[0];
    __pyx_t_2.suboffsets[0] = -1;

{
    Py_ssize_t __pyx_tmp_idx = 2;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_r_poly.shape[1];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_r_poly.strides[1];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 1)");
            <span class='error_goto'>__PYX_ERR(0, 2473, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 2473, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __pyx_v_z_poly_box = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">2474</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2475</span>:     <span class="n">dx</span> <span class="o">=</span> <span class="n">x_width</span> <span class="o">/</span> <span class="n">nx</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_nx == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 2475, __pyx_L1_error)</span>
  }
  __pyx_v_dx = (__pyx_v_x_width / __pyx_v_nx);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2476</span>:     <span class="n">dy</span> <span class="o">=</span> <span class="n">y_width</span> <span class="o">/</span> <span class="n">ny</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_ny == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 2476, __pyx_L1_error)</span>
  }
  __pyx_v_dy = (__pyx_v_y_width / __pyx_v_ny);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2477</span>:     <span class="n">dz</span> <span class="o">=</span> <span class="n">z_width</span> <span class="o">/</span> <span class="n">nz</span></pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_nz == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 2477, __pyx_L1_error)</span>
  }
  __pyx_v_dz = (__pyx_v_z_width / __pyx_v_nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">2478</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2479</span>:     <span class="n">n_bins</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">nz</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_bins = ((__pyx_v_nx * __pyx_v_ny) * __pyx_v_nz);
</pre><pre class="cython line score-0">&#xA0;<span class="">2480</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2481</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_n_bins;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2482</span>:         <span class="n">bin_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2482, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2482, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_bin_map, __pyx_t_7, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2482, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2483</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2484</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_n_inds;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2485</span>:         <span class="n">x_poly_box_minus</span> <span class="o">=</span> <span class="n">floor</span><span class="p">((</span><span class="n">r_poly</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 0;
    __pyx_t_10 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_r_poly.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_r_poly.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_r_poly.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_r_poly.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2485, __pyx_L1_error)</span>
    }
    __pyx_t_11 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r_poly.data + __pyx_t_8 * __pyx_v_r_poly.strides[0]) )) + __pyx_t_9)) ))) - (0.5 * __pyx_v_dx));
    if (unlikely(__pyx_v_x_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2485, __pyx_L1_error)</span>
    }
    __pyx_v_x_poly_box_minus = floor((__pyx_t_11 / __pyx_v_x_width));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2486</span>:         <span class="n">x_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">x_width</span> <span class="o">*</span> <span class="n">x_poly_box_minus</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_x_poly_box.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_x_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2486, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_x_poly_box.data + __pyx_t_9 * __pyx_v_x_poly_box.strides[0]) )) -= ((0.5 * __pyx_v_dx) + (__pyx_v_x_width * __pyx_v_x_poly_box_minus));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2487</span>:         <span class="n">y_poly_box_minus</span> <span class="o">=</span> <span class="n">floor</span><span class="p">((</span><span class="n">r_poly</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_8 = 1;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_r_poly.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_r_poly.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_r_poly.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_r_poly.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2487, __pyx_L1_error)</span>
    }
    __pyx_t_11 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r_poly.data + __pyx_t_9 * __pyx_v_r_poly.strides[0]) )) + __pyx_t_8)) ))) - (0.5 * __pyx_v_dy));
    if (unlikely(__pyx_v_y_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2487, __pyx_L1_error)</span>
    }
    __pyx_v_y_poly_box_minus = floor((__pyx_t_11 / __pyx_v_y_width));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2488</span>:         <span class="n">y_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">y_width</span> <span class="o">*</span> <span class="n">y_poly_box_minus</span></pre>
<pre class='cython code score-2 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_y_poly_box.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_y_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2488, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_y_poly_box.data + __pyx_t_8 * __pyx_v_y_poly_box.strides[0]) )) -= ((0.5 * __pyx_v_dy) + (__pyx_v_y_width * __pyx_v_y_poly_box_minus));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2489</span>:         <span class="n">z_poly_box_minus</span> <span class="o">=</span> <span class="n">floor</span><span class="p">((</span><span class="n">r_poly</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)</span> <span class="o">/</span> <span class="n">z_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 2;
    __pyx_t_10 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_r_poly.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_r_poly.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_r_poly.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_r_poly.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>
    }
    __pyx_t_11 = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r_poly.data + __pyx_t_8 * __pyx_v_r_poly.strides[0]) )) + __pyx_t_9)) ))) - (0.5 * __pyx_v_dz));
    if (unlikely(__pyx_v_z_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>
    }
    __pyx_v_z_poly_box_minus = floor((__pyx_t_11 / __pyx_v_z_width));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2490</span>:         <span class="n">z_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span> <span class="o">+</span> <span class="n">z_width</span> <span class="o">*</span> <span class="n">z_poly_box_minus</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_z_poly_box.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_z_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_z_poly_box.data + __pyx_t_9 * __pyx_v_z_poly_box.strides[0]) )) -= ((0.5 * __pyx_v_dz) + (__pyx_v_z_width * __pyx_v_z_poly_box_minus));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2491</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2492</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_n_inds;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2493</span>:         <span class="n">index_x</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">x_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">x_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_x_poly_box.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_x_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2493, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (__pyx_v_nx * (*((double *) ( /* dim=0 */ (__pyx_v_x_poly_box.data + __pyx_t_9 * __pyx_v_x_poly_box.strides[0]) ))));
    if (unlikely(__pyx_v_x_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2493, __pyx_L1_error)</span>
    }
    __pyx_v_index_x = ((long)floor((__pyx_t_11 / __pyx_v_x_width)));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2494</span>:         <span class="n">index_y</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">(</span><span class="n">ny</span> <span class="o">*</span> <span class="n">y_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">y_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_y_poly_box.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_y_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (__pyx_v_ny * (*((double *) ( /* dim=0 */ (__pyx_v_y_poly_box.data + __pyx_t_9 * __pyx_v_y_poly_box.strides[0]) ))));
    if (unlikely(__pyx_v_y_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>
    }
    __pyx_v_index_y = ((long)floor((__pyx_t_11 / __pyx_v_y_width)));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2495</span>:         <span class="n">index_z</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">floor</span><span class="p">(</span><span class="n">nz</span> <span class="o">*</span> <span class="n">z_poly_box</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">z_width</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_z_poly_box.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_z_poly_box.shape[0])) __pyx_t_10 = 0;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2495, __pyx_L1_error)</span>
    }
    __pyx_t_11 = (__pyx_v_nz * (*((double *) ( /* dim=0 */ (__pyx_v_z_poly_box.data + __pyx_t_9 * __pyx_v_z_poly_box.strides[0]) ))));
    if (unlikely(__pyx_v_z_width == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2495, __pyx_L1_error)</span>
    }
    __pyx_v_index_z = ((long)floor((__pyx_t_11 / __pyx_v_z_width)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2496</span>:         <span class="n">index_x0y0z0</span> <span class="o">=</span> <span class="n">index_x</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">index_y</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">index_z</span></pre>
<pre class='cython code score-0 '>    __pyx_v_index_x0y0z0 = ((__pyx_v_index_x + (__pyx_v_nx * __pyx_v_index_y)) + ((__pyx_v_nx * __pyx_v_ny) * __pyx_v_index_z));
</pre><pre class="cython line score-0">&#xA0;<span class="">2497</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2498</span>:         <span class="n">bin_map</span><span class="p">[</span><span class="n">index_x0y0z0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_index_x0y0z0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_bin_map, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Append</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2499</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2500</span>:     <span class="k">return</span> <span class="n">bin_map</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bin_map);
  __pyx_r = __pyx_v_bin_map;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2501</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2502</span>: </pre>
<pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2503</span>: <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">get_neighboring_bins</span><span class="p">(</span><span class="nb">long</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ny</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nz</span><span class="p">):</span></pre>
<pre class='cython code score-60 '>static PyObject *__pyx_pw_6chromo_6fields_5get_neighboring_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6chromo_6fields_get_neighboring_bins(long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_v_num_bins;
  long __pyx_v_i;
  PyObject *__pyx_v_neighbors = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighboring_bins", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_neighboring_bins", __pyx_f[0], 2503, 0, <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighboring_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_neighbors);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_5get_neighboring_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_4get_neighboring_bins[] = "Generate map of bin indices to all immediately neighboring bin indices.\n\n    Parameters\n    ----------\n    nx : long\n        Number of bins in the x direction\n    ny : long\n        Number of bins in the y direction\n    nz : long\n        Number of bins in the z direction\n\n    Returns\n    -------\n    Dict[long, np.ndarray(ndims=1, dtype=long)]\n        Dictionary where keys indicate bin indices and values provide a list of\n        all immediately neighboring bin indices, including the key.\n    ";
static PyObject *__pyx_pw_6chromo_6fields_5get_neighboring_bins(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_nx;
  long __pyx_v_ny;
  long __pyx_v_nz;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighboring_bins (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_nz,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighboring_bins", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighboring_bins", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_neighboring_bins") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_nx = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_nx == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
    __pyx_v_ny = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_ny == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
    __pyx_v_nz = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_nz == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighboring_bins", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighboring_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_4get_neighboring_bins(__pyx_self, __pyx_v_nx, __pyx_v_ny, __pyx_v_nz);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_4get_neighboring_bins(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighboring_bins", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_neighboring_bins (wrapper)", __pyx_f[0], 2503, 0, <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_6fields_get_neighboring_bins(__pyx_v_nx, __pyx_v_ny, __pyx_v_nz, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2503, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighboring_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2504</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate map of bin indices to all immediately neighboring bin indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2506</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2507</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2508</span>: <span class="sd">    nx : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2509</span>: <span class="sd">        Number of bins in the x direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2510</span>: <span class="sd">    ny : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2511</span>: <span class="sd">        Number of bins in the y direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2512</span>: <span class="sd">    nz : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2513</span>: <span class="sd">        Number of bins in the z direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2515</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2516</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2517</span>: <span class="sd">    Dict[long, np.ndarray(ndims=1, dtype=long)]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2518</span>: <span class="sd">        Dictionary where keys indicate bin indices and values provide a list of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2519</span>: <span class="sd">        all immediately neighboring bin indices, including the key.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2520</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2521</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">num_bins</span><span class="p">,</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2522</span>:     <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">neighbors</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2523</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2524</span>:     <span class="n">num_bins</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">nz</span></pre>
<pre class='cython code score-0 '>  __pyx_v_num_bins = ((__pyx_v_nx * __pyx_v_ny) * __pyx_v_nz);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2525</span>:     <span class="n">neighbors</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2525, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_neighbors = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2526</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_bins</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_num_bins;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2527</span>:         <span class="n">neighbors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_neighbors_at_ind</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">num_bins</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>    __pyx_t_5 = __pyx_f_6chromo_6fields_get_neighbors_at_ind(__pyx_v_nx, __pyx_v_ny, __pyx_v_nz, __pyx_v_i, __pyx_v_num_bins, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2527, __pyx_L1_error)</span>
    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2527, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_neighbors, __pyx_t_6, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2527, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2528</span>:     <span class="k">return</span> <span class="n">neighbors</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_neighbors);
  __pyx_r = __pyx_v_neighbors;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2529</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2530</span>: </pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2531</span>: <span class="k">cpdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">get_neighbors_at_ind</span><span class="p">(</span></pre>
<pre class='cython code score-105 '>static PyObject *__pyx_pw_6chromo_6fields_7get_neighbors_at_ind(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static __Pyx_memviewslice __pyx_f_6chromo_6fields_get_neighbors_at_ind(long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz, long __pyx_v_ind, CYTHON_UNUSED long __pyx_v_num_bins, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_nbr_bins_flat = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_xyz = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_v_z = NULL;
  PyObject *__pyx_v_nbr_bins = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_dy = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_dz = NULL;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighbors_at_ind", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_neighbors_at_ind", __pyx_f[0], 2531, 0, <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighbors_at_ind", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nbr_bins_flat, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xyz);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nbr_bins);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dz);
  <span class='trace'>__Pyx_TraceReturn</span>(Py_None, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_7get_neighbors_at_ind(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_6get_neighbors_at_ind[] = "Identify the bin indices immediately neighboring a specific bin index.\n\n    Parameters\n    ----------\n    nx : long\n        Number of bins in the x direction\n    ny : long\n        Number of bins in the y direction\n    nz : long\n        Number of bins in the z direction\n    ind : long\n        Super-index of bin for which neighbors are desired\n    num_bins : long\n        Number of bins contained  in the field\n    \n    Returns\n    -------\n    np.ndarray(ndims=1, dtype=long)\n        Array of nine bin super-indices immediately neighboring and containing\n        the bin specified by `ind`\n    ";
static PyObject *__pyx_pw_6chromo_6fields_7get_neighbors_at_ind(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_nx;
  long __pyx_v_ny;
  long __pyx_v_nz;
  long __pyx_v_ind;
  long __pyx_v_num_bins;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighbors_at_ind (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nx,&amp;__pyx_n_s_ny,&amp;__pyx_n_s_nz,&amp;__pyx_n_s_ind,&amp;__pyx_n_s_num_bins,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nx)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ny)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighbors_at_ind", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighbors_at_ind", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ind)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighbors_at_ind", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_bins)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighbors_at_ind", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_neighbors_at_ind") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_nx = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_nx == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L3_error)</span>
    __pyx_v_ny = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_ny == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L3_error)</span>
    __pyx_v_nz = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_nz == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L3_error)</span>
    __pyx_v_ind = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[3]); if (unlikely((__pyx_v_ind == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L3_error)</span>
    __pyx_v_num_bins = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[4]); if (unlikely((__pyx_v_num_bins == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_neighbors_at_ind", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighbors_at_ind", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_6get_neighbors_at_ind(__pyx_self, __pyx_v_nx, __pyx_v_ny, __pyx_v_nz, __pyx_v_ind, __pyx_v_num_bins);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_6get_neighbors_at_ind(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_nx, long __pyx_v_ny, long __pyx_v_nz, long __pyx_v_ind, long __pyx_v_num_bins) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_neighbors_at_ind", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_neighbors_at_ind (wrapper)", __pyx_f[0], 2531, 0, <span class='error_goto'>__PYX_ERR(0, 2531, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_6fields_get_neighbors_at_ind(__pyx_v_nx, __pyx_v_ny, __pyx_v_nz, __pyx_v_ind, __pyx_v_num_bins, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_neighbors_at_ind", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2532</span>:     <span class="nb">long</span> <span class="n">nx</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ny</span><span class="p">,</span> <span class="nb">long</span> <span class="n">nz</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind</span><span class="p">,</span> <span class="nb">long</span> <span class="n">num_bins</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2533</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2534</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify the bin indices immediately neighboring a specific bin index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2535</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2536</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2537</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2538</span>: <span class="sd">    nx : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2539</span>: <span class="sd">        Number of bins in the x direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2540</span>: <span class="sd">    ny : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2541</span>: <span class="sd">        Number of bins in the y direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2542</span>: <span class="sd">    nz : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2543</span>: <span class="sd">        Number of bins in the z direction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2544</span>: <span class="sd">    ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2545</span>: <span class="sd">        Super-index of bin for which neighbors are desired</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2546</span>: <span class="sd">    num_bins : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2547</span>: <span class="sd">        Number of bins contained  in the field</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2548</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2549</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2550</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2551</span>: <span class="sd">    np.ndarray(ndims=1, dtype=long)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2552</span>: <span class="sd">        Array of nine bin super-indices immediately neighboring and containing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2553</span>: <span class="sd">        the bin specified by `ind`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2554</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2555</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">nbr_bins_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mf">27</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2555, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__19, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_nbr_bins_flat = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_27);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 2555, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2556</span>:     <span class="n">xyz</span> <span class="o">=</span> <span class="n">super_ind_to_inds</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_f_6chromo_6fields_super_ind_to_inds(__pyx_v_ind, __pyx_v_nx, __pyx_v_ny, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 2556, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_4, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
  __pyx_v_xyz = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2557</span>:     <span class="n">x</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xyz, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2557, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_x = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2558</span>:     <span class="n">y</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xyz, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2558, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_y = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2559</span>:     <span class="n">z</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xyz, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2559, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_z = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2560</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2561</span>:     <span class="n">nbr_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_int_3, __pyx_int_3, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2561, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__21, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_nbr_bins = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__20);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 2561, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2562</span>:     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)):</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_2 = __pyx_int_0;
  for (__pyx_t_5 = -1L; __pyx_t_5 &lt; 2; __pyx_t_5+=1) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dx, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
    __pyx_t_2 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2563</span>:         <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)):</span></pre>
<pre class='cython code score-9 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_3 = __pyx_int_0;
    for (__pyx_t_6 = -1L; __pyx_t_6 &lt; 2; __pyx_t_6+=1) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2563, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dy, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2563, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2564</span>:             <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">dz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">)):</span></pre>
<pre class='cython code score-9 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      __pyx_t_1 = __pyx_int_0;
      for (__pyx_t_7 = -1L; __pyx_t_7 &lt; 2; __pyx_t_7+=1) {
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2564, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dz, __pyx_t_8);
        __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_1);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2564, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
        __pyx_t_1 = __pyx_t_8;
        __pyx_t_8 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2565</span>:                 <span class="n">nbr_bins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inds_to_super_ind</span><span class="p">(</span></pre>
<pre class='cython code score-23 '>        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_f_6chromo_6fields_inds_to_super_ind(__pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_v_nx, __pyx_v_ny));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2565, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2565, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_i);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_j);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_v_k);
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_nbr_bins, __pyx_t_9, __pyx_t_10) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2565, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2566</span>:                     <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">)</span> <span class="o">%</span> <span class="n">nx</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span> <span class="o">%</span> <span class="n">ny</span><span class="p">,</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">dz</span><span class="p">)</span> <span class="o">%</span> <span class="n">nz</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span></pre>
<pre class='cython code score-66 '>        __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_x, __pyx_v_dx);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_nx);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_10); if (unlikely((__pyx_t_11 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_y, __pyx_v_dy);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_ny);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_8 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_10, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_8); if (unlikely((__pyx_t_12 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_z, __pyx_v_dz);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_nz);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_10); if (unlikely((__pyx_t_13 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2566, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2567</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2568</span>:     <span class="n">nbr_bins_flat</span> <span class="o">=</span> <span class="n">nbr_bins</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_nbr_bins, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 2568, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_nbr_bins_flat, 1);
  __pyx_v_nbr_bins_flat = __pyx_t_4;
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2569</span>:     <span class="k">return</span> <span class="n">nbr_bins_flat</span></pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_nbr_bins_flat, 0);
  __pyx_r = __pyx_v_nbr_bins_flat;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2570</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2571</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2572</span>: <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">get_blocks</span><span class="p">(</span><span class="nb">long</span> <span class="n">num_beads</span><span class="p">,</span> <span class="nb">long</span> <span class="n">block_size</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_6fields_9get_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6chromo_6fields_get_blocks(long __pyx_v_num_beads, long __pyx_v_block_size, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_v_i;
  PyObject *__pyx_v_blocks = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_blocks", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_blocks", __pyx_f[0], 2572, 0, <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_blocks", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blocks);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_6fields_9get_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_6fields_8get_blocks[] = "Coarse grain individual beads into blocks of linearly adjacent beads.\n    \n    Notes\n    -----\n    Used to improve computational tractibility of contact map generation.\n\n    Parameters\n    ----------\n    num_beads : long\n        Number of beads in full-resolution polymer\n    block_size : long\n        Number of beads to place into a single block in course-grained model\n\n    Return\n    ------\n    dict[long, long]\n        Mapping of each bead ID to its block.\n    ";
static PyObject *__pyx_pw_6chromo_6fields_9get_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_num_beads;
  long __pyx_v_block_size;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_blocks (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_block_size,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_block_size)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_blocks", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_blocks") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_num_beads = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_num_beads == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L3_error)</span>
    __pyx_v_block_size = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_block_size == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_blocks", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_blocks", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_6fields_8get_blocks(__pyx_self, __pyx_v_num_beads, __pyx_v_block_size);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_6fields_8get_blocks(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_num_beads, long __pyx_v_block_size) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_blocks", 0);
  <span class='trace'>__Pyx_TraceCall</span>("get_blocks (wrapper)", __pyx_f[0], 2572, 0, <span class='error_goto'>__PYX_ERR(0, 2572, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_6fields_get_blocks(__pyx_v_num_beads, __pyx_v_block_size, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.fields.get_blocks", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2573</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Coarse grain individual beads into blocks of linearly adjacent beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2574</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2575</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2576</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2577</span>: <span class="sd">    Used to improve computational tractibility of contact map generation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2578</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2579</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2580</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2581</span>: <span class="sd">    num_beads : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2582</span>: <span class="sd">        Number of beads in full-resolution polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2583</span>: <span class="sd">    block_size : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2584</span>: <span class="sd">        Number of beads to place into a single block in course-grained model</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2585</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2586</span>: <span class="sd">    Return</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2587</span>: <span class="sd">    ------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2588</span>: <span class="sd">    dict[long, long]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2589</span>: <span class="sd">        Mapping of each bead ID to its block.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2590</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2591</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2592</span>:     <span class="k">cdef</span> <span class="kt">dict</span> <span class="nf">blocks</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2593</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2594</span>:     <span class="n">blocks</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_blocks = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2595</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_v_num_beads;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2596</span>:         <span class="n">blocks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">block_size</span><span class="p">))</span></pre>
<pre class='cython code score-21 '>    if (unlikely(__pyx_v_block_size == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "integer division or modulo by zero");
      <span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>
    }
    else if (sizeof(long) == sizeof(long) &amp;&amp; (!(((long)-1) &gt; 0)) &amp;&amp; unlikely(__pyx_v_block_size == (long)-1)  &amp;&amp; unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_v_i))) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_OverflowError, "value too large to perform division");
      <span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(floor(__Pyx_div_long(__pyx_v_i, __pyx_v_block_size)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_blocks, __pyx_t_5, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2597</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2598</span>:     <span class="k">return</span> <span class="n">blocks</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_blocks);
  __pyx_r = __pyx_v_blocks;
  goto __pyx_L0;
</pre></div></body></html>
