<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: moves.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="moves.cpp">moves.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="c"># cython: profile=False</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="sd">&quot;&quot;&quot;Utilities for proposing Monte Carlo moves.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="sd">This module includes an MC adapter class which will drive move adaption and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: <span class="sd">functions applying transformations made by each move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="c"># Built-in Modules</span></pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: <span class="k">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Dict</span></pre>
<pre class='cython code score-69 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Tuple);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Tuple);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_List);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_List);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_List);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Callable);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Callable);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_Callable);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Optional);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Optional);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_Optional);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Union);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Union);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_s_Union);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Dict);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Dict);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, __pyx_n_s_Dict);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_typing, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Tuple, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_List, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Callable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Callable, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Optional);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Optional, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Union);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Union, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Dict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Dict, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: <span class="c"># External Modules</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: <span class="k">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pandas, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: <span class="c"># Custom Modules</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: <span class="k">import</span> <span class="nn">chromo.util.mc_stat</span> <span class="k">as</span> <span class="nn">mc_stat</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__27);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s__27);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_util_mc_stat, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mc_stat, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">from</span> <span class="nn">chromo.mc.move_funcs</span> <span class="k">import</span> <span class="p">(</span></pre>
<pre class='cython code score-44 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_mc_move_funcs, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_change_binding_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_change_binding_state, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_crank_shaft);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_crank_shaft, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_end_pivot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_end_pivot, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_slide);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_slide, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_tangent_rotation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_tangent_rotation, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>:     <span class="n">change_binding_state</span><span class="p">,</span> <span class="n">crank_shaft</span><span class="p">,</span> <span class="n">end_pivot</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">tangent_rotation</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_change_binding_state);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_change_binding_state);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_change_binding_state);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_crank_shaft);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_crank_shaft);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_crank_shaft);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_end_pivot);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_end_pivot);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_s_end_pivot);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_slide);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_slide);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_s_slide);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_tangent_rotation);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_tangent_rotation);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_s_tangent_rotation);
</pre><pre class="cython line score-0">&#xA0;<span class="">020</span>: <span class="p">)</span></pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>: <span class="k">from</span> <span class="nn">chromo.polymers</span> <span class="k">import</span> <span class="n">PolymerBase</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_PolymerBase);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_PolymerBase);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_PolymerBase);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_polymers, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="k">from</span> <span class="nn">chromo.polymers</span> <span class="k">cimport</span> <span class="n">PolymerBase</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: <span class="k">from</span> <span class="nn">chromo.binders</span> <span class="k">import</span> <span class="n">ReaderProtein</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ReaderProtein);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ReaderProtein);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_ReaderProtein);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_binders, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_ReaderProtein);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ReaderProtein, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">026</span>: <span class="n">MOVE_AMP</span> <span class="o">=</span> <span class="nb">float</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_MOVE_AMP, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>: <span class="n">BEAD_AMP</span> <span class="o">=</span> <span class="nb">int</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_BEAD_AMP, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span>
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>: <span class="n">NUMERIC</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_Union);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)(&amp;PyInt_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)(&amp;PyFloat_Type)));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NUMERIC, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">029</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>: <span class="n">_proposal_arg_names</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-27 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_inds);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_inds);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_inds);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_continuous_inds);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_continuous_inds);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 5, __pyx_n_s_continuous_inds);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_amp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_amp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 6, __pyx_n_s_bead_amp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_move_amp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_move_amp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 7, __pyx_n_s_move_amp);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_proposal_arg_names, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">031</span>:     <span class="s">&#39;inds&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;t3&#39;</span><span class="p">,</span> <span class="s">&#39;t2&#39;</span><span class="p">,</span> <span class="s">&#39;states&#39;</span><span class="p">,</span> <span class="s">&#39;continuous_inds&#39;</span><span class="p">,</span> <span class="s">&#39;bead_amp&#39;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:     <span class="s">&#39;move_amp&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>: <span class="n">_proposal_arg_types</span> <span class="o">=</span> <span class="n">Tuple</span><span class="p">[</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 4, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)&amp;PyBool_Type));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)&amp;PyBool_Type));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 5, ((PyObject*)&amp;PyBool_Type));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 6, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 7, __pyx_t_8);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_proposal_arg_types, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)(&amp;PyInt_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyInt_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)(&amp;PyInt_Type)));
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:     <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, ((PyObject *)(&amp;PyFloat_Type)));
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:     <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)(&amp;PyFloat_Type)));
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:     <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)(&amp;PyFloat_Type)));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)(&amp;PyFloat_Type)));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)(&amp;PyFloat_Type)));
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 39, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:     <span class="n">List</span><span class="p">[</span><span class="n">ReaderProtein</span><span class="p">],</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_ReaderProtein);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_8, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">041</span>:     <span class="nb">bool</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:     <span class="n">BEAD_AMP</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_BEAD_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:     <span class="n">MOVE_AMP</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_MOVE_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-0">&#xA0;<span class="">044</span>: <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">046</span>: <span class="n">_move_arg_types</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-15 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_9);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_move_arg_types, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">047</span>:     <span class="n">PolymerBase</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:     <span class="n">MOVE_AMP</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_MOVE_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 48, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     <span class="n">BEAD_AMP</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_BEAD_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-0">&#xA0;<span class="">050</span>: <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>: <span class="n">_move_func_type</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_Callable);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_move_func_type, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>:     <span class="p">[</span><span class="n">PolymerBase</span><span class="p">,</span> <span class="n">MOVE_AMP</span><span class="p">,</span> <span class="n">BEAD_AMP</span><span class="p">],</span> <span class="n">_proposal_arg_types</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_MOVE_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_BEAD_AMP);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_8);
  __pyx_t_9 = 0;
  __pyx_t_8 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_proposal_arg_types);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-0">&#xA0;<span class="">054</span>: <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: <span class="c"># ctypedef long[:] (*mv_fxn)(PolymerBase, double, double)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">MCAdapter</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_2mc_5moves_MCAdapter {
  __Pyx_memviewslice (*propose)(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *, struct __pyx_obj_6chromo_8polymers_PolymerBase *);
  void (*accept)(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, double, __Pyx_memviewslice, long, int, int, int, int __pyx_skip_dispatch);
  void (*reject)(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *, struct __pyx_obj_6chromo_8polymers_PolymerBase *, double, __Pyx_memviewslice, long, int, int, int, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_6chromo_2mc_5moves_MCAdapter *__pyx_vtabptr_6chromo_2mc_5moves_MCAdapter;

</pre><pre class="cython line score-0">&#xA0;<span class="">059</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Track success rate and adjust parameters for Monte Carlo moves.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: <span class="sd">    In order to ensure that a Monte Carlo simulation equilibrates as quickly as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: <span class="sd">    possible, we provide an automated system for tuning the &quot;aggressiveness&quot; of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: <span class="sd">    each Monte Carlo move in order to optimize the tradeoff between</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: <span class="sd">    1. The move being large enough that it does not take too many moves to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: <span class="sd">       equilibrate, and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: <span class="sd">    2. The move not being so large that it will never be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">       accepted, or the computational cost becomes prohibitive (especially in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">       the case when the computational cost scales super-linearly).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: <span class="sd">    All Monte-Carlo moves we currently use for our polymers have two</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="sd">    &quot;amplitudes&quot;.  The &quot;bead&quot; amplitude controls how many beads are typically</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">    affected by the move, and the &quot;move&quot; amplitude controls how &quot;far&quot; those</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: <span class="sd">    beads are moved.  Typically, actually bead counts and move sizes are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: <span class="sd">    selected randomly, so these amplitudes will correspond to averages.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: <span class="sd">    Success rate will be tracked by a `AcceptanceTracker` object specified in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: <span class="sd">    the `chromo/util/mc_stat.py` module. The performance tracker will indicate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: <span class="sd">    an overall acceptance rate based on the total numbers of moves attempted</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: <span class="sd">    and accepted. A running acceptance rate will also be maintained, which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: <span class="sd">    decays the weight of historic values using a decay factor.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: <span class="sd">    In the future, we want to do this optimization by looking at actual metrics</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: <span class="sd">    based on the simulation output, but for now only implementation of an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: <span class="sd">    MCAdapter (`MCAdaptSuccessRate`) handles this optimization by simply trying</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: <span class="sd">    to maintain a fixed target success rate.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-86 '>/* Python wrapper */
static int __pyx_pw_6chromo_2mc_5moves_9MCAdapter_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_9MCAdapter___init__[] = "Initialize the MCAdapter object.\n\n        Parameters\n        ----------\n        log_dir : str\n            Path to the directory into which to save logs of bead/move\n            amplitudes and acceptance rates\n        log_file_prefix : str\n            File prefix for log file tracking bead/move amplitudes and\n            acceptance rate\n        move_func : Callable[_move_arg_types, _proposal_arg_types]\n            Functions representing Monte Carlo moves\n        moves_in_average : Optional[float]\n            Number of historical moves to track in incremental measure of move\n            acceptance (default = 20)\n        init_amp_bead : Optional[int]\n            Initial bead selection amplitude (default = 100)\n        init_amp_move : Optional[float]\n            Initial move amplitude (default = 0.05)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_2mc_5moves_9MCAdapter___init__;
#endif
static int __pyx_pw_6chromo_2mc_5moves_9MCAdapter_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_log_dir = 0;
  PyObject *__pyx_v_log_file_prefix = 0;
  PyObject *__pyx_v_move_func = 0;
  float __pyx_v_moves_in_average;
  long __pyx_v_init_amp_bead;
  double __pyx_v_init_amp_move;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_log_dir,&amp;__pyx_n_s_log_file_prefix,&amp;__pyx_n_s_move_func,&amp;__pyx_n_s_moves_in_average,&amp;__pyx_n_s_init_amp_bead,&amp;__pyx_n_s_init_amp_move,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_dir)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_file_prefix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, 1); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_move_func)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, 2); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_moves_in_average)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, 3); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_init_amp_bead)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, 4); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_init_amp_move)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, 5); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_log_dir = ((PyObject*)values[0]);
    __pyx_v_log_file_prefix = ((PyObject*)values[1]);
    __pyx_v_move_func = values[2];
    __pyx_v_moves_in_average = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[3]); if (unlikely((__pyx_v_moves_in_average == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    __pyx_v_init_amp_bead = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[4]); if (unlikely((__pyx_v_init_amp_bead == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L3_error)</span>
    __pyx_v_init_amp_move = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_init_amp_move == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 95, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_dir), (&amp;PyString_Type), 1, "log_dir", 1))) <span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_file_prefix), (&amp;PyString_Type), 1, "log_file_prefix", 1))) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_9MCAdapter___init__(((struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *)__pyx_v_self), __pyx_v_log_dir, __pyx_v_log_file_prefix, __pyx_v_move_func, __pyx_v_moves_in_average, __pyx_v_init_amp_bead, __pyx_v_init_amp_move);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_2mc_5moves_9MCAdapter___init__(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, PyObject *__pyx_v_log_dir, PyObject *__pyx_v_log_file_prefix, PyObject *__pyx_v_move_func, float __pyx_v_moves_in_average, long __pyx_v_init_amp_bead, double __pyx_v_init_amp_move) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">089</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:         <span class="nb">str</span> <span class="n">log_dir</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:         <span class="nb">str</span> <span class="n">log_file_prefix</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:         <span class="n">move_func</span><span class="p">,</span>  <span class="c"># define as type `mv_fxn` if only accessed from C</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>:         <span class="nb">float</span> <span class="n">moves_in_average</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:         <span class="nb">long</span> <span class="n">init_amp_bead</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:         <span class="n">double</span> <span class="n">init_amp_move</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MCAdapter object.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>: <span class="sd">        log_dir : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>: <span class="sd">            Path to the directory into which to save logs of bead/move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">            amplitudes and acceptance rates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: <span class="sd">        log_file_prefix : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">            File prefix for log file tracking bead/move amplitudes and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">            acceptance rate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">        move_func : Callable[_move_arg_types, _proposal_arg_types]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: <span class="sd">            Functions representing Monte Carlo moves</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">        moves_in_average : Optional[float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">            Number of historical moves to track in incremental measure of move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>: <span class="sd">            acceptance (default = 20)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>: <span class="sd">        init_amp_bead : Optional[int]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: <span class="sd">            Initial bead selection amplitude (default = 100)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>: <span class="sd">        init_amp_move : Optional[float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>: <span class="sd">            Initial move amplitude (default = 0.05)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">move_func</span><span class="o">.</span><span class="n">__name__</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_move_func, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;name);
  __pyx_v_self-&gt;name = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">move_func</span> <span class="o">=</span> <span class="n">move_func</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_move_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_move_func);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;move_func);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;move_func);
  __pyx_v_self-&gt;move_func = __pyx_v_move_func;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">amp_move</span> <span class="o">=</span> <span class="n">init_amp_move</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;amp_move = __pyx_v_init_amp_move;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_per_cycle</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_per_cycle = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">amp_bead</span> <span class="o">=</span> <span class="n">init_amp_bead</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;amp_bead = __pyx_v_init_amp_bead;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_attempt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_attempt = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_success</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_success = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">move_on</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;move_on = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">last_amp_move</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;last_amp_move = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">last_amp_bead</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;last_amp_bead = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">acceptance_tracker</span> <span class="o">=</span> <span class="n">mc_stat</span><span class="o">.</span><span class="n">AcceptanceTracker</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_mc_stat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_AcceptanceTracker);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;acceptance_tracker);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;acceptance_tracker);
  __pyx_v_self-&gt;acceptance_tracker = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:             <span class="n">log_dir</span><span class="p">,</span> <span class="n">log_file_prefix</span><span class="p">,</span> <span class="n">moves_in_average</span></pre>
<pre class='cython code score-45 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_moves_in_average);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_log_dir, __pyx_v_log_file_prefix, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_log_dir, __pyx_v_log_file_prefix, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_log_dir);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_log_dir);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_v_log_dir);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_log_file_prefix);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_log_file_prefix);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_log_file_prefix);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">129</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">131</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_3__str__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_3__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_9MCAdapter_2__str__(((struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_9MCAdapter_2__str__(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:         <span class="k">return</span> <span class="n">f</span><span class="s">&quot;MCAdapter&lt;{self.name}&gt;&quot;</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_MCAdapter);
  __pyx_t_2 += 10;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_MCAdapter);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_MCAdapter);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_self-&gt;name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 3, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">133</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:     <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_5to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_5to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_9MCAdapter_4to_file(((struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *)__pyx_v_self), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_9MCAdapter_4to_file(CYTHON_UNUSED struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file", 0);

  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">135</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:     <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">propose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PolymerBase</span> <span class="n">polymer</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>static __Pyx_memviewslice __pyx_f_6chromo_2mc_5moves_9MCAdapter_propose(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_polymer) {
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("propose", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.propose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: <span class="sd">        Get new proposed state of the system.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>: <span class="sd">        polymer : PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>: <span class="sd">            The polymer to attempt to move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>: <span class="sd">        inds : array_like (N,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>: <span class="sd">            List of indices for N beads being moved</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_attempt</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_attempt = (__pyx_v_self-&gt;num_attempt + 1);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_func</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_self-&gt;move_func, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">153</span>:             <span class="n">polymer</span><span class="o">=</span><span class="n">polymer</span><span class="p">,</span> <span class="n">amp_move</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amp_move</span><span class="p">,</span> <span class="n">amp_bead</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amp_bead</span></pre>
<pre class='cython code score-26 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_polymer, ((PyObject *)__pyx_v_polymer)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;amp_move);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_amp_move, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;amp_bead);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_amp_bead, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">154</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>: </pre>
<pre class="cython line score-189" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">accept</span><span class="p">(</span></pre>
<pre class='cython code score-189 '>static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_7accept(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6chromo_2mc_5moves_9MCAdapter_accept(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, double __pyx_v_dE, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_log_move, int __pyx_v_log_update, int __pyx_v_update_distances, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accept", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_accept);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_2mc_5moves_9MCAdapter_7accept)) {
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span> }
        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_move);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_update);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_update_distances);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
        __pyx_t_11 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
          __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
          if (likely(__pyx_t_10)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
            __pyx_t_11 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
          PyObject *__pyx_temp[8] = {__pyx_t_10, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
          PyObject *__pyx_temp[8] = {__pyx_t_10, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        } else
        #endif
        {
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          if (__pyx_t_10) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_poly));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_11, ((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_11, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_11, __pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3+__pyx_t_11, __pyx_t_5);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4+__pyx_t_11, __pyx_t_6);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 5+__pyx_t_11, __pyx_t_7);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 6+__pyx_t_11, __pyx_t_8);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_5 = 0;
          __pyx_t_6 = 0;
          __pyx_t_7 = 0;
          __pyx_t_8 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.mc.moves.MCAdapter.accept", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_7accept(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_9MCAdapter_6accept[] = "Update polymer with new state and update proposal stats.\n\n        Update all elements of `poly` for which proposed state is not None. Log\n        the move acceptance/rejection in the move acceptance tracker.\n\n        `replace_none` is outdated with cython implementation of `move_funcs`\n\n        Parameters\n        ----------\n        poly : PolymerBase\n            Polymer affected by the MC move\n        dE : float\n            Change in energy associated with the move\n        inds : long[:]\n            Indices of beads affected by the MC move\n        n_inds : long\n            Number of beads affected by a move\n        log_move : bint\n            Indicator for whether (1) or not (0) to log the move to a list\n            later outputted to a CSV file\n        log_update : bint\n            Indicator for whether (1) or not (2) to record the updated\n            acceptance rate after the MC move\n        update_distances : bint\n            Update pairwise distances between beads -- only relevant if the\n            polymer is an instance of DetailedChromatinWithSterics, which\n            tracks pairwise distances between beads.\n        ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_7accept(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly = 0;
  double __pyx_v_dE;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_n_inds;
  int __pyx_v_log_move;
  int __pyx_v_log_update;
  int __pyx_v_update_distances;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accept (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_poly,&amp;__pyx_n_s_dE,&amp;__pyx_n_s_inds,&amp;__pyx_n_s_n_inds,&amp;__pyx_n_s_log_move,&amp;__pyx_n_s_log_update,&amp;__pyx_n_s_update_distances,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_poly)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_move)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_update)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_update_distances)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "accept") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_poly = ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)values[0]);
    __pyx_v_dE = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_dE == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L3_error)</span>
    __pyx_v_inds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_inds.memview)) __PYX_ERR(0, 157, __pyx_L3_error)</span>
    __pyx_v_n_inds = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[3]); if (unlikely((__pyx_v_n_inds == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L3_error)</span>
    __pyx_v_log_move = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[4]); if (unlikely((__pyx_v_log_move == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
    __pyx_v_log_update = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[5]); if (unlikely((__pyx_v_log_update == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
    __pyx_v_update_distances = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[6]); if (unlikely((__pyx_v_update_distances == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 158, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accept", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.accept", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_poly), __pyx_ptype_6chromo_8polymers_PolymerBase, 1, "poly", 0))) <span class='error_goto'>__PYX_ERR(0, 157, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_9MCAdapter_6accept(((struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *)__pyx_v_self), __pyx_v_poly, __pyx_v_dE, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_log_move, __pyx_v_log_update, __pyx_v_update_distances);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_9MCAdapter_6accept(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, double __pyx_v_dE, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_log_move, int __pyx_v_log_update, int __pyx_v_update_distances) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accept", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 156, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_2mc_5moves_9MCAdapter_accept(__pyx_v_self, __pyx_v_poly, __pyx_v_dE, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_log_move, __pyx_v_log_update, __pyx_v_update_distances, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.accept", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">157</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="n">double</span> <span class="n">dE</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:         <span class="nb">bint</span> <span class="n">log_move</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">log_update</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">update_distances</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update polymer with new state and update proposal stats.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: <span class="sd">        Update all elements of `poly` for which proposed state is not None. Log</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: <span class="sd">        the move acceptance/rejection in the move acceptance tracker.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>: <span class="sd">        `replace_none` is outdated with cython implementation of `move_funcs`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>: <span class="sd">        poly : PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>: <span class="sd">            Polymer affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: <span class="sd">        dE : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: <span class="sd">            Change in energy associated with the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: <span class="sd">        inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>: <span class="sd">            Indices of beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>: <span class="sd">            Number of beads affected by a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>: <span class="sd">        log_move : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: <span class="sd">            Indicator for whether (1) or not (0) to log the move to a list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: <span class="sd">            later outputted to a CSV file</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>: <span class="sd">        log_update : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>: <span class="sd">            Indicator for whether (1) or not (2) to record the updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>: <span class="sd">            acceptance rate after the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>: <span class="sd">        update_distances : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>: <span class="sd">            Update pairwise distances between beads -- only relevant if the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>: <span class="sd">            polymer is an instance of DetailedChromatinWithSterics, which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: <span class="sd">            tracks pairwise distances between beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;change_binding_state&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_change_binding_state, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>
  __pyx_t_14 = (__pyx_t_13 != 0);
  if (__pyx_t_14) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_poly-&gt;num_binders;
      __pyx_t_19 = __pyx_t_18;
      for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
        __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;states_trial.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;states_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;states_trial.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;states_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;states.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;states.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_25 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_26)) )) = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states_trial.data + __pyx_t_22 * __pyx_v_poly-&gt;states_trial.strides[0]) )) + __pyx_t_23)) )));
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">194</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;slide&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_slide, Py_EQ)); if (unlikely(__pyx_t_14 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
  __pyx_t_13 = (__pyx_t_14 != 0);
  if (__pyx_t_13) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_18 = 0; __pyx_t_18 &lt; 3; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;r_trial.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;r_trial.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;r.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;r.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_26 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_23 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t3.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t3.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t3.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t3.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t3_trial.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t3_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t3_trial.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t3_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3_trial.data + __pyx_t_25 * __pyx_v_poly-&gt;t3_trial.strides[0]) )) + __pyx_t_26)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3.data + __pyx_t_22 * __pyx_v_poly-&gt;t3.strides[0]) )) + __pyx_t_23)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t2.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t2.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t2.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t2.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t2_trial.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t2_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t2_trial.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t2_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 200, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2_trial.data + __pyx_t_26 * __pyx_v_poly-&gt;t2_trial.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2.data + __pyx_t_23 * __pyx_v_poly-&gt;t2.strides[0]) )) + __pyx_t_22)) )));
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:                 <span class="k">if</span> <span class="n">update_distances</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (__pyx_v_update_distances != 0);
      if (__pyx_t_13) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_poly-&gt;num_beads;
        __pyx_t_19 = __pyx_t_18;
        for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
          __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
          __pyx_t_1 = 0;
          __pyx_t_2 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_12, __pyx_t_8, __pyx_t_9) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span>
          }
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
          __pyx_t_2 = 0;
          __pyx_t_9 = 0;
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
          __pyx_t_9 = 0;
          __pyx_t_8 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_2, __pyx_t_1, __pyx_t_12) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
          }
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_12);
          __pyx_t_8 = 0;
          __pyx_t_12 = 0;
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">207</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;tangent_rotation&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_tangent_rotation, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  __pyx_t_14 = (__pyx_t_13 != 0);
  if (__pyx_t_14) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_18 = 0; __pyx_t_18 &lt; 3; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t3_trial.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t3_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t3_trial.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t3_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t3.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t3.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t3.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t3.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3.data + __pyx_t_25 * __pyx_v_poly-&gt;t3.strides[0]) )) + __pyx_t_26)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3_trial.data + __pyx_t_22 * __pyx_v_poly-&gt;t3_trial.strides[0]) )) + __pyx_t_23)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t2_trial.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t2_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t2_trial.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t2_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t2.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t2.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t2.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t2.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2.data + __pyx_t_26 * __pyx_v_poly-&gt;t2.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2_trial.data + __pyx_t_23 * __pyx_v_poly-&gt;t2_trial.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;r.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;r.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;r_trial.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;r_trial.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_25 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_26)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_22 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_23)) )));
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">215</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_18 = 0; __pyx_t_18 &lt; 3; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;r_trial.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;r_trial.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;r.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;r.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_26 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_23 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t3_trial.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t3_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t3_trial.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t3_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t3.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t3.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t3.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t3.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3.data + __pyx_t_25 * __pyx_v_poly-&gt;t3.strides[0]) )) + __pyx_t_26)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3_trial.data + __pyx_t_22 * __pyx_v_poly-&gt;t3_trial.strides[0]) )) + __pyx_t_23)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t2_trial.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t2_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t2_trial.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t2_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t2.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t2.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t2.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t2.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2.data + __pyx_t_26 * __pyx_v_poly-&gt;t2.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2_trial.data + __pyx_t_23 * __pyx_v_poly-&gt;t2_trial.strides[0]) )) + __pyx_t_22)) )));
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:                 <span class="k">if</span> <span class="n">update_distances</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = (__pyx_v_update_distances != 0);
      if (__pyx_t_14) {
/* … */
      }
    }
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_poly-&gt;num_beads;
        __pyx_t_19 = __pyx_t_18;
        for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
          __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
          }
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_12);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_1);
          __pyx_t_12 = 0;
          __pyx_t_1 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_8, __pyx_t_9, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
          __pyx_t_1 = 0;
          __pyx_t_2 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_12, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>
          }
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
          __pyx_t_2 = 0;
          __pyx_t_9 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_1, __pyx_t_12, __pyx_t_8) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
          __pyx_t_9 = 0;
          __pyx_t_8 = 0;
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_success</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_success = (__pyx_v_self-&gt;num_success + 1);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">acceptance_tracker</span><span class="o">.</span><span class="n">update_acceptance_rate</span><span class="p">(</span></pre>
<pre class='cython code score-7 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;acceptance_tracker, __pyx_n_s_update_acceptance_rate);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_empty_tuple, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:             <span class="n">accept</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">log_update</span><span class="o">=</span><span class="n">log_update</span></pre>
<pre class='cython code score-15 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_accept, __pyx_float_1_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_update);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_log_update, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">231</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:         <span class="k">if</span> <span class="n">log_move</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = ((__pyx_v_log_move == 1) != 0);
  if (__pyx_t_14) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">acceptance_tracker</span><span class="o">.</span><span class="n">log_move</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;acceptance_tracker, __pyx_n_s_log_move);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">amp_move</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;amp_move);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">amp_bead</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;amp_bead);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                 <span class="n">poly</span><span class="o">.</span><span class="n">last_amp_move</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_poly-&gt;last_amp_move);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:                 <span class="n">poly</span><span class="o">.</span><span class="n">last_amp_bead</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;last_amp_bead);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:                 <span class="n">dE</span></pre>
<pre class='cython code score-54 '>    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_12)) {
      PyObject *__pyx_temp[6] = {__pyx_t_5, __pyx_t_8, __pyx_t_9, __pyx_t_2, __pyx_t_7, __pyx_t_6};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_12)) {
      PyObject *__pyx_temp[6] = {__pyx_t_5, __pyx_t_8, __pyx_t_9, __pyx_t_2, __pyx_t_7, __pyx_t_6};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_12, __pyx_temp+1-__pyx_t_11, 5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_5) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_11, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_11, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_11, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3+__pyx_t_11, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4+__pyx_t_11, __pyx_t_6);
      __pyx_t_8 = 0;
      __pyx_t_9 = 0;
      __pyx_t_2 = 0;
      __pyx_t_7 = 0;
      __pyx_t_6 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">239</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-189" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">reject</span><span class="p">(</span></pre>
<pre class='cython code score-189 '>static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_9reject(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6chromo_2mc_5moves_9MCAdapter_reject(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, double __pyx_v_dE, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_log_move, int __pyx_v_log_update, int __pyx_v_update_distances, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reject", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_reject);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_2mc_5moves_9MCAdapter_9reject)) {
        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L1_error)</span> }
        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_move);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_update);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_update_distances);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_9 = __pyx_t_1; __pyx_t_10 = NULL;
        __pyx_t_11 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
          __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
          if (likely(__pyx_t_10)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
            __pyx_t_11 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
          PyObject *__pyx_temp[8] = {__pyx_t_10, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
          PyObject *__pyx_temp[8] = {__pyx_t_10, ((PyObject *)__pyx_v_poly), __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        } else
        #endif
        {
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(7+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          if (__pyx_t_10) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_poly));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0+__pyx_t_11, ((PyObject *)__pyx_v_poly));
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1+__pyx_t_11, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 2+__pyx_t_11, __pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 3+__pyx_t_11, __pyx_t_5);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 4+__pyx_t_11, __pyx_t_6);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 5+__pyx_t_11, __pyx_t_7);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 6+__pyx_t_11, __pyx_t_8);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_5 = 0;
          __pyx_t_6 = 0;
          __pyx_t_7 = 0;
          __pyx_t_8 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.reject", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_9reject(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_9MCAdapter_8reject[] = "Reject a proposed Monte Carlo move.\n\n        Log the rejected move in the acceptance tracker.\n\n        Parameters\n        ----------\n        poly : PolymerBase\n            Polymer affected by the MC move\n        dE : float\n            Change in energy associated with the move\n        inds : long[:]\n            Indices of the beads that were affected by the move\n        n_inds : long\n            Number of beads that were affected by the move\n        log_move : bint\n            Indicator for whether (1) or not (0) to log the move to a list\n            later outputted to a CSV file\n        log_update : bint\n            Indicator for whether (1) or not (2) to record the updated\n            acceptance rate after the MC move\n        update_distances : bint\n            Update pairwise distances between beads -- only relevant if the\n            polymer is an instance of DetailedChromatinWithSterics, which\n            tracks pairwise distances between beads.\n        ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_9MCAdapter_9reject(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly = 0;
  double __pyx_v_dE;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_n_inds;
  int __pyx_v_log_move;
  int __pyx_v_log_update;
  int __pyx_v_update_distances;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reject (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_poly,&amp;__pyx_n_s_dE,&amp;__pyx_n_s_inds,&amp;__pyx_n_s_n_inds,&amp;__pyx_n_s_log_move,&amp;__pyx_n_s_log_update,&amp;__pyx_n_s_update_distances,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_poly)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dE)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_move)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_log_update)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_update_distances)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "reject") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_poly = ((struct __pyx_obj_6chromo_8polymers_PolymerBase *)values[0]);
    __pyx_v_dE = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_dE == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
    __pyx_v_inds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_inds.memview)) __PYX_ERR(0, 242, __pyx_L3_error)</span>
    __pyx_v_n_inds = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[3]); if (unlikely((__pyx_v_n_inds == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
    __pyx_v_log_move = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[4]); if (unlikely((__pyx_v_log_move == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L3_error)</span>
    __pyx_v_log_update = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[5]); if (unlikely((__pyx_v_log_update == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L3_error)</span>
    __pyx_v_update_distances = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[6]); if (unlikely((__pyx_v_update_distances == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 243, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("reject", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.reject", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_poly), __pyx_ptype_6chromo_8polymers_PolymerBase, 1, "poly", 0))) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_9MCAdapter_8reject(((struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *)__pyx_v_self), __pyx_v_poly, __pyx_v_dE, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_log_move, __pyx_v_log_update, __pyx_v_update_distances);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_9MCAdapter_8reject(struct __pyx_obj_6chromo_2mc_5moves_MCAdapter *__pyx_v_self, struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_poly, double __pyx_v_dE, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_v_log_move, int __pyx_v_log_update, int __pyx_v_update_distances) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("reject", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 241, __pyx_L1_error)</span> }
  __pyx_f_6chromo_2mc_5moves_9MCAdapter_reject(__pyx_v_self, __pyx_v_poly, __pyx_v_dE, __pyx_v_inds, __pyx_v_n_inds, __pyx_v_log_move, __pyx_v_log_update, __pyx_v_update_distances, 1);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  __pyx_t_1 = __Pyx_void_to_None(NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.MCAdapter.reject", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">PolymerBase</span> <span class="n">poly</span><span class="p">,</span> <span class="n">double</span> <span class="n">dE</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">243</span>:         <span class="nb">bint</span> <span class="n">log_move</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">log_update</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">update_distances</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">244</span>:     <span class="p">)</span> <span class="k">except</span> <span class="o">*</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Reject a proposed Monte Carlo move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">246</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>: <span class="sd">        Log the rejected move in the acceptance tracker.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>: <span class="sd">        poly : PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>: <span class="sd">            Polymer affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>: <span class="sd">        dE : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>: <span class="sd">            Change in energy associated with the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>: <span class="sd">        inds : long[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>: <span class="sd">            Indices of the beads that were affected by the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>: <span class="sd">            Number of beads that were affected by the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">259</span>: <span class="sd">        log_move : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">260</span>: <span class="sd">            Indicator for whether (1) or not (0) to log the move to a list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">261</span>: <span class="sd">            later outputted to a CSV file</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>: <span class="sd">        log_update : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>: <span class="sd">            Indicator for whether (1) or not (2) to record the updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>: <span class="sd">            acceptance rate after the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>: <span class="sd">        update_distances : bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">266</span>: <span class="sd">            Update pairwise distances between beads -- only relevant if the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>: <span class="sd">            polymer is an instance of DetailedChromatinWithSterics, which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>: <span class="sd">            tracks pairwise distances between beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">269</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">270</span>:         <span class="c"># Reset trial states</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;change_binding_state&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_change_binding_state, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 271, __pyx_L1_error)</span>
  __pyx_t_14 = (__pyx_t_13 != 0);
  if (__pyx_t_14) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_poly-&gt;num_binders;
      __pyx_t_19 = __pyx_t_18;
      for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
        __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;states.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;states.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;states.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;states.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;states_trial.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;states_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;states_trial.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;states_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
        }
        *((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states_trial.data + __pyx_t_25 * __pyx_v_poly-&gt;states_trial.strides[0]) )) + __pyx_t_26)) )) = (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_poly-&gt;states.data + __pyx_t_22 * __pyx_v_poly-&gt;states.strides[0]) )) + __pyx_t_23)) )));
      }
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">275</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_15 = __pyx_v_n_inds;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_i = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      for (__pyx_t_18 = 0; __pyx_t_18 &lt; 3; __pyx_t_18+=1) {
        __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;r.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;r.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;r.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;r.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;r_trial.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;r_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;r_trial.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;r_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r_trial.data + __pyx_t_26 * __pyx_v_poly-&gt;r_trial.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;r.data + __pyx_t_23 * __pyx_v_poly-&gt;r.strides[0]) )) + __pyx_t_22)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
        }
        __pyx_t_22 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_23 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t3.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t3.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t3.shape[1];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t3.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
        }
        __pyx_t_25 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_26 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t3_trial.shape[0];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t3_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t3_trial.shape[1];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t3_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3_trial.data + __pyx_t_25 * __pyx_v_poly-&gt;t3_trial.strides[0]) )) + __pyx_t_26)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t3.data + __pyx_t_22 * __pyx_v_poly-&gt;t3.strides[0]) )) + __pyx_t_23)) )));
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:                     <span class="n">poly</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>        if (unlikely(!__pyx_v_poly-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>}
        __pyx_t_21 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_21 &lt; 0) {
          __pyx_t_21 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
        }
        __pyx_t_23 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) )));
        __pyx_t_22 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_23 &lt; 0) {
          __pyx_t_23 += __pyx_v_poly-&gt;t2.shape[0];
          if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_poly-&gt;t2.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_22 &lt; 0) {
          __pyx_t_22 += __pyx_v_poly-&gt;t2.shape[1];
          if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_poly-&gt;t2.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_poly-&gt;t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>}
        __pyx_t_24 = __pyx_v_i;
        __pyx_t_11 = -1;
        if (__pyx_t_24 &lt; 0) {
          __pyx_t_24 += __pyx_v_inds.shape[0];
          if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
        }
        __pyx_t_26 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_24 * __pyx_v_inds.strides[0]) )));
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_11 = -1;
        if (__pyx_t_26 &lt; 0) {
          __pyx_t_26 += __pyx_v_poly-&gt;t2_trial.shape[0];
          if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_11 = 0;
        } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_poly-&gt;t2_trial.shape[0])) __pyx_t_11 = 0;
        if (__pyx_t_25 &lt; 0) {
          __pyx_t_25 += __pyx_v_poly-&gt;t2_trial.shape[1];
          if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_11 = 1;
        } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_poly-&gt;t2_trial.shape[1])) __pyx_t_11 = 1;
        if (unlikely(__pyx_t_11 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
          <span class='error_goto'>__PYX_ERR(0, 280, __pyx_L1_error)</span>
        }
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2_trial.data + __pyx_t_26 * __pyx_v_poly-&gt;t2_trial.strides[0]) )) + __pyx_t_25)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_poly-&gt;t2.data + __pyx_t_23 * __pyx_v_poly-&gt;t2.strides[0]) )) + __pyx_t_22)) )));
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:                 <span class="k">if</span> <span class="n">update_distances</span> <span class="ow">and</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (__pyx_v_update_distances != 0);
      if (__pyx_t_13) {
      } else {
        __pyx_t_14 = __pyx_t_13;
        goto __pyx_L13_bool_binop_done;
      }
/* … */
      if (__pyx_t_14) {
/* … */
      }
    }
  }
  __pyx_L3:;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;slide&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;end_pivot&quot;</span> <span class="ow">or</span></pre>
<pre class='cython code score-4 '>      __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_slide, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
      __pyx_t_27 = (__pyx_t_13 != 0);
      if (!__pyx_t_27) {
      } else {
        __pyx_t_14 = __pyx_t_27;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_27 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_end_pivot, Py_EQ)); if (unlikely(__pyx_t_27 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
      __pyx_t_13 = (__pyx_t_27 != 0);
      if (!__pyx_t_13) {
      } else {
        __pyx_t_14 = __pyx_t_13;
        goto __pyx_L13_bool_binop_done;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;crank_shaft&quot;</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_self-&gt;name, __pyx_n_s_crank_shaft, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 283, __pyx_L1_error)</span>
      __pyx_t_27 = (__pyx_t_13 != 0);
      __pyx_t_14 = __pyx_t_27;
      __pyx_L13_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">284</span>:                 <span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:                     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_poly-&gt;num_beads;
        __pyx_t_19 = __pyx_t_18;
        for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
          __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
          }
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_2);
          __pyx_t_1 = 0;
          __pyx_t_2 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_12, __pyx_t_8, __pyx_t_9) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 287, __pyx_L1_error)</span>
          }
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_9);
          __pyx_t_2 = 0;
          __pyx_t_9 = 0;
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 287, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:                         <span class="n">poly</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances_trial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
          }
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
          __pyx_t_9 = 0;
          __pyx_t_8 = 0;
          if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_2, __pyx_t_1, __pyx_t_12) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:                             <span class="n">poly</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span></pre>
<pre class='cython code score-19 '>          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_poly), __pyx_n_s_distances);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_21 = __pyx_v_i;
          __pyx_t_11 = -1;
          if (__pyx_t_21 &lt; 0) {
            __pyx_t_21 += __pyx_v_inds.shape[0];
            if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_11 = 0;
          } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_inds.shape[0])) __pyx_t_11 = 0;
          if (unlikely(__pyx_t_11 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
            <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
          }
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_21 * __pyx_v_inds.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_12);
          __pyx_t_8 = 0;
          __pyx_t_12 = 0;
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:         <span class="c"># Update acceptance tracker</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">acceptance_tracker</span><span class="o">.</span><span class="n">update_acceptance_rate</span><span class="p">(</span></pre>
<pre class='cython code score-7 '>  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;acceptance_tracker, __pyx_n_s_update_acceptance_rate);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:             <span class="n">accept</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">log_update</span><span class="o">=</span><span class="n">log_update</span></pre>
<pre class='cython code score-15 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_accept, __pyx_float_0_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_log_update);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_log_update, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:         <span class="k">if</span> <span class="n">log_move</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_14 = ((__pyx_v_log_move == 1) != 0);
  if (__pyx_t_14) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">acceptance_tracker</span><span class="o">.</span><span class="n">log_move</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self-&gt;acceptance_tracker, __pyx_n_s_log_move);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">amp_move</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">amp_bead</span><span class="p">,</span> <span class="n">poly</span><span class="o">.</span><span class="n">last_amp_move</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;amp_move);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;amp_bead);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_poly-&gt;last_amp_move);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:                 <span class="n">poly</span><span class="o">.</span><span class="n">last_amp_bead</span><span class="p">,</span> <span class="n">dE</span></pre>
<pre class='cython code score-56 '>    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_poly-&gt;last_amp_bead);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[6] = {__pyx_t_5, __pyx_t_12, __pyx_t_8, __pyx_t_9, __pyx_t_7, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[6] = {__pyx_t_5, __pyx_t_12, __pyx_t_8, __pyx_t_9, __pyx_t_7, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_5) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_11, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_11, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_11, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3+__pyx_t_11, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4+__pyx_t_11, __pyx_t_6);
      __pyx_t_12 = 0;
      __pyx_t_8 = 0;
      __pyx_t_9 = 0;
      __pyx_t_7 = 0;
      __pyx_t_6 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">299</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Bounds</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of move or bead amplitude bounds.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">name</span><span class="p">,</span> <span class="nb">dict</span> <span class="n">bounds</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static int __pyx_pw_6chromo_2mc_5moves_6Bounds_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_6Bounds___init__[] = "Initialize the `Bounds` object.\n\n        Parameters\n        ----------\n        name : str\n            Name of the bounds\n        bounds : Dict[str, Tuple[NUMERIC, NUMERIC]]\n            Dictionary of bead selection or move amplitude bounds for each move\n            type, where keys are the names of the move types and values are\n            tuples in the form (lower bound, upper bound)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_2mc_5moves_6Bounds___init__;
#endif
static int __pyx_pw_6chromo_2mc_5moves_6Bounds_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_bounds = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name_2,&amp;__pyx_n_s_bounds,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name_2)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bounds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_bounds = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.Bounds.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bounds), (&amp;PyDict_Type), 1, "bounds", 1))) <span class='error_goto'>__PYX_ERR(0, 306, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_6Bounds___init__(((struct __pyx_obj_6chromo_2mc_5moves_Bounds *)__pyx_v_self), __pyx_v_name, __pyx_v_bounds);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_2mc_5moves_6Bounds___init__(struct __pyx_obj_6chromo_2mc_5moves_Bounds *__pyx_v_self, PyObject *__pyx_v_name, PyObject *__pyx_v_bounds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">307</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the `Bounds` object.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>: <span class="sd">            Name of the bounds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">313</span>: <span class="sd">        bounds : Dict[str, Tuple[NUMERIC, NUMERIC]]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>: <span class="sd">            Dictionary of bead selection or move amplitude bounds for each move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">315</span>: <span class="sd">            type, where keys are the names of the move types and values are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>: <span class="sd">            tuples in the form (lower bound, upper bound)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">317</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;name);
  __pyx_v_self-&gt;name = __pyx_v_name;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bounds);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_bounds);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;bounds);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;bounds);
  __pyx_v_self-&gt;bounds = __pyx_v_bounds;
</pre><pre class="cython line score-0">&#xA0;<span class="">320</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:     <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_3to_dataframe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_6Bounds_2to_dataframe[] = "Express the Bounds using a dataframe.\n        ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_3to_dataframe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_dataframe (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_6Bounds_2to_dataframe(((struct __pyx_obj_6chromo_2mc_5moves_Bounds *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_6Bounds_2to_dataframe(struct __pyx_obj_6chromo_2mc_5moves_Bounds *__pyx_v_self) {
  PyObject *__pyx_v_move_names = NULL;
  PyObject *__pyx_v_bounds_arr = NULL;
  PyObject *__pyx_v_column_names = NULL;
  PyObject *__pyx_v_df = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_dataframe", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.Bounds.to_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_move_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bounds_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_column_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Express the Bounds using a dataframe.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:         <span class="n">move_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span></pre>
<pre class='cython code score-7 '>  if (unlikely(__pyx_v_self-&gt;bounds == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
    <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_Keys</span>(__pyx_v_self-&gt;bounds);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_move_names = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:         <span class="n">bounds_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_atleast_2d);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:             <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span></pre>
<pre class='cython code score-67 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_v_self-&gt;bounds == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "values");
    <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_Values</span>(__pyx_v_self-&gt;bounds);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bounds_arr = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">327</span>:         <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:         <span class="n">column_names</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_MultiIndex);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_from_product);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:             <span class="p">[</span><span class="n">move_names</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;lower_bound&#39;</span><span class="p">,</span> <span class="s">&#39;upper_bound&#39;</span><span class="p">)]</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_move_names);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_move_names);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_move_names);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_tuple__2);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_column_names = __pyx_t_1;
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_lower_bound, __pyx_n_s_upper_bound);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">330</span>:         <span class="p">)</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:         <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">bounds_arr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bounds_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_bounds_arr);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_bounds_arr);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_v_column_names) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_df = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:         <span class="k">return</span> <span class="n">df</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
  __pyx_r = __pyx_v_df;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">333</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:     <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_5to_csv(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_6Bounds_4to_csv[] = "Save Polymer object to CSV file as DataFrame.\n        ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_5to_csv(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_csv (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_6Bounds_4to_csv(((struct __pyx_obj_6chromo_2mc_5moves_Bounds *)__pyx_v_self), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_6Bounds_4to_csv(struct __pyx_obj_6chromo_2mc_5moves_Bounds *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_csv", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.Bounds.to_csv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Save Polymer object to CSV file as DataFrame.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_to_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_csv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">338</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:     <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_7to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_6Bounds_6to_file[] = "Synonym for `to_csv` to conform to `make_reproducible` spec.\n        ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_6Bounds_7to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_6Bounds_6to_file(((struct __pyx_obj_6chromo_2mc_5moves_Bounds *)__pyx_v_self), ((PyObject *)__pyx_v_path));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_6Bounds_6to_file(struct __pyx_obj_6chromo_2mc_5moves_Bounds *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.Bounds.to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">340</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Synonym for `to_csv` to conform to `make_reproducible` spec.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_to_csv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">343</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>: <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">move_list</span> <span class="o">=</span> <span class="p">[</span></pre>
<pre class='cython code score-11 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_t_6);
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_3 = 0;
  __pyx_t_7 = 0;
  __pyx_t_6 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_v_6chromo_2mc_5moves_move_list);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_2mc_5moves_move_list, ((PyObject*)__pyx_t_2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:     <span class="n">crank_shaft</span><span class="p">,</span> <span class="n">end_pivot</span><span class="p">,</span> <span class="n">slide</span><span class="p">,</span> <span class="n">tangent_rotation</span><span class="p">,</span> <span class="n">change_binding_state</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_crank_shaft);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_end_pivot);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_slide);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_tangent_rotation);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_change_binding_state);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-0">&#xA0;<span class="">347</span>: <span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>: <span class="k">cpdef</span> <span class="kt">list</span> <span class="nf">all_moves</span><span class="p">(</span><span class="nb">str</span> <span class="n">log_dir</span><span class="p">):</span></pre>
<pre class='cython code score-14 '>static PyObject *__pyx_pw_6chromo_2mc_5moves_1all_moves(PyObject *__pyx_self, PyObject *__pyx_v_log_dir); /*proto*/
static PyObject *__pyx_f_6chromo_2mc_5moves_all_moves(PyObject *__pyx_v_log_dir, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_move = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("all_moves", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.all_moves", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_move);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_2mc_5moves_1all_moves(PyObject *__pyx_self, PyObject *__pyx_v_log_dir); /*proto*/
static char __pyx_doc_6chromo_2mc_5moves_all_moves[] = "Generate a list of all adaptable MC move objects.\n\n    NOTE: Use `all_moves` function in `chromo.mc.mc_controller` module to\n    create list of controllers for all moves. This function only creates\n    list of all moves, which may not be compatible with `mc_sim` function\n    in `chromo.mc.mc_sim` module.\n\n    Parameters\n    ----------\n    log_dir : str\n        Path to the directory in which to save log files\n\n    Returns\n    -------\n    List of all adaptable MC move objects\n    ";
static PyObject *__pyx_pw_6chromo_2mc_5moves_1all_moves(PyObject *__pyx_self, PyObject *__pyx_v_log_dir) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("all_moves (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_dir), (&amp;PyString_Type), 1, "log_dir", 1))) <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_2mc_5moves_all_moves(__pyx_self, ((PyObject*)__pyx_v_log_dir));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_2mc_5moves_all_moves(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_log_dir) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("all_moves", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_2mc_5moves_all_moves(__pyx_v_log_dir, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.mc.moves.all_moves", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">351</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a list of all adaptable MC move objects.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>: <span class="sd">    NOTE: Use `all_moves` function in `chromo.mc.mc_controller` module to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>: <span class="sd">    create list of controllers for all moves. This function only creates</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>: <span class="sd">    list of all moves, which may not be compatible with `mc_sim` function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>: <span class="sd">    in `chromo.mc.mc_sim` module.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">357</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>: <span class="sd">    log_dir : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">361</span>: <span class="sd">        Path to the directory in which to save log files</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>: <span class="sd">    List of all adaptable MC move objects</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:     <span class="k">return</span> <span class="p">[</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:         <span class="n">MCAdapter</span><span class="p">(</span><span class="n">log_dir</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">move</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">move</span><span class="p">)</span> <span class="k">for</span> <span class="n">move</span> <span class="ow">in</span> <span class="n">move_list</span></pre>
<pre class='cython code score-40 '>  if (unlikely(__pyx_v_6chromo_2mc_5moves_move_list == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
  }
  __pyx_t_2 = __pyx_v_6chromo_2mc_5moves_move_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    #else
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_move, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_log_dir, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_move, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_move);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_move);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_move);
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_6chromo_2mc_5moves_MCAdapter), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">369</span>:     <span class="p">]</span></pre>
</div></body></html>
