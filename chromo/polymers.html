<!DOCTYPE html>
<!-- Generated by Cython 0.29.32 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: polymers.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.32</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="polymers.cpp">polymers.cpp</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c"># cython: profile=False</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="sd">&quot;&quot;&quot;Polymers that will make up our simulation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0006</span>: <span class="k">import</span> <span class="nn">pyximport</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pyximport, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pyximport, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0007</span>: <span class="n">pyximport</span><span class="o">.</span><span class="n">install</span><span class="p">()</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pyximport);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_install);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="c"># Built-in Modules</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: <span class="k">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Callable</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Callable);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Callable);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Callable);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_typing, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Callable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Callable, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0013</span>: <span class="c"># External Modules</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0014</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0015</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0016</span>: <span class="k">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_pandas, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0017</span>: <span class="k">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">comb</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_comb);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_comb);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_comb);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_special, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_comb);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_comb, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="c"># Custom Modules</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0020</span>: <span class="k">import</span> <span class="nn">chromo.beads</span> <span class="k">as</span> <span class="nn">beads</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__111);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__111);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s__111);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_beads, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_beads, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0021</span>: <span class="k">import</span> <span class="nn">chromo.util.mc_stat</span> <span class="k">as</span> <span class="nn">mc_stat</span></pre>
<pre class='cython code score-16 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s__111);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s__111);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s__111);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_chromo_util_mc_stat, __pyx_t_2, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mc_stat, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0022</span>: <span class="k">from</span> <span class="nn">chromo.util.linalg</span> <span class="k">cimport</span> <span class="p">(</span><span class="n">vec_sub3</span><span class="p">,</span> <span class="n">vec_dot3</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">)</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0023</span>: <span class="k">from</span> <span class="nn">.util</span> <span class="k">import</span> <span class="n">dss_params</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_dss_params);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_dss_params);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_dss_params);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_util, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_dss_params, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0024</span>: <span class="k">from</span> <span class="nn">.util</span> <span class="k">import</span> <span class="n">poly_paths</span> <span class="k">as</span> <span class="n">paths</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_poly_paths);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_poly_paths);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_poly_paths);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_util, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_poly_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_paths, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0025</span>: <span class="k">from</span> <span class="nn">.util.nucleo_geom</span> <span class="k">import</span> <span class="n">consts_dict</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_consts_dict);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_consts_dict);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_consts_dict);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_util_nucleo_geom, __pyx_t_1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_consts_dict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_consts_dict, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="c"># Global type aliases and variables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="n">uint8</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0029</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">empty_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__112, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d));
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_8polymers_empty_2d, ((PyArrayObject *)__pyx_t_2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__112 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__27);<span class='error_goto'> if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__112);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__112);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0030</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">mty_2d_int</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__112, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_8polymers_mty_2d_int, ((PyArrayObject *)__pyx_t_3));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0031</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">empty_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">0</span><span class="p">,</span> <span class="p">))</span></pre>
<pre class='cython code score-21 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__113 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__113);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__113);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__114, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_8polymers_empty_1d, ((PyArrayObject *)__pyx_t_3));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_tuple__114 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__113);<span class='error_goto'> if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__114);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__114);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0032</span>: <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">empty_1d_str</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">0</span><span class="p">,</span> <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyString_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__114, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6chromo_8polymers_empty_1d_str, ((PyArrayObject *)__pyx_t_1));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0035</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E_HUGE</span> <span class="o">=</span> <span class="mf">1E25</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6chromo_8polymers_E_HUGE = 1E25;
</pre><pre class="cython line score-0">&#xA0;<span class="">0036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: <span class="c"># Length per base pair of DNA</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0038</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">LENGTH_BP</span> <span class="o">=</span> <span class="mf">0.332</span></pre>
<pre class='cython code score-0 '>  __pyx_v_6chromo_8polymers_LENGTH_BP = 0.332;
</pre><pre class="cython line score-0">&#xA0;<span class="">0039</span>: <span class="c"># Natural twist of linker DNA (in radians / bp)</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0040</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">NATURAL_TWIST_BARE</span> <span class="o">=</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">10.5</span></pre>
<pre class='cython code score-25 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFloat_DivideObjC</span>(__pyx_t_1, __pyx_float_10_5, 10.5, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_6chromo_8polymers_NATURAL_TWIST_BARE = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">0041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">TransformedObject</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents any object undergoing physical transformations during MC sim.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: <span class="sd">    This class provides the transformation matrix attribute. The transformation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="sd">    matrix is updated with each iteration of the MC simulation. It&#39;s inclusion</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="sd">    avoids costly matrix initialization with each iteration, drastically</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="sd">    improving runtime.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: <span class="sd">    Attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: <span class="sd">    transformation_mat : array_like (4, 4) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>: <span class="sd">        Homogeneous transformation matrix for an arbitrary transformation in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>: <span class="sd">        the MC simulation; stored as attribute to avoid costly array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>: <span class="sd">        generation during inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0061</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_17TransformedObject_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6chromo_8polymers_17TransformedObject_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__init__", 0))) return -1;
  __pyx_r = __pyx_pf_6chromo_8polymers_17TransformedObject___init__(((struct __pyx_obj_6chromo_8polymers_TransformedObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_17TransformedObject___init__(struct __pyx_obj_6chromo_8polymers_TransformedObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.TransformedObject.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">transformation_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_identity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple_, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;transformation_mat, 0);
  __pyx_v_self-&gt;transformation_mat = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 62, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0">&#xA0;<span class="">0063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">PolymerBase</span><span class="p">(</span><span class="n">TransformedObject</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase {
  double (*compute_dE)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, PyObject *, __Pyx_memviewslice, long);
  void (*update_log_path)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, PyObject *, int __pyx_skip_dispatch);
  void (*construct_beads)(struct __pyx_obj_6chromo_8polymers_PolymerBase *);
  void (*check_binders)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, PyArrayObject *);
  void (*check_chemical_mods)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, PyArrayObject *);
  PyArrayObject *(*get_prop)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, __Pyx_memviewslice, PyObject *, int __pyx_skip_dispatch);
  PyArrayObject *(*get_all)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, PyObject *, int __pyx_skip_dispatch);
  long (*get_num_binders)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, int __pyx_skip_dispatch);
  long (*get_num_beads)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, int __pyx_skip_dispatch);
  int (*is_field_active)(struct __pyx_obj_6chromo_8polymers_PolymerBase *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *__pyx_vtabptr_6chromo_8polymers_PolymerBase;

</pre><pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class representation of an arbitrary polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>: <span class="sd">    See `TransformedObject` documentation for additional notes and attributes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="sd">    Attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: <span class="sd">    name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>: <span class="sd">        A name of the polymer for convenient representation; should be a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="sd">        valid filename</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: <span class="sd">    log_path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>: <span class="sd">        Path to configuration tracker log (if empty, flags for no configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>: <span class="sd">        log to be generated)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="sd">    beads : beads.Bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: <span class="sd">        Monomeric unit forming the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: <span class="sd">    num_beads : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>: <span class="sd">        Number of monomeric units forming the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>: <span class="sd">    configuration_tracker : mc_stat.ConfigurationTracker</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: <span class="sd">        Object tracking configuration of the polymer over the course of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="sd">        MC simulation, used for purposes of tracking simulation convergence</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: <span class="sd">    lp : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>: <span class="sd">        Persistence length of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>: <span class="sd">    num_binders : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>: <span class="sd">        Number of reader protein types bound to the polymer which are tracked</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>: <span class="sd">        by the simulator</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>: <span class="sd">    n_binders_p1 : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>: <span class="sd">        One more than `num_binders` to avoid repeated calculation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="sd">    binder_names : array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>: <span class="sd">        Name of M bound chemical states tracked in `states`; length of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: <span class="sd">        `binder_names` must match number of columns in `states`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: <span class="sd">    all_inds : array_like (N,) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>: <span class="sd">        Indices corresponding to each bead in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>: <span class="sd">    r, t3, t2 : array_like (N, 3) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>: <span class="sd">        Current position (r), tangent vector (t3) and material normal (t2) in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>: <span class="sd">        global coordinates (x, y, z) for each of N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0102</span>: <span class="sd">    r_trial, t3_trial, t2_trial : array_like (N, 3) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>: <span class="sd">        Proposed position (r), tangent vector (t3) and material normal (t2) in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>: <span class="sd">        global coordinates (x, y, z) for each of N beads in the polymer;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>: <span class="sd">        evaluated for acceptance using energy change determined by `compute_dE`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: <span class="sd">    states : array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>: <span class="sd">        Current state of each of the M reader proteins being tracked for each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: <span class="sd">        of the N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: <span class="sd">    states_trial : array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>: <span class="sd">        Trial state of each of the M reader proteins being tracked for each of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>: <span class="sd">        the N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="sd">    chemical_mods : array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: <span class="sd">        States of M chemical modifications (e.g., counts of H3K9me3) on each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>: <span class="sd">        of N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>: <span class="sd">    chemical_mod_names : array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: <span class="sd">        Name of M chemical modifications made to the polymer tracked for each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>: <span class="sd">        bead, corresponding to columns in `chemical_mods`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>: <span class="sd">    direction : array_like (3,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: <span class="sd">        Vector describing the direction of a transformation during a move in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>: <span class="sd">        the MC simulation; stored as attribute to avoid costly array generation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>: <span class="sd">        during inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>: <span class="sd">    point : array_like (3,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>: <span class="sd">        Used to describe a reference point (typically a fulcrum) for a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>: <span class="sd">        in the MC simulation; stored as attribute to avoid costly array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: <span class="sd">        generation during inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>: <span class="sd">    last_amp_move : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>: <span class="sd">        Most recent move amplitude during simulation step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>: <span class="sd">    last_amp_bead : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>: <span class="sd">        Most recent bead amplitude during simulation step</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>: <span class="sd">    required_attrs, _arrays, _3d_arrays : array_like (L,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="sd">        Minimal required attributes (required_attrs), arrays tracked (_arrays),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: <span class="sd">        and multi-index arrays tracked (_3d_arrays) by the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>: <span class="sd">    dr, dr_perp, bend : array_like (3,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>: <span class="sd">        Change in position (dr), perpendicular component of the change in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>: <span class="sd">        position (dr_perp), and bend vector (bend) used to compute the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>: <span class="sd">        elastic energy of a bond in a polymer; stored as attribute to avoid</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>: <span class="sd">        costly array generation during inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>: <span class="sd">    dr_test, dr_perp_test, bend_test : array_like (3,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>: <span class="sd">        Change in position (dr_test), perpendicular component of the change in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: <span class="sd">        position (dr_perp_test), and bend vector (bend_test) of proposed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>: <span class="sd">        configuration used to compute the elastic energy of a bond in a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>: <span class="sd">        polymer; stored as attribute to avoid costly array generation during</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>: <span class="sd">        inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>: <span class="sd">    densities_temp : array_like (2, n_binders_p1, 8) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>: <span class="sd">        Densities for current (dim0 = 0) and trial (dim0 = 1) bins containing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>: <span class="sd">        bead during MC move; the densities are tracked for the bead itself</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>: <span class="sd">        and each bound reader proteins (stored in dim1); the densities are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>: <span class="sd">        tracked for 8 bins containing the bead before and after the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>: <span class="sd">        (stored in dim2); stored as attribute to avoid costly array generation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>: <span class="sd">        during inner loop of simulation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>: <span class="sd">    max_binders : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>: <span class="sd">        Indicates the maximum number of total binders of any type that can bind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>: <span class="sd">        a single bead. This attribute accounts for steric limitations to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>: <span class="sd">        total number of binders that can attach to any give bead in the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>: <span class="sd">        A value of `-1` is reserved for no limit to the total number of binders</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>: <span class="sd">        bound to a bead. Any move which proposes more than the maximum number</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>: <span class="sd">        of binders is assigned an energy cost of 1E99 kT per binder beyond the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>: <span class="sd">        limit.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: <span class="sd">    Do not instantiate instances of `PolymerBase` -- this class functions as a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>: <span class="sd">    cython equivalent of an abstract base class. `PolymerBase` specifies the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>: <span class="sd">    attributes and methods required to define a new polymer class. The class</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>: <span class="sd">    also implements utility methods common to all polymer subclasses.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>: </pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-68 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_11PolymerBase_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase___init__[] = "Any polymer class requires these key attributes.\n\n        Notes\n        -----\n        Specifying these attributes ensures that new polymer classes are\n        compatible with the rest of the codebase. Optional arguments must be\n        specified by name.\n\n        `required_attrs` lists the required attributes of any polymer class,\n        `_arrays` lists the attributes of the polymer class which are stored as\n        arrays, and `_3d_arrays` lists arrays with multi-indexed (x, y, z)\n        values. I recognize that these would be better implemented as class\n        attributes if we were working in pure Python, but for Cython, it is\n        easier to treat these as instance attributes. This is because there is\n        no `.__class__` attribute in Cython, and we need to be able to access\n        `required_attrs`, `_arrays`, and `_3d_arrays` from the C code for any\n        particular subclass using methods in the superclass.\n\n        Parameters\n        ----------\n        name : str\n            A name of the polymer for convenient representation; should be a\n            valid filename\n        r : array_like (N, 3) of double\n            The positions of each bead forming monomeric units of the polymer\n        t3 : Optional array_like (N, 3) of double\n            The tangent vector to each bead in global coordinates (default is\n            empty array)\n        t2 : Optional array_like (N, 3) of double\n            Material normal to each bead in the global coordinate system; this\n            vector should be orthogonal to t2 (default is empty array)\n        bead_length : array_like (N,) of double\n            The length of each bond in the polymer (default is empty array)\n        lp : Optional double\n            The persistence length of the polymer (default is 0)\n        states : Optional array_like (N, M) of int\n            State of each of the M reader proteins being tracked for each of\n            the N beads (default is empty array)""\n        binder_names : Optional array_like (M,) of str\n            Name of M bound chemical states tracked in `states`; length of\n            `binder_names` must match number of columns in `states` (default is\n            empty array)\n        chemical_mods : Optional array_like (N, M) of long\n            States of M chemical modifications (e.g., counts of H3K9me3) on\n            each of N beads in the polymer (default is empty array)\n        chemical_mod_names : Optional array_like (M,) of str\n            Name of M chemical modifications made to the polymer tracked for\n            each bead, corresponding to columns in `chemical_mods` (default\n            is empty array)\n        log_path : Optional str\n            Path to configuration tracker log (default is empty string,\n            flagging for no configuration log to be generated)\n        max_binders : Optional long\n            Indicates the maximum number of total binders of any type that can\n            bind a single bead. This attribute accounts for steric limitations\n            to the total number of binders that can attach to any give bead in\n            the polymer. A value of `-1` is reserved for no limit to the total\n            number of binders bound to a bead. Any move which proposes more\n            than the maximum number of binders is assigned an energy cost of\n            1E99 kT per binder beyond the limit. (default = -1)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_11PolymerBase___init__;
#endif
static int __pyx_pw_6chromo_8polymers_11PolymerBase_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_log_path = 0;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    values[2] = ((PyObject*)__pyx_kp_s__2);
    values[8] = (PyObject *)__pyx_k__3;
    values[10] = (PyObject *)__pyx_k__4;
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 10)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 12 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = ((PyObject*)values[0]);
    if (values[1]) {
      __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 171, __pyx_L3_error)</span>
    } else {
      __pyx_v_r = __pyx_k__5;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_r, 1);
    }
    __pyx_v_log_path = ((PyObject*)values[2]);
    if (values[3]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 174, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__6;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[4]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 175, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__7;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[5]) {
      __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 176, __pyx_L3_error)</span>
    } else {
      __pyx_v_bead_length = __pyx_k__8;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
    }
    if (values[6]) {
      __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 177, __pyx_L3_error)</span>
    } else {
      __pyx_v_lp = ((double)0.0);
    }
    if (values[7]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 178, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__9;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[8]);
    if (values[9]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[9], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 180, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__10;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[10]);
    if (values[11]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[11]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 168, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 170, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 173, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase___init__(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_log_path, __pyx_v_t3, __pyx_v_t2, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_11PolymerBase___init__(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, PyObject *__pyx_v_log_path, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0171</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
  __pyx_k__5 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0172</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 174, __pyx_L1_error)</span>
  __pyx_k__6 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 175, __pyx_L1_error)</span>
  __pyx_k__7 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 176, __pyx_L1_error)</span>
  __pyx_k__8 = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0177</span>:         <span class="n">double</span> <span class="n">lp</span> <span class="o">=</span> <span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  __pyx_k__9 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__3 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  __pyx_k__10 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__4 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">0182</span>:         <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0183</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0184</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Any polymer class requires these key attributes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0186</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0187</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0188</span>: <span class="sd">        Specifying these attributes ensures that new polymer classes are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0189</span>: <span class="sd">        compatible with the rest of the codebase. Optional arguments must be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0190</span>: <span class="sd">        specified by name.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: <span class="sd">        `required_attrs` lists the required attributes of any polymer class,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: <span class="sd">        `_arrays` lists the attributes of the polymer class which are stored as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>: <span class="sd">        arrays, and `_3d_arrays` lists arrays with multi-indexed (x, y, z)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: <span class="sd">        values. I recognize that these would be better implemented as class</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: <span class="sd">        attributes if we were working in pure Python, but for Cython, it is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: <span class="sd">        easier to treat these as instance attributes. This is because there is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: <span class="sd">        no `.__class__` attribute in Cython, and we need to be able to access</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: <span class="sd">        `required_attrs`, `_arrays`, and `_3d_arrays` from the C code for any</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: <span class="sd">        particular subclass using methods in the superclass.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0203</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0204</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>: <span class="sd">            A name of the polymer for convenient representation; should be a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="sd">            valid filename</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: <span class="sd">        r : array_like (N, 3) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>: <span class="sd">            The positions of each bead forming monomeric units of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>: <span class="sd">        t3 : Optional array_like (N, 3) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>: <span class="sd">            The tangent vector to each bead in global coordinates (default is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>: <span class="sd">            empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>: <span class="sd">        t2 : Optional array_like (N, 3) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: <span class="sd">            Material normal to each bead in the global coordinate system; this</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>: <span class="sd">            vector should be orthogonal to t2 (default is empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: <span class="sd">        bead_length : array_like (N,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>: <span class="sd">            The length of each bond in the polymer (default is empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>: <span class="sd">        lp : Optional double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>: <span class="sd">            The persistence length of the polymer (default is 0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>: <span class="sd">        states : Optional array_like (N, M) of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>: <span class="sd">            State of each of the M reader proteins being tracked for each of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>: <span class="sd">            the N beads (default is empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0222</span>: <span class="sd">        binder_names : Optional array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>: <span class="sd">            Name of M bound chemical states tracked in `states`; length of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0224</span>: <span class="sd">            `binder_names` must match number of columns in `states` (default is</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0225</span>: <span class="sd">            empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0226</span>: <span class="sd">        chemical_mods : Optional array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0227</span>: <span class="sd">            States of M chemical modifications (e.g., counts of H3K9me3) on</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0228</span>: <span class="sd">            each of N beads in the polymer (default is empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0229</span>: <span class="sd">        chemical_mod_names : Optional array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0230</span>: <span class="sd">            Name of M chemical modifications made to the polymer tracked for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0231</span>: <span class="sd">            each bead, corresponding to columns in `chemical_mods` (default</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>: <span class="sd">            is empty array)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>: <span class="sd">        log_path : Optional str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: <span class="sd">            Path to configuration tracker log (default is empty string,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>: <span class="sd">            flagging for no configuration log to be generated)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0236</span>: <span class="sd">        max_binders : Optional long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>: <span class="sd">            Indicates the maximum number of total binders of any type that can</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: <span class="sd">            bind a single bead. This attribute accounts for steric limitations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>: <span class="sd">            to the total number of binders that can attach to any give bead in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: <span class="sd">            the polymer. A value of `-1` is reserved for no limit to the total</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: <span class="sd">            number of binders bound to a bead. Any move which proposes more</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: <span class="sd">            than the maximum number of binders is assigned an energy cost of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>: <span class="sd">            1E99 kT per binder beyond the limit. (default = -1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">num_binders</span><span class="p">,</span> <span class="nf">num_beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">required_attrs</span><span class="p">,</span> <span class="nf">_arrays</span><span class="p">,</span> <span class="nf">_3d_arrays</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">PolymerBase</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span></pre>
<pre class='cython code score-32 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0249</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0250</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;name);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;name);
  __pyx_v_self-&gt;name = __pyx_v_name;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0251</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;r, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_r, 0);
  __pyx_v_self-&gt;r = __pyx_v_r;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">t3</span> <span class="o">=</span> <span class="n">t3</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t3, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 0);
  __pyx_v_self-&gt;t3 = __pyx_v_t3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="n">t2</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t2, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 0);
  __pyx_v_self-&gt;t2 = __pyx_v_t2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bead_length</span> <span class="o">=</span> <span class="n">bead_length</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;bead_length, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_bead_length, 0);
  __pyx_v_self-&gt;bead_length = __pyx_v_bead_length;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">states</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;states, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 0);
  __pyx_v_self-&gt;states = __pyx_v_states;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0256</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span> <span class="o">=</span> <span class="n">max_binders</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;max_binders = __pyx_v_max_binders;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span> <span class="o">=</span> <span class="n">binder_names</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_binder_names));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_binder_names));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;binder_names);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;binder_names));
  __pyx_v_self-&gt;binder_names = __pyx_v_binder_names;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">chemical_mods</span></pre>
<pre class='cython code score-0 '>  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;chemical_mods, 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 0);
  __pyx_v_self-&gt;chemical_mods = __pyx_v_chemical_mods;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0259</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">chemical_mod_names</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_chemical_mod_names));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_chemical_mod_names));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;chemical_mod_names);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;chemical_mod_names));
  __pyx_v_self-&gt;chemical_mod_names = __pyx_v_chemical_mod_names;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_beads = ((struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *)__pyx_v_self-&gt;__pyx_vtab)-&gt;get_num_beads(__pyx_v_self, 0);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">fill_missing_arguments</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_fill_missing_arguments);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">all_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_2, __pyx_int_1};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_int_0, __pyx_t_2, __pyx_int_1};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, __pyx_int_1);
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;all_inds, 0);
  __pyx_v_self-&gt;all_inds = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0263</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_binders</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;num_binders = ((struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *)__pyx_v_self-&gt;__pyx_vtab)-&gt;get_num_binders(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_binders_p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_binders_p1 = (__pyx_v_self-&gt;num_binders + 1);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">log_path</span> <span class="o">=</span> <span class="n">log_path</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_log_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_log_path);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;log_path);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;log_path);
  __pyx_v_self-&gt;log_path = __pyx_v_log_path;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">check_binders</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *)__pyx_v_self-&gt;__pyx_vtab)-&gt;check_binders(__pyx_v_self, __pyx_v_states, __pyx_v_binder_names);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0267</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">construct_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *)__pyx_v_self-&gt;__pyx_vtab)-&gt;construct_beads(__pyx_v_self);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">update_log_path</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase *)__pyx_v_self-&gt;__pyx_vtab)-&gt;update_log_path(__pyx_v_self, __pyx_v_log_path, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0269</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lp</span> <span class="o">=</span> <span class="n">lp</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;lp = __pyx_v_lp;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">required_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_name);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_binder_names);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_binder_names);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 5, __pyx_n_s_binder_names);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_binders);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 6, __pyx_n_s_num_binders);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 7, __pyx_n_s_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 8, __pyx_n_s_num_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 9, __pyx_n_s_lp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 10, __pyx_n_s_bead_length);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 270, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;required_attrs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;required_attrs));
  __pyx_v_self-&gt;required_attrs = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>:             <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="s">&quot;t3&quot;</span><span class="p">,</span> <span class="s">&quot;t2&quot;</span><span class="p">,</span> <span class="s">&quot;states&quot;</span><span class="p">,</span> <span class="s">&quot;binder_names&quot;</span><span class="p">,</span> <span class="s">&quot;num_binders&quot;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>:             <span class="s">&quot;beads&quot;</span><span class="p">,</span> <span class="s">&quot;num_beads&quot;</span><span class="p">,</span> <span class="s">&quot;lp&quot;</span><span class="p">,</span> <span class="s">&quot;bead_length&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>:         <span class="p">])</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_arrays);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_arrays));
  __pyx_v_self-&gt;_arrays = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0275</span>:             <span class="p">[</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;t3&#39;</span><span class="p">,</span> <span class="s">&#39;t2&#39;</span><span class="p">,</span> <span class="s">&#39;states&#39;</span><span class="p">,</span> <span class="s">&#39;chemical_mods&#39;</span><span class="p">,</span> <span class="s">&#39;bead_length&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-32 '>  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 275, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chemical_mods);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chemical_mods);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 4, __pyx_n_s_chemical_mods);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 5, __pyx_n_s_bead_length);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0276</span>:         <span class="p">)</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_3d_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;t3&#39;</span><span class="p">,</span> <span class="s">&#39;t2&#39;</span><span class="p">])</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_t2);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_3d_arrays);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_3d_arrays));
  __pyx_v_self-&gt;_3d_arrays = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_single_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;lp&quot;</span><span class="p">,</span> <span class="s">&quot;lt&quot;</span><span class="p">,</span> <span class="s">&quot;bp_wrap&quot;</span><span class="p">])</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_name);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_s_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_n_s_lp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lt);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_n_s_lt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bp_wrap);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bp_wrap);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_n_s_bp_wrap);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;_single_values);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;_single_values));
  __pyx_v_self-&gt;_single_values = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0279</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0280</span>:         <span class="c"># For move proposals</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0281</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>}
  __pyx_t_8 = __pyx_memoryview_copy_slice_d_dc_double_c(__pyx_v_self-&gt;r);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;r_trial, 0);
  __pyx_v_self-&gt;r_trial = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>}
  __pyx_t_8 = __pyx_memoryview_copy_slice_d_dc_double_c(__pyx_v_self-&gt;t3);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 282, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t3_trial, 0);
  __pyx_v_self-&gt;t3_trial = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 283, __pyx_L1_error)</span>}
  __pyx_t_8 = __pyx_memoryview_copy_slice_d_dc_double_c(__pyx_v_self-&gt;t2);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t2_trial, 0);
  __pyx_v_self-&gt;t2_trial = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>}
  __pyx_t_9 = __pyx_memoryview_copy_slice_d_dc_long_c(__pyx_v_self-&gt;states);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 284, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;states_trial, 0);
  __pyx_v_self-&gt;states_trial = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">transformation_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mf">4</span><span class="p">,</span> <span class="mf">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.transformation_mat, 0);
  __pyx_v_self-&gt;__pyx_base.transformation_mat = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__11);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">last_amp_bead</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;last_amp_bead = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0287</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">last_amp_move</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;last_amp_move = 0.0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__14, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;direction, 0);
  __pyx_v_self-&gt;direction = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__13);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;point, 0);
  __pyx_v_self-&gt;point = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0290</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0291</span>:         <span class="c"># For elastic energy calculation</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;dr, 0);
  __pyx_v_self-&gt;dr = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__14, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;dr_test, 0);
  __pyx_v_self-&gt;dr_test = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;dr_perp, 0);
  __pyx_v_self-&gt;dr_perp = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;dr_perp_test, 0);
  __pyx_v_self-&gt;dr_perp_test = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__14, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;bend, 0);
  __pyx_v_self-&gt;bend = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">3</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;bend_test, 0);
  __pyx_v_self-&gt;bend_test = __pyx_t_10;
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>:         <span class="c"># For field energy calculation</span></pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">densities_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mf">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_binders_p1</span><span class="p">,</span> <span class="mf">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-38 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;n_binders_p1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_int_8);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;densities_temp, 0);
  __pyx_v_self-&gt;densities_temp = __pyx_t_11;
  __pyx_t_11.memview = NULL;
  __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0301</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0302</span>:     <span class="k">def</span> <span class="nf">fill_missing_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_3fill_missing_arguments(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_2fill_missing_arguments[] = "Fill empty arguments in `__init__` call.\n\n        Fills t3, t2, states, binder_names, chemical_mods, chemical_mod_names\n        if not defined during polymer initialization.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_3fill_missing_arguments(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_missing_arguments (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_2fill_missing_arguments(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_2fill_missing_arguments(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("fill_missing_arguments", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.fill_missing_arguments", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0303</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Fill empty arguments in `__init__` call.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: <span class="sd">        Fills t3, t2, states, binder_names, chemical_mods, chemical_mod_names</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: <span class="sd">        if not defined during polymer initialization.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0308</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_v_self-&gt;t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_1, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0309</span>:             <span class="k">print</span><span class="p">(</span><span class="s">&quot;No t3 tangent vectors defined.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_No_t3_tangent_vectors_defined) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t3, 0);
    __pyx_v_self-&gt;t3 = __pyx_t_6;
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_v_self-&gt;t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_4, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0312</span>:             <span class="k">print</span><span class="p">(</span><span class="s">&quot;No t2 tangent vectors defined.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_No_t2_tangent_vectors_defined) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 312, __pyx_L1_error)</span>
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0313</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_n_s_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;t2, 0);
    __pyx_v_self-&gt;t2 = __pyx_t_6;
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_v_self-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_1, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0315</span>:             <span class="k">print</span><span class="p">(</span><span class="s">&quot;No states defined.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_No_states_defined) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;states, 0);
    __pyx_v_self-&gt;states = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-25 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_v_self-&gt;binder_names)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_self-&gt;binder_names));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_4, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&quot;null_reader&quot;</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_null_reader);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_null_reader);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_null_reader);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;binder_names);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;binder_names));
    __pyx_v_self-&gt;binder_names = ((PyArrayObject *)__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemical_mods</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_v_self-&gt;chemical_mods.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>}
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_3, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:             <span class="k">print</span><span class="p">(</span><span class="s">&quot;No chemical modifications defined.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PrintOne</span>(0, __pyx_kp_s_No_chemical_modifications_define) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;chemical_mods, 0);
    __pyx_v_self-&gt;chemical_mods = __pyx_t_7;
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemical_mod_names</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-25 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)__pyx_v_self-&gt;chemical_mod_names)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_self-&gt;chemical_mod_names));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_1, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&quot;null_mod&quot;</span><span class="p">])</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_null_mod);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_null_mod);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_null_mod);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;chemical_mod_names);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;chemical_mod_names));
    __pyx_v_self-&gt;chemical_mod_names = ((PyArrayObject *)__pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0324</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_6chromo_8polymers_11PolymerBase_compute_dE(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_move_name, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_inds, CYTHON_UNUSED long __pyx_v_n_inds) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:         <span class="nb">str</span> <span class="n">move_name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>:         <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>:         <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the change in configurational (elastic) energy of a polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: <span class="sd">        This method must be implemented for any subclass of PolymerBase and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: <span class="sd">        is implemented based on the polymer model representing the subclass.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: <span class="sd">        move_name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>: <span class="sd">            Name of the MC move for which the energy change is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>: <span class="sd">        inds : array_like of int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: <span class="sd">            Indices of the beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: <span class="sd">        n_inds : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>: <span class="sd">            Number of indices affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: <span class="sd">        float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: <span class="sd">            Elastic energy change associated with the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_6chromo_8polymers_11PolymerBase_construct_beads(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0355</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a list of beads forming the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: <span class="sd">        This method must be implemented for any subclass of PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>: <span class="sd">        Stores a dictionary of beads constructing the polymer chain, where keys</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="sd">        represent bead IDs and values represent `beads.Bead` objects. The</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="sd">        dictionary is stored as an attribute of the `PolymerBase` class.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0367</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_5__str__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_4__str__[] = "Return string representation of the Polymer.\n\n        Returns\n        -------\n        str\n            String representation listing key attributes of the polymer\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_11PolymerBase_4__str__;
#endif
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_5__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_4__str__(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_4__str__(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_v_rep = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rep);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0368</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation of the Polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0371</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>: <span class="sd">        str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>: <span class="sd">            String representation listing key attributes of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0374</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:         <span class="n">rep</span> <span class="o">=</span> <span class="n">f</span><span class="s">&quot;Polymer&lt;{self.name}, nbeads={self.num_beads}, &quot;</span> <span class="w">\</span></pre>
<pre class='cython code score-28 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Polymer);
  __pyx_t_2 += 8;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Polymer);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Polymer);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_self-&gt;name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_nbeads);
  __pyx_t_2 += 9;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_nbeads);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_nbeads);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_long</span>(__pyx_v_self-&gt;num_beads, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_nbinder);
  __pyx_t_2 += 10;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_nbinder);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u_nbinder);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 7, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_rep = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:             <span class="n">f</span><span class="s">&quot;nbinder={self.num_binders}&gt;&quot;</span></pre>
<pre class='cython code score-7 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_long</span>(__pyx_v_self-&gt;num_binders, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__15);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 6, __pyx_kp_u__15);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:         <span class="k">return</span> <span class="n">rep</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rep);
  __pyx_r = __pyx_v_rep;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0378</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:     <span class="k">def</span> <span class="nf">check_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_7check_attrs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_6check_attrs[] = "Check that the required attributes are specified in the class.\n\n        Notes\n        -----\n        The required attributes of any polymer are stored in `required_attrs`.\n        All required attributes must be initialized for any polymer to be\n        instantiated. This method is run during the initialization of the\n        polymer to verify that all required attributes are specified.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_7check_attrs(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_attrs (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_6check_attrs(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_6check_attrs(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_v_attr = 0;
  long __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_attrs", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.check_attrs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_attr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0380</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that the required attributes are specified in the class.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0382</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: <span class="sd">        The required attributes of any polymer are stored in `required_attrs`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: <span class="sd">        All required attributes must be initialized for any polymer to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>: <span class="sd">        instantiated. This method is run during the initialization of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: <span class="sd">        polymer to verify that all required attributes are specified.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>:         <span class="k">cdef</span> <span class="kt">str</span> <span class="nf">attr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_attrs</span><span class="p">)):</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;required_attrs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 391, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:             <span class="n">attr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">required_attrs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></pre>
<pre class='cython code score-16 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_self-&gt;required_attrs), __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!(likely(<span class='py_c_api'>PyString_CheckExact</span>(__pyx_t_5))||((__pyx_t_5) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_t_5)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_attr, ((PyObject*)__pyx_t_5));
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(((PyObject *)__pyx_v_self), __pyx_v_attr);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 393, __pyx_L1_error)</span>
    __pyx_t_7 = ((!(__pyx_t_6 != 0)) != 0);
    if (unlikely(__pyx_t_7)) {
/* … */
    }
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:                 <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_NotImplementedError, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:                     <span class="s">&quot;Polymer subclass missing required attribute: &quot;</span> <span class="o">+</span> <span class="n">attr</span></pre>
<pre class='cython code score-5 '>      __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_Polymer_subclass_missing_require, __pyx_v_attr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">0396</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = ((__pyx_v_self-&gt;lp == 0.0) != 0);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 398, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Specify_the_persistence_length_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 398, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class="cython line score-0">&#xA0;<span class="">0399</span>:                 <span class="s">&quot;Specify the persistence length in the subclass of Polymer&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">check_binders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span><span class="p">):</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_6chromo_8polymers_11PolymerBase_check_binders(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names) {
  long __pyx_v_num_binders;
  Py_ssize_t __pyx_v_num_beads;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_binders", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.check_binders", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify that specified binder states and names are valid.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: <span class="sd">        states : array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: <span class="sd">            State of each of the M binders being tracked for each of the N bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="sd">        binder_names : array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: <span class="sd">            Name of M bound chemical states tracked in `states`; the number of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: <span class="sd">            `binder_names` specified must match number of columns in `states`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">n_beads</span><span class="p">,</span> <span class="nf">num_binders</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0414</span>:         <span class="k">if</span> <span class="n">states</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (((__pyx_v_states.shape[1]) != 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0415</span>:             <span class="n">num_beads</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_beads = (__pyx_v_states.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:             <span class="n">num_binders</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_v_num_binders = (__pyx_v_states.shape[1]);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0417</span>:             <span class="k">if</span> <span class="n">num_binders</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binder_names</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_binder_names));<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 417, __pyx_L1_error)</span>
    __pyx_t_1 = ((__pyx_v_num_binders != __pyx_t_2) != 0);
    if (unlikely(__pyx_t_1)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0418</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Each chemical state must be given a name.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 418, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Each_chemical_state_must_be_give);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 418, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0419</span>:             <span class="k">if</span> <span class="n">num_beads</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 419, __pyx_L1_error)</span>}
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;r); 
    __pyx_t_1 = ((__pyx_v_num_beads != __pyx_t_4) != 0);
    if (unlikely(__pyx_t_1)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0420</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Initial epigenetic state of wrong length.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 420, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Initial_epigenetic_state_of_wron);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 420, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-0">&#xA0;<span class="">0421</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0422</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">check_chemical_mods</span><span class="p">(</span></pre>
<pre class='cython code score-3 '>static void __pyx_f_6chromo_8polymers_11PolymerBase_check_chemical_mods(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_chemical_mods", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.check_chemical_mods", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0423</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check that a valid array of chemical modifications was specified.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: <span class="sd">        There must be a sequence of chemical modifications per reader protein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: <span class="sd">        included in the model. The sequence of chemical modifications must be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>: <span class="sd">        of length `self.num_beads`, meaning there is a chemical modification</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>: <span class="sd">        status specified for each bead of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: <span class="sd">        chemical_mods : array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="sd">            States of M chemical modifications (e.g., counts of H3K9me3) on</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>: <span class="sd">            each of N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>: <span class="sd">        chemical_mod_names : Optional (M, ) str or Sequence[str]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>: <span class="sd">            Name of chemical modifications made to the polymer tracked for each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>: <span class="sd">            bead in `chemical_mods` attribute</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">!=</span> <span class="n">chemical_mods</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;num_binders != (__pyx_v_chemical_mods.shape[1])) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 446, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Number_of_chemical_modifications);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-0">&#xA0;<span class="">0447</span>:                 <span class="s">&quot;Number of chemical modifications and binders must match.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">!=</span> <span class="n">chemical_mods</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_self-&gt;num_beads != (__pyx_v_chemical_mods.shape[0])) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__20, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Chemical_mod_state_must_be_speci);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);
</pre><pre class="cython line score-0">&#xA0;<span class="">0451</span>:                 <span class="s">&quot;Chemical mod. state must be specified for each polymer bead.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0452</span>:             <span class="p">)</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chemical_mod_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">chemical_mods</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_chemical_mod_names));<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 453, __pyx_L1_error)</span>
  __pyx_t_1 = ((__pyx_t_3 != (__pyx_v_chemical_mods.shape[1])) != 0);
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Please_specify_a_name_for_each_c);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-0">&#xA0;<span class="">0455</span>:                 <span class="s">&quot;Please specify a name for each chemical modification.&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0458</span>:     <span class="nd">@staticmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_staticmethod, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase-&gt;tp_dict, __pyx_n_s_load_seqs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_PolymerBase);
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:     <span class="k">def</span> <span class="nf">load_seqs</span><span class="p">(</span><span class="n">paths_to_seqs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span></pre>
<pre class='cython code score-51 '>/* Python wrapper */
static PyArrayObject *__pyx_pw_6chromo_8polymers_11PolymerBase_9load_seqs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_8load_seqs[] = "Load sequence of all chemical modifications on beads of polymer.\n\n        Parameters\n        ----------\n        paths_to_seqs : array_like (M,) of str\n            Paths to the sequence of chemical modifications or binders on the\n            beads. A single path should be provided per epigenetic mark.\n\n        Returns\n        -------\n        array_like (N, M) of long\n            States of M chemical modifications (e.g., counts of H3K9me3) on\n            each of N beads in the polymer\n        ";
static PyMethodDef __pyx_mdef_6chromo_8polymers_11PolymerBase_9load_seqs = {"load_seqs", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6chromo_8polymers_11PolymerBase_9load_seqs, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6chromo_8polymers_11PolymerBase_8load_seqs};
static PyArrayObject *__pyx_pw_6chromo_8polymers_11PolymerBase_9load_seqs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_paths_to_seqs = 0;
  PyArrayObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("load_seqs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_paths_to_seqs,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_paths_to_seqs)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "load_seqs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_paths_to_seqs = ((PyArrayObject *)values[0]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("load_seqs", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.load_seqs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_paths_to_seqs), __pyx_ptype_5numpy_ndarray, 1, "paths_to_seqs", 0))) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_8load_seqs(__pyx_v_paths_to_seqs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyArrayObject *__pyx_pf_6chromo_8polymers_11PolymerBase_8load_seqs(PyArrayObject *__pyx_v_paths_to_seqs) {
  Py_ssize_t __pyx_v_num_mods;
  PyObject *__pyx_v_first_seq = NULL;
  PyObject *__pyx_v_num_beads = NULL;
  PyObject *__pyx_v_chemical_mods = NULL;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_path = NULL;
  PyObject *__pyx_v_chemical_mod = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("load_seqs", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.load_seqs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_first_seq);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_num_beads);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chemical_mods);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chemical_mod);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__115 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_paths_to_seqs, __pyx_n_s_num_mods, __pyx_n_s_first_seq, __pyx_n_s_num_beads, __pyx_n_s_chemical_mods, __pyx_n_s_i, __pyx_n_s_path, __pyx_n_s_chemical_mod);<span class='error_goto'> if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__115);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__115);
/* … */
  __pyx_t_3 = PyCFunction_NewEx(&amp;__pyx_mdef_6chromo_8polymers_11PolymerBase_9load_seqs, NULL, __pyx_n_s_chromo_polymers);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase-&gt;tp_dict, __pyx_n_s_load_seqs, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_PolymerBase);
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase, __pyx_n_s_load_seqs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_codeobj__116 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__115, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_chromo_polymers_pyx, __pyx_n_s_load_seqs, 459, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__116)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0460</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Load sequence of all chemical modifications on beads of polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0464</span>: <span class="sd">        paths_to_seqs : array_like (M,) of str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0465</span>: <span class="sd">            Paths to the sequence of chemical modifications or binders on the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>: <span class="sd">            beads. A single path should be provided per epigenetic mark.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0468</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0469</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0470</span>: <span class="sd">        array_like (N, M) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>: <span class="sd">            States of M chemical modifications (e.g., counts of H3K9me3) on</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>: <span class="sd">            each of N beads in the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0473</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:         <span class="n">num_mods</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths_to_seqs</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_paths_to_seqs));<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  __pyx_v_num_mods = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:         <span class="k">if</span> <span class="n">num_mods</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_num_mods == 0) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:             <span class="k">return</span> <span class="n">mty_2d_int</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
    __pyx_r = __pyx_v_6chromo_8polymers_mty_2d_int;
    goto __pyx_L0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:         <span class="n">first_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">paths_to_seqs</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_loadtxt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_paths_to_seqs), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_first_seq = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>:         <span class="n">first_seq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">first_seq</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_v_first_seq) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_first_seq);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, ((PyObject *)(&amp;PyInt_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)(&amp;PyInt_Type)));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 478, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_first_seq, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0479</span>:         <span class="n">num_beads</span> <span class="o">=</span> <span class="n">first_seq</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_first_seq, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_num_beads = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0480</span>:         <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_beads</span><span class="p">,</span> <span class="n">num_mods</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_num_mods);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_num_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_chemical_mods = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0481</span>:         <span class="n">chemical_mods</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_seq</span></pre>
<pre class='cython code score-15 '>  __pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_chemical_mods, __pyx_tuple__23, __pyx_v_first_seq) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 481, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">num_mods</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_num_mods;
  __pyx_t_7 = __pyx_t_1;
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0483</span>:             <span class="n">path</span> <span class="o">=</span> <span class="n">paths_to_seqs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_paths_to_seqs), __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 483, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_path, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:             <span class="n">chemical_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_loadtxt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_path);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_path);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 484, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 484, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_chemical_mod, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>:             <span class="n">chemical_mod</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">chemical_mod</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_v_chemical_mod) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_chemical_mod);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_6 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, ((PyObject *)(&amp;PyInt_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)(&amp;PyInt_Type)));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_chemical_mod, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0486</span>:             <span class="k">if</span> <span class="n">chemical_mod</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_chemical_mod, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_v_num_beads, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 486, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(__pyx_t_2)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0487</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Inconsistent_sequences_of_chemic);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
</pre><pre class="cython line score-0">&#xA0;<span class="">0488</span>:                     <span class="s">&quot;Inconsistent sequences of chemical modifications&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0490</span>:             <span class="n">chemical_mods</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">chemical_mod</span></pre>
<pre class='cython code score-19 '>    __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__22);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_6);
    __pyx_t_6 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_chemical_mods, __pyx_t_3, __pyx_v_chemical_mod) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0491</span>:         <span class="k">return</span> <span class="n">chemical_mods</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_chemical_mods) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_chemical_mods, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_chemical_mods);
  __pyx_r = ((PyArrayObject *)__pyx_v_chemical_mods);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0492</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_log_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">log_path</span><span class="p">):</span></pre>
<pre class='cython code score-33 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_11update_log_path(PyObject *__pyx_v_self, PyObject *__pyx_v_log_path); /*proto*/
static void __pyx_f_6chromo_8polymers_11PolymerBase_update_log_path(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_log_path, int __pyx_skip_dispatch) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_log_path", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_update_log_path);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_11update_log_path)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_log_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_log_path);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 493, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.update_log_path", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_11update_log_path(PyObject *__pyx_v_self, PyObject *__pyx_v_log_path); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_10update_log_path[] = "Update the path to the configuration tracker log.\n        \n        Notes\n        -----\n        The configuration tracker is used during the simulation to evaluate \n        structural convergence of the polymer.\n\n        Parameters\n        ----------\n        log_path : str\n            Path to the configuration tracker log. If None, no configuration\n            tracker will be initialized. (default = None)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_11update_log_path(PyObject *__pyx_v_self, PyObject *__pyx_v_log_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_log_path (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 493, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_10update_log_path(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), ((PyObject*)__pyx_v_log_path));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_10update_log_path(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_log_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_log_path", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_8polymers_11PolymerBase_update_log_path(__pyx_v_self, __pyx_v_log_path, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.update_log_path", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0494</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the path to the configuration tracker log.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: <span class="sd">        The configuration tracker is used during the simulation to evaluate </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: <span class="sd">        structural convergence of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>: <span class="sd">        log_path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: <span class="sd">            Path to the configuration tracker log. If None, no configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: <span class="sd">            tracker will be initialized. (default = None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:         <span class="k">if</span> <span class="n">log_path</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_log_path, __pyx_kp_s__2, Py_NE)); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
  __pyx_t_6 = (__pyx_t_5 != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">configuration_tracker</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-1 '>    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;configuration_tracker);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;configuration_tracker);
    __pyx_v_self-&gt;configuration_tracker = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0509</span>:                 <span class="n">mc_stat</span><span class="o">.</span><span class="n">ConfigurationTracker</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-48 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_mc_stat);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ConfigurationTracker);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_v_self-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 509, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_log_path, __pyx_t_2};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_log_path, __pyx_t_2};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_log_path);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_log_path);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_v_log_path);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0510</span>: </pre>
<pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0511</span>:     <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">get_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span> <span class="nb">str</span> <span class="n">prop</span><span class="p">):</span></pre>
<pre class='cython code score-91 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_13get_prop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_6chromo_8polymers_11PolymerBase_get_prop(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, __Pyx_memviewslice __pyx_v_inds, PyObject *__pyx_v_prop, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_i = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_prop", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_prop);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_13get_prop)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
        if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span> }
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_6 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_v_prop};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_3, __pyx_v_prop};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (__pyx_t_5) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
          }
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_prop);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_prop);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_prop);
          __pyx_t_3 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span>
        __pyx_r = ((PyArrayObject *)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_prop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_13get_prop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_12get_prop[] = "Get specified property of beads at listed indices.\n\n        Parameters\n        ----------\n        inds : array_like (L,) of long\n            Bead indices at which to isolate multi-indexed attributes (e.g., \n            position, orientation) of the polymer\n        prop : str\n            Property of the bead to return at specified indices\n\n        Returns\n        -------\n        np.ndarray (M, 3)\n            Specified property of beads at specified indices\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_13get_prop(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_prop = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_prop (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_inds,&amp;__pyx_n_s_prop,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inds)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_prop)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_prop", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_prop") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_inds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_inds.memview)) __PYX_ERR(0, 511, __pyx_L3_error)</span>
    __pyx_v_prop = ((PyObject*)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_prop", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_prop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_prop), (&amp;PyString_Type), 1, "prop", 1))) <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_12get_prop(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), __pyx_v_inds, __pyx_v_prop);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_12get_prop(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, __Pyx_memviewslice __pyx_v_inds, PyObject *__pyx_v_prop) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_prop", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 511, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_6chromo_8polymers_11PolymerBase_get_prop(__pyx_v_self, __pyx_v_inds, __pyx_v_prop, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_prop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0512</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get specified property of beads at listed indices.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: <span class="sd">        inds : array_like (L,) of long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: <span class="sd">            Bead indices at which to isolate multi-indexed attributes (e.g., </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: <span class="sd">            position, orientation) of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>: <span class="sd">        prop : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>: <span class="sd">            Property of the bead to return at specified indices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: <span class="sd">        np.ndarray (M, 3)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0525</span>: <span class="sd">            Specified property of beads at specified indices</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0526</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0527</span>:         <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>
  __pyx_r = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:             <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">]</span></pre>
<pre class='cython code score-75 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
    __pyx_t_3 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_8 = 0;
    __pyx_t_9 = NULL;
  } else {
    __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  for (;;) {
    if (likely(!__pyx_t_9)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      } else {
        if (__pyx_t_8 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_8++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
      }
    } else {
      __pyx_t_7 = __pyx_t_9(__pyx_t_3);
      if (unlikely(!__pyx_t_7)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_self-&gt;beads, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_dict);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_5, __pyx_v_prop);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_7))) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 527, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0529</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:     <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">prop</span><span class="p">):</span></pre>
<pre class='cython code score-36 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_15get_all(PyObject *__pyx_v_self, PyObject *__pyx_v_prop); /*proto*/
static PyArrayObject *__pyx_f_6chromo_8polymers_11PolymerBase_get_all(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_prop, int __pyx_skip_dispatch) {
  PyObject *__pyx_v_array = NULL;
  Py_ssize_t __pyx_v_i;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_all", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_all);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_15get_all)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_prop) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_prop);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
        __pyx_r = ((PyArrayObject *)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_array);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_15get_all(PyObject *__pyx_v_self, PyObject *__pyx_v_prop); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_14get_all[] = "Get some bead property value from all beads.\n        \n        Notes\n        -----\n        Generates an array from a specified attribute separately stored in \n        each bead object representing the polymer. This utility function is \n        useful for accessing attributes which are separately stored in bead \n        objects and not aggregated in the polymer object. \n\n        Parameters\n        ----------\n        prop : str\n            Name of the property to obtain from all beads\n\n        Returns\n        -------\n        np.ndarray\n            Data frame of property values from all beads (default = None)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_15get_all(PyObject *__pyx_v_self, PyObject *__pyx_v_prop) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_all (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_prop), (&amp;PyString_Type), 1, "prop", 1))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_14get_all(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), ((PyObject*)__pyx_v_prop));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_14get_all(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_prop) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_all", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_6chromo_8polymers_11PolymerBase_get_all(__pyx_v_self, __pyx_v_prop, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_all", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0532</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get some bead property value from all beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: <span class="sd">        Generates an array from a specified attribute separately stored in </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="sd">        each bead object representing the polymer. This utility function is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">        useful for accessing attributes which are separately stored in bead </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">        objects and not aggregated in the polymer object. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        prop : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">            Name of the property to obtain from all beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">        np.ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: <span class="sd">            Data frame of property values from all beads (default = None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0551</span>:         <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:             <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">))]</span></pre>
<pre class='cython code score-38 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = __pyx_v_self-&gt;beads;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 552, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;beads, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_dict);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_8, __pyx_v_prop);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_4))) <span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_array = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0553</span>:         <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0554</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_array, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 554, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = ((__pyx_t_5 == 1) != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0555</span>:             <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">array</span><span class="p">)</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-23 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_atleast_2d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_array) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_array);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_array, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0556</span>:         <span class="k">return</span> <span class="n">array</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_array) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_array, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_array);
  __pyx_r = ((PyArrayObject *)__pyx_v_array);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0557</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0558</span>:     <span class="k">def</span> <span class="nf">update_prop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">prop</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_17update_prop(PyObject *__pyx_v_self, PyObject *__pyx_v_prop); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_16update_prop[] = "Update bead property for each bead in polymer.\n\n        Notes\n        -----\n        This utility function copies an attribute of the polymer to each bead\n        forming the polymer.\n\n        Parameters\n        ----------\n        prop : str\n            Name of the bead property being updated\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_17update_prop(PyObject *__pyx_v_self, PyObject *__pyx_v_prop) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_prop (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_prop), (&amp;PyString_Type), 1, "prop", 1))) <span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_16update_prop(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), ((PyObject*)__pyx_v_prop));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_16update_prop(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_prop) {
  long __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_prop", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.update_prop", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0559</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Update bead property for each bead in polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: <span class="sd">        This utility function copies an attribute of the polymer to each bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: <span class="sd">        forming the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>: <span class="sd">        prop : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: <span class="sd">            Name of the bead property being updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">)):</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = __pyx_v_self-&gt;beads;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_t_2;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">prop</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-54 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_getattr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, ((PyObject *)__pyx_v_self), __pyx_v_prop};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
      PyObject *__pyx_temp[3] = {__pyx_t_6, ((PyObject *)__pyx_v_self), __pyx_v_prop};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
      <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, ((PyObject *)__pyx_v_self));
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_prop);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_prop);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_v_prop);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;beads, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dict);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_t_8, __pyx_v_prop, __pyx_t_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:     <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_19to_dataframe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_18to_dataframe[] = "Write canonical CSV representation of the Polymer to file.\n\n        Notes\n        -----\n        The top-level multi-index values for the columns should correspond to\n        the kwargs, to simplify unpacking the structure (and to make for easy\n        accessing of the dataframe).\n\n        First get a listing of all the parts of the polymer that have to be\n        saved. These are defined in the class's `_arrays` attribute.\n\n        Next, separate out the arrays into two types: \"vector\" arrays are\n        composed of multiple columns (like r) and so we need to build a multi-\n        index for putting them into the data frame correctly.\n\n        All other arrays can be added as a single column to the data frame.\n\n        ReaderProtein names is a special case because it does not fit with\n        dimensions of the other properties, which are saved per bead.\n\n        Construct the parts of the DataFrame that need a multi-index.\n\n        TODO: remove \"list\" after numpy fixes issue 17305:\n        https://github.com/numpy/numpy/issues/17305\n\n        Replace:\n            `vector_arr = np.concatenate(list(vector_arrs.values()), axis=1)`\n        with:\n            `vector_arr = np.concatenate(vector_arrs.values(), axis=1)`\n\n        After adding multi-index properties, add remaining arrays one-by-one.\n\n        Returns\n        -------\n        pd.DataFrame\n            Data frame representation of the polymer, as recorded in the CSV\n            file that was generated\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_19to_dataframe(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_dataframe (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_18to_dataframe(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_18to_dataframe(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_v_arrays = NULL;
  PyObject *__pyx_v_single_vals = NULL;
  PyObject *__pyx_v_vector_arrs = NULL;
  PyObject *__pyx_v_regular_arrs = NULL;
  PyObject *__pyx_v_name = NULL;
  PyObject *__pyx_v_arr = NULL;
  PyObject *__pyx_v_vector_arr = NULL;
  PyObject *__pyx_v_vector_index = NULL;
  PyObject *__pyx_v_vector_df = NULL;
  PyObject *__pyx_v_states_index = NULL;
  PyObject *__pyx_v_chem_mod_index = NULL;
  PyObject *__pyx_v_states_df = NULL;
  PyObject *__pyx_v_chemical_mods_df = NULL;
  PyObject *__pyx_v_df = NULL;
  PyObject *__pyx_v_val = NULL;
  PyObject *__pyx_v_arr_temp = NULL;
  PyObject *__pyx_7genexpr__pyx_v_name = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_name = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_dataframe", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.to_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arrays);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_single_vals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vector_arrs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_regular_arrs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vector_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vector_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_vector_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_states_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chem_mod_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_states_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chemical_mods_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_val);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr_temp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0576</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Write canonical CSV representation of the Polymer to file.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="sd">        The top-level multi-index values for the columns should correspond to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="sd">        the kwargs, to simplify unpacking the structure (and to make for easy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="sd">        accessing of the dataframe).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="sd">        First get a listing of all the parts of the polymer that have to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="sd">        saved. These are defined in the class&#39;s `_arrays` attribute.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: <span class="sd">        Next, separate out the arrays into two types: &quot;vector&quot; arrays are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: <span class="sd">        composed of multiple columns (like r) and so we need to build a multi-</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: <span class="sd">        index for putting them into the data frame correctly.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: <span class="sd">        All other arrays can be added as a single column to the data frame.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="sd">        ReaderProtein names is a special case because it does not fit with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: <span class="sd">        dimensions of the other properties, which are saved per bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: <span class="sd">        Construct the parts of the DataFrame that need a multi-index.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>: <span class="sd">        TODO: remove &quot;list&quot; after numpy fixes issue 17305:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="sd">        https://github.com/numpy/numpy/issues/17305</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>: <span class="sd">        Replace:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>: <span class="sd">            `vector_arr = np.concatenate(list(vector_arrs.values()), axis=1)`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>: <span class="sd">        with:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: <span class="sd">            `vector_arr = np.concatenate(vector_arrs.values(), axis=1)`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>: <span class="sd">        After adding multi-index properties, add remaining arrays one-by-one.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>: <span class="sd">        pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>: <span class="sd">            Data frame representation of the polymer, as recorded in the CSV</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>: <span class="sd">            file that was generated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:         <span class="n">arrays</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-5 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L5_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>:             <span class="n">name</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span></pre>
<pre class='cython code score-53 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;_arrays))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;_arrays))) {
      __pyx_t_2 = ((PyObject *)__pyx_v_self-&gt;_arrays); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self-&gt;_arrays));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L5_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L5_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 615, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L5_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 615, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L5_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_7genexpr__pyx_v_name, __pyx_t_5);
      __pyx_t_5 = 0;
/* … */
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_7genexpr__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 615, __pyx_L5_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_7genexpr__pyx_v_name, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L5_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_name); __pyx_7genexpr__pyx_v_name = 0;
    goto __pyx_L9_exit_scope;
    __pyx_L5_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_name); __pyx_7genexpr__pyx_v_name = 0;
    goto __pyx_L1_error;
    __pyx_L9_exit_scope:;
  } /* exit inner scope */
  __pyx_v_arrays = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:             <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(((PyObject *)__pyx_v_self), __pyx_7genexpr__pyx_v_name);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 616, __pyx_L5_error)</span>
      __pyx_t_7 = (__pyx_t_6 != 0);
      if (__pyx_t_7) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>:         <span class="p">}</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:         <span class="n">single_vals</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-5 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L12_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>:             <span class="n">name</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_single_values</span></pre>
<pre class='cython code score-53 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;_single_values))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;_single_values))) {
      __pyx_t_2 = ((PyObject *)__pyx_v_self-&gt;_single_values); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self-&gt;_single_values));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L12_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L12_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L12_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L12_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L12_error)</span>
          #else
          __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L12_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          #endif
        }
      } else {
        __pyx_t_5 = __pyx_t_4(__pyx_t_2);
        if (unlikely(!__pyx_t_5)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L12_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_name, __pyx_t_5);
      __pyx_t_5 = 0;
/* … */
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetAttr</span>(((PyObject *)__pyx_v_self), __pyx_8genexpr1__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L12_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr1__pyx_v_name, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 619, __pyx_L12_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name); __pyx_8genexpr1__pyx_v_name = 0;
    goto __pyx_L16_exit_scope;
    __pyx_L12_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_name); __pyx_8genexpr1__pyx_v_name = 0;
    goto __pyx_L1_error;
    __pyx_L16_exit_scope:;
  } /* exit inner scope */
  __pyx_v_single_vals = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0620</span>:             <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(((PyObject *)__pyx_v_self), __pyx_8genexpr1__pyx_v_name);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 620, __pyx_L12_error)</span>
      __pyx_t_6 = (__pyx_t_7 != 0);
      if (__pyx_t_6) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0621</span>:         <span class="p">}</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:         <span class="n">vector_arrs</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_vector_arrs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:         <span class="n">regular_arrs</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_regular_arrs = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0624</span>: </pre>
<pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:         <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrays</span><span class="o">.</span><span class="n">items</span><span class="p">():</span></pre>
<pre class='cython code score-91 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_Items</span>(__pyx_v_arrays);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;
      index = 0; __pyx_t_5 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_5)) goto __pyx_L19_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      index = 1; __pyx_t_8 = __pyx_t_10(__pyx_t_9); if (unlikely(!__pyx_t_8)) goto __pyx_L19_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_10(__pyx_t_9), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
      __pyx_t_10 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L20_unpacking_done;
      __pyx_L19_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
      __pyx_L20_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arr, __pyx_t_8);
    __pyx_t_8 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:             <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_3d_arrays</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_name, ((PyObject *)__pyx_v_self-&gt;_3d_arrays), Py_EQ)); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
    __pyx_t_7 = (__pyx_t_6 != 0);
    if (__pyx_t_7) {
/* … */
      goto __pyx_L21;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0627</span>:                 <span class="n">vector_arrs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span></pre>
<pre class='cython code score-5 '>      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_vector_arrs, __pyx_v_name, __pyx_v_arr) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:             <span class="k">elif</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&#39;states&#39;</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&#39;chemical_mods&#39;</span> <span class="w">\</span></pre>
<pre class='cython code score-4 '>    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_name, __pyx_n_s_states, Py_NE)); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
    if (__pyx_t_6) {
    } else {
      __pyx_t_7 = __pyx_t_6;
      goto __pyx_L22_bool_binop_done;
    }
/* … */
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_name, __pyx_n_s_chemical_mods, Py_NE)); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
    if (__pyx_t_6) {
    } else {
      __pyx_t_7 = __pyx_t_6;
      goto __pyx_L22_bool_binop_done;
    }
/* … */
    if (__pyx_t_7) {
/* … */
    }
    __pyx_L21:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:                     <span class="ow">and</span> <span class="n">name</span> <span class="o">!=</span> <span class="s">&quot;bead_length&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_name, __pyx_n_s_bead_length, Py_NE)); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
    __pyx_t_7 = __pyx_t_6;
    __pyx_L22_bool_binop_done:;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:                 <span class="n">regular_arrs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span></pre>
<pre class='cython code score-5 '>      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_regular_arrs, __pyx_v_name, __pyx_v_arr) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:         <span class="n">vector_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vector_arrs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_Values</span>(__pyx_v_vector_arrs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_vector_arr = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:         <span class="n">vector_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_MultiIndex);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_from_product);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:             <span class="p">[</span><span class="n">vector_arrs</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">,</span> <span class="s">&#39;z&#39;</span><span class="p">)]</span></pre>
<pre class='cython code score-30 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_Keys</span>(__pyx_v_vector_arrs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_tuple__25);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_vector_index = __pyx_t_5;
  __pyx_t_5 = 0;
/* … */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_z);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
</pre><pre class="cython line score-0">&#xA0;<span class="">0634</span>:         <span class="p">)</span></pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:         <span class="n">vector_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vector_arr</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">vector_index</span><span class="p">)</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vector_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vector_arr);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_vector_arr);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_columns, __pyx_v_vector_index) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vector_df = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemical_mod_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>  __pyx_t_2 = ((PyObject *)__pyx_v_self-&gt;chemical_mod_names);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = ((__pyx_t_3 &gt; 0) != 0);
  if (__pyx_t_7) {
/* … */
    goto __pyx_L25;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:             <span class="n">states_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_MultiIndex);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_from_tuples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:                 <span class="p">[(</span><span class="s">&#39;states&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span><span class="p">]</span></pre>
<pre class='cython code score-75 '>    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;binder_names))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;binder_names))) {
      __pyx_t_8 = ((PyObject *)__pyx_v_self-&gt;binder_names); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self-&gt;binder_names));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_4(__pyx_t_8);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_n_s_states);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_name);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_5, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_2 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_states_index = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0639</span>:             <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0640</span>:             <span class="n">chem_mod_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_MultiIndex);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_from_tuples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:                 <span class="p">[(</span><span class="s">&#39;chemical_mods&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mod_names</span><span class="p">]</span></pre>
<pre class='cython code score-75 '>    __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;chemical_mod_names))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_v_self-&gt;chemical_mod_names))) {
      __pyx_t_8 = ((PyObject *)__pyx_v_self-&gt;chemical_mod_names); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_3 = 0;
      __pyx_t_4 = NULL;
    } else {
      __pyx_t_3 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_v_self-&gt;chemical_mod_names));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_4)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        } else {
          if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
          #else
          __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          #endif
        }
      } else {
        __pyx_t_9 = __pyx_t_4(__pyx_t_8);
        if (unlikely(!__pyx_t_9)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_9);
      __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chemical_mods);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chemical_mods);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_n_s_chemical_mods);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_v_name);
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_5, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_2 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_chem_mod_index = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0642</span>:             <span class="p">)</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>:             <span class="n">states_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span></pre>
<pre class='cython code score-16 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_states_df = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">states_index</span></pre>
<pre class='cython code score-32 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_v_states_index) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0645</span>:             <span class="p">)</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:             <span class="n">chemical_mods_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span></pre>
<pre class='cython code score-16 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    __pyx_t_5 = 0;
/* … */
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_chemical_mods_df = __pyx_t_8;
    __pyx_t_8 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chemical_mods</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">chem_mod_index</span><span class="p">,</span></pre>
<pre class='cython code score-32 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;chemical_mods.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_5 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_9, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_columns, __pyx_v_chem_mod_index) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0648</span>:                 <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span></pre>
<pre class='cython code score-5 '>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0649</span>:             <span class="p">)</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:             <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vector_df</span><span class="p">,</span> <span class="n">states_df</span><span class="p">,</span> <span class="n">chemical_mods_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_concat);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vector_df);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_vector_df);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_vector_df);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_states_df);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_states_df);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_states_df);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_chemical_mods_df);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_chemical_mods_df);
    <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_chemical_mods_df);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_df = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0651</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0652</span>:             <span class="n">df</span> <span class="o">=</span> <span class="n">vector_df</span></pre>
<pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_vector_df);
    __pyx_v_df = __pyx_v_vector_df;
  }
  __pyx_L25:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0653</span>:         <span class="c"># Store bead lengths</span></pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0654</span>:         <span class="n">df</span><span class="p">[</span><span class="s">&quot;bead_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_broadcast_to);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_df, __pyx_n_s_bead_length, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-130" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0655</span>:             <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_length</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">1</span><span class="p">)),</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-130 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_append);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (unlikely(!__pyx_v_self-&gt;bead_length.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>}
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_self-&gt;bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_12 = NULL;
  __pyx_t_13 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      __pyx_t_13 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_int_0};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_11)) {
    PyObject *__pyx_temp[3] = {__pyx_t_12, __pyx_t_9, __pyx_int_0};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_11, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_12) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_12); __pyx_t_12 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_int_0);
    __pyx_t_9 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  __pyx_t_8 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_5, __pyx_tuple__26) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_tuple__26);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1);
  __pyx_t_11 = 0;
  __pyx_t_11 = NULL;
  __pyx_t_13 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_13 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_8, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_8, __pyx_t_5};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else
  #endif
  {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_13, __pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_13, __pyx_t_5);
    __pyx_t_8 = 0;
    __pyx_t_5 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_neg_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
</pre><pre class="cython line score-0">&#xA0;<span class="">0656</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>:         <span class="c"># Store scalar measure of the maximum number of beads</span></pre>
<pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:         <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">regular_arrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span></pre>
<pre class='cython code score-91 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_Items</span>(__pyx_v_regular_arrs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      #else
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_14 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_14)) goto __pyx_L32_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      index = 1; __pyx_t_5 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_5)) goto __pyx_L32_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_10(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
      __pyx_t_10 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L33_unpacking_done;
      __pyx_L32_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_10 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
      __pyx_L33_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_14);
    __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arr, __pyx_t_5);
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0659</span>:             <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&quot;max_binders&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_name, __pyx_n_s_max_binders, Py_EQ)); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 659, __pyx_L1_error)</span>
    if (__pyx_t_7) {
/* … */
      goto __pyx_L34;
    }
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:                 <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-70 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_broadcast_to);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_1);
      __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_13 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
          __pyx_t_13 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_14)) {
        PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_arr, __pyx_t_8};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_14)) {
        PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_arr, __pyx_t_8};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_13, 2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      } else
      #endif
      {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (__pyx_t_5) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_5); __pyx_t_5 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_13, __pyx_v_arr);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_13, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_df, __pyx_v_name, __pyx_t_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0661</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:                 <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span></pre>
<pre class='cython code score-5 '>    /*else*/ {
      if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_df, __pyx_v_name, __pyx_v_arr) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
    }
    __pyx_L34:;
</pre><pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:         <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">single_vals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span></pre>
<pre class='cython code score-91 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_Items</span>(__pyx_v_single_vals);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_4(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_14 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_14 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      #else
      __pyx_t_14 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_10 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_14 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_14)) goto __pyx_L37_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      index = 1; __pyx_t_11 = __pyx_t_10(__pyx_t_8); if (unlikely(!__pyx_t_11)) goto __pyx_L37_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_10(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
      __pyx_t_10 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L38_unpacking_done;
      __pyx_L37_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_10 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
      __pyx_L38_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_14);
    __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_val, __pyx_t_11);
    __pyx_t_11 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:             <span class="n">arr_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_15 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1, __pyx_int_1);
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_14);
    __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_dtype, __pyx_builtin_object) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_1, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arr_temp, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:             <span class="n">arr_temp</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;PyString_Type)), __pyx_v_val);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_arr_temp, __pyx_tuple__27, __pyx_t_8) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 665, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>:             <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr_temp</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_df, __pyx_v_name, __pyx_v_arr_temp) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:             <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_12to_dataframe_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x); /*proto*/
static PyMethodDef __pyx_mdef_6chromo_8polymers_11PolymerBase_12to_dataframe_lambda = {"lambda", (PyCFunction)__pyx_pw_6chromo_8polymers_11PolymerBase_12to_dataframe_lambda, METH_O, 0};
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_12to_dataframe_lambda(PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda (wrapper)", 0);
  __pyx_r = __pyx_lambda_funcdef_lambda(__pyx_self, ((PyObject *)__pyx_v_x));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = (__pyx_v_x != Py_None);
  if ((__pyx_t_2 != 0)) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    __pyx_t_1 = __pyx_v_x;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s__2);
    __pyx_t_1 = __pyx_kp_s__2;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_df, __pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_apply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6chromo_8polymers_11PolymerBase_12to_dataframe_lambda, 0, __pyx_n_s_to_dataframe_locals_lambda, NULL, __pyx_n_s_chromo_polymers, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_8 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_11, __pyx_t_14) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_df, __pyx_v_name, __pyx_t_8) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:         <span class="k">return</span> <span class="n">df</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
  __pyx_r = __pyx_v_df;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0669</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:     <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span></pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_21to_csv(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_20to_csv[] = "Save Polymer object to CSV file as DataFrame.\n\n        Parameters\n        ----------\n        path : str\n            Path to file at which to save CSV representation of the polymer\n\n        Returns\n        -------\n        pd.DataFrame\n            Data frame representation of the polymer, as recorded in the CSV\n            file that was generated\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_21to_csv(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_csv (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_path), (&amp;PyString_Type), 1, "path", 1))) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_20to_csv(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), ((PyObject*)__pyx_v_path));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_20to_csv(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_csv", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.to_csv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Save Polymer object to CSV file as DataFrame.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>: <span class="sd">        path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>: <span class="sd">            Path to file at which to save CSV representation of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: <span class="sd">        pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>: <span class="sd">            Data frame representation of the polymer, as recorded in the CSV</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>: <span class="sd">            file that was generated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_to_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_csv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0685</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:     <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_23to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_22to_file[] = "Synonym for `to_csv` to conform to `make_reproducible` spec.\n\n        Notes\n        -----\n        See documentation for `to_csv` for details.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_23to_file(PyObject *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_path), (&amp;PyString_Type), 1, "path", 1))) <span class='error_goto'>__PYX_ERR(0, 686, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_22to_file(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self), ((PyObject*)__pyx_v_path));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_22to_file(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, PyObject *__pyx_v_path) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_file", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.to_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Synonym for `to_csv` to conform to `make_reproducible` spec.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0691</span>: <span class="sd">        See documentation for `to_csv` for details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0692</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_to_csv);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_path) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_path);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 693, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase-&gt;tp_dict, __pyx_n_s_from_csv, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_PolymerBase);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:     <span class="k">def</span> <span class="nf">from_csv</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="nb">str</span> <span class="n">csv_file</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span></pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_25from_csv(PyObject *__pyx_v_cls, PyObject *__pyx_v_csv_file); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_24from_csv[] = "Construct Polymer from CSV file.\n\n        Parameters\n        ----------\n        csv_file : str\n            Path to CSV file from which to construct polymer\n\n        Returns\n        -------\n        PolymerBase\n            Object representation of a polymer\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_25from_csv(PyObject *__pyx_v_cls, PyObject *__pyx_v_csv_file) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_csv (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_csv_file), (&amp;PyString_Type), 1, "csv_file", 1))) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_24from_csv(((PyTypeObject*)__pyx_v_cls), ((PyObject*)__pyx_v_csv_file));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_24from_csv(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_csv_file) {
  PyObject *__pyx_v_df = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_csv", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.from_csv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase, __pyx_n_s_from_csv);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0697</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Polymer from CSV file.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0698</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0700</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0701</span>: <span class="sd">        csv_file : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>: <span class="sd">            Path to CSV file from which to construct polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: <span class="sd">        PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: <span class="sd">            Object representation of a polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0709</span>:         <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_read_csv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_csv_file) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_csv_file);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_df = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0710</span>:         <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></pre>
<pre class='cython code score-17 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cls), __pyx_n_s_from_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_df) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0711</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase-&gt;tp_dict, __pyx_n_s_from_dataframe, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_PolymerBase);
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0713</span>:     <span class="k">def</span> <span class="nf">from_dataframe</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_27from_dataframe(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_26from_dataframe[] = "Construct Polymer object from DataFrame; inverts `.to_dataframe`.\n\n        Notes\n        -----\n        TODO: For the DetailedChromatinWithSterics class, this method does not\n        TODO: load binders from file. Binders must be specified separately as\n        TODO: kwargs. Perhaps a binders file can be handled in the future.\n\n        Parameters\n        ----------\n        df : pd.DataFrame\n            Data frame representation of the polymer\n        name : Optional str\n            Name of the polymer to be formed (default is None)\n\n        Returns\n        -------\n        PolymerBase\n            Polymer object reflecting the dataframe\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_27from_dataframe(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_df = 0;
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_dataframe (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_df,&amp;__pyx_n_s_name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_df)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "from_dataframe") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_df = values[0];
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_dataframe", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.from_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_26from_dataframe(((PyTypeObject*)__pyx_v_cls), __pyx_v_df, __pyx_v_name, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_26from_dataframe(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_df, PyObject *__pyx_v_name, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_kwnames = NULL;
  PyObject *__pyx_v_kwargs_ = NULL;
  PyObject *__pyx_v_binder_names = NULL;
  PyObject *__pyx_v_chemical_mod_names = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_8genexpr2__pyx_v_name = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_dataframe", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.from_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwnames);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binder_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chemical_mod_names);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_name);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase, __pyx_n_s_from_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 713, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0714</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Polymer object from DataFrame; inverts `.to_dataframe`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: <span class="sd">        TODO: For the DetailedChromatinWithSterics class, this method does not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span class="sd">        TODO: load binders from file. Binders must be specified separately as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>: <span class="sd">        TODO: kwargs. Perhaps a binders file can be handled in the future.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: <span class="sd">        df : pd.DataFrame</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: <span class="sd">            Data frame representation of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: <span class="sd">        name : Optional str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: <span class="sd">            Name of the polymer to be formed (default is None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>: <span class="sd">        PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: <span class="sd">            Polymer object reflecting the dataframe</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>:         <span class="c"># top-level multiindex values correspond to kwargs</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:         <span class="n">kwnames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_get_level_values);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_int_0) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_kwnames = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         <span class="n">kwargs_</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-5 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L5_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:             <span class="n">name</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">kwnames</span></pre>
<pre class='cython code score-92 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_kwnames)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_kwnames)) {
      __pyx_t_3 = __pyx_v_kwnames; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
    } else {
      __pyx_t_6 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_kwnames);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_7)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
          #else
          __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_7(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr2__pyx_v_name, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_df, __pyx_8genexpr2__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_to_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        }
      }
      __pyx_t_5 = (__pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        }
      }
      __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr2__pyx_v_name, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L5_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_name); __pyx_8genexpr2__pyx_v_name = 0;
    goto __pyx_L8_exit_scope;
    __pyx_L5_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_name); __pyx_8genexpr2__pyx_v_name = 0;
    goto __pyx_L1_error;
    __pyx_L8_exit_scope:;
  } /* exit inner scope */
  __pyx_v_kwargs_ = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0738</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>:         <span class="c"># extract names of each epigenetic state from multi-index</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0740</span>:         <span class="k">if</span> <span class="s">&#39;states&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_states, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0741</span>:             <span class="n">binder_names</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;states&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span></pre>
<pre class='cython code score-24 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_df, __pyx_n_s_states);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_binder_names = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;binder_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">binder_names</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_binder_names, __pyx_v_binder_names) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 742, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:         <span class="k">if</span> <span class="s">&#39;chemical_mods&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_chemical_mods, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:             <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;chemical_mods&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span></pre>
<pre class='cython code score-24 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_df, __pyx_n_s_chemical_mods);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_to_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_chemical_mod_names = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;chemical_mod_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chemical_mod_names</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_chemical_mod_names, __pyx_v_chemical_mod_names) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 745, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:         <span class="k">if</span> <span class="s">&#39;max_binders&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_max_binders, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;max_binders&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;max_binders&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_kwargs_, __pyx_n_s_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_max_binders, __pyx_t_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:         <span class="k">if</span> <span class="s">&quot;name&quot;</span> <span class="ow">in</span> <span class="n">df</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_name, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 748, __pyx_L1_error)</span>
  __pyx_t_12 = (__pyx_t_10 != 0);
  if (__pyx_t_12) {
  } else {
    __pyx_t_11 = __pyx_t_12;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_12 = (__pyx_v_name == Py_None);
  __pyx_t_10 = (__pyx_t_12 != 0);
  __pyx_t_11 = __pyx_t_10;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_11) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0749</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_df, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_name, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:         <span class="k">elif</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_name == Py_None);
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0751</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;unnamed&quot;</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_name, __pyx_n_s_unnamed) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0752</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span></pre>
<pre class='cython code score-5 '>  /*else*/ {
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_name, __pyx_v_name) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L1_error)</span>
  }
  __pyx_L12:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:         <span class="k">if</span> <span class="s">&quot;lp&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_lp, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0755</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;lp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;lp&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_kwargs_, __pyx_n_s_lp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_lp, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:         <span class="k">if</span> <span class="s">&quot;lt&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_lt, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;lt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;lt&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_kwargs_, __pyx_n_s_lt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_lt, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:         <span class="k">if</span> <span class="s">&quot;bp_wrap&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_bp_wrap, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 758, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;bp_wrap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;bp_wrap&#39;</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_kwargs_, __pyx_n_s_bp_wrap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_bp_wrap, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:         <span class="k">if</span> <span class="s">&quot;bead_length&quot;</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_bead_length, __pyx_v_df, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;bead_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_n_s_bead_length, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0762</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kwargs_</span><span class="p">[</span><span class="s">&#39;bead_length&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mf">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-66 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_kwargs_, __pyx_n_s_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_4, 0, -1L, NULL, NULL, &amp;__pyx_slice__28, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_3 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, ((PyObject *)(&amp;PyFloat_Type))) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, ((PyObject *)(&amp;PyFloat_Type)));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_slice__28 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__28)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__28);
</pre><pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:         <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span></pre>
<pre class='cython code score-91 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_Items</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_5 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = Py_TYPE(__pyx_t_5)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_6 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_5);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_9); if (unlikely(!__pyx_t_3)) goto __pyx_L21_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_13(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L21_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_9), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
      __pyx_t_13 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L22_unpacking_done;
      __pyx_L21_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_13 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
      __pyx_L22_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_value, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:             <span class="n">kwargs_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-5 '>    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_kwargs_, __pyx_v_key, __pyx_v_value) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs_</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs_);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0766</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase-&gt;tp_dict, __pyx_n_s_from_file, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_PolymerBase);
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:     <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></pre>
<pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_29from_file(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_28from_file[] = "Construct Polymer object from string representation.\n\n        Notes\n        -----\n        TODO: For the DetailedChromatinWithSterics class, this method does not\n        TODO: load binders from file. Binders must be specified separately as\n        TODO: kwargs. Perhaps a binders file can be handled in the future.\n\n        Parameters\n        ----------\n        path : str\n            Path to CSV file representing the polymer\n        name : Optional str\n            Name of the polymer to be formed (default is None)\n\n        Returns\n        -------\n        PolymerBase\n            Polymer object reflecting the dataframe\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_29from_file(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_path = 0;
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_path,&amp;__pyx_n_s_name,0};
    PyObject* values[2] = {0,0};
    values[1] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_path)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "from_file") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_path = values[0];
    __pyx_v_name = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("from_file", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_28from_file(((PyTypeObject*)__pyx_v_cls), __pyx_v_path, __pyx_v_name, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_28from_file(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_path, PyObject *__pyx_v_name, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_df = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("from_file", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.from_file", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_8polymers_PolymerBase, __pyx_n_s_from_file);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0769</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Polymer object from string representation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0773</span>: <span class="sd">        TODO: For the DetailedChromatinWithSterics class, this method does not</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0774</span>: <span class="sd">        TODO: load binders from file. Binders must be specified separately as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0775</span>: <span class="sd">        TODO: kwargs. Perhaps a binders file can be handled in the future.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0776</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0777</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>: <span class="sd">        path : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: <span class="sd">            Path to CSV file representing the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0781</span>: <span class="sd">        name : Optional str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0782</span>: <span class="sd">            Name of the polymer to be formed (default is None)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0786</span>: <span class="sd">        PolymerBase</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: <span class="sd">            Polymer object reflecting the dataframe</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:         <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_name == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:             <span class="n">name</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-40 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_path, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_kp_s__29) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_kp_s__29);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_kp_s__30) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_kp_s__30);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_name, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:         <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_read_csv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_path);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_path);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_path);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_header, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_index_col, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_df = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:         <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_cls), __pyx_n_s_from_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_df);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_name);
  __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:     <span class="k">cpdef</span> <span class="kt">long</span> <span class="nf">get_num_binders</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_31get_num_binders(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static long __pyx_f_6chromo_8polymers_11PolymerBase_get_num_binders(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_binders", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_num_binders);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_31get_num_binders)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.get_num_binders", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_31get_num_binders(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_30get_num_binders[] = "Return number of states tracked per bead.\n        \n        Returns\n        -------\n        long\n            Number of binder types bound to the polymer\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_31get_num_binders(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_binders (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_30get_num_binders(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_30get_num_binders(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_binders", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_f_6chromo_8polymers_11PolymerBase_get_num_binders(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_num_binders", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Return number of states tracked per bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>: <span class="sd">        long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="sd">            Number of binder types bound to the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0802</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 802, __pyx_L1_error)</span>}
  __pyx_r = (__pyx_v_self-&gt;states.shape[1]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0804</span>:     <span class="k">cpdef</span> <span class="kt">long</span> <span class="nf">get_num_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_33get_num_beads(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static long __pyx_f_6chromo_8polymers_11PolymerBase_get_num_beads(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_beads", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_33get_num_beads)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.get_num_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_33get_num_beads(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_32get_num_beads[] = "Return number of beads in the polymer.\n        \n        Returns\n        -------\n        long\n            Number of beads forming the polymer\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_33get_num_beads(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_beads (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_32get_num_beads(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_32get_num_beads(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_num_beads", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_f_6chromo_8polymers_11PolymerBase_get_num_beads(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.get_num_beads", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0805</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Return number of beads in the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="sd">        long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="sd">            Number of beads forming the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0812</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>}
  __pyx_r = (__pyx_v_self-&gt;r.shape[0]);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0813</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0814</span>:     <span class="k">cpdef</span> <span class="kt">bint</span> <span class="nf">is_field_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_35is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_6chromo_8polymers_11PolymerBase_is_field_active(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_is_field_active);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_11PolymerBase_35is_field_active)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 814, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 814, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.PolymerBase.is_field_active", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_35is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_11PolymerBase_34is_field_active[] = "Evaluate if the polymer is affected by a field.\n        \n        Notes\n        -----\n        In the future, you can make the code more efficient by activating the\n        field only when necessary. The field is necessary only when the polymer\n        is bound by reader proteins OR is in a confinement OR has a volume\n        fraction limit OR has a non-specific chi interaction. For now, to be\n        safe, we will assume that the field always needs to be assessed.\n\n        Returns\n        -------\n        bint\n            Flag indicating whether the polymer is affected by the field (True)\n            or is agnostic to the field (False)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_11PolymerBase_35is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_11PolymerBase_34is_field_active(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_11PolymerBase_34is_field_active(struct __pyx_obj_6chromo_8polymers_PolymerBase *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_f_6chromo_8polymers_11PolymerBase_is_field_active(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.PolymerBase.is_field_active", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate if the polymer is affected by a field.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: <span class="sd">        In the future, you can make the code more efficient by activating the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>: <span class="sd">        field only when necessary. The field is necessary only when the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: <span class="sd">        is bound by reader proteins OR is in a confinement OR has a volume</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>: <span class="sd">        fraction limit OR has a non-specific chi interaction. For now, to be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: <span class="sd">        safe, we will assume that the field always needs to be assessed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: <span class="sd">        bint</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>: <span class="sd">            Flag indicating whether the polymer is affected by the field (True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>: <span class="sd">            or is agnostic to the field (False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0831</span>:         <span class="k">return</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0834</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Rouse</span><span class="p">(</span><span class="n">PolymerBase</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_Rouse {
  struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_8polymers_Rouse *__pyx_vtabptr_6chromo_8polymers_Rouse;

</pre><pre class="cython line score-0">&#xA0;<span class="">0835</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of Rouse polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0839</span>: <span class="sd">    The Rouse model represents flexible chains of beads connected by harmonic</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>: <span class="sd">    springs. The model inherits from the PolymerBase class, which provides the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>: <span class="sd">    basic attributes and functionality shared by all polymers. Please see</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>: <span class="sd">    `PolymerBase` documentation for descriptions of attributes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0845</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-76 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_5Rouse_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5Rouse___init__[] = "Initialize the Rouse polymer.\n\n        Notes\n        -----\n        Please refer to documentation for `PolymerBase.__init__()` method for\n        description of shared parameters.\n\n        The Rouse model is not yet implemented in this codebase. When the\n        model is implemented, be sure to remove the `NotImplementedError`\n        statement.\n\n        Parameters\n        ----------\n        lp : double\n            Persistence length of the polymer\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_5Rouse___init__;
#endif
static int __pyx_pw_6chromo_8polymers_5Rouse_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  PyArrayObject *__pyx_v_states = 0;
  PyArrayObject *__pyx_v_binder_names = 0;
  PyArrayObject *__pyx_v_chemical_mods = 0;
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[3] = (PyObject *)__pyx_k__31;
    values[4] = (PyObject *)__pyx_k__32;
    values[5] = (PyObject *)__pyx_k__33;
    values[6] = (PyObject *)__pyx_k__34;
    values[7] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 5)) {
        Py_ssize_t index;
        for (index = 3; index &lt; 8 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 848, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L3_error)</span>
    __pyx_v_states = ((PyArrayObject *)values[3]);
    __pyx_v_binder_names = ((PyArrayObject *)values[4]);
    __pyx_v_chemical_mods = ((PyArrayObject *)values[5]);
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[6]);
    __pyx_v_log_path = ((PyObject*)values[7]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.Rouse.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 847, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_states), __pyx_ptype_5numpy_ndarray, 1, "states", 0))) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mods), __pyx_ptype_5numpy_ndarray, 1, "chemical_mods", 0))) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5Rouse___init__(((struct __pyx_obj_6chromo_8polymers_Rouse *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_lp, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_5Rouse___init__(struct __pyx_obj_6chromo_8polymers_Rouse *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, double __pyx_v_lp, PyArrayObject *__pyx_v_states, PyArrayObject *__pyx_v_binder_names, PyArrayObject *__pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_chemical_mods;
  __Pyx_Buffer __pyx_pybuffer_chemical_mods;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_states;
  __Pyx_Buffer __pyx_pybuffer_states;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  __pyx_pybuffer_states.pybuffer.buf = NULL;
  __pyx_pybuffer_states.refcount = 0;
  __pyx_pybuffernd_states.data = NULL;
  __pyx_pybuffernd_states.rcbuffer = &amp;__pyx_pybuffer_states;
  __pyx_pybuffer_chemical_mods.pybuffer.buf = NULL;
  __pyx_pybuffer_chemical_mods.refcount = 0;
  __pyx_pybuffernd_chemical_mods.data = NULL;
  __pyx_pybuffernd_chemical_mods.rcbuffer = &amp;__pyx_pybuffer_chemical_mods;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_states, &amp;__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_states.diminfo[0].strides = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_states.diminfo[0].shape = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_states.diminfo[1].strides = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_states.diminfo[1].shape = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_chemical_mods, &amp;__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 845, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_chemical_mods.diminfo[0].strides = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_chemical_mods.diminfo[0].shape = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_chemical_mods.diminfo[1].strides = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_chemical_mods.diminfo[1].shape = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.Rouse.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  goto __pyx_L2;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0846</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:         <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">long</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
  __pyx_k__31 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_mty_2d_int);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_mty_2d_int);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__32 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">long</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
  __pyx_k__33 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_mty_2d_int);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_mty_2d_int);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__34 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Rouse polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>: <span class="sd">        Please refer to documentation for `PolymerBase.__init__()` method for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>: <span class="sd">        description of shared parameters.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: <span class="sd">        The Rouse model is not yet implemented in this codebase. When the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>: <span class="sd">        model is implemented, be sure to remove the `NotImplementedError`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>: <span class="sd">        statement.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: <span class="sd">        lp : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>: <span class="sd">            Persistence length of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">Rouse</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_Rouse));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_Rouse));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_Rouse));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0874</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, ((PyObject *)__pyx_v_states)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:             <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, ((PyObject *)__pyx_v_chemical_mods)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0876</span>:             <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0877</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0878</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lp</span> <span class="o">=</span> <span class="n">lp</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.lp = __pyx_v_lp;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0879</span>:         <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span></pre>
<pre class='cython code score-10 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_NotImplementedError, __pyx_tuple__35, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='error_goto'>__PYX_ERR(0, 879, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_The_Rouse_polymer_model_is_not_y);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
</pre><pre class="cython line score-0">&#xA0;<span class="">0880</span>:             <span class="s">&quot;The Rouse polymer model is not yet implemented&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>static double __pyx_f_6chromo_8polymers_5Rouse_compute_dE(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_Rouse *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v_move_name, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_inds, CYTHON_UNUSED long __pyx_v_n_inds) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0884</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>:         <span class="nb">str</span> <span class="n">move_name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>:         <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>:         <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the change in configurational energy of a polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>: <span class="sd">        This method currently serves as a place-holder. The Rouse polymer is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>: <span class="sd">        not yet implemented into this codebase.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>: <span class="sd">        Please see documentation for `PolymerBase.compute_dE()` for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: <span class="sd">        description of parameters and return arguments.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0901</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_6chromo_8polymers_5Rouse_construct_beads(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_Rouse *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a list of beads forming the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0904</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>: <span class="sd">        This method currently serves as a place-holder. The Rouse polymer is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>: <span class="sd">        not yet implemented into this codebase.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">SSWLC</span><span class="p">(</span><span class="n">PolymerBase</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_SSWLC {
  struct __pyx_vtabstruct_6chromo_8polymers_PolymerBase __pyx_base;
  double (*compute_E)(struct __pyx_obj_6chromo_8polymers_SSWLC *, int __pyx_skip_dispatch);
  double (*continuous_dE_poly)(struct __pyx_obj_6chromo_8polymers_SSWLC *, long, long);
  double (*E_pair)(struct __pyx_obj_6chromo_8polymers_SSWLC *, __Pyx_memviewslice, double, __Pyx_memviewslice, long);
  double (*bead_pair_dE_poly_forward)(struct __pyx_obj_6chromo_8polymers_SSWLC *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, long);
  double (*bead_pair_dE_poly_reverse)(struct __pyx_obj_6chromo_8polymers_SSWLC *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, long);
  double (*binding_dE)(struct __pyx_obj_6chromo_8polymers_SSWLC *, long, long, long);
  double (*bead_binding_dE)(struct __pyx_obj_6chromo_8polymers_SSWLC *, long, __Pyx_memviewslice);
  void (*_find_parameters)(struct __pyx_obj_6chromo_8polymers_SSWLC *, __Pyx_memviewslice, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *__pyx_vtabptr_6chromo_8polymers_SSWLC;

</pre><pre class="cython line score-0">&#xA0;<span class="">0913</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of a stretchable, shearable wormlike chain.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>: <span class="sd">    The `SSWLC` class describes a discrete, semiflexible polymer with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>: <span class="sd">    attributes for position, orientation, chemical modification, and reader</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0919</span>: <span class="sd">    protein binding state.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0920</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: <span class="sd">    The polymer carries around a set of coordinates `r` of shape</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>: <span class="sd">    `(num_beads, 3)`, sets of material normals `t3` and `t2`, some number of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: <span class="sd">    chemical modifications, and some number of chemical binding states per</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>: <span class="sd">    bead. A third set of material normals `t1` can be derived from the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>: <span class="sd">    cross-product of the `t2` and `t3`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>: <span class="sd">    Polymer also carries around a dictionary of beads of length `num_beads`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>: <span class="sd">    Each bead has a set of coordiantes `r` of length (3,). The beads also</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: <span class="sd">    have material normals `t3` and `t2`. The beads optionally carry around</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: <span class="sd">    some number of chemical modifications and binding states.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: <span class="sd">    If this codebase is used to simulate DNA, information about the chemical</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>: <span class="sd">    properties of each reader protein are stored in `ReaderProtein` objects. To</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>: <span class="sd">    model arbitrary SSWLC&#39;s, the different types of `Binder` objects may be</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>: <span class="sd">    specified to characterize bound components.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>: <span class="sd">    See documentation for `PolymerBase` class for additional paramete details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: <span class="sd">    TODO: allow differential discretization, and decay to constant</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: <span class="sd">    discretization naturally.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>: <span class="sd">    delta : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: <span class="sd">        Spacing between beads of the polymer, non-dimensionalized by</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>: <span class="sd">        persistence length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>: <span class="sd">    eps_bend : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: <span class="sd">        Bending modulus of polymer (obtained from `_find_parameters`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: <span class="sd">    eps_par : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>: <span class="sd">        Stretch modulus of polymer (obtained from `_find_parameters`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: <span class="sd">    eps_perp : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: <span class="sd">        Shear modulus of polymer (obtained from `_find_parameters`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: <span class="sd">    gamma : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="sd">        Ground-state segment compression (obtained from `_find_parameters`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>: <span class="sd">    eta : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>: <span class="sd">        Bend-shear coupling (obtained from `_find_parameters`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: <span class="sd">    bead_length : np.ndarray (N-1,) of float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>: <span class="sd">        Dimensional spacing between beads of the discrete polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>: <span class="sd">    bead_rad : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: <span class="sd">        Dimensional radius of each bead in the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>: </pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-87 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_5SSWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC___init__[] = "Construct a `SSWLC` polymer object as a subclass of `PolymerBase`.\n\n        Notes\n        -----\n        Please refer to documentation for `PolymerBase.__init__()` method for\n        description of shared parameters.\n\n        Parameters\n        ----------\n        bead_length : double[:]\n            The amount of polymer path length between subsequent beads (in nm),\n            defined for each linker along the polymer\n        lp : double\n            Dimensional persistence length of the SSWLC (in nm)\n        bead_rad : double\n            Radius of individual beads on the polymer (in nm)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_5SSWLC___init__;
#endif
static int __pyx_pw_6chromo_8polymers_5SSWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  double __pyx_v_bead_rad;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_bead_rad,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[13] = {0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[8] = (PyObject *)__pyx_k__36;
    values[10] = (PyObject *)__pyx_k__37;
    values[11] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
        }
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 9)) {
        Py_ssize_t index;
        for (index = 4; index &lt; 13 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 964, __pyx_L3_error)</span>
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 964, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 964, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_bead_rad = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_bead_rad == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 965, __pyx_L3_error)</span>
    } else {
      __pyx_v_bead_rad = ((double)5.0);
    }
    if (values[5]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 965, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__38;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[6]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 966, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__39;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[7]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 966, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__40;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[8]);
    if (values[9]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[9], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 967, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__41;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[10]);
    __pyx_v_log_path = ((PyObject*)values[11]);
    if (values[12]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[12]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 969, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 964, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 967, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 968, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 968, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC___init__(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_bead_rad, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_5SSWLC___init__(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_bead_rad, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0964</span>:         <span class="bp">self</span><span class="p">,</span> <span class="nb">str</span> <span class="n">name</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span> <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0965</span>:         <span class="n">double</span> <span class="n">bead_rad</span><span class="o">=</span><span class="mf">5</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span><span class="o">=</span><span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 965, __pyx_L1_error)</span>
  __pyx_k__38 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0966</span>:         <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span><span class="o">=</span><span class="n">empty_2d</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span><span class="o">=</span><span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-4 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 966, __pyx_L1_error)</span>
  __pyx_k__39 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 966, __pyx_L1_error)</span>
  __pyx_k__40 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">empty_1d</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__36 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 967, __pyx_L1_error)</span>
  __pyx_k__41 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0968</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">empty_1d</span><span class="p">,</span> <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__37 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-0">&#xA0;<span class="">0969</span>:         <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a `SSWLC` polymer object as a subclass of `PolymerBase`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: <span class="sd">        Please refer to documentation for `PolymerBase.__init__()` method for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>: <span class="sd">        description of shared parameters.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>: <span class="sd">        bead_length : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>: <span class="sd">            The amount of polymer path length between subsequent beads (in nm),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>: <span class="sd">            defined for each linker along the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>: <span class="sd">        lp : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>: <span class="sd">            Dimensional persistence length of the SSWLC (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>: <span class="sd">        bead_rad : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: <span class="sd">            Radius of individual beads on the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_arrays</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0989</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">SSWLC</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 989, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 989, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 989, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 989, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 989, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>:             <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span></pre>
<pre class='cython code score-22 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 991, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>:             <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0994</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0995</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span> <span class="o">=</span> <span class="n">bead_rad</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;bead_rad = __pyx_v_bead_rad;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0996</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">construct_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;__pyx_base.construct_beads(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0997</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_find_parameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_length</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.bead_length.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 997, __pyx_L1_error)</span>}
  ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;_find_parameters(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.bead_length, 0);
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0998</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">required_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-50 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 998, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_name);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_binder_names);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_binder_names);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_n_s_binder_names);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_binders);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_n_s_num_binders);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, __pyx_n_s_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, __pyx_n_s_num_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, __pyx_n_s_lp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_rad);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_rad);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, __pyx_n_s_bead_rad);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 998, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 998, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.required_attrs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.required_attrs));
  __pyx_v_self-&gt;__pyx_base.required_attrs = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0999</span>:             <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="s">&quot;t3&quot;</span><span class="p">,</span> <span class="s">&quot;t2&quot;</span><span class="p">,</span> <span class="s">&quot;states&quot;</span><span class="p">,</span> <span class="s">&quot;binder_names&quot;</span><span class="p">,</span> <span class="s">&quot;num_binders&quot;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>:             <span class="s">&quot;beads&quot;</span><span class="p">,</span> <span class="s">&quot;num_beads&quot;</span><span class="p">,</span> <span class="s">&quot;lp&quot;</span><span class="p">,</span> <span class="s">&quot;bead_rad&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>:         <span class="p">])</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1002, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_s_bead_length);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chemical_mods);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chemical_mods);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 5, __pyx_n_s_chemical_mods);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_max_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_max_binders);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 6, __pyx_n_s_max_binders);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1002, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base._arrays);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base._arrays));
  __pyx_v_self-&gt;__pyx_base._arrays = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1003</span>:             <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;t3&#39;</span><span class="p">,</span> <span class="s">&#39;t2&#39;</span><span class="p">,</span> <span class="s">&#39;states&#39;</span><span class="p">,</span> <span class="s">&#39;bead_length&#39;</span><span class="p">,</span> <span class="s">&#39;chemical_mods&#39;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>:             <span class="s">&#39;max_binders&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>:         <span class="p">])</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1006</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">check_attrs</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_check_attrs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_4 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">mu_adjust_factor</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.mu_adjust_factor = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>static void __pyx_f_6chromo_8polymers_5SSWLC_construct_beads(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self) {
  Py_ssize_t __pyx_8genexpr3__pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.construct_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1010</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct `GhostBead` objects forming beads of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1012</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-6 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.beads);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.beads);
  __pyx_v_self-&gt;__pyx_base.beads = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1013</span>:             <span class="n">i</span><span class="p">:</span> <span class="n">beads</span><span class="o">.</span><span class="n">GhostBead</span><span class="p">(</span></pre>
<pre class='cython code score-21 '>      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr3__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1013, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_beads);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1013, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_GhostBead);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1013, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1013, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_t_5, (PyObject*)__pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 1013, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  } /* exit inner scope */
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:                 <span class="n">id_</span><span class="o">=</span><span class="n">i</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr3__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_id, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:                 <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.r.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr3__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_r, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:                 <span class="n">t3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.t3.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr3__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:                 <span class="n">t2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1017, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.t2.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.t2.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr3__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1017, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1017, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1018</span>:                 <span class="n">states</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1018, __pyx_L1_error)</span>}
      __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.states.data;
      __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.states.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr3__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.states.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.states.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1018, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.states.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.states.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1018, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_states, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1019</span>:                 <span class="n">binder_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_self-&gt;__pyx_base.binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1020</span>:                 <span class="n">rad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span></pre>
<pre class='cython code score-11 '>      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1020, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_rad, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">))</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L1_error)</span>}
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;__pyx_base.r); 
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_8genexpr3__pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1022</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1024</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_compute_dE(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, PyObject *__pyx_v_move_name, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  double __pyx_v_delta_energy_poly;
  long __pyx_v_ind0;
  long __pyx_v_indf;
  long __pyx_v_ind;
  long __pyx_v_i;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1025</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:         <span class="nb">str</span> <span class="n">move_name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>:         <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>:         <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in elastic energy for proposed transformation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1034</span>: <span class="sd">        Non-zero elastic energy changes occur at bonds of the polymer </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>: <span class="sd">        directly changed by an MC move. If the indices affected by the MC </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>: <span class="sd">        move are continuous, then the elastic energy change is computed for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>: <span class="sd">        the bonds at the boundaries of the continuous interval; internal </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>: <span class="sd">        bonds are unchanged by such moves. When the indices affected by an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1039</span>: <span class="sd">        MC move are non-continuous (i.e., the move is not applied to a </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>: <span class="sd">        continuous polymer segment), then the elastic energy change is </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>: <span class="sd">        calculated individually at each affected bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>: <span class="sd">        move_name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>: <span class="sd">            Name of the MC move for which the energy change is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>: <span class="sd">        inds : array_like (N, 3)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>: <span class="sd">            Indices of N beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>: <span class="sd">            Number of beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>: <span class="sd">        delta_energy_poly : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>: <span class="sd">            Change in polymer elastic energy assocaited with the trial move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0</span><span class="p">,</span> <span class="nf">indf</span><span class="p">,</span> <span class="nf">ind</span><span class="p">,</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1061</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1062</span>:         <span class="k">if</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;change_binding_state&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_change_binding_state, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1062, __pyx_L1_error)</span>
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>:             <span class="n">ind0</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_inds.shape[0])) __pyx_t_4 = 0;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1063, __pyx_L1_error)</span>
    }
    __pyx_v_ind0 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_3 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:             <span class="n">indf</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">n_inds</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = (__pyx_v_n_inds - 1);
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_inds.shape[0])) __pyx_t_4 = 0;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L1_error)</span>
    }
    __pyx_v_indf = ((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_3 * __pyx_v_inds.strides[0]) ))) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_dE</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;binding_dE(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf, __pyx_v_n_inds));
</pre><pre class="cython line score-0">&#xA0;<span class="">1066</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>:         <span class="k">elif</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;slide&quot;</span> <span class="ow">or</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;end_pivot&quot;</span> <span class="ow">or</span></pre>
<pre class='cython code score-4 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_slide, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1068, __pyx_L1_error)</span>
  __pyx_t_5 = (__pyx_t_1 != 0);
  if (!__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_end_pivot, Py_EQ)); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1068, __pyx_L1_error)</span>
  __pyx_t_1 = (__pyx_t_5 != 0);
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;crank_shaft&quot;</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_crank_shaft, Py_EQ)); if (unlikely(__pyx_t_1 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1069, __pyx_L1_error)</span>
  __pyx_t_5 = (__pyx_t_1 != 0);
  __pyx_t_2 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1070</span>:         <span class="p">):</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:             <span class="n">ind0</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = 0;
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_inds.shape[0])) __pyx_t_4 = 0;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1071, __pyx_L1_error)</span>
    }
    __pyx_v_ind0 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_3 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1072</span>:             <span class="n">indf</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">n_inds</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = (__pyx_v_n_inds - 1);
    __pyx_t_4 = -1;
    if (__pyx_t_3 &lt; 0) {
      __pyx_t_3 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
    } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_inds.shape[0])) __pyx_t_4 = 0;
    if (unlikely(__pyx_t_4 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
      <span class='error_goto'>__PYX_ERR(0, 1072, __pyx_L1_error)</span>
    }
    __pyx_v_indf = ((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_3 * __pyx_v_inds.strides[0]) ))) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_dE_poly</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;continuous_dE_poly(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf));
</pre><pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:         <span class="k">elif</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;tangent_rotation&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_tangent_rotation, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1075, __pyx_L1_error)</span>
  __pyx_t_5 = (__pyx_t_2 != 0);
  if (__pyx_t_5) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_n_inds;
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1077</span>:                 <span class="n">ind</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_3 = __pyx_v_i;
      __pyx_t_4 = -1;
      if (__pyx_t_3 &lt; 0) {
        __pyx_t_3 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_4 = 0;
      } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_inds.shape[0])) __pyx_t_4 = 0;
      if (unlikely(__pyx_t_4 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_4);
        <span class='error_goto'>__PYX_ERR(0, 1077, __pyx_L1_error)</span>
      }
      __pyx_v_ind = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_3 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1078</span>:                 <span class="n">ind0</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ind0 = __pyx_v_ind;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1079</span>:                 <span class="n">indf</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_indf = (__pyx_v_ind + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:                 <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_dE_poly</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;continuous_dE_poly(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1081</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1082</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">continuous_dE_poly</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_continuous_dE_poly(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  long __pyx_v_ind0_m_1;
  long __pyx_v_indf_m_1;
  double __pyx_v_delta_energy_poly;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("continuous_dE_poly", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.continuous_dE_poly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1085</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>:         <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>:         <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1088</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in elastic energy for a continuous bead region.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1090</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1091</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1092</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1093</span>: <span class="sd">        The internal configuration of a continuous segment selected for a move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1094</span>: <span class="sd">        is unaffected; therefore, change in polymer energy can be determined</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1095</span>: <span class="sd">        from the beads at the ends of the selected segment.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1097</span>: <span class="sd">        If a bound of the selected segment exists at the end of the polymer,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1098</span>: <span class="sd">        then that bound does not contribute to a change in elastic energy, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>: <span class="sd">        since there are no bonds continuing beyond an end bead.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1101</span>: <span class="sd">        For bounds of affected beads inside the polymer, begin by isolating</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>: <span class="sd">        the position and orientation vectors of those bounds and their</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1103</span>: <span class="sd">        neighbors, then calculate the change in polymer energy for the bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1104</span>: <span class="sd">        pair.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1106</span>: <span class="sd">        Paramaters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1107</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>: <span class="sd">        ind0 : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>: <span class="sd">            Index of the first bead in the continuous region</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1110</span>: <span class="sd">        indf : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1111</span>: <span class="sd">            One past the index of the last bead in the continuous region</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1113</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1114</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>: <span class="sd">        delta_energy_poly : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>: <span class="sd">            Change in energy of polymer associated with trial move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1118</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0_m_1</span><span class="p">,</span> <span class="nf">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1119</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>:         <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind0_m_1 = (__pyx_v_ind0 - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1122</span>:         <span class="n">indf_m_1</span> <span class="o">=</span> <span class="n">indf</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indf_m_1 = (__pyx_v_indf - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1123</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1124</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:         <span class="k">if</span> <span class="n">ind0</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ind0 != 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_forward</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;bead_pair_dE_poly_forward(__pyx_v_self, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_v_ind0_m_1));
/* … */
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL;
    __pyx_t_3.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1127</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>}
    __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>}
/* … */
    __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1129, __pyx_L1_error)</span>}
/* … */
    __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.r_trial.data;
    __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1129, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.r_trial.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.r_trial.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>}
/* … */
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>}
/* … */
    __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>}
/* … */
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.t3_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.t3_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.t3_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">1133</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">ind0_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1134</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1135</span>:         <span class="k">if</span> <span class="n">indf</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_indf != __pyx_v_self-&gt;__pyx_base.num_beads) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_reverse</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;bead_pair_dE_poly_reverse(__pyx_v_self, __pyx_t_7, __pyx_t_6, __pyx_t_5, __pyx_t_4, __pyx_t_3, __pyx_t_2, __pyx_v_indf_m_1));
/* … */
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL;
    __pyx_t_3.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1137, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1137, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>}
/* … */
    __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.r_trial.data;
    __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.r_trial.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.r_trial.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>}
/* … */
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>}
/* … */
    __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>}
/* … */
    __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.t3_trial.data;
    __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.t3_trial.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.t3_trial.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span>}
/* … */
    __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">1143</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1146</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1148</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E_pair</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_E_pair(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_bend, double __pyx_v_dr_par, __Pyx_memviewslice __pyx_v_dr_perp, long __pyx_v_bond_ind) {
  double __pyx_v_E;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("E_pair", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.E_pair", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1149</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">bend</span><span class="p">,</span> <span class="n">double</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate elastic energy for a pair of beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>: <span class="sd">        bend : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>: <span class="sd">            Bending vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>: <span class="sd">        dr_par : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: <span class="sd">            Magnitude of the parallel component of the displacement vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>: <span class="sd">        dr_perp : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>: <span class="sd">            Perpendicular component of the displacement vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>: <span class="sd">        bond_ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>: <span class="sd">            Index of the bond between the beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>: <span class="sd">            Elastic energy of bond between the bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1170</span>:         <span class="n">E</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">bend</span><span class="p">)</span> <span class="o">+</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;eps_bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;eps_bend.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;eps_bend.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1172</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dr_par</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">])</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;eps_par.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>}
  __pyx_t_3 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_3 &lt; 0) {
    __pyx_t_3 += __pyx_v_self-&gt;eps_par.shape[0];
    if (unlikely(__pyx_t_3 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_3 &gt;= __pyx_v_self-&gt;eps_par.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;gamma.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>}
  __pyx_t_4 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_self-&gt;gamma.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;gamma.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>
  }
/* … */
  __pyx_v_E = ((((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_bend.data + __pyx_t_1 * __pyx_v_self-&gt;eps_bend.strides[0]) )))) * __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_bend, __pyx_v_bend)) + ((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_par.data + __pyx_t_3 * __pyx_v_self-&gt;eps_par.strides[0]) )))) * pow((__pyx_v_dr_par - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;gamma.data + __pyx_t_4 * __pyx_v_self-&gt;gamma.strides[0]) )))), 2.0))) + ((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_perp.data + __pyx_t_5 * __pyx_v_self-&gt;eps_perp.strides[0]) )))) * __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_dr_perp, __pyx_v_dr_perp)));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;eps_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span>}
  __pyx_t_5 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_5 &lt; 0) {
    __pyx_t_5 += __pyx_v_self-&gt;eps_perp.shape[0];
    if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;eps_perp.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1174</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1176</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_pair_dE_poly_forward</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_bead_pair_dE_poly_forward(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_r_0, __Pyx_memviewslice __pyx_v_r_1, __Pyx_memviewslice __pyx_v_test_r_1, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_t3_1, __Pyx_memviewslice __pyx_v_test_t3_1, long __pyx_v_bond_ind) {
  long __pyx_v_i;
  double __pyx_v_dr_par;
  double __pyx_v_dr_par_test;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bead_pair_dE_poly_forward", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.bead_pair_dE_poly_forward", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1178</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1182</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1183</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>:         <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy when affecting a single bead pair.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1188</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1189</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>: <span class="sd">        For the current and proposed states of the polymer, calculate change in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1192</span>: <span class="sd">        position, as well as the parallel magnitude and perpendicular component</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1193</span>: <span class="sd">        of that change, of the bead pair. Calcualate the bend vectors for the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1194</span>: <span class="sd">        existing and trial orientations. Calculate the change in energy given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1195</span>: <span class="sd">        these properties using theory for a discretized worm-like chain.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>: <span class="sd">        In this &#39;forward&#39; setup, the bead at index zero is linearly adjacent to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>: <span class="sd">        the affected beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: <span class="sd">        This function can be written in a cleaner (slower) manner, as copied</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>: <span class="sd">        below. We have opted for in-place operations where possible to improve</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: <span class="sd">        runtime. This is particularly important because this method is called</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>: <span class="sd">        from the inner-most loop of the MC algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>: <span class="sd">        # Cleaner (and slower) code:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>: <span class="sd">        cdef double de_poly, dr_par, dr_par_test</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: <span class="sd">        cdef long i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>: <span class="sd">        cdef double[:] dr, dr_test, dr_perp, dr_perp_test, bend, bend_test</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1209</span>: <span class="sd">        dr_test = vec_sub3(test_r_1, r_0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>: <span class="sd">        dr = vec_sub3(r_1, r_0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>: <span class="sd">        dr_par_test = vec_dot3(t3_0, dr_test)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1212</span>: <span class="sd">        dr_par = vec_dot3(t3_0, dr)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>: <span class="sd">        dr_perp_test = vec_sub3(dr_test, vec_scale3(t3_0, dr_par_test))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1214</span>: <span class="sd">        dr_perp = vec_sub3(dr, vec_scale3(t3_0, dr_par))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>: <span class="sd">        bend_test = vec_add3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>: <span class="sd">            test_t3_1, vec_sub3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>: <span class="sd">                vec_scale3(t3_0, -1.0), vec_scale3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>: <span class="sd">                    dr_perp_test, self.eta</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>: <span class="sd">                )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: <span class="sd">            )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>: <span class="sd">        bend = vec_add3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>: <span class="sd">            t3_1, vec_sub3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>: <span class="sd">                vec_scale3(t3_0, -1.0), vec_scale3(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>: <span class="sd">                    dr_perp, self.eta</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>: <span class="sd">                )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>: <span class="sd">            )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>: <span class="sd">        )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>: <span class="sd">        return self.E_pair(bend_test, dr_par_test, dr_perp_test) -\</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>: <span class="sd">            self.E_pair(bend, dr_par, dr_perp)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: <span class="sd">        r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: <span class="sd">            Position vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: <span class="sd">        r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: <span class="sd">            Position vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>: <span class="sd">        test_r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>: <span class="sd">            Position vector of second bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: <span class="sd">        t3_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>: <span class="sd">            t3 tangent vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: <span class="sd">        t3_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>: <span class="sd">            t3 tangent vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>: <span class="sd">        test_t3_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: <span class="sd">            t3 tangent vector of second bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>: <span class="sd">        bond_ind : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>: <span class="sd">            Index of the bond being affected</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>: <span class="sd">            Change in polymer energy for move of a single bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dr_par</span><span class="p">,</span> <span class="nf">dr_par_test</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1256</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1258</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_test_r_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_test_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_test_r_1.data + __pyx_t_2 * __pyx_v_test_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_4 * __pyx_v_r_0.strides[0]) ))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_4 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_2 * __pyx_v_r_0.strides[0]) ))));
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1260</span>:         <span class="n">dr_par_test</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>}
  __pyx_v_dr_par_test = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.dr_test);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:         <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>}
  __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.dr);
</pre><pre class="cython line score-0">&#xA0;<span class="">1262</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par_test</span></pre>
<pre class='cython code score-16 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_test.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.dr_test.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_4 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par_test));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par</span></pre>
<pre class='cython code score-16 '>
    /* "chromo/polymers.pyx":1265
 *         for i in range(3):
 *             self.dr_perp_test[i] = self.dr_test[i] - t3_0[i] * dr_par_test
 *             self.dr_perp[i] = self.dr[i] - t3_0[i] * dr_par             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             self.bend_test[i] = (
 *                 test_t3_1[i] - t3_0[i] - self.dr_perp_test[i] *
 */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.dr.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_2 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1266, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.bend_test.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.bend_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1266, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.bend_test.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.bend_test.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_test_t3_1.data + __pyx_t_2 * __pyx_v_test_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_4 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp_test.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_6 * __pyx_v_self-&gt;eta.strides[0]) )))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:                 <span class="n">test_t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_test_t3_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_test_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1268, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;eta.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1268, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1269</span>:             <span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.bend.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.bend.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.bend.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.bend.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_6 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_5 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.dr_perp.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_2 * __pyx_v_self-&gt;eta.strides[0]) )))));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>    __pyx_t_6 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    }
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;eta.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1271, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1272</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1273</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1274</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">,</span> <span class="n">dr_par_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:         <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;E_pair(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.bend_test, __pyx_v_dr_par_test, __pyx_v_self-&gt;__pyx_base.dr_perp_test, __pyx_v_bond_ind) - ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;E_pair(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.bend, __pyx_v_dr_par, __pyx_v_self-&gt;__pyx_base.dr_perp, __pyx_v_bond_ind));
  goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1276, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0">&#xA0;<span class="">1277</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1279</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_pair_dE_poly_reverse</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_bead_pair_dE_poly_reverse(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_r_0, __Pyx_memviewslice __pyx_v_test_r_0, __Pyx_memviewslice __pyx_v_r_1, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_test_t3_0, __Pyx_memviewslice __pyx_v_t3_1, long __pyx_v_bond_ind) {
  double __pyx_v_dr_par;
  double __pyx_v_dr_par_test;
  long __pyx_v_i;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bead_pair_dE_poly_reverse", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.bead_pair_dE_poly_reverse", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1280</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>:         <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy when affecting a single bead pair.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>: <span class="sd">        For the current and proposed states of the polymer, calculate change in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: <span class="sd">        position, as well as the parallel magnitude and perpendicular component</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: <span class="sd">        of that change, of the bead pair. Calcualate the bend vectors for the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>: <span class="sd">        existing and trial orientations. Calculate the change in energy given</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>: <span class="sd">        these properties using theory for a discretized worm-like chain.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>: <span class="sd">        In this &#39;reverse&#39; setup, the bead at index one is linearly adjacent to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1300</span>: <span class="sd">        the affected beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>: <span class="sd">        r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>: <span class="sd">            Position vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>: <span class="sd">        test_r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>: <span class="sd">            Position vector of first bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>: <span class="sd">        r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1309</span>: <span class="sd">            Position vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>: <span class="sd">        t3_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1311</span>: <span class="sd">            t3 tangent vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1312</span>: <span class="sd">        test_t3_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>: <span class="sd">            t3 tangent vector of first bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>: <span class="sd">        t3_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>: <span class="sd">            t3 tangent vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>: <span class="sd">        bond_ind : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1317</span>: <span class="sd">            Index of the bond being affected</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1318</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1319</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1320</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1322</span>: <span class="sd">            Change in polymer energy for move of a single bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1323</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1324</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dr_par</span><span class="p">,</span> <span class="nf">dr_par_test</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1325</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1326</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1328</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">-</span> <span class="n">test_r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1328, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_r_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1328, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1328, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1328, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_2 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_test_r_0.data + __pyx_t_4 * __pyx_v_test_r_0.strides[0]) ))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_4 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_2 * __pyx_v_r_0.strides[0]) ))));
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1330</span>:         <span class="n">dr_par_test</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">test_t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>}
  __pyx_v_dr_par_test = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_test_t3_0, __pyx_v_self-&gt;__pyx_base.dr_test);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1331</span>:         <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1331, __pyx_L1_error)</span>}
  __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1333</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par_test</span></pre>
<pre class='cython code score-16 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_test.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.dr_test.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_test_t3_0.data + __pyx_t_4 * __pyx_v_test_t3_0.strides[0]) ))) * __pyx_v_dr_par_test));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par</span></pre>
<pre class='cython code score-16 '>
    /* "chromo/polymers.pyx":1334
 *         for i in range(3):
 *             self.dr_perp_test[i] = self.dr_test[i] - test_t3_0[i] * dr_par_test
 *             self.dr_perp[i] = self.dr[i] - t3_0[i] * dr_par             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             self.bend_test[i] = (
 *                 t3_1[i] - test_t3_0[i] - self.dr_perp_test[i] *
 */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1334, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.dr.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_2 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.bend_test.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.bend_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.bend_test.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.bend_test.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_2 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_test_t3_0.data + __pyx_t_4 * __pyx_v_test_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.dr_perp_test.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_6 * __pyx_v_self-&gt;eta.strides[0]) )))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1337</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1337, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;eta.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1337, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1338</span>:             <span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.bend.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.bend.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.bend.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.bend.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_6 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_5 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.dr_perp.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.dr_perp.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_2 * __pyx_v_self-&gt;eta.strides[0]) )))));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>    __pyx_t_6 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
    }
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;eta.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1341</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1342</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">,</span> <span class="n">dr_par_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:         <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;E_pair(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.bend_test, __pyx_v_dr_par_test, __pyx_v_self-&gt;__pyx_base.dr_perp_test, __pyx_v_bond_ind) - ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;E_pair(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.bend, __pyx_v_dr_par, __pyx_v_self-&gt;__pyx_base.dr_perp, __pyx_v_bond_ind));
  goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1345</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0">&#xA0;<span class="">1346</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1347</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_E</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_3compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_5SSWLC_compute_E(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_m1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_5SSWLC_3compute_E)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_3compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_2compute_E[] = "Compute the overall polymer energy at the current configuration.\n        \n        Notes\n        -----\n        This method loops over each bond in the polymer and calculates the \n        energy change of that bond.\n\n        Returns\n        -------\n        double\n            Configurational energy of the polymer.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_3compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_2compute_E(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_2compute_E(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_5SSWLC_compute_E(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1350</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1351</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1352</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1353</span>: <span class="sd">        This method loops over each bond in the polymer and calculates the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1354</span>: <span class="sd">        energy change of that bond.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1356</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1357</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>: <span class="sd">            Configurational energy of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1360</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1361</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1362</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_m1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1364</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1365</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1366</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1367</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.num_beads;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1368</span>:             <span class="n">i_m1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_m1 = (__pyx_v_i - 1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1369</span>:             <span class="n">r_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1369, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1369, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
    __pyx_v_r_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:             <span class="n">r_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
    __pyx_v_r_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1371</span>:             <span class="n">t3_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1371, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1371, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
    __pyx_v_t3_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1372</span>:             <span class="n">t3_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1372, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1372, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
    __pyx_v_t3_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1373</span>:             <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span> <span class="n">r_0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_r_1, __pyx_v_r_0);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1373, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1374</span>:             <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1375</span>:             <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_v_t3_0, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1375, __pyx_L1_error)</span>
    __pyx_t_11 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1375, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1376</span>:             <span class="n">bend</span> <span class="o">=</span> <span class="n">t3_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_v_t3_1);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1376, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1377</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1378</span>:                 <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_t3_0.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i_m1;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;eta.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_bend.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 1378, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_17 * __pyx_v_bend.strides[0]) )) += ((-(*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_13 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_15 * __pyx_v_self-&gt;eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_16 * __pyx_v_dr_perp.strides[0]) )))));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1379</span>:             <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">i_m1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;E_pair(__pyx_v_self, __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_i_m1));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1380</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1381</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1382</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1383</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">binding_dE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span> <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span> <span class="nb">long</span> <span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_5SSWLC_binding_dE(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, long __pyx_v_ind0, CYTHON_UNUSED long __pyx_v_indf, long __pyx_v_n_inds) {
  long __pyx_v_i;
  long __pyx_v_ind;
  double __pyx_v_dE;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("binding_dE", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.binding_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute energy difference associated with change in binding state.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1387</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1388</span>: <span class="sd">        ind0, indf : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1389</span>: <span class="sd">            The first (ind0) and last (indf) indices of the continuous </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>: <span class="sd">            interval for which the binding state was changed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>: <span class="sd">            Number of beads affected by binding state move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1396</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>: <span class="sd">            Change in energy associated with the proposed binding state move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1399</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dE</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>:         <span class="n">dE</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1403</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_n_inds;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:             <span class="n">ind</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">+</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ind = (__pyx_v_ind0 + __pyx_v_i);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1405</span>:             <span class="n">dE</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_binding_dE</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">ind</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1405, __pyx_L1_error)</span>}
    __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.states_trial.data;
    __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.states_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.states_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.states_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1405, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.states_trial.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.states_trial.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

__pyx_v_dE = (__pyx_v_dE + ((struct __pyx_vtabstruct_6chromo_8polymers_SSWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_vtab)-&gt;bead_binding_dE(__pyx_v_self, __pyx_v_ind, __pyx_t_4));
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1406</span>:         <span class="k">return</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_dE;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1407</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1408</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_binding_dE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:]</span> <span class="n">states_trial_ind</span><span class="p">):</span></pre>
<pre class='cython code score-15 '>static double __pyx_f_6chromo_8polymers_5SSWLC_bead_binding_dE(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, long __pyx_v_ind, __Pyx_memviewslice __pyx_v_states_trial_ind) {
  long __pyx_v_h;
  long __pyx_v_Nn;
  long __pyx_v_Nm;
  CYTHON_UNUSED long __pyx_v_Nu;
  long __pyx_v_tot_bound;
  long __pyx_v_diff;
  double __pyx_v_dE;
  __Pyx_memviewslice __pyx_v_mod_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states_ind = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_b;
  PyObject *__pyx_v_i = NULL;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bead_binding_dE", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC.bead_binding_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mod_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states_ind, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1409</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute energy difference for a single bead change in binding state.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: <span class="sd">        Begin by identifying the chemical modification and binding states of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>: <span class="sd">        nucleosome. Using a single-site partition function, we compute the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>: <span class="sd">        expected binding energy over all possible binding configurations.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>: <span class="sd">        Previously, we had assumed that binders will first bind marked sites</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>: <span class="sd">        before binding unmarked sites. Using the single-site partition function,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>: <span class="sd">        we remove this assumption and consider the entropy of binding.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: <span class="sd">        Consider that we are arranging `Nb` binders on `Nn` sites, of which `Nm`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>: <span class="sd">        are marked. We can have up to `min(Nb, Nm)` binders on marked sites. For</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>: <span class="sd">        each value `i` in range(`min(Nb, Nm)`), there are `comb(Nm, i)` ways to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>: <span class="sd">        arrange `i` binders on marked sites and `comb(Nn-Nm, Nb-i)` ways to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>: <span class="sd">        arrange the remaining `Nb-i` binders on unmarked sites. Thus, the total</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>: <span class="sd">        number of ways to arrange `Nb` binders on `Nn` sites, of which `Nm` are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>: <span class="sd">        marked, is the sum of `comb(Nm, i) * comb(Nn-Nm, Nb-i)` for `i` in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1427</span>: <span class="sd">        range(`min(Nb, Nm)`). This is equivalent to `comb(Nn, Nb)`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1428</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1429</span>: <span class="sd">         The energy of each configuration is determined by the number of binders</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1430</span>: <span class="sd">        on marked sites, or `i`. If there is an energy `E_b` associated with</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1431</span>: <span class="sd">        each binder on a marked site, then the total energy of the configuration</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1432</span>: <span class="sd">        is `i * E_b`. Therefore, the site partition function representing</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1433</span>: <span class="sd">        binding is given by `sum(comb(Nm, i) * comb(Nn-Nm, Nb-i) * exp(-i * E_b))`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1434</span>: <span class="sd">        for `i` in range(`min(Nb, Nm)`).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1435</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1436</span>: <span class="sd">        `self.max_binders` indicates the maximum number of total binders of any</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1437</span>: <span class="sd">        type that can bind a single bead. This attribute accounts for steric</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1438</span>: <span class="sd">        limitations to the total number of binders that can attach to any give</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1439</span>: <span class="sd">        bead in the polymer. A value of `-1` is reserved for no limit to the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1440</span>: <span class="sd">        total number of binders bound to a bead. Any move which proposes more</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1441</span>: <span class="sd">        than the maximum number of binders is assigned an energy cost of 1E99</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1442</span>: <span class="sd">        kT per binder beyond the limit.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1444</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1445</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1446</span>: <span class="sd">        ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1447</span>: <span class="sd">            Bead index for which the change in binding state is proposed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1448</span>: <span class="sd">        states_trial_ind : array_like (M, )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1449</span>: <span class="sd">            Proposed binding states for the bead affected by the move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1450</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1451</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1452</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1453</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1454</span>: <span class="sd">            The energy change from the single bead&#39;s change in binding state</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1455</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1456</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">h</span><span class="p">,</span> <span class="nf">Nn</span><span class="p">,</span> <span class="nf">Nm</span><span class="p">,</span> <span class="nf">Nu</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1457</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">tot_bound</span><span class="p">,</span> <span class="nf">diff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1458</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dE</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1459</span>:         <span class="k">cdef</span> <span class="kt">long</span>[<span class="p">:]</span> <span class="n">mod_states</span><span class="p">,</span> <span class="n">states_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1460</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1461</span>:         <span class="n">mod_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemical_mods</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.chemical_mods.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>}
  __pyx_t_1.data = __pyx_v_self-&gt;__pyx_base.chemical_mods.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;__pyx_base.chemical_mods.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.chemical_mods.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.chemical_mods.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1461, __pyx_L1_error)</span>
        }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;__pyx_base.chemical_mods.shape[1];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;__pyx_base.chemical_mods.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_v_mod_states = __pyx_t_1;
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1462</span>:         <span class="n">states_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1462, __pyx_L1_error)</span>}
  __pyx_t_1.data = __pyx_v_self-&gt;__pyx_base.states.data;
  __pyx_t_1.memview = __pyx_v_self-&gt;__pyx_base.states.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_1, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.states.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.states.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1462, __pyx_L1_error)</span>
        }
        __pyx_t_1.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_1.shape[0] = __pyx_v_self-&gt;__pyx_base.states.shape[1];
__pyx_t_1.strides[0] = __pyx_v_self-&gt;__pyx_base.states.strides[1];
    __pyx_t_1.suboffsets[0] = -1;

__pyx_t_2 = __pyx_memoryview_copy_slice_dc_long_c(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL;
  __pyx_t_1.data = NULL;
  __pyx_v_states_ind = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1463</span>:         <span class="n">dE</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_dE = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1464</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1465</span>:         <span class="c"># Evaluate constraint on the total number of binders bound to a bead</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1466</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_self-&gt;__pyx_base.max_binders != -1L) != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1467</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1468</span>:             <span class="c"># Trail configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1469</span>:             <span class="n">tot_bound</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tot_bound = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1470</span>:             <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_self-&gt;__pyx_base.num_binders;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_h = __pyx_t_6;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1471</span>:                 <span class="n">tot_bound</span> <span class="o">+=</span> <span class="n">states_trial_ind</span><span class="p">[</span><span class="n">h</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_7 = __pyx_v_h;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1471, __pyx_L1_error)</span>
      }
      __pyx_v_tot_bound = (__pyx_v_tot_bound + (*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1472</span>:             <span class="k">if</span> <span class="n">tot_bound</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_tot_bound &gt; __pyx_v_self-&gt;__pyx_base.max_binders) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1473</span>:                 <span class="n">diff</span> <span class="o">=</span> <span class="n">tot_bound</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span></pre>
<pre class='cython code score-0 '>      __pyx_v_diff = (__pyx_v_tot_bound - __pyx_v_self-&gt;__pyx_base.max_binders);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1474</span>:                 <span class="n">dE</span> <span class="o">+=</span> <span class="n">E_HUGE</span> <span class="o">*</span> <span class="n">diff</span></pre>
<pre class='cython code score-0 '>      __pyx_v_dE = (__pyx_v_dE + (__pyx_v_6chromo_8polymers_E_HUGE * __pyx_v_diff));
</pre><pre class="cython line score-0">&#xA0;<span class="">1475</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1476</span>:             <span class="c"># Current configuration</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1477</span>:             <span class="n">tot_bound</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_tot_bound = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1478</span>:             <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_self-&gt;__pyx_base.num_binders;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_h = __pyx_t_6;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1479</span>:                 <span class="n">tot_bound</span> <span class="o">+=</span> <span class="n">states_ind</span><span class="p">[</span><span class="n">h</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_7 = __pyx_v_h;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
      }
      __pyx_v_tot_bound = (__pyx_v_tot_bound + (*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1480</span>:             <span class="k">if</span> <span class="n">tot_bound</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((__pyx_v_tot_bound &gt; __pyx_v_self-&gt;__pyx_base.max_binders) != 0);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1481</span>:                 <span class="n">diff</span> <span class="o">=</span> <span class="n">tot_bound</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_binders</span></pre>
<pre class='cython code score-0 '>      __pyx_v_diff = (__pyx_v_tot_bound - __pyx_v_self-&gt;__pyx_base.max_binders);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1482</span>:                 <span class="n">dE</span> <span class="o">-=</span> <span class="n">E_HUGE</span> <span class="o">*</span> <span class="n">diff</span></pre>
<pre class='cython code score-0 '>      __pyx_v_dE = (__pyx_v_dE - (__pyx_v_6chromo_8polymers_E_HUGE * __pyx_v_diff));
</pre><pre class="cython line score-0">&#xA0;<span class="">1483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1484</span>:         <span class="c"># Evaluate the change in binding energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1485</span>:         <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;__pyx_base.num_binders;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_b = __pyx_t_6;
</pre><pre class="cython line score-0">&#xA0;<span class="">1486</span>:             <span class="c"># Number of sites</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1487</span>:             <span class="n">Nn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">sites_per_bead</span></pre>
<pre class='cython code score-19 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_10, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_sites_per_bead);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_10); if (unlikely((__pyx_t_11 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_v_Nn = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">1488</span>:             <span class="c"># Number of modified tails</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1489</span>:             <span class="n">Nm</span> <span class="o">=</span> <span class="n">mod_states</span><span class="p">[</span><span class="n">b</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_mod_states.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_mod_states.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1489, __pyx_L1_error)</span>
    }
    __pyx_v_Nm = (*((long *) ( /* dim=0 */ (__pyx_v_mod_states.data + __pyx_t_7 * __pyx_v_mod_states.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1490</span>:             <span class="c"># Number of unmodified tails</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1491</span>:             <span class="n">Nu</span> <span class="o">=</span> <span class="n">Nn</span> <span class="o">-</span> <span class="n">Nm</span></pre>
<pre class='cython code score-0 '>    __pyx_v_Nu = (__pyx_v_Nn - __pyx_v_Nm);
</pre><pre class="cython line score-0">&#xA0;<span class="">1492</span>:             <span class="c"># Single-site Helmholtz free energy (trial configuration)</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">states_trial_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>
    /* "chromo/polymers.pyx":1493
 *             Nu = Nn - Nm
 *             # Single-site Helmholtz free energy (trial configuration)
 *             i = np.arange(states_trial_ind[b] + 1)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             dE += -np.log(np.sum(
 *                 comb(Nm, i) *
 */
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))) + 1));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_10 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_10);
    __pyx_t_10 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:             <span class="n">dE</span> <span class="o">+=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span></pre>
<pre class='cython code score-39 '>
    /* "chromo/polymers.pyx":1494
 *             # Single-site Helmholtz free energy (trial configuration)
 *             i = np.arange(states_trial_ind[b] + 1)
 *             dE += -np.log(np.sum(             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 comb(Nm, i) *
 *                 comb(Nn - Nm, states_trial_ind[b] - i) *
 */
    __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;

    /* "chromo/polymers.pyx":1494
 *             # Single-site Helmholtz free energy (trial configuration)
 *             i = np.arange(states_trial_ind[b] + 1)
 *             dE += -np.log(np.sum(             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 comb(Nm, i) *
 *                 comb(Nn - Nm, states_trial_ind[b] - i) *
 */
    __pyx_t_13 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_10, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_v_dE = __pyx_t_22;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1495</span>:                 <span class="n">comb</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-49 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_16, __pyx_n_s_comb);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_Nm);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
    __pyx_t_18 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
      __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
      if (likely(__pyx_t_18)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_16)) {
      PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_t_17, __pyx_v_i};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_16, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_16)) {
      PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_t_17, __pyx_v_i};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_16, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    } else
    #endif
    {
      __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
      if (__pyx_t_18) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_t_18); __pyx_t_18 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0+__pyx_t_8, __pyx_t_17);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1+__pyx_t_8, __pyx_v_i);
      __pyx_t_17 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
/* … */
    __pyx_t_19 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
</pre><pre class="cython line score-90" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1496</span>:                 <span class="n">comb</span><span class="p">(</span><span class="n">Nn</span> <span class="o">-</span> <span class="n">Nm</span><span class="p">,</span> <span class="n">states_trial_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-90 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_19, __pyx_n_s_comb);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_Nn - __pyx_v_Nm));<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1496, __pyx_L1_error)</span>
    }
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_18, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    __pyx_t_18 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
      __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
      if (likely(__pyx_t_18)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_19)) {
      PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_t_17, __pyx_t_20};
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_19)) {
      PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_t_17, __pyx_t_20};
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_19, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    } else
    #endif
    {
      __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      if (__pyx_t_18) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_t_18); __pyx_t_18 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_17);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0+__pyx_t_8, __pyx_t_17);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1+__pyx_t_8, __pyx_t_20);
      __pyx_t_17 = 0;
      __pyx_t_20 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_19, __pyx_t_21, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
/* … */
    __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    __pyx_t_16 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
      __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
      if (likely(__pyx_t_16)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
      }
    }
    __pyx_t_9 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_16, __pyx_t_21) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_15, __pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_15 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_15)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
      }
    }
    __pyx_t_12 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_15, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_13, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1497</span>:                 <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1497, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_exp);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1497, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1498</span>:                     <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-21 '>
    /* "chromo/polymers.pyx":1498
 *                 comb(Nn - Nm, states_trial_ind[b] - i) *
 *                 (np.exp(
 *                     - (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                         i * self.beads[ind].binders[b].bind_energy_mod +
 *                         (states_trial_ind[b] - i) *
 */
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    __pyx_t_18 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_18)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    __pyx_t_16 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_21, __pyx_t_18, __pyx_t_20) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    if (unlikely(!__pyx_t_16)) <span class='error_goto'>__PYX_ERR(0, 1497, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1499</span>:                         <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">bind_energy_mod</span> <span class="o">+</span></pre>
<pre class='cython code score-24 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_20, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_bind_energy_mod);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
    __pyx_t_18 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_14, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1499, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:                         <span class="p">(</span><span class="n">states_trial_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-17 '>    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>
    }
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_17 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_20, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
/* … */
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_17, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1501</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">bind_energy_no_mod</span></pre>
<pre class='cython code score-11 '>    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_18, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_bind_energy_no_mod);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1502</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1503</span>:                 <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1504</span>:             <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1505</span>:             <span class="c"># Single-site Helmholtz free energy (current configuration)</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1506</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">states_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>
    /* "chromo/polymers.pyx":1506
 *             ))
 *             # Single-site Helmholtz free energy (current configuration)
 *             i = np.arange(states_ind[b] + 1)             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             dE -= -np.log(np.sum(
 *                 comb(Nm, i) *
 */
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L1_error)</span>
    }
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))) + 1));<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    __pyx_t_12 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_9, __pyx_t_13) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 1506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_i, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1507</span>:             <span class="n">dE</span> <span class="o">-=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span></pre>
<pre class='cython code score-39 '>
    /* "chromo/polymers.pyx":1507
 *             # Single-site Helmholtz free energy (current configuration)
 *             i = np.arange(states_ind[b] + 1)
 *             dE -= -np.log(np.sum(             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 comb(Nm, i) *
 *                 comb(Nn - Nm, states_ind[b] - i) *
 */
    __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;

    /* "chromo/polymers.pyx":1507
 *             # Single-site Helmholtz free energy (current configuration)
 *             i = np.arange(states_ind[b] + 1)
 *             dE -= -np.log(np.sum(             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 comb(Nm, i) *
 *                 comb(Nn - Nm, states_ind[b] - i) *
 */
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_12, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_10); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_v_dE = __pyx_t_22;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1508</span>:                 <span class="n">comb</span><span class="p">(</span><span class="n">Nm</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-49 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_16, __pyx_n_s_comb);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_Nm);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_20 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
      __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
      if (likely(__pyx_t_20)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_16)) {
      PyObject *__pyx_temp[3] = {__pyx_t_20, __pyx_t_19, __pyx_v_i};
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_16, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_16)) {
      PyObject *__pyx_temp[3] = {__pyx_t_20, __pyx_t_19, __pyx_v_i};
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_16, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    } else
    #endif
    {
      __pyx_t_18 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
      if (__pyx_t_20) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0, __pyx_t_20); __pyx_t_20 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 0+__pyx_t_8, __pyx_t_19);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_18, 1+__pyx_t_8, __pyx_v_i);
      __pyx_t_19 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_16, __pyx_t_18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
/* … */
    __pyx_t_18 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_15, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1508, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
</pre><pre class="cython line score-90" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1509</span>:                 <span class="n">comb</span><span class="p">(</span><span class="n">Nn</span> <span class="o">-</span> <span class="n">Nm</span><span class="p">,</span> <span class="n">states_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-90 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_18, __pyx_n_s_comb);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_Nn - __pyx_v_Nm));<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1509, __pyx_L1_error)</span>
    }
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_20, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = NULL;
    __pyx_t_8 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_18))) {
      __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_18);
      if (likely(__pyx_t_20)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_18);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_18, function);
        __pyx_t_8 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_18)) {
      PyObject *__pyx_temp[3] = {__pyx_t_20, __pyx_t_19, __pyx_t_14};
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_18, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_18)) {
      PyObject *__pyx_temp[3] = {__pyx_t_20, __pyx_t_19, __pyx_t_14};
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_18, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    } else
    #endif
    {
      __pyx_t_17 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
      if (__pyx_t_20) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_20); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0, __pyx_t_20); __pyx_t_20 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 0+__pyx_t_8, __pyx_t_19);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_17, 1+__pyx_t_8, __pyx_t_14);
      __pyx_t_19 = 0;
      __pyx_t_14 = 0;
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_18, __pyx_t_17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
/* … */
    __pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_18, __pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    __pyx_t_16 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
      __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
      if (likely(__pyx_t_16)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
      }
    }
    __pyx_t_13 = (__pyx_t_16) ? __Pyx_PyObject_Call2Args(__pyx_t_21, __pyx_t_16, __pyx_t_17) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
    if (unlikely(!__pyx_t_13)) <span class='error_goto'>__PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    __pyx_t_21 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_21)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_10 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_21, __pyx_t_13) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 1507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1510</span>:                 <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_exp);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1511</span>:                     <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-21 '>
    /* "chromo/polymers.pyx":1511
 *                 comb(Nn - Nm, states_ind[b] - i) *
 *                 (np.exp(
 *                     - (             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                         i * self.beads[ind].binders[b].bind_energy_mod +
 *                         (states_ind[b] - i) *
 */
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1511, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_17))) {
      __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_17);
      if (likely(__pyx_t_20)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_17);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_17, function);
      }
    }
    __pyx_t_16 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_17, __pyx_t_20, __pyx_t_14) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_17, __pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    if (unlikely(!__pyx_t_16)) <span class='error_goto'>__PYX_ERR(0, 1510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1512</span>:                         <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">bind_energy_mod</span> <span class="o">+</span></pre>
<pre class='cython code score-24 '>    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_14, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_bind_energy_mod);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_15 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
    __pyx_t_20 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1513</span>:                         <span class="p">(</span><span class="n">states_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">*</span></pre>
<pre class='cython code score-17 '>    __pyx_t_7 = __pyx_v_b;
    __pyx_t_8 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_states_ind.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
    if (unlikely(__pyx_t_8 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
      <span class='error_goto'>__PYX_ERR(0, 1513, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_19 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_14, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1514</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">bind_energy_no_mod</span></pre>
<pre class='cython code score-11 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_20, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_bind_energy_no_mod);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1514, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1515</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1516</span>:                 <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>:             <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1518</span>:             <span class="c"># Chemical potential</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1519</span>:             <span class="c"># Note: Simulated annealing affects positive and negative chemical</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1520</span>:             <span class="c"># potentials in different ways</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1521</span>:             <span class="c"># TODO: Accommodate different types of simulated annealing schedules</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1522</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">chemical_potential</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-20 '>
    /* "chromo/polymers.pyx":1522
 *             # potentials in different ways
 *             # TODO: Accommodate different types of simulated annealing schedules
 *             if self.beads[ind].binders[b].chemical_potential &gt; 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 dE -= states_trial_ind[b] * (
 *                     self.beads[ind].binders[b].chemical_potential *
 */
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_chemical_potential);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_9, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_10); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1522, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (__pyx_t_3) {

      /* "chromo/polymers.pyx":1522
 *             # potentials in different ways
 *             # TODO: Accommodate different types of simulated annealing schedules
 *             if self.beads[ind].binders[b].chemical_potential &gt; 0:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *                 dE -= states_trial_ind[b] * (
 *                     self.beads[ind].binders[b].chemical_potential *
 */
      goto __pyx_L12;
    }
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1523</span>:                 <span class="n">dE</span> <span class="o">-=</span> <span class="n">states_trial_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-34 '>      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1523, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_7 = __pyx_v_b;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1523, __pyx_L1_error)</span>
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1523, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
/* … */
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1523, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_21 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_10, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1523, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_21); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1523, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_v_dE = __pyx_t_22;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1524</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">chemical_potential</span> <span class="o">*</span></pre>
<pre class='cython code score-18 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1524, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1524, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_13, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1524, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_chemical_potential);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1524, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
      __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1524, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1525</span>:                     <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_adjust_factor</span> <span class="o">+</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>      __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(((-__pyx_v_self-&gt;__pyx_base.mu_adjust_factor) + 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1525, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
</pre><pre class="cython line score-0">&#xA0;<span class="">1526</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1527</span>:                 <span class="n">dE</span> <span class="o">+=</span> <span class="n">states_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-34 '>      __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      __pyx_t_7 = __pyx_v_b;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1527, __pyx_L1_error)</span>
      }
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
/* … */
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_21, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1527, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1527, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_v_dE = __pyx_t_22;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1528</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">chemical_potential</span> <span class="o">*</span></pre>
<pre class='cython code score-18 '>      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1528, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1528, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1528, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_chemical_potential);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1528, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
/* … */
      __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1528, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1529</span>:                     <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_adjust_factor</span> <span class="o">+</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>      __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>(((-__pyx_v_self-&gt;__pyx_base.mu_adjust_factor) + 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1529, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-0">&#xA0;<span class="">1530</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1531</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1532</span>:                 <span class="n">dE</span> <span class="o">-=</span> <span class="n">states_trial_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-34 '>    /*else*/ {
      __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1532, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_7 = __pyx_v_b;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_trial_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_trial_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1532, __pyx_L1_error)</span>
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_trial_ind.data + __pyx_t_7 * __pyx_v_states_trial_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1532, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
      __pyx_t_21 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_10, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1532, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
/* … */
      __pyx_t_12 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_13, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1532, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1532, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_v_dE = __pyx_t_22;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1533</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">chemical_potential</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-18 '>      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1533, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1533, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_12, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1533, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_chemical_potential);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1533, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_21, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1533, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1534</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">mu_adjust_factor</span></pre>
<pre class='cython code score-5 '>      __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.mu_adjust_factor);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1534, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1535</span>:                 <span class="n">dE</span> <span class="o">+=</span> <span class="n">states_ind</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-34 '>      __pyx_t_12 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dE);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1535, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      __pyx_t_7 = __pyx_v_b;
      __pyx_t_8 = -1;
      if (__pyx_t_7 &lt; 0) {
        __pyx_t_7 += __pyx_v_states_ind.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_8 = 0;
      } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_states_ind.shape[0])) __pyx_t_8 = 0;
      if (unlikely(__pyx_t_8 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);
        <span class='error_goto'>__PYX_ERR(0, 1535, __pyx_L1_error)</span>
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((*((long *) ( /* dim=0 */ (__pyx_v_states_ind.data + __pyx_t_7 * __pyx_v_states_ind.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1535, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
      __pyx_t_13 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_10, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1535, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
/* … */
      __pyx_t_21 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_12, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1535, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_21); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1535, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_v_dE = __pyx_t_22;
    }
    __pyx_L12:;
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1536</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">.</span><span class="n">chemical_potential</span> <span class="o">*</span> <span class="w">\</span></pre>
<pre class='cython code score-18 '>      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.beads, __pyx_v_ind, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_binders);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_21, __pyx_v_b, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
      __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_chemical_potential);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_13, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1537</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">mu_adjust_factor</span></pre>
<pre class='cython code score-5 '>      __pyx_t_21 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.mu_adjust_factor);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1537, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1538</span>:         <span class="k">return</span> <span class="n">dE</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_dE;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1539</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1540</span>:     <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_5__str__(PyObject *__pyx_v_self); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_4__str__[] = "Return string representation of the SSWLC.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_5SSWLC_4__str__;
#endif
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_5__str__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_4__str__(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_4__str__(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__str__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.__str__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1541</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation of the SSWLC.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1542</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1543</span>:         <span class="k">return</span> <span class="n">f</span><span class="s">&quot;Polymer_Class&lt;SSWLC&gt;, {super(SSWLC, self).__str__()}&quot;</span></pre>
<pre class='cython code score-38 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_str);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Polymer_Class_SSWLC, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1544</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1545</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">_find_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">):</span></pre>
<pre class='cython code score-42 '>static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_7_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_bead_length); /*proto*/
static void __pyx_f_6chromo_8polymers_5SSWLC__find_parameters(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_bead_length, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters", 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_find_parameters);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_5SSWLC_7_find_parameters)) {
        if (unlikely(!__pyx_v_bead_length.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bead_length"); <span class='error_goto'>__PYX_ERR(0, 1545, __pyx_L1_error)</span> }
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1545, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1545, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_7_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_bead_length); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_6_find_parameters[] = "Look up elastic parameters of ssWLC for each bead_length.\n        \n        Interpolate from the parameter table to get the physical parameters of\n        the WLC model matching the discretized WLC.\n        \n        Notes\n        -----\n        The units of the WLC parameters must be consistent with those in the \n        equation for elastic energy change. Lenght units are non-dimensionalized\n        using the persistence length of the polymer.\n\n        All parameters in the equation for elastic energy change are divided \n        or multiplied by `delta`. To avoid redundant calculations, we divide \n        or multiply the parameters by `delta` here and not each time elastic \n        energy change is calculated.\n        \n        The definition and units (after division by persistence length) of each \n        physical parameter are listed below:\n\n            - delta         Distance btwn beads (Unitless)\n            - eps_bend      Bending modulus (kbT)\n            - gamma         Ground-state segment compression (Distance)\n            - eps_par       Stretch Modulus (kbT / Distance**2)\n            - eps_perp      Shear modulus (kbT / Distance**2)\n            - eta           Bend-shear coupling (1 / Distance)\n\n        Parameters\n        ----------\n        bead_length : double\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_7_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_bead_length) {
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters (wrapper)", 0);
  assert(__pyx_arg_bead_length); {
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_arg_bead_length, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 1545, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_6_find_parameters(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_bead_length);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_6_find_parameters(struct __pyx_obj_6chromo_8polymers_SSWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_bead_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_bead_length.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("bead_length"); <span class='error_goto'>__PYX_ERR(0, 1545, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_8polymers_5SSWLC__find_parameters(__pyx_v_self, __pyx_v_bead_length, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1545, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1546</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Look up elastic parameters of ssWLC for each bead_length.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1547</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1548</span>: <span class="sd">        Interpolate from the parameter table to get the physical parameters of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1549</span>: <span class="sd">        the WLC model matching the discretized WLC.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1550</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1551</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1553</span>: <span class="sd">        The units of the WLC parameters must be consistent with those in the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1554</span>: <span class="sd">        equation for elastic energy change. Lenght units are non-dimensionalized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>: <span class="sd">        using the persistence length of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1557</span>: <span class="sd">        All parameters in the equation for elastic energy change are divided </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>: <span class="sd">        or multiplied by `delta`. To avoid redundant calculations, we divide </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>: <span class="sd">        or multiply the parameters by `delta` here and not each time elastic </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1560</span>: <span class="sd">        energy change is calculated.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>: <span class="sd">        The definition and units (after division by persistence length) of each </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>: <span class="sd">        physical parameter are listed below:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1564</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>: <span class="sd">            - delta         Distance btwn beads (Unitless)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>: <span class="sd">            - eps_bend      Bending modulus (kbT)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1567</span>: <span class="sd">            - gamma         Ground-state segment compression (Distance)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1568</span>: <span class="sd">            - eps_par       Stretch Modulus (kbT / Distance**2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1569</span>: <span class="sd">            - eps_perp      Shear modulus (kbT / Distance**2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1570</span>: <span class="sd">            - eta           Bend-shear coupling (1 / Distance)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1571</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1572</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1573</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1574</span>: <span class="sd">        bead_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1575</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1576</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1577</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>:         <span class="n">bead_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bead_length</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __pyx_v_bead_length = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1579</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1579, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;delta, 0);
  __pyx_v_self-&gt;delta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1580</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;eps_bend, 0);
  __pyx_v_self-&gt;eps_bend = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1581</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1581, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;gamma, 0);
  __pyx_v_self-&gt;gamma = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;eps_par, 0);
  __pyx_v_self-&gt;eps_par = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1583</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1583, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;eps_perp, 0);
  __pyx_v_self-&gt;eps_perp = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1584</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;eta, 0);
  __pyx_v_self-&gt;eta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1585</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bead_length</span><span class="p">)):</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_bead_length); 
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1586</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bead_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-14 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_bead_length.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_bead_length.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1586, __pyx_L1_error)</span>
    }
    __pyx_t_12 = (*((double *) ( /* dim=0 */ (__pyx_v_bead_length.data + __pyx_t_10 * __pyx_v_bead_length.strides[0]) )));
    if (unlikely(__pyx_v_self-&gt;__pyx_base.lp == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1586, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1586, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1586, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) )) = (__pyx_t_12 / __pyx_v_self-&gt;__pyx_base.lp);
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1587</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;eps_bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;eps_bend.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;eps_bend.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_bend.data + __pyx_t_10 * __pyx_v_self-&gt;eps_bend.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-69 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__42);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_13};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_13};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_11, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_11, __pyx_t_13);
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_13 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__42 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__42);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__42);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1589</span>:             <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1590</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;gamma.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1590, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;gamma.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;gamma.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1590, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;gamma.data + __pyx_t_10 * __pyx_v_self-&gt;gamma.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1591</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-69 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1591, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1591, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_13, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_13, __pyx_tuple__43);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_2, __pyx_t_5, __pyx_t_4};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_2, __pyx_t_5, __pyx_t_4};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_13) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_13); __pyx_t_13 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_11, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_11, __pyx_t_4);
      __pyx_t_2 = 0;
      __pyx_t_5 = 0;
      __pyx_t_4 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1590, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__43 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 1591, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__43);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__43);
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1592</span>:             <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-42 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.lp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1593</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;eps_par.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1593, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;eps_par.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;eps_par.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1593, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_par.data + __pyx_t_10 * __pyx_v_self-&gt;eps_par.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1594</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-69 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1594, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1594, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__44);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_1, __pyx_t_5, __pyx_t_2};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_1, __pyx_t_5, __pyx_t_2};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_11, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_11, __pyx_t_2);
      __pyx_t_1 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__44 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1594, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__44);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1595</span>:             <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))) * pow(__pyx_v_self-&gt;__pyx_base.lp, 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1596</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;eps_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;eps_perp.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;eps_perp.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_perp.data + __pyx_t_10 * __pyx_v_self-&gt;eps_perp.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1597</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-69 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1597, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1597, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_tuple__45);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_3, __pyx_t_5, __pyx_t_1};
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_3, __pyx_t_5, __pyx_t_1};
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_11, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_11, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_5 = 0;
      __pyx_t_1 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
  __pyx_tuple__45 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__45);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__45);
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1598</span>:             <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))) * pow(__pyx_v_self-&gt;__pyx_base.lp, 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_13, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1598, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1599</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;eta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;eta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eta.data + __pyx_t_10 * __pyx_v_self-&gt;eta.strides[0]) )) = __pyx_t_12;
  }
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1600</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-69 '>    if (unlikely(!__pyx_v_self-&gt;delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;delta.data + __pyx_t_10 * __pyx_v_self-&gt;delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__46);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_14, __pyx_t_5, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_14, __pyx_t_5, __pyx_t_3};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (__pyx_t_1) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_11, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_11, __pyx_t_3);
      __pyx_t_14 = 0;
      __pyx_t_5 = 0;
      __pyx_t_3 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
/* … */
  __pyx_tuple__46 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__22, __pyx_int_5);<span class='error_goto'> if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__46);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__46);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1601</span>:             <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-20 '>    __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.lp);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1601, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1602</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1603</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_straight_line_in_x, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1604</span>:     <span class="k">def</span> <span class="nf">straight_line_in_x</span><span class="p">(</span></pre>
<pre class='cython code score-47 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_9straight_line_in_x(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_8straight_line_in_x[] = "Construct polymer initialized uniformly along the positve x-axis.\n\n        Parameters\n        ----------\n        name : str\n            Name of polymer being constructed\n        step_sizes : np.ndarray (N-1,) of float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n            represented as an (N-1,) array where N is the number of beads in the\n            polymer.\n\n        Returns\n        -------\n        SSWLC\n            Object representation of a polymer currently configured as a\n            straight line\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_9straight_line_in_x(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyArrayObject *__pyx_v_step_sizes = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("straight_line_in_x (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_step_sizes,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_sizes)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("straight_line_in_x", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "straight_line_in_x") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_step_sizes = ((PyArrayObject *)values[1]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("straight_line_in_x", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.straight_line_in_x", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1605, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_step_sizes), __pyx_ptype_5numpy_ndarray, 1, "step_sizes", 0))) <span class='error_goto'>__PYX_ERR(0, 1605, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_8straight_line_in_x(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_step_sizes, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_8straight_line_in_x(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyArrayObject *__pyx_v_step_sizes, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_csum = NULL;
  Py_ssize_t __pyx_v_num_beads;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("straight_line_in_x", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.straight_line_in_x", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_csum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_straight_line_in_x);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1605</span>:         <span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">step_sizes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1606</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1607</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct polymer initialized uniformly along the positve x-axis.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1610</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1611</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1612</span>: <span class="sd">            Name of polymer being constructed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>: <span class="sd">        step_sizes : np.ndarray (N-1,) of float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1614</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1615</span>: <span class="sd">            represented as an (N-1,) array where N is the number of beads in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1616</span>: <span class="sd">            polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1618</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1619</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1620</span>: <span class="sd">        SSWLC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1621</span>: <span class="sd">            Object representation of a polymer currently configured as a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1622</span>: <span class="sd">            straight line</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1623</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1624</span>:         <span class="c"># Get the cumulative sum of the step sizes</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1625</span>:         <span class="n">csum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">step_sizes</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_v_step_sizes)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_step_sizes));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1625, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_csum = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1626</span>:         <span class="c"># Initialize the positions and orientations of the polymer</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1627</span>:         <span class="n">num_beads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">step_sizes</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_step_sizes));<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1627, __pyx_L1_error)</span>
  __pyx_v_num_beads = (__pyx_t_4 + 1);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1628</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1629</span>:         <span class="n">r</span><span class="p">[</span><span class="mf">1</span><span class="p">:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">csum</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-34 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_csum, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_slice__47 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__47)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__47);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_r, __pyx_tuple__48, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_tuple__48 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__47, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__48);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1630</span>:         <span class="n">t3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_t3 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1631</span>:         <span class="n">t3</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_t3, __pyx_tuple__23, __pyx_int_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1631, __pyx_L1_error)</span>
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1632</span>:         <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_beads</span><span class="p">,</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1632, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_t2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1633</span>:         <span class="n">t2</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_t2, __pyx_tuple__42, __pyx_int_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1633, __pyx_L1_error)</span>
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1634</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">step_sizes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1634, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, ((PyObject *)__pyx_v_step_sizes)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_t_2;
  __pyx_t_2 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1634, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1635</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1636</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_arbitrary_path_in_x_y, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1637</span>:     <span class="k">def</span> <span class="nf">arbitrary_path_in_x_y</span><span class="p">(</span></pre>
<pre class='cython code score-82 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_11arbitrary_path_in_x_y(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_10arbitrary_path_in_x_y[] = "Construct a polymer initialized as y = f(x) from x = 0.\n\n        Notes\n        -----\n        As is, this code does not support variable linker lengths.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        bead_length : float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        shape_func : Callable[[float], float]\n            Shape of the polymer where z = 0 and y = f(x)\n        step_size : float\n            Step size for numerical evaluation of contour length when\n            building the polymer path\n\n        Returns\n        -------\n        SSWLC\n            Object representing a polymer following path y = f(x)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_11arbitrary_path_in_x_y(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  double __pyx_v_bead_length;
  PyObject *__pyx_v_shape_func = 0;
  double __pyx_v_step_size;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("arbitrary_path_in_x_y (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_shape_func,&amp;__pyx_n_s_step_size,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y", 0, 4, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y", 0, 4, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape_func)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y", 0, 4, 5, 3); <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_size);
          if (value) { values[4] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "arbitrary_path_in_x_y") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_bead_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bead_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1638, __pyx_L3_error)</span>
    __pyx_v_shape_func = values[3];
    if (values[4]) {
      __pyx_v_step_size = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_step_size == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
    } else {
      __pyx_v_step_size = ((double)0.001);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y", 0, 4, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.arbitrary_path_in_x_y", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1638, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_10arbitrary_path_in_x_y(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_bead_length, __pyx_v_shape_func, __pyx_v_step_size, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_10arbitrary_path_in_x_y(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, double __pyx_v_bead_length, PyObject *__pyx_v_shape_func, double __pyx_v_step_size, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("arbitrary_path_in_x_y", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.arbitrary_path_in_x_y", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_arbitrary_path_in_x_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1638</span>:         <span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">bead_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>:         <span class="n">shape_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1640</span>:         <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a polymer initialized as y = f(x) from x = 0.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1645</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1646</span>: <span class="sd">        As is, this code does not support variable linker lengths.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1648</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1649</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1650</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1651</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1652</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1653</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1654</span>: <span class="sd">        bead_length : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1655</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1656</span>: <span class="sd">        shape_func : Callable[[float], float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1657</span>: <span class="sd">            Shape of the polymer where z = 0 and y = f(x)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1658</span>: <span class="sd">        step_size : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1659</span>: <span class="sd">            Step size for numerical evaluation of contour length when</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1660</span>: <span class="sd">            building the polymer path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1662</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1663</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1664</span>: <span class="sd">        SSWLC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1665</span>: <span class="sd">            Object representing a polymer following path y = f(x)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1666</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1667</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">coordinates_in_x_y</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_coordinates_in_x_y);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1668</span>:             <span class="n">num_beads</span><span class="p">,</span> <span class="n">bead_length</span><span class="p">,</span> <span class="n">shape_func</span><span class="p">,</span> <span class="n">step_size</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_shape_func, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_shape_func, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_shape_func);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1669</span>:         <span class="p">)</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1670</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_tangent_vals_x_y</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_get_tangent_vals_x_y);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_v_t3 = __pyx_t_7;
  __pyx_t_7 = 0;
  __pyx_v_t2 = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1671</span>:             <span class="n">r</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">shape_func</span><span class="p">,</span> <span class="n">step_size</span></pre>
<pre class='cython code score-92 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_r, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1671, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1671, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_7)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_3, __pyx_v_shape_func, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_7)) {
    PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_3, __pyx_v_shape_func, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_2) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_6, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_6, __pyx_v_shape_func);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_6, __pyx_t_4);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_7 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_7)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    index = 1; __pyx_t_5 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1672</span>:         <span class="p">)</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1673</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1673, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1673, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1673, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = __pyx_t_7;
  __pyx_t_7 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_5, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1673, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1673, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1674</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_arbitrary_path_in_x_y_z, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1676</span>:     <span class="k">def</span> <span class="nf">arbitrary_path_in_x_y_z</span><span class="p">(</span></pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_13arbitrary_path_in_x_y_z(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_12arbitrary_path_in_x_y_z[] = "Construct a polymer initialized as y = f(x) from x = 0.\n\n        Notes\n        -----\n        As is, this code does not support variable linker lengths.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        bead_length : float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        shape_func_x : Callable[[float], float]\n            Parametric functions to obtain the x coordinates of the path\n        shape_func_y : Callable[[float], float]\n            Parametric functions to obtain the y coordinates of the path\n        shape_func_z : Callable[[float], float]\n            Parametric functions to obtain the z coordinates of the path\n        step_size : float\n            Step size for numerical evaluation of contour length when\n            building the polymer path\n\n        Returns\n        -------\n        SSWLC\n            Object representing a polymer following path x = X(t), y = Y(t),\n            z = Z(t)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_13arbitrary_path_in_x_y_z(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  double __pyx_v_bead_length;
  PyObject *__pyx_v_shape_func_x = 0;
  PyObject *__pyx_v_shape_func_y = 0;
  PyObject *__pyx_v_shape_func_z = 0;
  double __pyx_v_step_size;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("arbitrary_path_in_x_y_z (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_shape_func_x,&amp;__pyx_n_s_shape_func_y,&amp;__pyx_n_s_shape_func_z,&amp;__pyx_n_s_step_size,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, 1); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, 2); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape_func_x)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, 3); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape_func_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, 4); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_shape_func_z)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, 5); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_size);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "arbitrary_path_in_x_y_z") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_bead_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bead_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1680, __pyx_L3_error)</span>
    __pyx_v_shape_func_x = values[3];
    __pyx_v_shape_func_y = values[4];
    __pyx_v_shape_func_z = values[5];
    if (values[6]) {
      __pyx_v_step_size = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_step_size == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1684, __pyx_L3_error)</span>
    } else {
      __pyx_v_step_size = ((double)0.001);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("arbitrary_path_in_x_y_z", 0, 6, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.arbitrary_path_in_x_y_z", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_12arbitrary_path_in_x_y_z(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_bead_length, __pyx_v_shape_func_x, __pyx_v_shape_func_y, __pyx_v_shape_func_z, __pyx_v_step_size, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_12arbitrary_path_in_x_y_z(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, double __pyx_v_bead_length, PyObject *__pyx_v_shape_func_x, PyObject *__pyx_v_shape_func_y, PyObject *__pyx_v_shape_func_z, double __pyx_v_step_size, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_parameter_vals = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("arbitrary_path_in_x_y_z", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.arbitrary_path_in_x_y_z", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_parameter_vals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_arbitrary_path_in_x_y_z);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1676, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1677</span>:         <span class="n">cls</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1678</span>:         <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1679</span>:         <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1680</span>:         <span class="n">bead_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1681</span>:         <span class="n">shape_func_x</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1682</span>:         <span class="n">shape_func_y</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1683</span>:         <span class="n">shape_func_z</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1684</span>:         <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1685</span>:         <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1686</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1687</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a polymer initialized as y = f(x) from x = 0.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1689</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1690</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1691</span>: <span class="sd">        As is, this code does not support variable linker lengths.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1692</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1696</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1697</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1698</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1699</span>: <span class="sd">        bead_length : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1701</span>: <span class="sd">        shape_func_x : Callable[[float], float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1702</span>: <span class="sd">            Parametric functions to obtain the x coordinates of the path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1703</span>: <span class="sd">        shape_func_y : Callable[[float], float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>: <span class="sd">            Parametric functions to obtain the y coordinates of the path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1705</span>: <span class="sd">        shape_func_z : Callable[[float], float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1706</span>: <span class="sd">            Parametric functions to obtain the z coordinates of the path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1707</span>: <span class="sd">        step_size : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1708</span>: <span class="sd">            Step size for numerical evaluation of contour length when</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1709</span>: <span class="sd">            building the polymer path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1711</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1712</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1713</span>: <span class="sd">        SSWLC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1714</span>: <span class="sd">            Object representing a polymer following path x = X(t), y = Y(t),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1715</span>: <span class="sd">            z = Z(t)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1716</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1717</span>:         <span class="n">r</span><span class="p">,</span> <span class="n">parameter_vals</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">coordinates_in_x_y_z</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_coordinates_in_x_y_z);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_v_r = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_parameter_vals = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1718</span>:             <span class="n">num_beads</span><span class="p">,</span> <span class="n">bead_length</span><span class="p">,</span> <span class="n">shape_func_x</span><span class="p">,</span> <span class="n">shape_func_y</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-96" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1719</span>:             <span class="n">shape_func_z</span><span class="p">,</span> <span class="n">step_size</span></pre>
<pre class='cython code score-96 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_shape_func_x, __pyx_v_shape_func_y, __pyx_v_shape_func_z, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_shape_func_x, __pyx_v_shape_func_y, __pyx_v_shape_func_z, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_shape_func_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_v_shape_func_y);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_z);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4+__pyx_t_6, __pyx_v_shape_func_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 5+__pyx_t_6, __pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1717, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_7 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_7)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1717, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1717, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1720</span>:         <span class="p">)</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1721</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">get_tangent_vals_x_y_z</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_get_tangent_vals_x_y_z);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
  __pyx_v_t3 = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_t2 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1722</span>:             <span class="n">parameter_vals</span><span class="p">,</span> <span class="n">shape_func_x</span><span class="p">,</span> <span class="n">shape_func_y</span><span class="p">,</span> <span class="n">shape_func_z</span><span class="p">,</span></pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1723</span>:             <span class="n">step_size</span><span class="p">,</span> <span class="n">r</span></pre>
<pre class='cython code score-95 '>  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_size);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1723, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_parameter_vals, __pyx_v_shape_func_x, __pyx_v_shape_func_y, __pyx_v_shape_func_z, __pyx_t_7, __pyx_v_r};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_parameter_vals, __pyx_v_shape_func_x, __pyx_v_shape_func_y, __pyx_v_shape_func_z, __pyx_t_7, __pyx_v_r};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_parameter_vals);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_parameter_vals);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_6, __pyx_v_parameter_vals);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_x);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_6, __pyx_v_shape_func_x);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_y);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_6, __pyx_v_shape_func_y);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_shape_func_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_shape_func_z);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3+__pyx_t_6, __pyx_v_shape_func_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4+__pyx_t_6, __pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 5+__pyx_t_6, __pyx_v_r);
    __pyx_t_7 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1721, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1721, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1721, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1724</span>:         <span class="p">)</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1725</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1725, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1725, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_bead_length, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1725, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_2 = __pyx_t_3;
  __pyx_t_3 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_2, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1725, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1725, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1726</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1727</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1727, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_gaussian_walk_polymer, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1728</span>:     <span class="k">def</span> <span class="nf">gaussian_walk_polymer</span><span class="p">(</span></pre>
<pre class='cython code score-53 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_15gaussian_walk_polymer(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_14gaussian_walk_polymer[] = "Initialize a polymer to a Gaussian random walk.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        step_lengths : np.ndarray (N-1,) float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n\n        Returns\n        -------\n        SSWLC\n            Object representing a polymer initialized as Gaussian random walk\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_15gaussian_walk_polymer(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  PyArrayObject *__pyx_v_step_lengths = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gaussian_walk_polymer (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_step_lengths,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gaussian_walk_polymer", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_lengths)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gaussian_walk_polymer", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "gaussian_walk_polymer") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_step_lengths = ((PyArrayObject *)values[2]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gaussian_walk_polymer", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1728, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.gaussian_walk_polymer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_step_lengths), __pyx_ptype_5numpy_ndarray, 1, "step_lengths", 0))) <span class='error_goto'>__PYX_ERR(0, 1729, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_14gaussian_walk_polymer(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_step_lengths, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_14gaussian_walk_polymer(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, PyArrayObject *__pyx_v_step_lengths, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gaussian_walk_polymer", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.gaussian_walk_polymer", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_gaussian_walk_polymer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1728, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1729</span>:         <span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1730</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1731</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a polymer to a Gaussian random walk.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1732</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1733</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1734</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1735</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1736</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1737</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1738</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1739</span>: <span class="sd">        step_lengths : np.ndarray (N-1,) float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1740</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1741</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1742</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1743</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1744</span>: <span class="sd">        SSWLC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1745</span>: <span class="sd">            Object representing a polymer initialized as Gaussian random walk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1746</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1747</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">gaussian_walk</span><span class="p">(</span><span class="n">num_beads</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_gaussian_walk);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_num_beads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, ((PyObject *)__pyx_v_step_lengths)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, ((PyObject *)__pyx_v_step_lengths)};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_step_lengths));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_step_lengths));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, ((PyObject *)__pyx_v_step_lengths));
    __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1748</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">estimate_tangents_from_coordinates</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_estimate_tangents_from_coordinat);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_v_r) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1748, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;
    index = 0; __pyx_t_6 = __pyx_t_7(__pyx_t_2); if (unlikely(!__pyx_t_6)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
    __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_7 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_t3 = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_v_t2 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1749</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">step_lengths</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_bead_length, ((PyObject *)__pyx_v_step_lengths)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_t_6;
  __pyx_t_6 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1750</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1751</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_confined_gaussian_walk, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-79" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1752</span>:     <span class="k">def</span> <span class="nf">confined_gaussian_walk</span><span class="p">(</span></pre>
<pre class='cython code score-79 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_17confined_gaussian_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_16confined_gaussian_walk[] = "Initialize a polymer to a confined Gaussian random walk.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        step_lengths : np.ndarray (N-1,) float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        confine_type : str\n            Name of the confining boundary; to indicate model w/o confinement,\n            enter a blank string for this argument\n        confine_length : double\n            The lengthscale associated with the confining boundary. Length\n            representation specified in function associated w/ `confine_type`\n\n        Returns\n        -------\n        Polymer\n            Object representing a polymer initialized as a confined Gaussian\n            random walk\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_17confined_gaussian_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  PyArrayObject *__pyx_v_step_lengths = 0;
  PyObject *__pyx_v_confine_type = 0;
  double __pyx_v_confine_length;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("confined_gaussian_walk (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_step_lengths,&amp;__pyx_n_s_confine_type,&amp;__pyx_n_s_confine_length,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_gaussian_walk", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_lengths)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_gaussian_walk", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_gaussian_walk", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_gaussian_walk", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "confined_gaussian_walk") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_step_lengths = ((PyArrayObject *)values[2]);
    __pyx_v_confine_type = ((PyObject*)values[3]);
    __pyx_v_confine_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_confine_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1754, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_gaussian_walk", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.confined_gaussian_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1753, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_step_lengths), __pyx_ptype_5numpy_ndarray, 1, "step_lengths", 0))) <span class='error_goto'>__PYX_ERR(0, 1753, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_confine_type), (&amp;PyString_Type), 1, "confine_type", 1))) <span class='error_goto'>__PYX_ERR(0, 1754, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_16confined_gaussian_walk(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_step_lengths, __pyx_v_confine_type, __pyx_v_confine_length, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_16confined_gaussian_walk(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, PyArrayObject *__pyx_v_step_lengths, PyObject *__pyx_v_confine_type, double __pyx_v_confine_length, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("confined_gaussian_walk", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_step_lengths);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.confined_gaussian_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_step_lengths);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_confined_gaussian_walk);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1753</span>:         <span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1754</span>:         <span class="n">confine_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">confine_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1755</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1756</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a polymer to a confined Gaussian random walk.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1758</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1759</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1760</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1761</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1762</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1763</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1764</span>: <span class="sd">        step_lengths : np.ndarray (N-1,) float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1765</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1766</span>: <span class="sd">        confine_type : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1767</span>: <span class="sd">            Name of the confining boundary; to indicate model w/o confinement,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1768</span>: <span class="sd">            enter a blank string for this argument</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1769</span>: <span class="sd">        confine_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1770</span>: <span class="sd">            The lengthscale associated with the confining boundary. Length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1771</span>: <span class="sd">            representation specified in function associated w/ `confine_type`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1772</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1773</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1774</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1775</span>: <span class="sd">        Polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1776</span>: <span class="sd">            Object representing a polymer initialized as a confined Gaussian</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1777</span>: <span class="sd">            random walk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1778</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1779</span>:         <span class="n">step_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, ((PyObject *)__pyx_v_step_lengths)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, ((PyObject *)__pyx_v_step_lengths));
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_step_lengths, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1780</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">confined_gaussian_walk</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_confined_gaussian_walk);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1781</span>:             <span class="n">num_beads</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">,</span> <span class="n">confine_type</span><span class="p">,</span> <span class="n">confine_length</span></pre>
<pre class='cython code score-47 '>  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_confine_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_4, __pyx_v_num_beads, ((PyObject *)__pyx_v_step_lengths), __pyx_v_confine_type, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_4, __pyx_v_num_beads, ((PyObject *)__pyx_v_step_lengths), __pyx_v_confine_type, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, __pyx_v_num_beads);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_step_lengths));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_step_lengths));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, ((PyObject *)__pyx_v_step_lengths));
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_confine_type);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, __pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_5, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1782</span>:         <span class="p">)</span></pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1783</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">estimate_tangents_from_coordinates</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_estimate_tangents_from_coordinat);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_v_r) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1783, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;
    index = 0; __pyx_t_6 = __pyx_t_7(__pyx_t_3); if (unlikely(!__pyx_t_6)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    index = 1; __pyx_t_2 = __pyx_t_7(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_3), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
    __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1783, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_t3 = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_v_t2 = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1784</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">step_lengths</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_bead_length, ((PyObject *)__pyx_v_step_lengths)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_t_6;
  __pyx_t_6 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_2, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1785</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1786</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC-&gt;tp_dict, __pyx_n_s_confined_uniform_random_walk, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_SSWLC);
</pre><pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1787</span>:     <span class="k">def</span> <span class="nf">confined_uniform_random_walk</span><span class="p">(</span></pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_19confined_uniform_random_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_5SSWLC_18confined_uniform_random_walk[] = "Initialize a polymer to a confined uniform random walk.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        step_lengths : float\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        confine_type : str\n            Name of the confining boundary; to indicate model w/o confinement,\n            enter a blank string for this argument\n        confine_length : double\n            The lengthscale associated with the confining boundary. Length\n            representation specified in function associated w/ `confine_type`\n\n        Returns\n        -------\n        Polymer\n            Object representing a polymer initialized as a confined uniform\n            random walk\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_5SSWLC_19confined_uniform_random_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  double __pyx_v_step_lengths;
  PyObject *__pyx_v_confine_type = 0;
  double __pyx_v_confine_length;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("confined_uniform_random_walk (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_step_lengths,&amp;__pyx_n_s_confine_type,&amp;__pyx_n_s_confine_length,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_uniform_random_walk", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_step_lengths)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_uniform_random_walk", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_uniform_random_walk", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_uniform_random_walk", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "confined_uniform_random_walk") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_step_lengths = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_step_lengths == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1788, __pyx_L3_error)</span>
    __pyx_v_confine_type = ((PyObject*)values[3]);
    __pyx_v_confine_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_confine_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1789, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("confined_uniform_random_walk", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.confined_uniform_random_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1788, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_confine_type), (&amp;PyString_Type), 1, "confine_type", 1))) <span class='error_goto'>__PYX_ERR(0, 1788, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_5SSWLC_18confined_uniform_random_walk(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_step_lengths, __pyx_v_confine_type, __pyx_v_confine_length, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_5SSWLC_18confined_uniform_random_walk(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, double __pyx_v_step_lengths, PyObject *__pyx_v_confine_type, double __pyx_v_confine_length, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("confined_uniform_random_walk", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSWLC.confined_uniform_random_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_1, (PyObject *)__pyx_ptype_6chromo_8polymers_SSWLC, __pyx_n_s_confined_uniform_random_walk);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1788</span>:             <span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">confine_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1789</span>:             <span class="n">confine_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1790</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1791</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a polymer to a confined uniform random walk.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1793</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1794</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1795</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1796</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1797</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1798</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>: <span class="sd">        step_lengths : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1800</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1801</span>: <span class="sd">        confine_type : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1802</span>: <span class="sd">            Name of the confining boundary; to indicate model w/o confinement,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1803</span>: <span class="sd">            enter a blank string for this argument</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1804</span>: <span class="sd">        confine_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1805</span>: <span class="sd">            The lengthscale associated with the confining boundary. Length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1806</span>: <span class="sd">            representation specified in function associated w/ `confine_type`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1807</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1808</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1809</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1810</span>: <span class="sd">        Polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1811</span>: <span class="sd">            Object representing a polymer initialized as a confined uniform</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1812</span>: <span class="sd">            random walk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1813</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1814</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">confined_uniform_random_walk</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_confined_uniform_random_walk);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1815</span>:             <span class="n">num_beads</span><span class="p">,</span> <span class="n">step_lengths</span><span class="p">,</span> <span class="n">confine_type</span><span class="p">,</span> <span class="n">confine_length</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_lengths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_confine_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1815, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_confine_type, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_confine_type, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_confine_type);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1814, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1816</span>:         <span class="p">)</span></pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1817</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">estimate_tangents_from_coordinates</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_estimate_tangents_from_coordinat);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_r) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1817, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1817, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1817, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1817, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1817, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_7 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_7)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    index = 1; __pyx_t_3 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1817, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1817, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_t3 = __pyx_t_7;
  __pyx_t_7 = 0;
  __pyx_v_t2 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1818</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">step_lengths</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1818, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1818, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_step_lengths);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1818, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_t_7;
  __pyx_t_7 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1818, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1819</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1820</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1821</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Chromatin</span><span class="p">(</span><span class="n">SSWLC</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_Chromatin {
  struct __pyx_vtabstruct_6chromo_8polymers_SSWLC __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_8polymers_Chromatin *__pyx_vtabptr_6chromo_8polymers_Chromatin;

</pre><pre class="cython line score-0">&#xA0;<span class="">1822</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Stretchable, sharable WLC model of chromatin.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1823</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1824</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1825</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1826</span>: <span class="sd">    The persistence length of DNA is 53 nm. Each base pair of DNA is 0.34 nm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1827</span>: <span class="sd">    along the double helix.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1828</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1829</span>: <span class="sd">    Please see documentation for `PolymerBase` and `SSWLC` for parameter</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1830</span>: <span class="sd">    descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1832</span>: <span class="sd">    TODO: This should be instantiated directly from SSWLC. This does not have</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1833</span>: <span class="sd">    the same level of abstraction as `SSTWLC`, which is also a subclass of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1834</span>: <span class="sd">    `SSWLC`. Subclasses at the same level should have the same level of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1835</span>: <span class="sd">    abstraction. To implement chromatin as an instance of the SSWLC, we need</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1836</span>: <span class="sd">    to adjust the `construct_beads` method to accept an arbitrary bead type.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1837</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1838</span>: </pre>
<pre class="cython line score-114" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1839</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-114 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_9Chromatin_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_9Chromatin___init__[] = "Construct a `Chromatin` fiber object as a subclass of `SSWLC`.\n\n        Notes\n        -----\n        The persistence length of DNA is 53 nm. For now, this will be used as\n        the persistence length of chromatin, stored in the `lp` attribute.\n\n        Please see documentation for `PolymerBase.__init__()` and\n        `SSWLC.__init__()` for parameter descriptions.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_9Chromatin___init__;
#endif
static int __pyx_pw_6chromo_8polymers_9Chromatin_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyArrayObject *__pyx_v_r = 0;
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_bead_rad;
  PyArrayObject *__pyx_v_t3 = 0;
  PyArrayObject *__pyx_v_t2 = 0;
  PyArrayObject *__pyx_v_states = 0;
  PyArrayObject *__pyx_v_binder_names = 0;
  PyArrayObject *__pyx_v_chemical_mods = 0;
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return -1;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_bead_rad,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    values[4] = (PyObject *)__pyx_k__49;
    values[5] = (PyObject *)__pyx_k__50;
    values[6] = (PyObject *)__pyx_k__51;
    values[7] = (PyObject *)__pyx_k__52;
    values[8] = (PyObject *)__pyx_k__53;
    values[9] = (PyObject *)__pyx_k__54;
    values[10] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; (kw_args &lt;= 9)) {
        Py_ssize_t index;
        for (index = 3; index &lt; 12 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = ((PyArrayObject *)values[1]);
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 1844, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_bead_rad = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_bead_rad == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1845, __pyx_L3_error)</span>
    } else {
      __pyx_v_bead_rad = ((double)5.0);
    }
    __pyx_v_t3 = ((PyArrayObject *)values[4]);
    __pyx_v_t2 = ((PyArrayObject *)values[5]);
    __pyx_v_states = ((PyArrayObject *)values[6]);
    __pyx_v_binder_names = ((PyArrayObject *)values[7]);
    __pyx_v_chemical_mods = ((PyArrayObject *)values[8]);
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[9]);
    __pyx_v_log_path = ((PyObject*)values[10]);
    if (values[11]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[11]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1852, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.Chromatin.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1841, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_r), __pyx_ptype_5numpy_ndarray, 1, "r", 0))) <span class='error_goto'>__PYX_ERR(0, 1842, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t3), __pyx_ptype_5numpy_ndarray, 1, "t3", 0))) <span class='error_goto'>__PYX_ERR(0, 1846, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_t2), __pyx_ptype_5numpy_ndarray, 1, "t2", 0))) <span class='error_goto'>__PYX_ERR(0, 1847, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_states), __pyx_ptype_5numpy_ndarray, 1, "states", 0))) <span class='error_goto'>__PYX_ERR(0, 1848, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 1849, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mods), __pyx_ptype_5numpy_ndarray, 1, "chemical_mods", 0))) <span class='error_goto'>__PYX_ERR(0, 1850, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 1851, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 1852, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_9Chromatin___init__(((struct __pyx_obj_6chromo_8polymers_Chromatin *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bead_length, __pyx_v_bead_rad, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_9Chromatin___init__(struct __pyx_obj_6chromo_8polymers_Chromatin *__pyx_v_self, PyObject *__pyx_v_name, PyArrayObject *__pyx_v_r, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_bead_rad, PyArrayObject *__pyx_v_t3, PyArrayObject *__pyx_v_t2, PyArrayObject *__pyx_v_states, PyArrayObject *__pyx_v_binder_names, PyArrayObject *__pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  double __pyx_v_lp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_chemical_mods;
  __Pyx_Buffer __pyx_pybuffer_chemical_mods;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r;
  __Pyx_Buffer __pyx_pybuffer_r;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_states;
  __Pyx_Buffer __pyx_pybuffer_states;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t2;
  __Pyx_Buffer __pyx_pybuffer_t2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_t3;
  __Pyx_Buffer __pyx_pybuffer_t3;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
  __pyx_pybuffer_r.pybuffer.buf = NULL;
  __pyx_pybuffer_r.refcount = 0;
  __pyx_pybuffernd_r.data = NULL;
  __pyx_pybuffernd_r.rcbuffer = &amp;__pyx_pybuffer_r;
  __pyx_pybuffer_t3.pybuffer.buf = NULL;
  __pyx_pybuffer_t3.refcount = 0;
  __pyx_pybuffernd_t3.data = NULL;
  __pyx_pybuffernd_t3.rcbuffer = &amp;__pyx_pybuffer_t3;
  __pyx_pybuffer_t2.pybuffer.buf = NULL;
  __pyx_pybuffer_t2.refcount = 0;
  __pyx_pybuffernd_t2.data = NULL;
  __pyx_pybuffernd_t2.rcbuffer = &amp;__pyx_pybuffer_t2;
  __pyx_pybuffer_states.pybuffer.buf = NULL;
  __pyx_pybuffer_states.refcount = 0;
  __pyx_pybuffernd_states.data = NULL;
  __pyx_pybuffernd_states.rcbuffer = &amp;__pyx_pybuffer_states;
  __pyx_pybuffer_chemical_mods.pybuffer.buf = NULL;
  __pyx_pybuffer_chemical_mods.refcount = 0;
  __pyx_pybuffernd_chemical_mods.data = NULL;
  __pyx_pybuffernd_chemical_mods.rcbuffer = &amp;__pyx_pybuffer_chemical_mods;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_r, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_r.diminfo[0].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_r.diminfo[0].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_r.diminfo[1].strides = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_r.diminfo[1].shape = __pyx_pybuffernd_r.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t3, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t3.diminfo[0].strides = __pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t3.diminfo[0].shape = __pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_t3.diminfo[1].strides = __pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_t3.diminfo[1].shape = __pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_t2, &amp;__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_t2.diminfo[0].strides = __pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_t2.diminfo[0].shape = __pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_t2.diminfo[1].strides = __pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_t2.diminfo[1].shape = __pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_states, &amp;__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_states.diminfo[0].strides = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_states.diminfo[0].shape = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_states.diminfo[1].strides = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_states.diminfo[1].shape = __pyx_pybuffernd_states.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_chemical_mods, &amp;__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 1839, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_chemical_mods.diminfo[0].strides = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_chemical_mods.diminfo[0].shape = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_chemical_mods.diminfo[1].strides = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_chemical_mods.diminfo[1].shape = __pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.Chromatin.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_chemical_mods.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_r.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_states.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t2.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_t3.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1840</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1841</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1842</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1843</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1844</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1845</span>:         <span class="n">double</span> <span class="n">bead_rad</span> <span class="o">=</span> <span class="mf">5</span><span class="p">,</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1846</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d));
  __pyx_k__49 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_empty_2d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_2d);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1847</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">double</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d));
  __pyx_k__50 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_empty_2d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_2d);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1848</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">long</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
  __pyx_k__51 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_mty_2d_int);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_mty_2d_int);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1849</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__52 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1850</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">long</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int));
  __pyx_k__53 = ((PyArrayObject *)__pyx_v_6chromo_8polymers_mty_2d_int);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_mty_2d_int);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1851</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__54 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">1852</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1853</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1854</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a `Chromatin` fiber object as a subclass of `SSWLC`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1855</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1857</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1858</span>: <span class="sd">        The persistence length of DNA is 53 nm. For now, this will be used as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1859</span>: <span class="sd">        the persistence length of chromatin, stored in the `lp` attribute.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1860</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1861</span>: <span class="sd">        Please see documentation for `PolymerBase.__init__()` and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1862</span>: <span class="sd">        `SSWLC.__init__()` for parameter descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1863</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1864</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">lp</span> <span class="o">=</span> <span class="mf">53</span></pre>
<pre class='cython code score-0 '>  __pyx_v_lp = 53.0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1865</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">Chromatin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-30 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_Chromatin));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_Chromatin));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_Chromatin));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_r));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_r));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_r));
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1866</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="n">bead_rad</span><span class="o">=</span><span class="n">bead_rad</span><span class="p">,</span> <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span></pre>
<pre class='cython code score-35 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_bead_rad, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_t3, ((PyObject *)__pyx_v_t3)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1867</span>:             <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span></pre>
<pre class='cython code score-20 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_t2, ((PyObject *)__pyx_v_t2)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_states, ((PyObject *)__pyx_v_states)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1868</span>:             <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_chemical_mods, ((PyObject *)__pyx_v_chemical_mods)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1869</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1869, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1870</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1871</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">construct_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_Chromatin *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.construct_beads(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));
</pre><pre class="cython line score-0">&#xA0;<span class="">1872</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1873</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>static void __pyx_f_6chromo_8polymers_9Chromatin_construct_beads(struct __pyx_obj_6chromo_8polymers_Chromatin *__pyx_v_self) {
  Py_ssize_t __pyx_8genexpr4__pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.Chromatin.construct_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1874</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Nucleosome objects forming beads of our Chromatin polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1875</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1876</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-6 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.beads);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.beads);
  __pyx_v_self-&gt;__pyx_base.__pyx_base.beads = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1877</span>:             <span class="n">i</span><span class="p">:</span> <span class="n">beads</span><span class="o">.</span><span class="n">Nucleosome</span><span class="p">(</span></pre>
<pre class='cython code score-21 '>      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr4__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1877, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_beads);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1877, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_Nucleosome);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1877, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1877, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_t_5, (PyObject*)__pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 1877, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  } /* exit inner scope */
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1878</span>:                 <span class="n">id_</span><span class="o">=</span><span class="n">i</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr4__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_id, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1879</span>:                 <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1879, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr4__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1879, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1879, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_r, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1880</span>:                 <span class="n">t3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr4__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1880, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1881</span>:                 <span class="n">t2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1881, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr4__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1881, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1881, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1882</span>:                 <span class="n">rad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1882, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_rad, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1883</span>:                 <span class="n">states</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>}
      __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.data;
      __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr4__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.states.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1883, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_states, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1884</span>:                 <span class="n">binder_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span></pre>
<pre class='cython code score-5 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1878, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1885</span>:             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1885, __pyx_L1_error)</span>}
    __pyx_t_2 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0]);
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_8genexpr4__pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1886</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1887</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1888</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1889</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">SSTWLC</span><span class="p">(</span><span class="n">SSWLC</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC {
  struct __pyx_vtabstruct_6chromo_8polymers_SSWLC __pyx_base;
  double (*E_pair_with_twist)(struct __pyx_obj_6chromo_8polymers_SSTWLC *, __Pyx_memviewslice, double, __Pyx_memviewslice, double, long);
  double (*bead_pair_dE_poly_forward_with_twist)(struct __pyx_obj_6chromo_8polymers_SSTWLC *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, long);
  double (*bead_pair_dE_poly_reverse_with_twist)(struct __pyx_obj_6chromo_8polymers_SSTWLC *, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, __Pyx_memviewslice, long);
  double (*compute_E_no_twist)(struct __pyx_obj_6chromo_8polymers_SSTWLC *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *__pyx_vtabptr_6chromo_8polymers_SSTWLC;

</pre><pre class="cython line score-0">&#xA0;<span class="">1890</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of stretchable, shearable wormlike chain w/ twist.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1891</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1892</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1893</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1894</span>: <span class="sd">    Please see documentation for `PolymerBase` and `SSWLC` for shared parameter</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1895</span>: <span class="sd">    descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1897</span>: <span class="sd">    TODO: It does not make sense for Chromatin to be on the same level of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1898</span>: <span class="sd">    abstraction as a SSTWLC.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1900</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1901</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1902</span>: <span class="sd">    lt : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1903</span>: <span class="sd">        Twist persistence length of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1904</span>: <span class="sd">    eps_twist : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1905</span>: <span class="sd">        Twist modulus of the polymer, divided by dimensionless `delta`,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1906</span>: <span class="sd">        as appears in the equation for SSTWLC elastic energy (units of kbT)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1907</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1908</span>: </pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1909</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-101 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_6SSTWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_6SSTWLC___init__[] = "Construct a `SSTWLC` polymer object as a subclass of `SSWLC`.\n\n        Notes\n        -----\n        See documentation for `SSWLC` class additional parameter descriptions.\n\n        Parameters\n        ----------\n        lt : double\n            Twist persistence length (in nm)\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_6SSTWLC___init__;
#endif
static int __pyx_pw_6chromo_8polymers_6SSTWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  double __pyx_v_lt;
  double __pyx_v_bead_rad;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_lt,&amp;__pyx_n_s_bead_rad,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[9] = (PyObject *)__pyx_k__55;
    values[11] = (PyObject *)__pyx_k__56;
    values[12] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
        }
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
        }
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lt); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 9)) {
        Py_ssize_t index;
        for (index = 5; index &lt; 14 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 1912, __pyx_L3_error)</span>
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 1914, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1915, __pyx_L3_error)</span>
    __pyx_v_lt = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_lt == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1916, __pyx_L3_error)</span>
    if (values[5]) {
      __pyx_v_bead_rad = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_bead_rad == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1917, __pyx_L3_error)</span>
    } else {
      __pyx_v_bead_rad = ((double)5.0);
    }
    if (values[6]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 1918, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__57;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[7]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 1919, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__58;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[8]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 1920, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__59;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 1922, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__60;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[11]);
    __pyx_v_log_path = ((PyObject*)values[12]);
    if (values[13]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[13]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1924, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1909, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 1911, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 1921, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 1923, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 1924, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_6SSTWLC___init__(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_lt, __pyx_v_bead_rad, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_6SSTWLC___init__(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_lt, double __pyx_v_bead_rad, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1910</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1911</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1912</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1913</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1914</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1915</span>:         <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1916</span>:         <span class="n">double</span> <span class="n">lt</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1917</span>:         <span class="n">double</span> <span class="n">bead_rad</span> <span class="o">=</span> <span class="mf">5</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1918</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1918, __pyx_L1_error)</span>
  __pyx_k__57 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1919</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1919, __pyx_L1_error)</span>
  __pyx_k__58 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1920</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1920, __pyx_L1_error)</span>
  __pyx_k__59 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1921</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__55 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1922</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1922, __pyx_L1_error)</span>
  __pyx_k__60 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1923</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__56 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">1924</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1925</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1926</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a `SSTWLC` polymer object as a subclass of `SSWLC`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1927</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1928</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1929</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1930</span>: <span class="sd">        See documentation for `SSWLC` class additional parameter descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1931</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1932</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1933</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1934</span>: <span class="sd">        lt : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1935</span>: <span class="sd">            Twist persistence length (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1936</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1937</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_arrays</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1938</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">SSTWLC</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSTWLC));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_SSTWLC));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_SSTWLC));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1939</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span></pre>
<pre class='cython code score-25 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1940</span>:             <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span> <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span></pre>
<pre class='cython code score-22 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1940, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1940, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1941</span>:             <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1942</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1942, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1939, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1943</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1944</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span> <span class="o">=</span> <span class="n">bead_rad</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.bead_rad = __pyx_v_bead_rad;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1945</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">construct_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.construct_beads(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1946</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">lt</span> <span class="o">=</span> <span class="n">lt</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;lt = __pyx_v_lt;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1947</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_find_parameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_length</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1947, __pyx_L1_error)</span>}
  ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base._find_parameters(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length, 0);
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1948</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">required_attrs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-52 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1948, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1948, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1948, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_name);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_binder_names);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_binder_names);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_n_s_binder_names);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_binders);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_n_s_num_binders);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, __pyx_n_s_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_num_beads);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_num_beads);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, __pyx_n_s_num_beads);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lp);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lp);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, __pyx_n_s_lp);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lt);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, __pyx_n_s_lt);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_rad);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_rad);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, __pyx_n_s_bead_rad);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1948, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1948, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.required_attrs);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.required_attrs));
  __pyx_v_self-&gt;__pyx_base.__pyx_base.required_attrs = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1949</span>:             <span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="s">&quot;t3&quot;</span><span class="p">,</span> <span class="s">&quot;t2&quot;</span><span class="p">,</span> <span class="s">&quot;states&quot;</span><span class="p">,</span> <span class="s">&quot;binder_names&quot;</span><span class="p">,</span> <span class="s">&quot;num_binders&quot;</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1950</span>:             <span class="s">&quot;beads&quot;</span><span class="p">,</span> <span class="s">&quot;num_beads&quot;</span><span class="p">,</span> <span class="s">&quot;lp&quot;</span><span class="p">,</span> <span class="s">&quot;lt&quot;</span><span class="p">,</span> <span class="s">&quot;bead_rad&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1951</span>:         <span class="p">])</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1952</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">_arrays</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1952, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1952, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1952, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base._arrays);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base._arrays));
  __pyx_v_self-&gt;__pyx_base.__pyx_base._arrays = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1953</span>:             <span class="p">[</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="s">&#39;t3&#39;</span><span class="p">,</span> <span class="s">&#39;t2&#39;</span><span class="p">,</span> <span class="s">&#39;states&#39;</span><span class="p">,</span> <span class="s">&#39;bead_length&#39;</span><span class="p">,</span> <span class="s">&#39;chemical_mods&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-32 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1953, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_t3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_t2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_t2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_t2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_states);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_states);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_states);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_bead_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_bead_length);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_s_bead_length);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_chemical_mods);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_chemical_mods);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 5, __pyx_n_s_chemical_mods);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1952, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1954</span>:         <span class="p">)</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1955</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">check_attrs</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_check_attrs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1955, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_4 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1955, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1956</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1957</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">_find_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">step_lengths</span><span class="p">):</span></pre>
<pre class='cython code score-42 '>static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_3_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_step_lengths); /*proto*/
static void __pyx_f_6chromo_8polymers_6SSTWLC__find_parameters(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_step_lengths, int __pyx_skip_dispatch) {
  Py_ssize_t __pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters", 0);
  __PYX_INC_MEMVIEW(&amp;__pyx_v_step_lengths, 1);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_find_parameters);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1957, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_6SSTWLC_3_find_parameters)) {
        if (unlikely(!__pyx_v_step_lengths.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("step_lengths"); <span class='error_goto'>__PYX_ERR(0, 1957, __pyx_L1_error)</span> }
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_step_lengths, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1957, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1957, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_step_lengths, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_3_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_step_lengths); /*proto*/
static char __pyx_doc_6chromo_8polymers_6SSTWLC_2_find_parameters[] = "Look up elastic parameters of ssWLC for each bead_length.\n\n        Notes\n        -----\n        See `_find_parameters` method in `SSWLC` class for additional\n        documentation.\n        \n        A new physical parameters, the twist modulus `eps_twist`, is added to\n        the SSTWLC model. Once divided by dimensionless `delta`, the twist \n        modulus carries units of kbT.\n\n        TODO: Check definition of `delta`; check units of `eps_twist`.\n\n        Parameters\n        ----------\n        step_lengths : np.ndarray (N-1,) of double\n            Dimensional distance between subsequent beads of the polymer (in nm)\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_3_find_parameters(PyObject *__pyx_v_self, PyObject *__pyx_arg_step_lengths) {
  __Pyx_memviewslice __pyx_v_step_lengths = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters (wrapper)", 0);
  assert(__pyx_arg_step_lengths); {
    __pyx_v_step_lengths = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_arg_step_lengths, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_step_lengths.memview)) __PYX_ERR(0, 1957, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_6SSTWLC_2_find_parameters(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_v_step_lengths);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_6SSTWLC_2_find_parameters(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_step_lengths) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_find_parameters", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_step_lengths.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("step_lengths"); <span class='error_goto'>__PYX_ERR(0, 1957, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_8polymers_6SSTWLC__find_parameters(__pyx_v_self, __pyx_v_step_lengths, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1957, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC._find_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_step_lengths, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1958</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Look up elastic parameters of ssWLC for each bead_length.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1959</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1960</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1961</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1962</span>: <span class="sd">        See `_find_parameters` method in `SSWLC` class for additional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1963</span>: <span class="sd">        documentation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1964</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1965</span>: <span class="sd">        A new physical parameters, the twist modulus `eps_twist`, is added to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1966</span>: <span class="sd">        the SSTWLC model. Once divided by dimensionless `delta`, the twist </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1967</span>: <span class="sd">        modulus carries units of kbT.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1968</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1969</span>: <span class="sd">        TODO: Check definition of `delta`; check units of `eps_twist`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1970</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1971</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1972</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1973</span>: <span class="sd">        step_lengths : np.ndarray (N-1,) of double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1974</span>: <span class="sd">            Dimensional distance between subsequent beads of the polymer (in nm)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1975</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1976</span>:         <span class="n">step_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">)</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_step_lengths, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1976, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_step_lengths, 1);
  __pyx_v_step_lengths = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1977</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1977, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.delta, 0);
  __pyx_v_self-&gt;__pyx_base.delta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1978</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1978, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1978, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1978, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1978, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.eps_bend, 0);
  __pyx_v_self-&gt;__pyx_base.eps_bend = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1979</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1979, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.gamma, 0);
  __pyx_v_self-&gt;__pyx_base.gamma = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1980</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.eps_par, 0);
  __pyx_v_self-&gt;__pyx_base.eps_par = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1981</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1981, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1981, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1981, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1981, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1981, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.eps_perp, 0);
  __pyx_v_self-&gt;__pyx_base.eps_perp = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1982</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;__pyx_base.eta, 0);
  __pyx_v_self-&gt;__pyx_base.eta = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1983</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">eps_twist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">))</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1983, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;eps_twist, 0);
  __pyx_v_self-&gt;eps_twist = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1984</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">step_lengths</span><span class="p">)):</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_step_lengths); 
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1985</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">step_lengths</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-14 '>    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_step_lengths.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_step_lengths.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>
    }
    __pyx_t_12 = (*((double *) ( /* dim=0 */ (__pyx_v_step_lengths.data + __pyx_t_10 * __pyx_v_step_lengths.strides[0]) )));
    if (unlikely(__pyx_v_self-&gt;__pyx_base.__pyx_base.lp == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) )) = (__pyx_t_12 / __pyx_v_self-&gt;__pyx_base.__pyx_base.lp);
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1986</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1986, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.eps_bend.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.eps_bend.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1986, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_bend.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.eps_bend.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1987</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-64 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_tuple__42);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_2, __pyx_t_5, __pyx_t_13};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_2, __pyx_t_5, __pyx_t_13};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    } else
    #endif
    {
      __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_11, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 2+__pyx_t_11, __pyx_t_13);
      __pyx_t_2 = 0;
      __pyx_t_5 = 0;
      __pyx_t_13 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1986, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1988</span>:             <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1988, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1988, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1989</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.gamma.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1989, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.gamma.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.gamma.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1989, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.gamma.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.gamma.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1990</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-64 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1990, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1990, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_13, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_13, __pyx_tuple__43);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_13 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_4, __pyx_t_5, __pyx_t_2};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
      PyObject *__pyx_temp[4] = {__pyx_t_13, __pyx_t_4, __pyx_t_5, __pyx_t_2};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_13) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_13); __pyx_t_13 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_11, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_11, __pyx_t_2);
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1991</span>:             <span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-42 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_14, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.lp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_14 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_14); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1992</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_par.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1992, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.eps_par.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.eps_par.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1992, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_par.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.eps_par.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1993</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-64 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_tuple__44);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_1, __pyx_t_5, __pyx_t_4};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_t_1, __pyx_t_5, __pyx_t_4};
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (__pyx_t_2) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_2); __pyx_t_2 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_11, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_11, __pyx_t_4);
      __pyx_t_1 = 0;
      __pyx_t_5 = 0;
      __pyx_t_4 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1992, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1994</span>:             <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))) * pow(__pyx_v_self-&gt;__pyx_base.__pyx_base.lp, 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1994, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1994, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_13); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1995</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1995, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.eps_perp.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.eps_perp.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1995, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_perp.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.eps_perp.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1996</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-64 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1996, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1996, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_tuple__45);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_3, __pyx_t_5, __pyx_t_1};
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_14)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_3, __pyx_t_5, __pyx_t_1};
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_14, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else
    #endif
    {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0+__pyx_t_11, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2+__pyx_t_11, __pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_5 = 0;
      __pyx_t_1 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1995, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1997</span>:             <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="o">**</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1997, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1997, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))) * pow(__pyx_v_self-&gt;__pyx_base.__pyx_base.lp, 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_13, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1998</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_interp);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
/* … */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1998, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1998, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) )) = __pyx_t_12;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1999</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">dss_params</span><span class="p">[:,</span> <span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-64 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1999, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 1999, __pyx_L1_error)</span>
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__23);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_dss_params);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__46);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_14, __pyx_t_5, __pyx_t_3};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_13)) {
      PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_t_14, __pyx_t_5, __pyx_t_3};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_13, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_1) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_11, __pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_11, __pyx_t_3);
      __pyx_t_14 = 0;
      __pyx_t_5 = 0;
      __pyx_t_3 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1998, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2000</span>:             <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span></pre>
<pre class='cython code score-20 '>    __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.lp);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2000, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2000, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    __pyx_t_12 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_12 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2000, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2001</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">eps_twist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lt</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.delta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2001, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.delta.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.delta.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 2001, __pyx_L1_error)</span>
    }
    __pyx_t_12 = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.delta.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.delta.strides[0]) ))) * __pyx_v_self-&gt;__pyx_base.__pyx_base.lp);
    if (unlikely(__pyx_t_12 == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 2001, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;eps_twist.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2001, __pyx_L1_error)</span>}
    __pyx_t_10 = __pyx_v_i;
    __pyx_t_11 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_self-&gt;eps_twist.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_11 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;eps_twist.shape[0])) __pyx_t_11 = 0;
    if (unlikely(__pyx_t_11 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_11);
      <span class='error_goto'>__PYX_ERR(0, 2001, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_twist.data + __pyx_t_10 * __pyx_v_self-&gt;eps_twist.strides[0]) )) = (__pyx_v_self-&gt;lt / __pyx_t_12);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2002</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2003</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">continuous_dE_poly</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_6SSTWLC_continuous_dE_poly(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  long __pyx_v_ind0_m_1;
  long __pyx_v_indf_m_1;
  double __pyx_v_delta_energy_poly;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("continuous_dE_poly", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.continuous_dE_poly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2004</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2005</span>:         <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2006</span>:         <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2007</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2008</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy for a continuous bead region.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2010</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2011</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2012</span>: <span class="sd">        See documentation for `SSWLC.continuous_dE_poly()` class for details </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2013</span>: <span class="sd">        and parameter/return descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2014</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2015</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0_m_1</span><span class="p">,</span> <span class="nf">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2016</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2017</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2018</span>:         <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind0_m_1 = (__pyx_v_ind0 - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2019</span>:         <span class="n">indf_m_1</span> <span class="o">=</span> <span class="n">indf</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indf_m_1 = (__pyx_v_indf - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">2020</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2021</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2022</span>:         <span class="k">if</span> <span class="n">ind0</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ind0 != 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2023</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_forward_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;bead_pair_dE_poly_forward_with_twist(__pyx_v_self, __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_v_ind0_m_1));
/* … */
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL;
    __pyx_t_3.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2024</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2024, __pyx_L1_error)</span>}
    __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2024, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2025</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>}
/* … */
    __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2025, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2026</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2026, __pyx_L1_error)</span>}
/* … */
    __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2026, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2027</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2027, __pyx_L1_error)</span>}
/* … */
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2027, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2028</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2028, __pyx_L1_error)</span>}
/* … */
    __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2028, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2029</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2029, __pyx_L1_error)</span>}
/* … */
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2029, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2030</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2030, __pyx_L1_error)</span>}
/* … */
    __pyx_t_8.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_8.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2030, __pyx_L1_error)</span>
        }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_8.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2031</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2031, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2031, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2032</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2032, __pyx_L1_error)</span>}
/* … */
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2032, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">2033</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">ind0_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2034</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2035</span>:         <span class="k">if</span> <span class="n">indf</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_indf != __pyx_v_self-&gt;__pyx_base.__pyx_base.num_beads) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2036</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_reverse_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;bead_pair_dE_poly_reverse_with_twist(__pyx_v_self, __pyx_t_10, __pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_6, __pyx_t_5, __pyx_t_4, __pyx_t_3, __pyx_t_2, __pyx_v_indf_m_1));
/* … */
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
    __pyx_t_8.memview = NULL;
    __pyx_t_8.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
    __pyx_t_6.memview = NULL;
    __pyx_t_6.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL;
    __pyx_t_3.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
    __pyx_t_2.memview = NULL;
    __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2037</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2037, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2037, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2038</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>}
/* … */
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2038, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2039</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>}
/* … */
    __pyx_t_8.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_8.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_8, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2039, __pyx_L1_error)</span>
        }
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_8.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2040</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2040, __pyx_L1_error)</span>}
/* … */
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2040, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2041</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>}
/* … */
    __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2041, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2042</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2042, __pyx_L1_error)</span>}
/* … */
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2042, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2043</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2043, __pyx_L1_error)</span>}
/* … */
    __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2043, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2044</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2044, __pyx_L1_error)</span>}
/* … */
    __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2044, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2045</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2045, __pyx_L1_error)</span>}
/* … */
    __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2045, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">2046</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2047</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2048</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2049</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2050</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E_pair_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-7 '>static double __pyx_f_6chromo_8polymers_6SSTWLC_E_pair_with_twist(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_bend, double __pyx_v_dr_par, __Pyx_memviewslice __pyx_v_dr_perp, double __pyx_v_omega, long __pyx_v_bond_ind) {
  double __pyx_v_E;
  double __pyx_v_delta_omega;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("E_pair_with_twist", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.E_pair_with_twist", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2051</span>:         <span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">bend</span><span class="p">,</span> <span class="n">double</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">double</span> <span class="n">omega</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2052</span>:         <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2053</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2054</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate elastic energy for a pair of beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2055</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2056</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2057</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2058</span>: <span class="sd">        See documentation for `SSWLC.E_pair()` class for more details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2060</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2061</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2062</span>: <span class="sd">        bend : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2063</span>: <span class="sd">            Bending vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2064</span>: <span class="sd">        dr_par : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2065</span>: <span class="sd">            Magnitude of the parallel component of the displacement vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2066</span>: <span class="sd">        dr_perp : double[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2067</span>: <span class="sd">            Perpendicular component of the displacement vector</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2068</span>: <span class="sd">        omega : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2069</span>: <span class="sd">            Twist angle (in radians)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2070</span>: <span class="sd">        bond_ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2071</span>: <span class="sd">            Index of the bond between the two beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2072</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2073</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2074</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2075</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2076</span>: <span class="sd">            Elastic energy of bond between the bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2077</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2078</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">delta_omega</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2080</span>:         <span class="c"># Note, natural twist is based on the number of base pairs in a linker.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2081</span>:         <span class="c"># If the linker stretches, the mean-squared end-to-end distances of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2082</span>:         <span class="c"># polymer segments may deviate from theory, unless `bead_length[ind]`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2083</span>:         <span class="c"># is equal to the stretched bond length.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2085</span>:         <span class="c"># TODO: Adding twist seems to increase linker lengths! Why is this?</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2086</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2087</span>:         <span class="c"># Adjust for natural twist of DNA (2 pi / 10.5 bp * 1 bp / 0.332 nm)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2088</span>:         <span class="n">delta_omega</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">-</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_omega = (__pyx_v_omega - (__pyx_t_3 / __pyx_v_6chromo_8polymers_LENGTH_BP));
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2089</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bead_length</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">NATURAL_TWIST_BARE</span> <span class="o">/</span> <span class="n">LENGTH_BP</span></pre>
<pre class='cython code score-12 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2089, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2089, __pyx_L1_error)</span>
  }
  __pyx_t_3 = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.data + __pyx_t_1 * __pyx_v_self-&gt;__pyx_base.__pyx_base.bead_length.strides[0]) ))) * __pyx_v_6chromo_8polymers_NATURAL_TWIST_BARE);
  if (unlikely(__pyx_v_6chromo_8polymers_LENGTH_BP == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 2089, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2090</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2091</span>:         <span class="c"># Assume polymer is well-behaved and twists &lt; 2pi from relaxed state</span></pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2092</span>:         <span class="n">delta_omega</span> <span class="o">-=</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">((</span><span class="n">delta_omega</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span></pre>
<pre class='cython code score-76 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_omega);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_omega);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_6); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_delta_omega = __pyx_t_3;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2093</span>:         <span class="k">assert</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">&lt;=</span> <span class="n">delta_omega</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="w">\</span></pre>
<pre class='cython code score-45 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_omega);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_8, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4)) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_8, __pyx_t_7, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2093, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2093, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_9)) {
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_kp_s_Twist_angle_out_of_bounds);
      <span class='error_goto'>__PYX_ERR(0, 2093, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">2094</span>:             <span class="s">&quot;Twist angle out of bounds.&quot;</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2095</span>:         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_twist</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">,</span> <span class="s">&quot;Twist modulus must be positive.&quot;</span></pre>
<pre class='cython code score-12 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!__pyx_v_self-&gt;eps_twist.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>}
    __pyx_t_1 = __pyx_v_bond_ind;
    __pyx_t_2 = -1;
    if (__pyx_t_1 &lt; 0) {
      __pyx_t_1 += __pyx_v_self-&gt;eps_twist.shape[0];
      if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
    } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;eps_twist.shape[0])) __pyx_t_2 = 0;
    if (unlikely(__pyx_t_2 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
      <span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>
    }
    if (unlikely(!(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_twist.data + __pyx_t_1 * __pyx_v_self-&gt;eps_twist.strides[0]) ))) &gt; 0.0) != 0))) {
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_kp_s_Twist_modulus_must_be_positive);
      <span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">2096</span>:         <span class="n">E</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2097</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_bend</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">bend</span><span class="p">)</span> <span class="o">+</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_1 &lt; 0) {
    __pyx_t_1 += __pyx_v_self-&gt;__pyx_base.eps_bend.shape[0];
    if (unlikely(__pyx_t_1 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_1 &gt;= __pyx_v_self-&gt;__pyx_base.eps_bend.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2097, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2098</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_par</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">dr_par</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">])</span><span class="o">**</span><span class="mf">2</span> <span class="o">+</span></pre>
<pre class='cython code score-14 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_par.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2098, __pyx_L1_error)</span>}
  __pyx_t_10 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_10 &lt; 0) {
    __pyx_t_10 += __pyx_v_self-&gt;__pyx_base.eps_par.shape[0];
    if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_self-&gt;__pyx_base.eps_par.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2098, __pyx_L1_error)</span>
  }
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.gamma.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2098, __pyx_L1_error)</span>}
  __pyx_t_11 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_11 &lt; 0) {
    __pyx_t_11 += __pyx_v_self-&gt;__pyx_base.gamma.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_self-&gt;__pyx_base.gamma.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2098, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2099</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_perp</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">)</span> <span class="o">+</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.eps_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>}
  __pyx_t_12 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_12 &lt; 0) {
    __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.eps_perp.shape[0];
    if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.eps_perp.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>
  }
/* … */
  __pyx_v_E = (((((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_bend.data + __pyx_t_1 * __pyx_v_self-&gt;__pyx_base.eps_bend.strides[0]) )))) * __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_bend, __pyx_v_bend)) + ((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_par.data + __pyx_t_10 * __pyx_v_self-&gt;__pyx_base.eps_par.strides[0]) )))) * pow((__pyx_v_dr_par - (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.gamma.data + __pyx_t_11 * __pyx_v_self-&gt;__pyx_base.gamma.strides[0]) )))), 2.0))) + ((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eps_perp.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.eps_perp.strides[0]) )))) * __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_dr_perp, __pyx_v_dr_perp))) + ((0.5 * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;eps_twist.data + __pyx_t_13 * __pyx_v_self-&gt;eps_twist.strides[0]) )))) * pow(__pyx_v_delta_omega, 2.0)));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2100</span>:             <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps_twist</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span> <span class="o">*</span> <span class="n">delta_omega</span><span class="o">**</span><span class="mf">2</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;eps_twist.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>}
  __pyx_t_13 = __pyx_v_bond_ind;
  __pyx_t_2 = -1;
  if (__pyx_t_13 &lt; 0) {
    __pyx_t_13 += __pyx_v_self-&gt;eps_twist.shape[0];
    if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_2 = 0;
  } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;eps_twist.shape[0])) __pyx_t_2 = 0;
  if (unlikely(__pyx_t_2 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_2);
    <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2101</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2102</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2103</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2104</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_pair_dE_poly_forward_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_6SSTWLC_bead_pair_dE_poly_forward_with_twist(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_r_0, __Pyx_memviewslice __pyx_v_r_1, __Pyx_memviewslice __pyx_v_test_r_1, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_t3_1, __Pyx_memviewslice __pyx_v_test_t3_1, __Pyx_memviewslice __pyx_v_t2_0, __Pyx_memviewslice __pyx_v_t2_1, __Pyx_memviewslice __pyx_v_test_t2_1, long __pyx_v_bond_ind) {
  long __pyx_v_i;
  double __pyx_v_omega;
  double __pyx_v_omega_test;
  double __pyx_v_dr_par;
  double __pyx_v_dr_par_test;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bead_pair_dE_poly_forward_with_twist", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.bead_pair_dE_poly_forward_with_twist", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2105</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2106</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2107</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2108</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2109</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2110</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2111</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2112</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2113</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2114</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t2_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2115</span>:         <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2116</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2117</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy when affecting a single bead pair.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2119</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2120</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2121</span>: <span class="sd">        See documentation for `SSWLC.bead_pair_dE_poly_forward()` class for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2122</span>: <span class="sd">        more details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2123</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2124</span>: <span class="sd">        TODO: Check sign of cross product (t2 x t3 OR t3 x t2). Store t1 </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2125</span>: <span class="sd">        arrays so they don&#39;t need to be recreated every time. Manually </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2126</span>: <span class="sd">        implement dot products to speed up computation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2127</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2128</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2129</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2130</span>: <span class="sd">        r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2131</span>: <span class="sd">            Position vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2132</span>: <span class="sd">        r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2133</span>: <span class="sd">            Position vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2134</span>: <span class="sd">        test_r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2135</span>: <span class="sd">            Position vector of second bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2136</span>: <span class="sd">        t3_0, t2_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2137</span>: <span class="sd">            t3, t2 tangent vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2138</span>: <span class="sd">        t3_1, t2_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2139</span>: <span class="sd">            t3, t2 tangent vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2140</span>: <span class="sd">        test_t3_1, test_t2_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2141</span>: <span class="sd">            t3, t2 tangent vector of second bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2142</span>: <span class="sd">        bond_ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2143</span>: <span class="sd">            Index of the bond between the two beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2145</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2146</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2147</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2148</span>: <span class="sd">            Change in polymer energy for move of a single bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2149</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2150</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2151</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">omega</span><span class="p">,</span> <span class="nf">omega_test</span><span class="p">,</span> <span class="nf">dr_par</span><span class="p">,</span> <span class="nf">dr_par_test</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2152</span>:         <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2_0</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_t2_1, __pyx_v_t3_1, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2153</span>:         <span class="n">omega_test</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_omega_test = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_test_t2_1, __pyx_v_test_t3_1, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">2154</span>:             <span class="n">t2_0</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">test_t2_1</span><span class="p">,</span> <span class="n">test_t3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2155</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2156</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2157</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_test_r_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_test_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2157, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2157, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2157, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2157, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_test_r_1.data + __pyx_t_2 * __pyx_v_test_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_4 * __pyx_v_r_0.strides[0]) ))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2158</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2158, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2158, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2158, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2158, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_4 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_2 * __pyx_v_r_0.strides[0]) ))));
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2159</span>:         <span class="n">dr_par_test</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2159, __pyx_L1_error)</span>}
  __pyx_v_dr_par_test = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2160</span>:         <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2160, __pyx_L1_error)</span>}
  __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2161</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2162</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par_test</span></pre>
<pre class='cython code score-16 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2162, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2162, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2162, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2162, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2162, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_4 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par_test));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2163</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par</span></pre>
<pre class='cython code score-16 '>
    /* "chromo/polymers.pyx":2163
 *         for i in range(3):
 *             self.dr_perp_test[i] = self.dr_test[i] - t3_0[i] * dr_par_test
 *             self.dr_perp[i] = self.dr[i] - t3_0[i] * dr_par             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             self.bend_test[i] = (
 *                 test_t3_1[i] - t3_0[i] - self.dr_perp_test[i] *
 */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2163, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2163, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2163, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2163, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2163, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_2 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2164</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2164, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2164, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_test_t3_1.data + __pyx_t_2 * __pyx_v_test_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_4 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_6 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) )))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2165</span>:                 <span class="n">test_t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_test_t3_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_test_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2165, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2165, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2165, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2165, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2166</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2166, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2166, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2167</span>:             <span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2168</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2168, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2168, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_6 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_5 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) )))));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2169</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>    __pyx_t_6 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
    }
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2169, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2170</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2171</span>:         <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2172</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">,</span> <span class="n">dr_par_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">,</span> <span class="n">omega_test</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2172, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2172, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2173</span>:         <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;E_pair_with_twist(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test, __pyx_v_dr_par_test, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test, __pyx_v_omega_test, __pyx_v_bond_ind) - ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;E_pair_with_twist(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.__pyx_base.bend, __pyx_v_dr_par, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp, __pyx_v_omega, __pyx_v_bond_ind));
  goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2174</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2174, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0">&#xA0;<span class="">2175</span>:         <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2176</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2177</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">bead_pair_dE_poly_reverse_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_6SSTWLC_bead_pair_dE_poly_reverse_with_twist(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, __Pyx_memviewslice __pyx_v_r_0, __Pyx_memviewslice __pyx_v_test_r_0, __Pyx_memviewslice __pyx_v_r_1, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_test_t3_0, __Pyx_memviewslice __pyx_v_t3_1, __Pyx_memviewslice __pyx_v_t2_0, __Pyx_memviewslice __pyx_v_test_t2_0, __Pyx_memviewslice __pyx_v_t2_1, long __pyx_v_bond_ind) {
  long __pyx_v_i;
  double __pyx_v_omega;
  double __pyx_v_omega_test;
  double __pyx_v_dr_par;
  double __pyx_v_dr_par_test;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("bead_pair_dE_poly_reverse_with_twist", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.bead_pair_dE_poly_reverse_with_twist", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2178</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2179</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2180</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_r_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2181</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">r_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2182</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2183</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t3_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2184</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2185</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2186</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">test_t2_0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2187</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2188</span>:         <span class="nb">long</span> <span class="n">bond_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2189</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2190</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy when affecting a single bead pair.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2192</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2193</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2194</span>: <span class="sd">        See documentation for `SSWLC.bead_pair_dE_poly_reverse()` class for </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2195</span>: <span class="sd">        more details.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2196</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2197</span>: <span class="sd">        TODO: Check sign of cross product (t2 x t3 OR t3 x t2). Store t1 </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2198</span>: <span class="sd">        arrays so they don&#39;t need to be recreated every time. Manually </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2199</span>: <span class="sd">        implement dot products to speed up computation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2201</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2202</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2203</span>: <span class="sd">        r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2204</span>: <span class="sd">            Position vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2205</span>: <span class="sd">        test_r_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2206</span>: <span class="sd">            Position vector of first bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2207</span>: <span class="sd">        r_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2208</span>: <span class="sd">            Position vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2209</span>: <span class="sd">        t3_0, t2_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2210</span>: <span class="sd">            t3, t2 tangent vector of first bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2211</span>: <span class="sd">        test_t3_0, test_t2_0 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2212</span>: <span class="sd">            t3, t2 tangent vector of first bead in bend (TRIAL MOVE)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2213</span>: <span class="sd">        t3_1, t2_1 : array_like (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2214</span>: <span class="sd">            t3, t2 tangent vector of second bead in bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2215</span>: <span class="sd">        bond_ind : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2216</span>: <span class="sd">            Index of the bond between the two beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2218</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2219</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2220</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2221</span>: <span class="sd">            Change in polymer energy for move of a single bead pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2222</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2223</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2224</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">omega</span><span class="p">,</span> <span class="nf">omega_test</span><span class="p">,</span> <span class="nf">dr_par</span><span class="p">,</span> <span class="nf">dr_par_test</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2225</span>:         <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2_0</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_t2_1, __pyx_v_t3_1, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2226</span>:         <span class="n">omega_test</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_v_omega_test = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_test_t2_0, __pyx_v_test_t3_0, __pyx_v_t2_1, __pyx_v_t3_1, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">2227</span>:             <span class="n">test_t2_0</span><span class="p">,</span> <span class="n">test_t3_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">,</span> <span class="n">t3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2228</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2229</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2230</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">-</span> <span class="n">test_r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2230, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_r_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2230, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2230, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2230, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_2 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_test_r_0.data + __pyx_t_4 * __pyx_v_test_r_0.strides[0]) ))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2231</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_r_1.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_r_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2231, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_r_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_r_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2231, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2231, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2231, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_r_1.data + __pyx_t_4 * __pyx_v_r_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_r_0.data + __pyx_t_2 * __pyx_v_r_0.strides[0]) ))));
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2232</span>:         <span class="n">dr_par_test</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">test_t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2232, __pyx_L1_error)</span>}
  __pyx_v_dr_par_test = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_test_t3_0, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2233</span>:         <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2233, __pyx_L1_error)</span>}
  __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2234</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2235</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par_test</span></pre>
<pre class='cython code score-16 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2235, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2235, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2235, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2235, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2235, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_test.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_test_t3_0.data + __pyx_t_4 * __pyx_v_test_t3_0.strides[0]) ))) * __pyx_v_dr_par_test));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2236</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_par</span></pre>
<pre class='cython code score-16 '>
    /* "chromo/polymers.pyx":2236
 *         for i in range(3):
 *             self.dr_perp_test[i] = self.dr_test[i] - test_t3_0[i] * dr_par_test
 *             self.dr_perp[i] = self.dr[i] - t3_0[i] * dr_par             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             self.bend_test[i] = (
 *                 t3_1[i] - test_t3_0[i] - self.dr_perp_test[i] *
 */
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2236, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.strides[0]) )) = ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr.strides[0]) ))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_2 * __pyx_v_t3_0.strides[0]) ))) * __pyx_v_dr_par));
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2237</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2237, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_2 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_test_t3_0.data + __pyx_t_4 * __pyx_v_test_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.data + __pyx_t_5 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_6 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) )))));
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2238</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class='cython code score-11 '>    __pyx_t_2 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2238, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_test_t3_0.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_test_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2238, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2238, __pyx_L1_error)</span>}
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2238, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2239</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2239, __pyx_L1_error)</span>}
    __pyx_t_6 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2239, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2240</span>:             <span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2241</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2241, __pyx_L1_error)</span>}
    __pyx_t_7 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_7 &lt; 0) {
      __pyx_t_7 += __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.shape[0];
      if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2241, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.data + __pyx_t_7 * __pyx_v_self-&gt;__pyx_base.__pyx_base.bend.strides[0]) )) = (((*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_6 * __pyx_v_t3_1.strides[0]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_5 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.data + __pyx_t_4 * __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_2 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) )))));
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2242</span>:                 <span class="n">t3_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t3_0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">bond_ind</span><span class="p">]</span></pre>
<pre class='cython code score-18 '>    __pyx_t_6 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_6 &lt; 0) {
      __pyx_t_6 += __pyx_v_t3_1.shape[0];
      if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
    }
    __pyx_t_5 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_5 &lt; 0) {
      __pyx_t_5 += __pyx_v_t3_0.shape[0];
      if (unlikely(__pyx_t_5 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_5 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>}
    __pyx_t_4 = __pyx_v_i;
    __pyx_t_3 = -1;
    if (__pyx_t_4 &lt; 0) {
      __pyx_t_4 += __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0];
      if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>}
    __pyx_t_2 = __pyx_v_bond_ind;
    __pyx_t_3 = -1;
    if (__pyx_t_2 &lt; 0) {
      __pyx_t_2 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
      if (unlikely(__pyx_t_2 &lt; 0)) __pyx_t_3 = 0;
    } else if (unlikely(__pyx_t_2 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_3 = 0;
    if (unlikely(__pyx_t_3 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_3);
      <span class='error_goto'>__PYX_ERR(0, 2242, __pyx_L1_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2243</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2244</span>:         <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2245</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend_test</span><span class="p">,</span> <span class="n">dr_par_test</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp_test</span><span class="p">,</span> <span class="n">omega_test</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2245, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2245, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2246</span>:         <span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;E_pair_with_twist(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.__pyx_base.bend_test, __pyx_v_dr_par_test, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp_test, __pyx_v_omega_test, __pyx_v_bond_ind) - ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;E_pair_with_twist(__pyx_v_self, __pyx_v_self-&gt;__pyx_base.__pyx_base.bend, __pyx_v_dr_par, __pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp, __pyx_v_omega, __pyx_v_bond_ind));
  goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2247</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">bond_ind</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.bend.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L1_error)</span>}
  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.dr_perp.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L1_error)</span>}
</pre><pre class="cython line score-0">&#xA0;<span class="">2248</span>:         <span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2249</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2250</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_E</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_5compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_6SSTWLC_compute_E(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_m1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_omega;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2250, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_6SSTWLC_5compute_E)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2250, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2250, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_1, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_5compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_6SSTWLC_4compute_E[] = "Compute the overall polymer energy at the current configuration.\n        \n        Notes\n        -----\n        This method loops over each bond in the polymer and calculates the \n        energy change of that bond.\n\n        Returns\n        -------\n        double\n            Configurational energy of the polymer.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_5compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_6SSTWLC_4compute_E(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_6SSTWLC_4compute_E(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_6SSTWLC_compute_E(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2251</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2252</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2253</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2254</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2255</span>: <span class="sd">        This method loops over each bond in the polymer and calculates the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2256</span>: <span class="sd">        energy change of that bond.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2257</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2258</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2259</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2260</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2261</span>: <span class="sd">            Configurational energy of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2262</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2263</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2264</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_m1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2265</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2266</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">,</span> <span class="n">t2_0</span><span class="p">,</span> <span class="n">t2_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2267</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2268</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2269</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.num_beads;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2270</span>:             <span class="n">i_m1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_m1 = (__pyx_v_i - 1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2271</span>:             <span class="n">r_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2271, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2271, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
    __pyx_v_r_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2272</span>:             <span class="n">r_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
    __pyx_v_r_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2273</span>:             <span class="n">t3_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2273, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2273, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
    __pyx_v_t3_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2274</span>:             <span class="n">t3_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2274, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
    __pyx_v_t3_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2275</span>:             <span class="n">t2_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2275, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2275, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_0, 1);
    __pyx_v_t2_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2276</span>:             <span class="n">t2_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2276, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2276, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_1, 1);
    __pyx_v_t2_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2277</span>:             <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2_0</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_t2_1, __pyx_v_t3_1, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2278</span>:             <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span> <span class="n">r_0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_r_1, __pyx_v_r_0);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 2278, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2279</span>:             <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2280</span>:             <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_v_t3_0, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
    __pyx_t_11 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 2280, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2281</span>:             <span class="n">bend</span> <span class="o">=</span> <span class="n">t3_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_v_t3_1);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2281, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2282</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2283</span>:                 <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_t3_0.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2283, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2283, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i_m1;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2283, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2283, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_bend.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2283, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_17 * __pyx_v_bend.strides[0]) )) += ((-(*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_13 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_16 * __pyx_v_dr_perp.strides[0]) )))));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2284</span>:             <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">i_m1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;E_pair_with_twist(__pyx_v_self, __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_omega, __pyx_v_i_m1));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2285</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2286</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2287</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_E_no_twist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_7compute_E_no_twist(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_6SSTWLC_compute_E_no_twist(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_m1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_no_twist", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E_no_twist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2287, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_6SSTWLC_7compute_E_no_twist)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2287, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2287, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_11, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.SSTWLC.compute_E_no_twist", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_7compute_E_no_twist(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_6SSTWLC_6compute_E_no_twist[] = "Compute the overall polymer energy at the current configuration.\n        \n        Notes\n        -----\n        This method loops over each bond in the polymer and calculates the \n        energy change of that bond.\n\n        Returns\n        -------\n        double\n            Configurational energy of the polymer.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_6SSTWLC_7compute_E_no_twist(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_no_twist (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_6SSTWLC_6compute_E_no_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_6SSTWLC_6compute_E_no_twist(struct __pyx_obj_6chromo_8polymers_SSTWLC *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_no_twist", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_6SSTWLC_compute_E_no_twist(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.SSTWLC.compute_E_no_twist", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2288</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2289</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2290</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2291</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2292</span>: <span class="sd">        This method loops over each bond in the polymer and calculates the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2293</span>: <span class="sd">        energy change of that bond.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2295</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2296</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2297</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2298</span>: <span class="sd">            Configurational energy of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2299</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2300</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2301</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_m1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2302</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2303</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2304</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2305</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2306</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.num_beads;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2307</span>:             <span class="n">i_m1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_m1 = (__pyx_v_i - 1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2308</span>:             <span class="n">r_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2308, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2308, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_0, 1);
    __pyx_v_r_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2309</span>:             <span class="n">r_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_1, 1);
    __pyx_v_r_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2310</span>:             <span class="n">t3_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
    __pyx_v_t3_0 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2311</span>:             <span class="n">t3_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-10 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2311, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2311, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
    __pyx_v_t3_1 = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2312</span>:             <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">r_1</span><span class="p">,</span> <span class="n">r_0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_r_1, __pyx_v_r_0);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 2312, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_10;
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2313</span>:             <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_v_t3_0, __pyx_v_dr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2314</span>:             <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_v_t3_0, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 2314, __pyx_L1_error)</span>
    __pyx_t_11 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 2314, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_11;
    __pyx_t_11.memview = NULL;
    __pyx_t_11.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2315</span>:             <span class="n">bend</span> <span class="o">=</span> <span class="n">t3_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_memoryview_copy_slice_dc_double_c(__pyx_v_t3_1);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 2315, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_9;
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2316</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_12 = 0; __pyx_t_12 &lt; 3; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2317</span>:                 <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_t3_0.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i_m1;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.eta.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.eta.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>
      }
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>
      }
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_bend.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_17 * __pyx_v_bend.strides[0]) )) += ((-(*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_13 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.eta.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_16 * __pyx_v_dr_perp.strides[0]) )))));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2318</span>:             <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">i_m1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.E_pair(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_i_m1));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2319</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2321</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2322</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">LoopedSSTWLC</span><span class="p">(</span><span class="n">SSTWLC</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_LoopedSSTWLC {
  struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_8polymers_LoopedSSTWLC *__pyx_vtabptr_6chromo_8polymers_LoopedSSTWLC;

</pre><pre class="cython line score-0">&#xA0;<span class="">2323</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of a looped SSTWLC.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2324</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2325</span>: </pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2326</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-101 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_12LoopedSSTWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_12LoopedSSTWLC___init__[] = "Construct a looped SSTWLC object as a subclass of `SSTWLC`.\n\n        Notes\n        -----\n        See documentation for `SSTWLC` class for description of parameters.\n\n        TODO: Change the default values of lt, lp to ones that makes more sense\n\n        TODO: Implement variable linker lengths in this class!\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_12LoopedSSTWLC___init__;
#endif
static int __pyx_pw_6chromo_8polymers_12LoopedSSTWLC_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_bead_length;
  double __pyx_v_lp;
  double __pyx_v_lt;
  double __pyx_v_bead_rad;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_lt,&amp;__pyx_n_s_bead_rad,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[9] = (PyObject *)__pyx_k__61;
    values[11] = (PyObject *)__pyx_k__62;
    values[12] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 11)) {
        Py_ssize_t index;
        for (index = 3; index &lt; 14 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 2328, __pyx_L3_error)</span>
    __pyx_v_bead_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bead_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2328, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2328, __pyx_L3_error)</span>
    } else {
      __pyx_v_lp = ((double)53.0);
    }
    if (values[4]) {
      __pyx_v_lt = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_lt == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L3_error)</span>
    } else {
      __pyx_v_lt = ((double)46.37);
    }
    if (values[5]) {
      __pyx_v_bead_rad = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_bead_rad == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L3_error)</span>
    } else {
      __pyx_v_bead_rad = ((double)5.0);
    }
    if (values[6]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 2329, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__63;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[7]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 2330, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__64;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[8]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 2330, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__65;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 2331, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__66;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[11]);
    __pyx_v_log_path = ((PyObject*)values[12]);
    if (values[13]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[13]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2333, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.LoopedSSTWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2328, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_12LoopedSSTWLC___init__(((struct __pyx_obj_6chromo_8polymers_LoopedSSTWLC *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_lt, __pyx_v_bead_rad, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_12LoopedSSTWLC___init__(struct __pyx_obj_6chromo_8polymers_LoopedSSTWLC *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, double __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_lt, double __pyx_v_bead_rad, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.LoopedSSTWLC.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2327</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2328</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">double</span> <span class="n">bead_length</span><span class="p">,</span> <span class="n">double</span> <span class="n">lp</span><span class="o">=</span><span class="mf">53</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2329</span>:         <span class="n">double</span> <span class="n">lt</span><span class="o">=</span><span class="mf">46.37</span><span class="p">,</span> <span class="n">double</span> <span class="n">bead_rad</span><span class="o">=</span><span class="mf">5</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span><span class="o">=</span><span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2329, __pyx_L1_error)</span>
  __pyx_k__63 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2330</span>:         <span class="n">double</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span><span class="o">=</span><span class="n">empty_2d</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span><span class="o">=</span><span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-4 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2330, __pyx_L1_error)</span>
  __pyx_k__64 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2330, __pyx_L1_error)</span>
  __pyx_k__65 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2331</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">empty_1d</span><span class="p">,</span> <span class="nb">long</span><span class="p">[:,::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__61 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2331, __pyx_L1_error)</span>
  __pyx_k__66 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2332</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">empty_1d</span><span class="p">,</span> <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__62 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-0">&#xA0;<span class="">2333</span>:         <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2334</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2335</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a looped SSTWLC object as a subclass of `SSTWLC`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2337</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2338</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2339</span>: <span class="sd">        See documentation for `SSTWLC` class for description of parameters.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2340</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2341</span>: <span class="sd">        TODO: Change the default values of lt, lp to ones that makes more sense</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2343</span>: <span class="sd">        TODO: Implement variable linker lengths in this class!</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2344</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2345</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">LoopedSSTWLC</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_LoopedSSTWLC));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_LoopedSSTWLC));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_LoopedSSTWLC));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2345, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2346</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="n">lt</span><span class="p">,</span> <span class="n">bead_rad</span><span class="o">=</span><span class="n">bead_rad</span><span class="p">,</span></pre>
<pre class='cython code score-46 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lt, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_rad, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2347</span>:             <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span></pre>
<pre class='cython code score-23 '>  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2348</span>:             <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2349</span>:             <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span> <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-13 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2350</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2351</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2352</span>:     <span class="nd">@classmethod</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Method_ClassMethod</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6chromo_8polymers_LoopedSSTWLC-&gt;tp_dict, __pyx_n_s_looped_confined_gaussian_walk, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6chromo_8polymers_LoopedSSTWLC);
</pre><pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2353</span>:     <span class="k">def</span> <span class="nf">looped_confined_gaussian_walk</span><span class="p">(</span></pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_12LoopedSSTWLC_3looped_confined_gaussian_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_12LoopedSSTWLC_2looped_confined_gaussian_walk[] = "Initialize a polymer to a looped, confined Gaussian random walk.\n\n        Parameters\n        ----------\n        name : str\n            Name of the polymer\n        num_beads : int\n            Number of monomer units on the polymer\n        bead_length : float\n            The amount of polymer path length between this bead and the next\n            bead. For now, a constant value is assumed (the first value if an\n            array is passed).\n        confine_type : str\n            Name of the confining boundary. To indicate model w/o confinement,\n            enter a blank string for this argument\n        confine_length : double\n            The lengthscale associated with the confining boundary. Length\n            representation specified in function associated w/ `confine_type`\n\n        Returns\n        -------\n        SSTWLC\n            Object representing a SSTWLC initialized as a confined, looped\n            Gaussian random walk\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_12LoopedSSTWLC_3looped_confined_gaussian_walk(PyObject *__pyx_v_cls, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_num_beads = 0;
  double __pyx_v_bead_length;
  PyObject *__pyx_v_confine_type = 0;
  double __pyx_v_confine_length;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("looped_confined_gaussian_walk (wrapper)", 0);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_num_beads,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_confine_type,&amp;__pyx_n_s_confine_length,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_num_beads)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("looped_confined_gaussian_walk", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("looped_confined_gaussian_walk", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_type)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("looped_confined_gaussian_walk", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_confine_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("looped_confined_gaussian_walk", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, __pyx_v_kwargs, values, pos_args, "looped_confined_gaussian_walk") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_num_beads = values[1];
    __pyx_v_bead_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bead_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2357, __pyx_L3_error)</span>
    __pyx_v_confine_type = ((PyObject*)values[3]);
    __pyx_v_confine_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_confine_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2359, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("looped_confined_gaussian_walk", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2353, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.LoopedSSTWLC.looped_confined_gaussian_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2355, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_confine_type), (&amp;PyString_Type), 1, "confine_type", 1))) <span class='error_goto'>__PYX_ERR(0, 2358, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_12LoopedSSTWLC_2looped_confined_gaussian_walk(((PyTypeObject*)__pyx_v_cls), __pyx_v_name, __pyx_v_num_beads, __pyx_v_bead_length, __pyx_v_confine_type, __pyx_v_confine_length, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_12LoopedSSTWLC_2looped_confined_gaussian_walk(PyTypeObject *__pyx_v_cls, PyObject *__pyx_v_name, PyObject *__pyx_v_num_beads, double __pyx_v_bead_length, PyObject *__pyx_v_confine_type, double __pyx_v_confine_length, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_v_t3 = NULL;
  PyObject *__pyx_v_t2 = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("looped_confined_gaussian_walk", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.LoopedSSTWLC.looped_confined_gaussian_walk", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='pyx_c_api'>__Pyx_GetNameInClass</span>(__pyx_t_3, (PyObject *)__pyx_ptype_6chromo_8polymers_LoopedSSTWLC, __pyx_n_s_looped_confined_gaussian_walk);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">2354</span>:         <span class="n">cls</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2355</span>:         <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2356</span>:         <span class="n">num_beads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2357</span>:         <span class="n">bead_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2358</span>:         <span class="n">confine_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2359</span>:         <span class="n">confine_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2360</span>:         <span class="o">**</span><span class="n">kwargs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2361</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2362</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a polymer to a looped, confined Gaussian random walk.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2363</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2364</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2365</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2366</span>: <span class="sd">        name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2367</span>: <span class="sd">            Name of the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2368</span>: <span class="sd">        num_beads : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2369</span>: <span class="sd">            Number of monomer units on the polymer</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2370</span>: <span class="sd">        bead_length : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2371</span>: <span class="sd">            The amount of polymer path length between this bead and the next</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2372</span>: <span class="sd">            bead. For now, a constant value is assumed (the first value if an</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2373</span>: <span class="sd">            array is passed).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2374</span>: <span class="sd">        confine_type : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2375</span>: <span class="sd">            Name of the confining boundary. To indicate model w/o confinement,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2376</span>: <span class="sd">            enter a blank string for this argument</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2377</span>: <span class="sd">        confine_length : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2378</span>: <span class="sd">            The lengthscale associated with the confining boundary. Length</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2379</span>: <span class="sd">            representation specified in function associated w/ `confine_type`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2381</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2382</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2383</span>: <span class="sd">        SSTWLC</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2384</span>: <span class="sd">            Object representing a SSTWLC initialized as a confined, looped</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2385</span>: <span class="sd">            Gaussian random walk</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2386</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2387</span>:         <span class="n">r</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">looped_confined_gaussian_walk</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_looped_confined_gaussian_walk);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2388</span>:             <span class="n">num_beads</span><span class="p">,</span> <span class="n">bead_length</span><span class="p">,</span> <span class="n">confine_type</span><span class="p">,</span> <span class="n">confine_length</span></pre>
<pre class='cython code score-53 '>  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_confine_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_confine_type, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_v_num_beads, __pyx_t_2, __pyx_v_confine_type, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_num_beads);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_num_beads);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_confine_type);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_confine_type);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_t_4);
    __pyx_t_2 = 0;
    __pyx_t_4 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2389</span>:         <span class="p">)</span></pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2390</span>:         <span class="n">t3</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">paths</span><span class="o">.</span><span class="n">estimate_tangents_from_coordinates</span><span class="p">(</span><span class="n">r</span><span class="p">)</span></pre>
<pre class='cython code score-63 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_paths);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_estimate_tangents_from_coordinat);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_r) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_v_r);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2390, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 2390, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_8 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_7 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_7)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    index = 1; __pyx_t_3 = __pyx_t_8(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2390, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 2390, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  __pyx_v_t3 = __pyx_t_7;
  __pyx_t_7 = 0;
  __pyx_v_t2 = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2391</span>:         <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_r);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_r);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t3, __pyx_v_t3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2391, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_t2, __pyx_v_t2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2391, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bead_length);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2391, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_t_7;
  __pyx_t_7 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_3, __pyx_v_kwargs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2391, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_v_cls), __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2391, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2392</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2393</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>static void __pyx_f_6chromo_8polymers_12LoopedSSTWLC_construct_beads(struct __pyx_obj_6chromo_8polymers_LoopedSSTWLC *__pyx_v_self) {
  Py_ssize_t __pyx_8genexpr5__pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.LoopedSSTWLC.construct_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2394</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Nucleosome objects forming beads of our polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2395</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2396</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-6 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads);
  __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2397</span>:             <span class="n">i</span><span class="p">:</span> <span class="n">beads</span><span class="o">.</span><span class="n">Nucleosome</span><span class="p">(</span></pre>
<pre class='cython code score-21 '>      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr5__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_beads);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_Nucleosome);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_t_5, (PyObject*)__pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 2397, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  } /* exit inner scope */
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2398</span>:                 <span class="n">id_</span><span class="o">=</span><span class="n">i</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr5__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_id, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2399</span>:                 <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2399, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr5__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2399, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2399, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_r, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2400</span>:                 <span class="n">t3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2400, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr5__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2400, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2400, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2401</span>:                 <span class="n">t2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2401, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr5__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2401, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2402</span>:                 <span class="n">rad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2402, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_rad, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2403</span>:                 <span class="n">states</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2403, __pyx_L1_error)</span>}
      __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.data;
      __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr5__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2403, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2403, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_states, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2404</span>:                 <span class="n">binder_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span></pre>
<pre class='cython code score-5 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2398, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2405</span>:             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2405, __pyx_L1_error)</span>}
    __pyx_t_2 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0]);
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_8genexpr5__pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">2406</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2407</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2408</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">continuous_dE_poly</span><span class="p">(</span></pre>
<pre class='cython code score-2 '>static double __pyx_f_6chromo_8polymers_12LoopedSSTWLC_continuous_dE_poly(struct __pyx_obj_6chromo_8polymers_LoopedSSTWLC *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  long __pyx_v_ind0_m_1;
  long __pyx_v_indf_m_1;
  double __pyx_v_delta_energy_poly;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("continuous_dE_poly", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.LoopedSSTWLC.continuous_dE_poly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2409</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2410</span>:         <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2411</span>:         <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2412</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2413</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy for a continuous bead region.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2414</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2415</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2416</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2417</span>: <span class="sd">        See documentation for this method in `SSWLC` class for details and </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2418</span>: <span class="sd">        parameter/return descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2419</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2420</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0_m_1</span><span class="p">,</span> <span class="nf">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2421</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2423</span>:         <span class="c"># Elastic energy change from LHS of the move</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2424</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2425</span>:         <span class="k">if</span> <span class="n">ind0</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ind0 != 0) != 0);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2426</span>:             <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ind0_m_1 = (__pyx_v_ind0 - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">2427</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2428</span>:             <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_ind0_m_1 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2429</span>:         <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_forward</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_LoopedSSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.bead_pair_dE_poly_forward(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_t_2, __pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_v_ind0_m_1));
/* … */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2430</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L1_error)</span>}
  __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
  __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2431</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2431, __pyx_L1_error)</span>}
/* … */
  __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
  __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2431, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2432</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L1_error)</span>}
/* … */
  __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.data;
  __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2433</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
  __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2433, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2434</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>}
/* … */
  __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
  __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2434, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2435</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L1_error)</span>}
/* … */
  __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
  __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2435, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">2436</span>:             <span class="n">ind0_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2437</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2438</span>:         <span class="c"># Elastic energy change from RHS of the move</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2439</span>:         <span class="n">indf_m_1</span> <span class="o">=</span> <span class="n">indf</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indf_m_1 = (__pyx_v_indf - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2440</span>:         <span class="k">if</span> <span class="n">indf</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_indf == __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.num_beads) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2441</span>:             <span class="n">indf</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_indf = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2442</span>:         <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_reverse</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>__pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_LoopedSSTWLC *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.bead_pair_dE_poly_reverse(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_t_7, __pyx_t_6, __pyx_t_5, __pyx_t_4, __pyx_t_3, __pyx_t_2, __pyx_v_indf_m_1));
/* … */
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  __pyx_t_4.memview = NULL;
  __pyx_t_4.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2443</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>  if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2443, __pyx_L1_error)</span>}
  __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
  __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2443, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2444</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2444, __pyx_L1_error)</span>}
/* … */
  __pyx_t_6.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.data;
  __pyx_t_6.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_6, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2444, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_6.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2445</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2445, __pyx_L1_error)</span>}
/* … */
  __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
  __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2445, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2446</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2446, __pyx_L1_error)</span>}
/* … */
  __pyx_t_4.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
  __pyx_t_4.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_4, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2446, __pyx_L1_error)</span>
        }
        __pyx_t_4.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_4.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_4.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_4.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2447</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2447, __pyx_L1_error)</span>}
/* … */
  __pyx_t_3.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
  __pyx_t_3.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2447, __pyx_L1_error)</span>
        }
        __pyx_t_3.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_3.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_3.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_3.suboffsets[0] = -1;

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2448</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-10 '>if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2448, __pyx_L1_error)</span>}
/* … */
  __pyx_t_2.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
  __pyx_t_2.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
  __PYX_INC_MEMVIEW(&amp;__pyx_t_2, 0);
  {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2448, __pyx_L1_error)</span>
        }
        __pyx_t_2.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_2.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_2.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_2.suboffsets[0] = -1;

</pre><pre class="cython line score-0">&#xA0;<span class="">2449</span>:             <span class="n">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2450</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2451</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2452</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2453</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2454</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2455</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">DetailedChromatin</span><span class="p">(</span><span class="n">SSTWLC</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin {
  struct __pyx_vtabstruct_6chromo_8polymers_SSTWLC __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin *__pyx_vtabptr_6chromo_8polymers_DetailedChromatin;

</pre><pre class="cython line score-0">&#xA0;<span class="">2456</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representation of a chromatin fiber with detailed nucleosomes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2457</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2458</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-105 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_17DetailedChromatin_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_17DetailedChromatin___init__[] = "Construct a detailed chromatin object as a subclass of `SSTWLC`.\n\n        Notes\n        -----\n        See documentation for `SSTWLC` class for description of common\n        parameters.\n\n        Parameters\n        ----------\n        bp_wrap : double\n            Number of base pairs wrapped around each nucleosome\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_17DetailedChromatin___init__;
#endif
static int __pyx_pw_6chromo_8polymers_17DetailedChromatin_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_bp_wrap;
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  double __pyx_v_lt;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bp_wrap,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_lt,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[9] = (PyObject *)__pyx_k__67;
    values[11] = (PyObject *)__pyx_k__68;
    values[12] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bp_wrap)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
        }
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
        }
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
        }
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lt); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 8)) {
        Py_ssize_t index;
        for (index = 6; index &lt; 14 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 2461, __pyx_L3_error)</span>
    __pyx_v_bp_wrap = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bp_wrap == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2463, __pyx_L3_error)</span>
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 2464, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2465, __pyx_L3_error)</span>
    __pyx_v_lt = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_lt == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2466, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 2467, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__69;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[7]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 2468, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__70;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[8]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 2469, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__71;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 2471, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__72;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[11]);
    __pyx_v_log_path = ((PyObject*)values[12]);
    if (values[13]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[13]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2473, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2458, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatin.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2460, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2470, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2472, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 2473, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_17DetailedChromatin___init__(((struct __pyx_obj_6chromo_8polymers_DetailedChromatin *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bp_wrap, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_lt, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_17DetailedChromatin___init__(struct __pyx_obj_6chromo_8polymers_DetailedChromatin *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, double __pyx_v_bp_wrap, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_lt, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatin.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2459</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2460</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2461</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2462</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2463</span>:         <span class="n">double</span> <span class="n">bp_wrap</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2464</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2465</span>:         <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2466</span>:         <span class="n">double</span> <span class="n">lt</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2467</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2467, __pyx_L1_error)</span>
  __pyx_k__69 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2468</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2468, __pyx_L1_error)</span>
  __pyx_k__70 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2469</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2469, __pyx_L1_error)</span>
  __pyx_k__71 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2470</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__67 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2471</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2471, __pyx_L1_error)</span>
  __pyx_k__72 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2472</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__68 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">2473</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2474</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2475</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a detailed chromatin object as a subclass of `SSTWLC`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2476</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2477</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2478</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2479</span>: <span class="sd">        See documentation for `SSTWLC` class for description of common</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2480</span>: <span class="sd">        parameters.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2482</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2483</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2484</span>: <span class="sd">        bp_wrap : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2485</span>: <span class="sd">            Number of base pairs wrapped around each nucleosome</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2486</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2487</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bp_wrap</span> <span class="o">=</span> <span class="n">bp_wrap</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;bp_wrap = __pyx_v_bp_wrap;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2488</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span> <span class="o">=</span> <span class="n">consts_dict</span><span class="p">[</span><span class="s">&quot;R&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_consts_dict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_t_1, __pyx_n_s_R);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2488, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2488, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_self-&gt;__pyx_base.__pyx_base.bead_rad = __pyx_t_3;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2489</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">DetailedChromatin</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  __pyx_t_1 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2490</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span> <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="n">lt</span><span class="p">,</span></pre>
<pre class='cython code score-30 '>  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_bead_length, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_lp, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lt);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_lt, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2491</span>:             <span class="n">bead_rad</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bead_rad</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span></pre>
<pre class='cython code score-29 '>  __pyx_t_5 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.bead_rad);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_bead_rad, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_t3, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_t2, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_states, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2492</span>:             <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2493</span>:             <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span> <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2493, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_chemical_mods, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2494</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_max_binders, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2495</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2496</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">construct_beads</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.construct_beads(((struct __pyx_obj_6chromo_8polymers_PolymerBase *)__pyx_v_self));
</pre><pre class="cython line score-0">&#xA0;<span class="">2497</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2498</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">construct_beads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-7 '>static void __pyx_f_6chromo_8polymers_17DetailedChromatin_construct_beads(struct __pyx_obj_6chromo_8polymers_DetailedChromatin *__pyx_v_self) {
  Py_ssize_t __pyx_8genexpr6__pyx_v_i;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("construct_beads", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatin.construct_beads", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2499</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct Nucleosome objects forming beads of our polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2500</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2501</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">beads</span> <span class="o">=</span> <span class="p">{</span></pre>
<pre class='cython code score-6 '>  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads);
  __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2502</span>:             <span class="n">i</span><span class="p">:</span> <span class="n">beads</span><span class="o">.</span><span class="n">DetailedNucleosome</span><span class="p">(</span></pre>
<pre class='cython code score-21 '>      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr6__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2502, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_beads);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2502, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_DetailedNucleosome);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2502, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2502, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_t_5, (PyObject*)__pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 2502, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
  } /* exit inner scope */
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2503</span>:                 <span class="n">id_</span><span class="o">=</span><span class="n">i</span><span class="p">,</span></pre>
<pre class='cython code score-13 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_8genexpr6__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_id, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2504</span>:                 <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr6__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2504, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_r, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2505</span>:                 <span class="n">t3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2505, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr6__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2505, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2505, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t3, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2506</span>:                 <span class="n">t2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2506, __pyx_L1_error)</span>}
      __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
      __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr6__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2506, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2506, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
      __pyx_t_9.memview = NULL;
      __pyx_t_9.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_t2, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2507</span>:                 <span class="n">bp_wrap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bp_wrap</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>      __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_self-&gt;bp_wrap);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2507, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_bp_wrap, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2508</span>:                 <span class="n">states</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">],</span></pre>
<pre class='cython code score-16 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2508, __pyx_L1_error)</span>}
      __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.data;
      __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.memview;
      __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
      {
    Py_ssize_t __pyx_tmp_idx = __pyx_8genexpr6__pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2508, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.states.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2508, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
      __pyx_t_10.memview = NULL;
      __pyx_t_10.data = NULL;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_states, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2509</span>:                 <span class="n">binder_names</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binder_names</span></pre>
<pre class='cython code score-5 '>      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2503, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2510</span>:             <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-5 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2510, __pyx_L1_error)</span>}
    __pyx_t_2 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0]);
    __pyx_t_3 = __pyx_t_2;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_8genexpr6__pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">2511</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2512</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2513</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">continuous_dE_poly</span><span class="p">(</span></pre>
<pre class='cython code score-34 '>static double __pyx_f_6chromo_8polymers_17DetailedChromatin_continuous_dE_poly(struct __pyx_obj_6chromo_8polymers_DetailedChromatin *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  long __pyx_v_ind0_m_1;
  long __pyx_v_indf_m_1;
  double __pyx_v_delta_energy_poly;
  CYTHON_UNUSED PyObject *__pyx_v_ri_0 = NULL;
  PyObject *__pyx_v_ro_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0 = NULL;
  PyObject *__pyx_v_t3o_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0 = NULL;
  PyObject *__pyx_v_t2o_0 = NULL;
  PyObject *__pyx_v_ri_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ro_1_try = NULL;
  PyObject *__pyx_v_t3i_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1_try = NULL;
  PyObject *__pyx_v_t2i_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1_try = NULL;
  PyObject *__pyx_v_ri_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ro_1 = NULL;
  PyObject *__pyx_v_t3i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1 = NULL;
  PyObject *__pyx_v_t2i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ri_0_try = NULL;
  PyObject *__pyx_v_ro_0_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0_try = NULL;
  PyObject *__pyx_v_t3o_0_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0_try = NULL;
  PyObject *__pyx_v_t2o_0_try = NULL;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("continuous_dE_poly", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatin.continuous_dE_poly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0_try);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2514</span>:             <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2515</span>:             <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2516</span>:             <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2517</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2518</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy for a continuous bead region.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2520</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2521</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2522</span>: <span class="sd">        See documentation for `SSWLC.continuous_dE_poly()` class for details </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2523</span>: <span class="sd">        and parameter/return descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2524</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2525</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0_m_1</span><span class="p">,</span> <span class="nf">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2526</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2527</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2528</span>:         <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind0_m_1 = (__pyx_v_ind0 - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2529</span>:         <span class="n">indf_m_1</span> <span class="o">=</span> <span class="n">indf</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indf_m_1 = (__pyx_v_indf - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">2530</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2531</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2532</span>:         <span class="k">if</span> <span class="n">ind0</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ind0 != 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2533</span>:             <span class="c"># Compute the entry and exit positions and orientations of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2534</span>:             <span class="c"># linker DNA for the first nucleosome in the continuous region</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2535</span>:             <span class="n">ri_0</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span>  <span class="w">\</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ri_0 = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_ro_0 = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_t3i_0 = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t3o_0 = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_0 = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_t2o_0 = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2536</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2537</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2537, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2537, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2537, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2537, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2537, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2537, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2538</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2538, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2538, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2538, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2539</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2539, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2539, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_10, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2539, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_3, __pyx_t_6, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_3, __pyx_t_6, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (__pyx_t_9) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_11, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_11, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_11, __pyx_t_8);
      __pyx_t_3 = 0;
      __pyx_t_6 = 0;
      __pyx_t_8 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2536, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2535, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_9};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_9};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2535, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L4_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2535, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2535, __pyx_L1_error)</span>
      __pyx_L5_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2540</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2541</span>:             <span class="n">ri_1_try</span><span class="p">,</span> <span class="n">ro_1_try</span><span class="p">,</span> <span class="n">t3i_1_try</span><span class="p">,</span> <span class="n">t3o_1_try</span><span class="p">,</span> <span class="n">t2i_1_try</span><span class="p">,</span> <span class="n">t2o_1_try</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ri_1_try = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_ro_1_try = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t3i_1_try = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_t3o_1_try = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t2i_1_try = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_t2o_1_try = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2542</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2543</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2543, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2543, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2543, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2543, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2543, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_9 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 2543, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2544</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_8 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2545</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2545, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2545, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2545, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_9, __pyx_t_8, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_9, __pyx_t_8, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_11, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_11, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_11, __pyx_t_5);
      __pyx_t_9 = 0;
      __pyx_t_8 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2542, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2541, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_4};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2541, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_4};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2541, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L6_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2541, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L7_unpacking_done;
      __pyx_L6_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2541, __pyx_L1_error)</span>
      __pyx_L7_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2546</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2547</span>:             <span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ri_1 = __pyx_t_9;
    __pyx_t_9 = 0;
    __pyx_v_ro_1 = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t3i_1 = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t3o_1 = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_t2i_1 = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_t2o_1 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2548</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2549</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2549, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2549, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2549, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2549, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2550</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2550, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2550, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2550, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2550, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2550, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2550, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2551</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2551, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2551, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2551, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2551, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2551, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_6 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2551, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_11, __pyx_t_6);
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_6 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2548, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2547, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2547, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_3};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2547, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L8_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2547, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2547, __pyx_L1_error)</span>
      __pyx_L9_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2552</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2554</span>:             <span class="c"># Check progress (can be removed later)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2555</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_0), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2556</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_0), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2557</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2558</span>:             <span class="c">#     np.linalg.norm(ri_0 - np.asarray(self.r[ind0_m_1, :])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2559</span>:             <span class="c">#     np.linalg.norm(ro_0 - np.asarray(self.r[ind0_m_1, :]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2560</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2561</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_1_try), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2562</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_1_try), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2563</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2564</span>:             <span class="c">#     np.linalg.norm(ri_1_try - np.asarray(self.r_trial[ind0, :])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2565</span>:             <span class="c">#     np.linalg.norm(ro_1_try - np.asarray(self.r_trial[ind0, :]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2566</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2567</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_1), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2568</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_1), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2569</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2570</span>:             <span class="c">#     np.linalg.norm(ri_1 - np.asarray(self.r[ind0, :])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2571</span>:             <span class="c">#     np.linalg.norm(ro_1 - np.asarray(self.r[ind0, :]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2572</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2573</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2574</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_forward_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.bead_pair_dE_poly_forward_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_t_19, __pyx_t_20, __pyx_t_21, __pyx_v_ind0_m_1));
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
    __pyx_t_20.memview = NULL;
    __pyx_t_20.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
    __pyx_t_21.memview = NULL;
    __pyx_t_21.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2575</span>:                 <span class="n">ro_0</span><span class="p">,</span> <span class="n">ri_1</span><span class="p">,</span> <span class="n">ri_1_try</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3i_1_try</span><span class="p">,</span> <span class="n">t2o_0</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span></pre>
<pre class='cython code score-16 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_1_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 2575, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2576</span>:                 <span class="n">t2i_1_try</span><span class="p">,</span> <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">ind0_m_1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 2576, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2577</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2578</span>:         <span class="k">if</span> <span class="n">indf</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_indf != __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.num_beads) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2579</span>:             <span class="c"># Compute the entry and exit positions and orientations of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2580</span>:             <span class="c"># linker DNA for the last nucleosome in the continuous region</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2581</span>:             <span class="n">ri_0_try</span><span class="p">,</span> <span class="n">ro_0_try</span><span class="p">,</span> <span class="n">t3i_0_try</span><span class="p">,</span> <span class="n">t3o_0_try</span><span class="p">,</span> <span class="n">t2i_0_try</span><span class="p">,</span> <span class="n">t2o_0_try</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-0 '>    __pyx_v_ri_0_try = __pyx_t_4;
    __pyx_t_4 = 0;
    __pyx_v_ro_0_try = __pyx_t_5;
    __pyx_t_5 = 0;
    __pyx_v_t3i_0_try = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t3o_0_try = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_0_try = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_t2o_0_try = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2582</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2583</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2583, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2583, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2583, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2584</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2584, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2584, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_9 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2585</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_10, __pyx_t_5) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_3, __pyx_t_6, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_t_3, __pyx_t_6, __pyx_t_8};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    } else
    #endif
    {
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (__pyx_t_9) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_9); __pyx_t_9 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_11, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_11, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_11, __pyx_t_8);
      __pyx_t_3 = 0;
      __pyx_t_6 = 0;
      __pyx_t_8 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2581, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_9};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2581, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_9};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2581, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2581, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L12_unpacking_done;
      __pyx_L11_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2581, __pyx_L1_error)</span>
      __pyx_L12_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2586</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2587</span>:             <span class="n">ri_0</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_0, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_0, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_0, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_0, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_0, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_0, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2588</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2589</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2589, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2589, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_5 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_9 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 2589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2590</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2590, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2590, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_8 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2590, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2591</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2591, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2591, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2591, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_9, __pyx_t_8, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_9, __pyx_t_8, __pyx_t_5};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else
    #endif
    {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_11, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_11, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_11, __pyx_t_5);
      __pyx_t_9 = 0;
      __pyx_t_8 = 0;
      __pyx_t_5 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2587, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_4};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2587, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_8,&amp;__pyx_t_9,&amp;__pyx_t_4};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2587, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L13_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2587, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L14_unpacking_done;
      __pyx_L13_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2587, __pyx_L1_error)</span>
      __pyx_L14_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2592</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2593</span>:             <span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_1, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_1, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_1, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_1, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_1, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_1, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2594</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2595</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2595, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2595, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2595, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2596</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2597</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>}
    __pyx_t_7.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_7.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_7, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
        }
        __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_7.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_7.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_7.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_7, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
    __pyx_t_7.memview = NULL;
    __pyx_t_7.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_6 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_11 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_11 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_5, __pyx_t_6};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_11, __pyx_t_6);
      __pyx_t_4 = 0;
      __pyx_t_5 = 0;
      __pyx_t_6 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2594, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2593, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_9,&amp;__pyx_t_8,&amp;__pyx_t_6,&amp;__pyx_t_5,&amp;__pyx_t_4,&amp;__pyx_t_3};
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2593, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_10); if (unlikely(!item)) goto __pyx_L15_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_10), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L16_unpacking_done;
      __pyx_L15_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>
      __pyx_L16_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2598</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2599</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2600</span>:             <span class="c"># Check progress (can be removed later)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2601</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_0_try), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2602</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_0_try), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2603</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2604</span>:             <span class="c">#     np.linalg.norm(ri_0_try - np.asarray(self.r_trial[indf_m_1,:])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2605</span>:             <span class="c">#     np.linalg.norm(ro_0_try - np.asarray(self.r_trial[indf_m_1,:]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2606</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2607</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_0), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2608</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_0), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2609</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2610</span>:             <span class="c">#     np.linalg.norm(ri_0 - np.asarray(self.r[indf_m_1, :])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2611</span>:             <span class="c">#     np.linalg.norm(ro_0 - np.asarray(self.r[indf_m_1, :]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2612</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2613</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2i_1), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2614</span>:             <span class="c"># assert np.isclose(np.linalg.norm(t2o_1), 1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2615</span>:             <span class="c"># assert np.isclose(</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2616</span>:             <span class="c">#     np.linalg.norm(ri_1 - np.asarray(self.r[indf, :])),</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2617</span>:             <span class="c">#     np.linalg.norm(ro_1 - np.asarray(self.r[indf, :]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2618</span>:             <span class="c"># ), &quot;Error in calculation of entry and exit positions&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2619</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2620</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_reverse_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.bead_pair_dE_poly_reverse_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_t_21, __pyx_t_20, __pyx_t_19, __pyx_t_18, __pyx_t_17, __pyx_t_16, __pyx_t_15, __pyx_t_14, __pyx_t_13, __pyx_v_indf_m_1));
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
    __pyx_t_21.memview = NULL;
    __pyx_t_21.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
    __pyx_t_20.memview = NULL;
    __pyx_t_20.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2621</span>:                 <span class="n">ro_0</span><span class="p">,</span> <span class="n">ro_0_try</span><span class="p">,</span> <span class="n">ri_1</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t3o_0_try</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t2o_0</span><span class="p">,</span> <span class="n">t2o_0_try</span><span class="p">,</span></pre>
<pre class='cython code score-16 '>    __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_0_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_14.memview)) __PYX_ERR(0, 2621, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2622</span>:                 <span class="n">t2i_1</span><span class="p">,</span> <span class="n">bond_ind</span><span class="o">=</span><span class="n">indf_m_1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 2622, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2623</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2624</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2625</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2626</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2627</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">DetailedChromatin2</span><span class="p">(</span><span class="n">DetailedChromatin</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_6chromo_8polymers_DetailedChromatin2 {
  struct __pyx_obj_6chromo_8polymers_DetailedChromatin __pyx_base;
};
/* … */
struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin2 {
  struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin __pyx_base;
};
static struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin2 *__pyx_vtabptr_6chromo_8polymers_DetailedChromatin2;

</pre><pre class="cython line score-0">&#xA0;<span class="">2628</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Chromatin fiber with detailed nucleosomes without nucleosome diameter.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2629</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2630</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2631</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2632</span>: <span class="sd">    This class is identical to `DetailedChromatin` except that the nucleosome</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2633</span>: <span class="sd">    diameter is not included in the energy calculations. This is useful for</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2634</span>: <span class="sd">    comparison with theoretical end-to-end distances of a kinked wormlike chain.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2635</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2636</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2637</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2638</span>: <span class="sd">    See documentation for `DetailedChromatin` class for details and parameter</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2639</span>: <span class="sd">    descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2640</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2641</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-105 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_18DetailedChromatin2_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_18DetailedChromatin2___init__[] = "Initialize a detailed chromatin fiber.\n\n        Parameters\n        ----------\n        see `DetailedChromatin.__init__()` for details\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_18DetailedChromatin2___init__;
#endif
static int __pyx_pw_6chromo_8polymers_18DetailedChromatin2_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_bp_wrap;
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  double __pyx_v_lt;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bp_wrap,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_lt,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[9] = (PyObject *)__pyx_k__73;
    values[11] = (PyObject *)__pyx_k__74;
    values[12] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bp_wrap)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
        }
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
        }
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
        }
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lt); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 8)) {
        Py_ssize_t index;
        for (index = 6; index &lt; 14 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 2644, __pyx_L3_error)</span>
    __pyx_v_bp_wrap = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bp_wrap == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2646, __pyx_L3_error)</span>
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 2647, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2648, __pyx_L3_error)</span>
    __pyx_v_lt = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_lt == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2649, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 2650, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__75;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[7]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 2651, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__76;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[8]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 2652, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__77;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[9]);
    if (values[10]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[10], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 2654, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__78;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[11]);
    __pyx_v_log_path = ((PyObject*)values[12]);
    if (values[13]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[13]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2656, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2641, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatin2.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2643, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2653, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 2656, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_18DetailedChromatin2___init__(((struct __pyx_obj_6chromo_8polymers_DetailedChromatin2 *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bp_wrap, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_lt, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_18DetailedChromatin2___init__(struct __pyx_obj_6chromo_8polymers_DetailedChromatin2 *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, double __pyx_v_bp_wrap, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_lt, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatin2.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2642</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2643</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2644</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2645</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2646</span>:         <span class="n">double</span> <span class="n">bp_wrap</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2647</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2648</span>:         <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2649</span>:         <span class="n">double</span> <span class="n">lt</span><span class="p">,</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2650</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2650, __pyx_L1_error)</span>
  __pyx_k__75 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2651</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2651, __pyx_L1_error)</span>
  __pyx_k__76 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2652</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2652, __pyx_L1_error)</span>
  __pyx_k__77 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2653</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__73 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2654</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2654, __pyx_L1_error)</span>
  __pyx_k__78 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2655</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__74 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">2656</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2657</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2658</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a detailed chromatin fiber.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2659</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2660</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2661</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2662</span>: <span class="sd">        see `DetailedChromatin.__init__()` for details</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2663</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2664</span>:         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin2));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatin2));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2665</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bp_wrap</span><span class="o">=</span><span class="n">bp_wrap</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bp_wrap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bp_wrap, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2666</span>:             <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="n">lt</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span></pre>
<pre class='cython code score-40 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lt, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2667</span>:             <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2668</span>:             <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2669</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2665, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2670</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2671</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2672</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">continuous_dE_poly</span><span class="p">(</span></pre>
<pre class='cython code score-27 '>static double __pyx_f_6chromo_8polymers_18DetailedChromatin2_continuous_dE_poly(struct __pyx_obj_6chromo_8polymers_DetailedChromatin2 *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  long __pyx_v_ind0_m_1;
  long __pyx_v_indf_m_1;
  double __pyx_v_delta_energy_poly;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0 = NULL;
  PyObject *__pyx_v_t3o_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0 = NULL;
  PyObject *__pyx_v_t2o_0 = NULL;
  PyObject *__pyx_v_t3i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1 = NULL;
  PyObject *__pyx_v_t2i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1 = NULL;
  PyObject *__pyx_v_t3i_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1_try = NULL;
  PyObject *__pyx_v_t2i_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0_try = NULL;
  PyObject *__pyx_v_t3o_0_try = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0_try = NULL;
  PyObject *__pyx_v_t2o_0_try = NULL;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("continuous_dE_poly", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatin2.continuous_dE_poly", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0_try);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0_try);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2673</span>:             <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2674</span>:             <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2675</span>:             <span class="nb">long</span> <span class="n">indf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2676</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2677</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in polymer energy for a continuous bead region.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2678</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2679</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2680</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2681</span>: <span class="sd">        See documentation for `SSWLC.continuous_dE_poly()` class for details </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2682</span>: <span class="sd">        and parameter/return descriptions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2683</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2684</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0_m_1</span><span class="p">,</span> <span class="nf">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2685</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2686</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2687</span>:         <span class="n">ind0_m_1</span> <span class="o">=</span> <span class="n">ind0</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_ind0_m_1 = (__pyx_v_ind0 - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2688</span>:         <span class="n">indf_m_1</span> <span class="o">=</span> <span class="n">indf</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indf_m_1 = (__pyx_v_indf - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">2689</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2690</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2691</span>:         <span class="k">if</span> <span class="n">ind0</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_ind0 != 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2692</span>:             <span class="c"># Compute the entry and exit positions and orientations of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2693</span>:             <span class="c"># linker DNA for the first nucleosome in the continuous region</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2694</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-1 '>    __pyx_v__ = __pyx_t_4;
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_v_t3i_0 = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_v_t3o_0 = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_0 = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_t2o_0 = __pyx_t_8;
    __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2695</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2696</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-20 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2697</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-107 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2697, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2697, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2697, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_3, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_3, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_8) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_3 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2695, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2694, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_8};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2694, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_8};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2694, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L4_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2694, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L5_unpacking_done;
      __pyx_L4_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2694, __pyx_L1_error)</span>
      __pyx_L5_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2698</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2699</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_v_t3i_1 = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_v_t3o_1 = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_1 = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t2o_1 = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2700</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2701</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-127 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2701, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __pyx_t_10 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_8, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_8, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_10) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10); __pyx_t_10 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_9, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_8 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2700, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2699, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_8,&amp;__pyx_t_10};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2699, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_8,&amp;__pyx_t_10};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2699, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L6_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2699, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L7_unpacking_done;
      __pyx_L6_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2699, __pyx_L1_error)</span>
      __pyx_L7_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2702</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2703</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_1_try</span><span class="p">,</span> <span class="n">t3o_1_try</span><span class="p">,</span> <span class="n">t2i_1_try</span><span class="p">,</span> <span class="n">t2o_1_try</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_v_t3i_1_try = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_v_t3o_1_try = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_1_try = __pyx_t_10;
    __pyx_t_10 = 0;
    __pyx_v_t2o_1_try = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2704</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">ind0</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_ind0, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2705</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-20 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2705, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2705, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_10 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2705, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2705, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2705, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2705, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2706</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-107 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2706, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2706, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_5, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2706, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __pyx_t_4 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_8)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_10, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_8)) {
      PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_t_10, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_8, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (__pyx_t_4) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_9, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_10 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2704, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2703, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_8,&amp;__pyx_t_3,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_10,&amp;__pyx_t_4};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2703, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_8,&amp;__pyx_t_3,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_10,&amp;__pyx_t_4};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2703, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L8_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2703, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2703, __pyx_L1_error)</span>
      __pyx_L9_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2707</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2708</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_forward_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin2 *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.bead_pair_dE_poly_forward_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_t_5, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_t_19, __pyx_t_20, __pyx_v_ind0_m_1));
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
    __pyx_t_20.memview = NULL;
    __pyx_t_20.data = NULL;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2709</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">ind0</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-30 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>}
    __pyx_t_13.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_13.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_13, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>
        }
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_13.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ind0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2710</span>:                 <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3i_1_try</span><span class="p">,</span> <span class="n">t2o_0</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2i_1_try</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
/* … */
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2711</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">ind0_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2712</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2713</span>:         <span class="k">if</span> <span class="n">indf</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_indf != __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2714</span>:             <span class="c"># Compute the entry and exit positions and orientations of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2715</span>:             <span class="c"># linker DNA for the last nucleosome in the continuous region</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2716</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v__, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_0, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_0, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_0, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_0, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2717</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2718</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-20 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2718, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2718, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2718, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2718, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2718, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2718, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2719</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-107 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2719, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2719, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2719, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __pyx_t_3 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_10)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_10)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_4, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_9, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_4 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2717, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2716, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_4,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2716, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_4,&amp;__pyx_t_3};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2716, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2716, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L12_unpacking_done;
      __pyx_L11_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2716, __pyx_L1_error)</span>
      __pyx_L12_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2720</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2721</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_1, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_1, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_1, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_1, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2722</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2723</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-127 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2723, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2723, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2723, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2723, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __pyx_t_8 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_3, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
      PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_3, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      if (__pyx_t_8) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_9, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_3 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2722, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_8};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2721, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_3,&amp;__pyx_t_8};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2721, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L13_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L14_unpacking_done;
      __pyx_L13_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2721, __pyx_L1_error)</span>
      __pyx_L14_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2724</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2725</span>:             <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">t3i_0_try</span><span class="p">,</span> <span class="n">t3o_0_try</span><span class="p">,</span> <span class="n">t2i_0_try</span><span class="p">,</span> <span class="n">t2o_0_try</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_v_t3i_0_try = __pyx_t_7;
    __pyx_t_7 = 0;
    __pyx_v_t3o_0_try = __pyx_t_6;
    __pyx_t_6 = 0;
    __pyx_v_t2i_0_try = __pyx_t_8;
    __pyx_t_8 = 0;
    __pyx_v_t2o_0_try = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2726</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_indf_m_1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2727</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">t3_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-20 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2727, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2727, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2727, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2727, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2727, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3_trial.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2727, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2728</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">t2_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:]</span></pre>
<pre class='cython code score-107 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2728, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2728, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2_trial.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

__pyx_t_7 = __pyx_memoryview_fromslice(__pyx_t_14, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2728, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __pyx_t_10 = NULL;
    __pyx_t_9 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_9 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_8, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_10, __pyx_t_8, __pyx_t_6, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_10) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_10); __pyx_t_10 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_9, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_9, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_9, __pyx_t_7);
      __pyx_t_8 = 0;
      __pyx_t_6 = 0;
      __pyx_t_7 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2726, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 2725, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_8,&amp;__pyx_t_10};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 2725, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_7,&amp;__pyx_t_6,&amp;__pyx_t_8,&amp;__pyx_t_10};
      __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2725, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = Py_TYPE(__pyx_t_11)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_12(__pyx_t_11); if (unlikely(!item)) goto __pyx_L15_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2725, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      goto __pyx_L16_unpacking_done;
      __pyx_L15_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 2725, __pyx_L1_error)</span>
      __pyx_L16_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2729</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2730</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bead_pair_dE_poly_reverse_with_twist</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin2 *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.bead_pair_dE_poly_reverse_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_t_14, __pyx_t_13, __pyx_t_5, __pyx_t_20, __pyx_t_19, __pyx_t_18, __pyx_t_17, __pyx_t_16, __pyx_t_15, __pyx_v_indf_m_1));
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_14, 1);
    __pyx_t_14.memview = NULL;
    __pyx_t_14.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_13, 1);
    __pyx_t_13.memview = NULL;
    __pyx_t_13.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL;
    __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_20, 1);
    __pyx_t_20.memview = NULL;
    __pyx_t_20.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2731</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">indf_m_1</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">indf</span><span class="p">,</span> <span class="p">:],</span></pre>
<pre class='cython code score-30 '>    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>}
    __pyx_t_14.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_14.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_14, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>
        }
        __pyx_t_14.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_14.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_14.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_14.suboffsets[0] = -1;

if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>}
    __pyx_t_13.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data;
    __pyx_t_13.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_13, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf_m_1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>
        }
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
__pyx_t_13.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>}
    __pyx_t_5.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_5.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_indf;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>
        }
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_5.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2732</span>:                 <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t3o_0_try</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t2o_0</span><span class="p">,</span> <span class="n">t2o_0_try</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>__pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
/* … */
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0_try, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 2732, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2733</span>:                 <span class="n">bond_ind</span> <span class="o">=</span> <span class="n">indf_m_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2734</span>:             <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2735</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2736</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2737</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2738</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">DetailedChromatinWithSterics</span><span class="p">(</span><span class="n">DetailedChromatin</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics {
  struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatin __pyx_base;
  double (*evaluate_binder_interactions)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
  double (*get_E_bind)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
  void (*get_distances)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
  long (*check_steric_clashes)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, __Pyx_memviewslice, int __pyx_skip_dispatch);
  double (*compute_dE)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, PyObject *, __Pyx_memviewslice, long, int __pyx_skip_dispatch);
  PyObject *(*compute_E_detailed)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
  PyObject *(*compute_E_detailed_reverse)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
  void (*get_delta_distances)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, long, long, int __pyx_skip_dispatch);
  double (*eval_delta_steric_clashes)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, long, long, int __pyx_skip_dispatch);
  double (*eval_E_steric_clashes)(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *, int __pyx_skip_dispatch);
};
static struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_vtabptr_6chromo_8polymers_DetailedChromatinWithSterics;

</pre><pre class="cython line score-0">&#xA0;<span class="">2739</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Chromatin fiber with detailed nucleosomes and steric interactions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2740</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2741</span>: <span class="sd">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2742</span>: <span class="sd">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2743</span>: <span class="sd">    Because we are computing pairwise distances explicitly, we can evaluate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2744</span>: <span class="sd">    binder protein interactions specifically. For this reason, we do not need</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2745</span>: <span class="sd">    to use a field. The field is never active. We can specify a null field as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2746</span>: <span class="sd">    a place-holder. Beware that the field will not contribute to the energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2747</span>: <span class="sd">    associated with an instance of this class.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2748</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2749</span>:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-7 '>/* Python wrapper */
static int __pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics___init__[] = "Initialize a detailed chromatin fiber with steric interactions.\n\n        Parameters\n        ----------\n        see `DetailedChromatin.__init__()` for details\n\n        binders : sequence of Binder objects, optional\n            Representation of the interacting binders on the chromatin fiber.\n            If None, no binders are present. Default is None.\n        ";
#if CYTHON_UPDATE_DESCRIPTOR_DOC
struct wrapperbase __pyx_wrapperbase_6chromo_8polymers_28DetailedChromatinWithSterics___init__;
#endif
static int __pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_name = 0;
  __Pyx_memviewslice __pyx_v_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_bp_wrap;
  __Pyx_memviewslice __pyx_v_bead_length = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_lp;
  double __pyx_v_lt;
  PyObject *__pyx_v_binders = 0;
  __Pyx_memviewslice __pyx_v_t3 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_states = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_binder_names = 0;
  __Pyx_memviewslice __pyx_v_chemical_mods = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_chemical_mod_names = 0;
  PyObject *__pyx_v_log_path = 0;
  long __pyx_v_max_binders;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_r,&amp;__pyx_n_s_bp_wrap,&amp;__pyx_n_s_bead_length,&amp;__pyx_n_s_lp,&amp;__pyx_n_s_lt,&amp;__pyx_n_s_binders,&amp;__pyx_n_s_t3,&amp;__pyx_n_s_t2,&amp;__pyx_n_s_states,&amp;__pyx_n_s_binder_names,&amp;__pyx_n_s_chemical_mods,&amp;__pyx_n_s_chemical_mod_names,&amp;__pyx_n_s_log_path,&amp;__pyx_n_s_max_binders,0};
    PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics___init__(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, PyObject *__pyx_v_name, __Pyx_memviewslice __pyx_v_r, double __pyx_v_bp_wrap, __Pyx_memviewslice __pyx_v_bead_length, double __pyx_v_lp, double __pyx_v_lt, PyObject *__pyx_v_binders, __Pyx_memviewslice __pyx_v_t3, __Pyx_memviewslice __pyx_v_t2, __Pyx_memviewslice __pyx_v_states, PyArrayObject *__pyx_v_binder_names, __Pyx_memviewslice __pyx_v_chemical_mods, PyArrayObject *__pyx_v_chemical_mod_names, PyObject *__pyx_v_log_path, long __pyx_v_max_binders) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bead_length, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_states, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2750</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2751</span>:         <span class="nb">str</span> <span class="n">name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2752</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">r</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2753</span>:         <span class="o">*</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2754</span>:         <span class="n">double</span> <span class="n">bp_wrap</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2755</span>:         <span class="n">double</span><span class="p">[:]</span> <span class="n">bead_length</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2756</span>:         <span class="n">double</span> <span class="n">lp</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2757</span>:         <span class="n">double</span> <span class="n">lt</span><span class="p">,</span></pre>
<pre class="cython line score-99" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2758</span>:         <span class="n">binders</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-99 '>    values[6] = ((PyObject *)Py_None);
    values[10] = (PyObject *)__pyx_k__79;
    values[12] = (PyObject *)__pyx_k__80;
    values[13] = ((PyObject*)__pyx_kp_s__2);
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bp_wrap)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
        }
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_bead_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bead_length); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
        }
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lp); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
        }
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_lt)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_lt); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 9)) {
        Py_ssize_t index;
        for (index = 6; index &lt; 15 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, *__pyx_pyargnames[index]);
          if (value) { values[index] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("__init__", __pyx_n_s_bp_wrap); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_r = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 2752, __pyx_L3_error)</span>
    __pyx_v_bp_wrap = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_bp_wrap == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2754, __pyx_L3_error)</span>
    __pyx_v_bead_length = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_bead_length.memview)) __PYX_ERR(0, 2755, __pyx_L3_error)</span>
    __pyx_v_lp = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_lp == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2756, __pyx_L3_error)</span>
    __pyx_v_lt = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_lt == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2757, __pyx_L3_error)</span>
    __pyx_v_binders = values[6];
    if (values[7]) {
      __pyx_v_t3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[7], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3.memview)) __PYX_ERR(0, 2759, __pyx_L3_error)</span>
    } else {
      __pyx_v_t3 = __pyx_k__81;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t3, 1);
    }
    if (values[8]) {
      __pyx_v_t2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[8], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2.memview)) __PYX_ERR(0, 2760, __pyx_L3_error)</span>
    } else {
      __pyx_v_t2 = __pyx_k__82;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_t2, 1);
    }
    if (values[9]) {
      __pyx_v_states = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[9], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_states.memview)) __PYX_ERR(0, 2761, __pyx_L3_error)</span>
    } else {
      __pyx_v_states = __pyx_k__83;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_states, 1);
    }
    __pyx_v_binder_names = ((PyArrayObject *)values[10]);
    if (values[11]) {
      __pyx_v_chemical_mods = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(values[11], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_chemical_mods.memview)) __PYX_ERR(0, 2763, __pyx_L3_error)</span>
    } else {
      __pyx_v_chemical_mods = __pyx_k__84;
      __PYX_INC_MEMVIEW(&amp;__pyx_v_chemical_mods, 1);
    }
    __pyx_v_chemical_mod_names = ((PyArrayObject *)values[12]);
    __pyx_v_log_path = ((PyObject*)values[13]);
    if (values[14]) {
      __pyx_v_max_binders = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[14]); if (unlikely((__pyx_v_max_binders == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2765, __pyx_L3_error)</span>
    } else {
      __pyx_v_max_binders = ((long)-1L);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2749, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyString_Type), 1, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2751, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_binder_names), __pyx_ptype_5numpy_ndarray, 1, "binder_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2762, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chemical_mod_names), __pyx_ptype_5numpy_ndarray, 1, "chemical_mod_names", 0))) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_log_path), (&amp;PyString_Type), 1, "log_path", 1))) <span class='error_goto'>__PYX_ERR(0, 2765, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics___init__(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self), __pyx_v_name, __pyx_v_r, __pyx_v_bp_wrap, __pyx_v_bead_length, __pyx_v_lp, __pyx_v_lt, __pyx_v_binders, __pyx_v_t3, __pyx_v_t2, __pyx_v_states, __pyx_v_binder_names, __pyx_v_chemical_mods, __pyx_v_chemical_mod_names, __pyx_v_log_path, __pyx_v_max_binders);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2759</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2759, __pyx_L1_error)</span>
  __pyx_k__81 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2760</span>:         <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">empty_2d</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_2d), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 2760, __pyx_L1_error)</span>
  __pyx_k__82 = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2761</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">states</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2761, __pyx_L1_error)</span>
  __pyx_k__83 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2762</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">binder_names</span> <span class="o">=</span> <span class="n">empty_1d</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d));
  __pyx_k__79 = __pyx_v_6chromo_8polymers_empty_1d;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2763</span>:         <span class="nb">long</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">chemical_mods</span> <span class="o">=</span> <span class="n">mty_2d_int</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(((PyObject *)__pyx_v_6chromo_8polymers_mty_2d_int), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2763, __pyx_L1_error)</span>
  __pyx_k__84 = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2764</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">chemical_mod_names</span> <span class="o">=</span> <span class="n">empty_1d_str</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6chromo_8polymers_empty_1d_str));
  __pyx_k__80 = __pyx_v_6chromo_8polymers_empty_1d_str;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_6chromo_8polymers_empty_1d_str);
</pre><pre class="cython line score-0">&#xA0;<span class="">2765</span>:         <span class="nb">str</span> <span class="n">log_path</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nb">long</span> <span class="n">max_binders</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2766</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2767</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a detailed chromatin fiber with steric interactions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2768</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2769</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2770</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2771</span>: <span class="sd">        see `DetailedChromatin.__init__()` for details</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2772</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2773</span>: <span class="sd">        binders : sequence of Binder objects, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2774</span>: <span class="sd">            Representation of the interacting binders on the chromatin fiber.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2775</span>: <span class="sd">            If None, no binders are present. Default is None.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2776</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2777</span>:         <span class="nb">super</span><span class="p">(</span><span class="n">DetailedChromatinWithSterics</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatinWithSterics));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatinWithSterics));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_6chromo_8polymers_DetailedChromatinWithSterics));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_self));
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_2 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2778</span>:             <span class="n">name</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">bp_wrap</span><span class="o">=</span><span class="n">bp_wrap</span><span class="p">,</span> <span class="n">bead_length</span><span class="o">=</span><span class="n">bead_length</span><span class="p">,</span></pre>
<pre class='cython code score-19 '>  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_bp_wrap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bp_wrap, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_bead_length, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bead_length, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2779</span>:             <span class="n">lp</span><span class="o">=</span><span class="n">lp</span><span class="p">,</span> <span class="n">lt</span><span class="o">=</span><span class="n">lt</span><span class="p">,</span> <span class="n">t3</span><span class="o">=</span><span class="n">t3</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span></pre>
<pre class='cython code score-40 '>  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lp, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_lt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_lt, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t3, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t3, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_t2, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_t2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_states, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_states, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2780</span>:             <span class="n">binder_names</span><span class="o">=</span><span class="n">binder_names</span><span class="p">,</span> <span class="n">chemical_mods</span><span class="o">=</span><span class="n">chemical_mods</span><span class="p">,</span></pre>
<pre class='cython code score-11 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_binder_names, ((PyObject *)__pyx_v_binder_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_chemical_mods, 2, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mods, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2781</span>:             <span class="n">chemical_mod_names</span><span class="o">=</span><span class="n">chemical_mod_names</span><span class="p">,</span> <span class="n">log_path</span><span class="o">=</span><span class="n">log_path</span><span class="p">,</span></pre>
<pre class='cython code score-10 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_chemical_mod_names, ((PyObject *)__pyx_v_chemical_mod_names)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_log_path, __pyx_v_log_path) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2782</span>:             <span class="n">max_binders</span><span class="o">=</span><span class="n">max_binders</span></pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_max_binders);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_max_binders, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2783</span>:         <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2784</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">V0</span> <span class="o">=</span> <span class="mf">1.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;V0 = 1.0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2785</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">rad</span> <span class="o">*</span> <span class="mf">2.0</span></pre>
<pre class='cython code score-22 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2785, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_rad);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2785, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_float_2_0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2785, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2785, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_self-&gt;excluded_distance = __pyx_t_5;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2786</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2786, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;distances, 0);
  __pyx_v_self-&gt;distances = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2787</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">))</span></pre>
<pre class='cython code score-34 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 2787, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;distances_trial, 0);
  __pyx_v_self-&gt;distances_trial = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2788</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">get_distances</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_distances(__pyx_v_self, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">2789</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2790</span>:         <span class="c"># Load binders</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2791</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">binders</span> <span class="o">=</span> <span class="n">binders</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_binders);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_binders);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;binders);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;binders);
  __pyx_v_self-&gt;binders = __pyx_v_binders;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2792</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_self-&gt;binders != Py_None);
  __pyx_t_9 = (__pyx_t_8 != 0);
  if (__pyx_t_9) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2793</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>    __pyx_t_4 = __pyx_v_self-&gt;binders;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2793, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">2794</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2795</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2796</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2797</span>:     <span class="k">cpdef</span> <span class="kt">bint</span> <span class="nf">is_field_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-41 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_3is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static int __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_is_field_active(CYTHON_UNUSED struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_is_field_active);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_3is_field_active)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2797, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.is_field_active", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_3is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_2is_field_active[] = "The field is never active for this class.\n        \n        Notes\n        -----\n        All interactions are handled using explicit pairwise interactions.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_3is_field_active(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_2is_field_active(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_2is_field_active(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_field_active", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_is_field_active(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.is_field_active", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2798</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;The field is never active for this class.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2799</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2800</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2801</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2802</span>: <span class="sd">        All interactions are handled using explicit pairwise interactions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2803</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2804</span>:         <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2805</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2806</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">get_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_5get_distances(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static void __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_distances(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_distances", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_distances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_5get_distances)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.get_distances", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_5get_distances(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_4get_distances[] = "Get the distances between all pairs of nucleosomes.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_5get_distances(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_distances (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_4get_distances(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_4get_distances(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_distances", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_distances(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2806, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.get_distances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2807</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the distances between all pairs of nucleosomes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2808</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2809</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2810</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2811</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2811, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;distances.shape[0];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;distances.shape[1];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2811, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_8 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_9)) )) = 0.0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2812</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2812, __pyx_L1_error)</span>}
    __pyx_t_9 = __pyx_v_i;
    __pyx_t_8 = __pyx_v_i;
    __pyx_t_10 = -1;
    if (__pyx_t_9 &lt; 0) {
      __pyx_t_9 += __pyx_v_self-&gt;distances_trial.shape[0];
      if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
    } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_10 = 0;
    if (__pyx_t_8 &lt; 0) {
      __pyx_t_8 += __pyx_v_self-&gt;distances_trial.shape[1];
      if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 1;
    } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_10 = 1;
    if (unlikely(__pyx_t_10 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
      <span class='error_goto'>__PYX_ERR(0, 2812, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_9 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_8)) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2813</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
    __pyx_t_12 = __pyx_t_11;
    for (__pyx_t_13 = (__pyx_v_i + 1); __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_v_j = __pyx_t_13;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2814</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span></pre>
<pre class='cython code score-23 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
      __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_24 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2814, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2814, __pyx_L1_error)</span>}
      __pyx_t_23 = __pyx_v_i;
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_10 = -1;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_self-&gt;distances.shape[0];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_self-&gt;distances.shape[1];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2814, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_23 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_22)) )) = __pyx_t_24;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2815</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2815, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = 0;
      __pyx_t_10 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2815, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2815, __pyx_L1_error)</span>}
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = 0;
      __pyx_t_10 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2815, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2816</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-34 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>}
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_17 = 1;
      __pyx_t_10 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_19 = 1;
      __pyx_t_10 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2816, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_8 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_9)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_14 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_15)) )))), 2.0) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_17)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_18 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_19)) )))), 2.0)) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_20 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_21)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data + __pyx_t_22 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0]) )) + __pyx_t_23)) )))), 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2816, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2814, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2817</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>}
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = 2;
      __pyx_t_10 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>}
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_23 = 2;
      __pyx_t_10 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2818</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2819</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span></pre>
<pre class='cython code score-23 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2819, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2819, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
      __pyx_t_24 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_24 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2819, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2819, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_10 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2819, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_8 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_9)) )) = __pyx_t_24;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2820</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2820, __pyx_L1_error)</span>}
      __pyx_t_22 = __pyx_v_i;
      __pyx_t_23 = 0;
      __pyx_t_10 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2820, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2820, __pyx_L1_error)</span>}
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_20 = 0;
      __pyx_t_10 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2820, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2821</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-34 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>}
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_18 = 1;
      __pyx_t_10 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>}
      __pyx_t_17 = __pyx_v_j;
      __pyx_t_16 = 1;
      __pyx_t_10 = -1;
      if (__pyx_t_17 &lt; 0) {
        __pyx_t_17 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_17 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_17 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_22 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_23)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_21 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_20)) )))), 2.0) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_19 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_18)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_17 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_16)) )))), 2.0)) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_14)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_9 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_8)) )))), 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2819, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2822</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_14 = 2;
      __pyx_t_10 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>}
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_8 = 2;
      __pyx_t_10 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2823</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2824</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>}
      __pyx_t_9 = __pyx_v_i;
      __pyx_t_8 = __pyx_v_j;
      __pyx_t_10 = -1;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;distances.shape[0];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;distances.shape[1];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>}
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_10 = -1;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_self-&gt;distances.shape[0];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;distances.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_14 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_15)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_9 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_8)) )));
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2825</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>}
      __pyx_t_8 = __pyx_v_i;
      __pyx_t_9 = __pyx_v_j;
      __pyx_t_10 = -1;
      if (__pyx_t_8 &lt; 0) {
        __pyx_t_8 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_9 &lt; 0) {
        __pyx_t_9 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_9 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_9 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_14 = __pyx_v_i;
      __pyx_t_10 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_10 = 0;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_10 = 1;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_10 = 1;
      if (unlikely(__pyx_t_10 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);
        <span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_15 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_14)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_8 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_9)) )));
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2826</span>: </pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2827</span>:     <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">get_delta_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span> <span class="nb">long</span> <span class="n">indf</span><span class="p">):</span></pre>
<pre class='cython code score-100 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_7get_delta_distances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_delta_distances(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_delta_distances", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_delta_distances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_7get_delta_distances)) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_ind0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_indf);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_7 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (__pyx_t_6) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.get_delta_distances", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_7get_delta_distances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_6get_delta_distances[] = "Get changes in distances, rather than every distance\n        \n        Notes\n        -----\n        This function operates a lot like `get_distances`, but only computes\n        the pairwise distances only between beads affected by a move and all\n        other beads in the system. This is useful for computing the change in\n        energy associated with a proposed move in a more efficient manner.\n        \n        This method only updates the `distances_trial` attribute of the class.\n        \n        Parameters\n        ----------\n        ind0, indf : long\n            Indices of the first and one-past-the-last beads affected by the\n            move\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_7get_delta_distances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_ind0;
  long __pyx_v_indf;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_delta_distances (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ind0,&amp;__pyx_n_s_indf,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ind0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_indf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_delta_distances", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_delta_distances") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_ind0 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_ind0 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L3_error)</span>
    __pyx_v_indf = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_indf == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_delta_distances", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.get_delta_distances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_6get_delta_distances(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self), __pyx_v_ind0, __pyx_v_indf);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_6get_delta_distances(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_delta_distances", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_delta_distances(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.get_delta_distances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2828</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get changes in distances, rather than every distance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2829</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2830</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2831</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2832</span>: <span class="sd">        This function operates a lot like `get_distances`, but only computes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2833</span>: <span class="sd">        the pairwise distances only between beads affected by a move and all</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2834</span>: <span class="sd">        other beads in the system. This is useful for computing the change in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2835</span>: <span class="sd">        energy associated with a proposed move in a more efficient manner.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2836</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2837</span>: <span class="sd">        This method only updates the `distances_trial` attribute of the class.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2838</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2839</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2840</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2841</span>: <span class="sd">        ind0, indf : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2842</span>: <span class="sd">            Indices of the first and one-past-the-last beads affected by the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2843</span>: <span class="sd">            move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2844</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2845</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2846</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_indf;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = __pyx_v_ind0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2847</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-7 '>    if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2847, __pyx_L1_error)</span>}
    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_7 = -1;
    if (__pyx_t_12 &lt; 0) {
      __pyx_t_12 += __pyx_v_self-&gt;distances_trial.shape[0];
      if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_self-&gt;distances_trial.shape[1];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 1;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 2847, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_12 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_13)) )) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2848</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_j = __pyx_t_16;
</pre><pre class="cython line score-0">&#xA0;<span class="">2849</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2850</span>:                 <span class="c"># Let&#39;s avoid unnecessary computation</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2851</span>:                 <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = ((__pyx_v_i == __pyx_v_j) != 0);
      if (__pyx_t_17) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2852</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L5_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">2853</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2854</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span></pre>
<pre class='cython code score-23 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2854, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2854, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
      __pyx_t_28 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_28 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2854, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2854, __pyx_L1_error)</span>}
      __pyx_t_27 = __pyx_v_i;
      __pyx_t_26 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2854, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_27 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_26)) )) = __pyx_t_28;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2855</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2855, __pyx_L1_error)</span>}
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_12 = 0;
      __pyx_t_7 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2855, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2855, __pyx_L1_error)</span>}
      __pyx_t_18 = __pyx_v_j;
      __pyx_t_19 = 0;
      __pyx_t_7 = -1;
      if (__pyx_t_18 &lt; 0) {
        __pyx_t_18 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_18 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_18 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2855, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2856</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">+</span> <span class="w">\</span></pre>
<pre class='cython code score-34 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2856, __pyx_L1_error)</span>}
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = 1;
      __pyx_t_7 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2856, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2856, __pyx_L1_error)</span>}
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_23 = 1;
      __pyx_t_7 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_23 &lt; 0) {
        __pyx_t_23 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_23 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_23 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2856, __pyx_L1_error)</span>
      }
/* … */
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_12)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_18 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_19)) )))), 2.0) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_20 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_21)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_22 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_23)) )))), 2.0)) + pow(((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_24 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_25)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.data + __pyx_t_26 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.strides[0]) )) + __pyx_t_27)) )))), 2.0)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_8 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        }
      }
      __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_8, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2854, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2857</span>:                     <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L1_error)</span>}
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_25 = 2;
      __pyx_t_7 = -1;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L1_error)</span>}
      __pyx_t_26 = __pyx_v_j;
      __pyx_t_27 = 2;
      __pyx_t_7 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2858</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2859</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>}
      __pyx_t_26 = __pyx_v_i;
      __pyx_t_27 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_26 &lt; 0) {
        __pyx_t_26 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_26 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_26 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_27 &lt; 0) {
        __pyx_t_27 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_27 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_27 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>}
      __pyx_t_25 = __pyx_v_j;
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_7 = -1;
      if (__pyx_t_25 &lt; 0) {
        __pyx_t_25 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_25 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_25 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_24 &lt; 0) {
        __pyx_t_24 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_24 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_24 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_25 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_24)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_26 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_27)) )));
      __pyx_L5_continue:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2860</span>: </pre>
<pre class="cython line score-115" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2861</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">eval_delta_steric_clashes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">long</span> <span class="n">ind0</span><span class="p">,</span> <span class="nb">long</span> <span class="n">indf</span><span class="p">):</span></pre>
<pre class='cython code score-115 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_9eval_delta_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_eval_delta_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_num_beads;
  double __pyx_v_overlap_frac;
  double __pyx_v_E_clash;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_delta_steric_clashes", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_eval_delta_steric_clashes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_9eval_delta_steric_clashes)) {
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_ind0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_indf);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_7 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (__pyx_t_6) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_9;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.eval_delta_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_9eval_delta_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_8eval_delta_steric_clashes[] = "Get the change in steric clashes associated with a move.\n        \n        Notes\n        -----\n        This method computes the steric clashes, but does so only by checking\n        the beads that were affected by an MC move. There is not need to\n        re-check for steric clashes between unmoved beads.\n        \n        Returns\n        -------\n        double\n            Change in the number of steric clashes associated with the move.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_9eval_delta_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  long __pyx_v_ind0;
  long __pyx_v_indf;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_delta_steric_clashes (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ind0,&amp;__pyx_n_s_indf,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ind0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_indf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("eval_delta_steric_clashes", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "eval_delta_steric_clashes") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_ind0 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_ind0 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
    __pyx_v_indf = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_indf == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("eval_delta_steric_clashes", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.eval_delta_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_8eval_delta_steric_clashes(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self), __pyx_v_ind0, __pyx_v_indf);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_8eval_delta_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, long __pyx_v_ind0, long __pyx_v_indf) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_delta_steric_clashes", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_eval_delta_steric_clashes(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.eval_delta_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2862</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the change in steric clashes associated with a move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2863</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2864</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2865</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2866</span>: <span class="sd">        This method computes the steric clashes, but does so only by checking</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2867</span>: <span class="sd">        the beads that were affected by an MC move. There is not need to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2868</span>: <span class="sd">        re-check for steric clashes between unmoved beads.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2869</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2870</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2871</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2872</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2873</span>: <span class="sd">            Change in the number of steric clashes associated with the move.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2874</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2875</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">num_beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2876</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">overlap_frac</span><span class="p">,</span> <span class="nf">E_clash</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2877</span>:         <span class="n">E_clash</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_clash = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2878</span>:         <span class="n">num_beads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
  __pyx_v_num_beads = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2879</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_indf;
  __pyx_t_11 = __pyx_t_10;
  for (__pyx_t_12 = __pyx_v_ind0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
    __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2880</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_num_beads;
    __pyx_t_14 = __pyx_t_13;
    for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
      __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">2881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2882</span>:                 <span class="c"># Don&#39;t double count!</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2883</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">i</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ind0</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">indf</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = ((__pyx_v_j &gt;= __pyx_v_i) != 0);
      if (__pyx_t_17) {
      } else {
        __pyx_t_16 = __pyx_t_17;
        goto __pyx_L8_bool_binop_done;
      }
      __pyx_t_17 = (__pyx_v_ind0 &lt;= __pyx_v_j);
      if (__pyx_t_17) {
        __pyx_t_17 = (__pyx_v_j &lt; __pyx_v_indf);
      }
      __pyx_t_18 = (__pyx_t_17 != 0);
      __pyx_t_16 = __pyx_t_18;
      __pyx_L8_bool_binop_done:;
      if (__pyx_t_16) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2884</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L5_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">2885</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2886</span>:                 <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2886, __pyx_L1_error)</span>}
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_self-&gt;distances_trial.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;distances_trial.shape[1];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2886, __pyx_L1_error)</span>
      }
      __pyx_t_16 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_19 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_20)) ))) &lt; __pyx_v_self-&gt;excluded_distance) != 0);
      if (__pyx_t_16) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2887</span>:                     <span class="n">overlap_frac</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2888</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2888, __pyx_L1_error)</span>}
        __pyx_t_20 = __pyx_v_i;
        __pyx_t_19 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_v_self-&gt;distances_trial.shape[0];
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_v_self-&gt;distances_trial.shape[1];
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2888, __pyx_L1_error)</span>
        }
        __pyx_t_9 = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_20 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_19)) )));
        if (unlikely(__pyx_t_9 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 2888, __pyx_L1_error)</span>
        }
        __pyx_v_overlap_frac = (__pyx_v_self-&gt;excluded_distance / __pyx_t_9);
</pre><pre class="cython line score-0">&#xA0;<span class="">2889</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2890</span>:                     <span class="n">E_clash</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V0</span> <span class="o">*</span> <span class="p">(</span><span class="n">overlap_frac</span><span class="o">**</span><span class="mf">12</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>        __pyx_v_E_clash = (__pyx_v_E_clash + (__pyx_v_self-&gt;V0 * ((pow(__pyx_v_overlap_frac, 12.0) - (2.0 * pow(__pyx_v_overlap_frac, 6.0))) + 1.0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">2891</span>:                         <span class="mf">2</span> <span class="o">*</span> <span class="n">overlap_frac</span><span class="o">**</span><span class="mf">6</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2892</span>:                 <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2892, __pyx_L1_error)</span>}
      __pyx_t_19 = __pyx_v_i;
      __pyx_t_20 = __pyx_v_j;
      __pyx_t_7 = -1;
      if (__pyx_t_19 &lt; 0) {
        __pyx_t_19 += __pyx_v_self-&gt;distances.shape[0];
        if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_7 = 0;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;distances.shape[1];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 1;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_7 = 1;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2892, __pyx_L1_error)</span>
      }
      __pyx_t_16 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_19 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_20)) ))) &lt; __pyx_v_self-&gt;excluded_distance) != 0);
      if (__pyx_t_16) {
/* … */
      }
      __pyx_L5_continue:;
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2893</span>:                     <span class="n">overlap_frac</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2894</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>}
        __pyx_t_20 = __pyx_v_i;
        __pyx_t_19 = __pyx_v_j;
        __pyx_t_7 = -1;
        if (__pyx_t_20 &lt; 0) {
          __pyx_t_20 += __pyx_v_self-&gt;distances.shape[0];
          if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_7 = 0;
        } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_7 = 0;
        if (__pyx_t_19 &lt; 0) {
          __pyx_t_19 += __pyx_v_self-&gt;distances.shape[1];
          if (unlikely(__pyx_t_19 &lt; 0)) __pyx_t_7 = 1;
        } else if (unlikely(__pyx_t_19 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_7 = 1;
        if (unlikely(__pyx_t_7 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
          <span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>
        }
        __pyx_t_9 = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_20 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_19)) )));
        if (unlikely(__pyx_t_9 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>
        }
        __pyx_v_overlap_frac = (__pyx_v_self-&gt;excluded_distance / __pyx_t_9);
</pre><pre class="cython line score-0">&#xA0;<span class="">2895</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2896</span>:                     <span class="n">E_clash</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V0</span> <span class="o">*</span> <span class="p">(</span><span class="n">overlap_frac</span><span class="o">**</span><span class="mf">12</span> <span class="o">-</span></pre>
<pre class='cython code score-0 '>        __pyx_v_E_clash = (__pyx_v_E_clash - (__pyx_v_self-&gt;V0 * ((pow(__pyx_v_overlap_frac, 12.0) - (2.0 * pow(__pyx_v_overlap_frac, 6.0))) + 1.0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">2897</span>:                         <span class="mf">2</span> <span class="o">*</span> <span class="n">overlap_frac</span><span class="o">**</span><span class="mf">6</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2898</span>:         <span class="k">return</span> <span class="n">E_clash</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E_clash;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2899</span>: </pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2900</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">eval_E_steric_clashes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-48 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_11eval_E_steric_clashes(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_eval_E_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_num_beads;
  double __pyx_v_overlap_frac;
  PyObject *__pyx_v_E_clash = NULL;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_E_steric_clashes", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_eval_E_steric_clashes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2900, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_11eval_E_steric_clashes)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2900, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2900, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.eval_E_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_E_clash);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_11eval_E_steric_clashes(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_10eval_E_steric_clashes[] = "Compute the Energy associated with steric clashes.\n        \n        Returns\n        -------\n        double\n            Energy associated with steric clashes in the current configuration.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_11eval_E_steric_clashes(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_E_steric_clashes (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_10eval_E_steric_clashes(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_10eval_E_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_E_steric_clashes", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_eval_E_steric_clashes(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.eval_E_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2901</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the Energy associated with steric clashes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2902</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2903</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2904</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2905</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2906</span>: <span class="sd">            Energy associated with steric clashes in the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2907</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2908</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">num_beads</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2909</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">overlap_frac</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2910</span>:         <span class="n">E_clash</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_v_E_clash = __pyx_int_0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2911</span>:         <span class="n">num_beads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2911, __pyx_L1_error)</span>}
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_self-&gt;distances); 
  __pyx_v_num_beads = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2912</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (__pyx_v_num_beads - 1);
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2913</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_num_beads;
    __pyx_t_11 = __pyx_t_10;
    for (__pyx_t_12 = (__pyx_v_i + 1); __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2914</span>:                 <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>      if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2914, __pyx_L1_error)</span>}
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_self-&gt;distances.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_15 = 0;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_self-&gt;distances.shape[1];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_15 = 1;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_15 = 1;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>__PYX_ERR(0, 2914, __pyx_L1_error)</span>
      }
      __pyx_t_16 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_13 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_14)) ))) &lt; __pyx_v_self-&gt;excluded_distance) != 0);
      if (__pyx_t_16) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2915</span>:                     <span class="n">overlap_frac</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2916</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-12 '>        if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 2916, __pyx_L1_error)</span>}
        __pyx_t_14 = __pyx_v_i;
        __pyx_t_13 = __pyx_v_j;
        __pyx_t_15 = -1;
        if (__pyx_t_14 &lt; 0) {
          __pyx_t_14 += __pyx_v_self-&gt;distances.shape[0];
          if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_15 = 0;
        } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_15 = 0;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_self-&gt;distances.shape[1];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_15 = 1;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_15 = 1;
        if (unlikely(__pyx_t_15 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
          <span class='error_goto'>__PYX_ERR(0, 2916, __pyx_L1_error)</span>
        }
        __pyx_t_5 = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_14 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_13)) )));
        if (unlikely(__pyx_t_5 == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 2916, __pyx_L1_error)</span>
        }
        __pyx_v_overlap_frac = (__pyx_v_self-&gt;excluded_distance / __pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">2917</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2918</span>:                     <span class="n">E_clash</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V0</span> <span class="o">*</span> <span class="p">(</span><span class="n">overlap_frac</span> <span class="o">**</span> <span class="mf">12</span> <span class="o">-</span></pre>
<pre class='cython code score-12 '>        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_self-&gt;V0 * ((pow(__pyx_v_overlap_frac, 12.0) - (2.0 * pow(__pyx_v_overlap_frac, 6.0))) + 1.0)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2918, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_E_clash, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2918, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_E_clash, __pyx_t_2);
        __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2919</span>:                                           <span class="mf">2</span> <span class="o">*</span> <span class="n">overlap_frac</span> <span class="o">**</span> <span class="mf">6</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2920</span>:         <span class="k">return</span> <span class="n">E_clash</span></pre>
<pre class='cython code score-10 '>  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_E_clash); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2920, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_5;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2921</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2922</span>:     <span class="k">cpdef</span> <span class="kt">long</span> <span class="nf">check_steric_clashes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">distances</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_13check_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_arg_distances); /*proto*/
static long __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_check_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, __Pyx_memviewslice __pyx_v_distances, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_n_clashes;
  long __pyx_v_num_beads;
  long __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_steric_clashes", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_check_steric_clashes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2922, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_13check_steric_clashes)) {
        if (unlikely(!__pyx_v_distances.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("distances"); <span class='error_goto'>__PYX_ERR(0, 2922, __pyx_L1_error)</span> }
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_distances, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2922, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          }
        }
        __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2922, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_2); if (unlikely((__pyx_t_6 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2922, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_6;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.check_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_13check_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_arg_distances); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_12check_steric_clashes[] = "Check for steric clashes between nucleosomes.\n\n        Returns\n        -------\n        long\n            Number of Steric clashes.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_13check_steric_clashes(PyObject *__pyx_v_self, PyObject *__pyx_arg_distances) {
  __Pyx_memviewslice __pyx_v_distances = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_steric_clashes (wrapper)", 0);
  assert(__pyx_arg_distances); {
    __pyx_v_distances = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_arg_distances, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_distances.memview)) __PYX_ERR(0, 2922, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.check_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_12check_steric_clashes(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self), __pyx_v_distances);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_12check_steric_clashes(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, __Pyx_memviewslice __pyx_v_distances) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_steric_clashes", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_distances.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("distances"); <span class='error_goto'>__PYX_ERR(0, 2922, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_check_steric_clashes(__pyx_v_self, __pyx_v_distances, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2922, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.check_steric_clashes", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_distances, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2923</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for steric clashes between nucleosomes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2924</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2925</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2926</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2927</span>: <span class="sd">        long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2928</span>: <span class="sd">            Number of Steric clashes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2929</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2930</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">n_clashes</span><span class="p">,</span> <span class="nf">num_beads</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2931</span>:         <span class="n">n_clashes</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_clashes = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2932</span>:         <span class="n">num_beads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_distances); 
  __pyx_v_num_beads = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2933</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = (__pyx_v_num_beads - 1);
  __pyx_t_8 = __pyx_t_6;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2934</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_num_beads;
    __pyx_t_11 = __pyx_t_10;
    for (__pyx_t_12 = (__pyx_v_i + 1); __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
      __pyx_v_j = __pyx_t_12;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2935</span>:                 <span class="k">if</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">excluded_distance</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_distances.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_15 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_distances.shape[0])) __pyx_t_15 = 0;
      if (__pyx_t_14 &lt; 0) {
        __pyx_t_14 += __pyx_v_distances.shape[1];
        if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_15 = 1;
      } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_distances.shape[1])) __pyx_t_15 = 1;
      if (unlikely(__pyx_t_15 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_15);
        <span class='error_goto'>__PYX_ERR(0, 2935, __pyx_L1_error)</span>
      }
      __pyx_t_16 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_distances.data + __pyx_t_13 * __pyx_v_distances.strides[0]) )) + __pyx_t_14)) ))) &lt; __pyx_v_self-&gt;excluded_distance) != 0);
      if (__pyx_t_16) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2936</span>:                     <span class="n">n_clashes</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_n_clashes = (__pyx_v_n_clashes + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2937</span>:         <span class="k">return</span> <span class="n">n_clashes</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_n_clashes;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2938</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2939</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_dE</span><span class="p">(</span></pre>
<pre class='cython code score-122 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_15compute_dE(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_dE(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, PyObject *__pyx_v_move_name, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds, int __pyx_skip_dispatch) {
  double __pyx_v_delta_energy_poly;
  double __pyx_v_dE_clashes;
  long __pyx_v_ind0;
  long __pyx_v_indf;
  long __pyx_v_ind;
  long __pyx_v_i;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_dE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_15compute_dE)) {
        if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span> }
        __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_inds, 1, (PyObject *(*)(char *)) __pyx_memview_get_long, (int (*)(char *, PyObject *)) __pyx_memview_set_long, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_n_inds);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_7 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_move_name, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
          PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_move_name, __pyx_t_3, __pyx_t_4};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        } else
        #endif
        {
          __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (__pyx_t_6) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_move_name);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_move_name);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_v_move_name);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
          __pyx_t_3 = 0;
          __pyx_t_4 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_9 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_9 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_9;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_15compute_dE(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_14compute_dE[] = "Compute change in energy for proposed transformation.\n        \n        Notes\n        -----\n        This method accounts for the elastic energy of the polymer, the steric\n        interactions between nucleosomes, and the interactions between binders.\n        \n        Parameters\n        ----------\n        move_name : str\n            Name of the MC move for which the energy change is being calculated\n        inds : array_like (N,)\n            Indices of N beads affected by the MC move\n        n_inds : long\n            Number of beads affected by the MC move\n\n        Returns\n        -------\n        delta_energy_poly : double\n            Change in polymer elastic energy associated with the trial move\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_15compute_dE(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_move_name = 0;
  __Pyx_memviewslice __pyx_v_inds = { 0, 0, { 0 }, { 0 }, { 0 } };
  long __pyx_v_n_inds;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_move_name,&amp;__pyx_n_s_inds,&amp;__pyx_n_s_n_inds,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_move_name)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_dE", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_inds)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_dE", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_dE") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_move_name = ((PyObject*)values[0]);
    __pyx_v_inds = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_long</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_inds.memview)) __PYX_ERR(0, 2942, __pyx_L3_error)</span>
    __pyx_v_n_inds = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[2]); if (unlikely((__pyx_v_n_inds == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2943, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_dE", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_move_name), (&amp;PyString_Type), 1, "move_name", 1))) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_14compute_dE(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self), __pyx_v_move_name, __pyx_v_inds, __pyx_v_n_inds);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_14compute_dE(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, PyObject *__pyx_v_move_name, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_dE", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_inds.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("inds"); <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_dE(__pyx_v_self, __pyx_v_move_name, __pyx_v_inds, __pyx_v_n_inds, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_dE", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_inds, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_dE__pyx_wrap_1(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, PyObject *__pyx_v_move_name, __Pyx_memviewslice __pyx_v_inds, long __pyx_v_n_inds) {
  return __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_dE(__pyx_v_self, __pyx_v_move_name, __pyx_v_inds, __pyx_v_n_inds, 0);
}
</pre><pre class="cython line score-0">&#xA0;<span class="">2940</span>:         <span class="bp">self</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2941</span>:         <span class="nb">str</span> <span class="n">move_name</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2942</span>:         <span class="nb">long</span><span class="p">[:]</span> <span class="n">inds</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2943</span>:         <span class="nb">long</span> <span class="n">n_inds</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2944</span>:     <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2945</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute change in energy for proposed transformation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2946</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2947</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2948</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2949</span>: <span class="sd">        This method accounts for the elastic energy of the polymer, the steric</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2950</span>: <span class="sd">        interactions between nucleosomes, and the interactions between binders.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2951</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2952</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2953</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2954</span>: <span class="sd">        move_name : str</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2955</span>: <span class="sd">            Name of the MC move for which the energy change is being calculated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2956</span>: <span class="sd">        inds : array_like (N,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2957</span>: <span class="sd">            Indices of N beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2958</span>: <span class="sd">        n_inds : long</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2959</span>: <span class="sd">            Number of beads affected by the MC move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2960</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2961</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2962</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2963</span>: <span class="sd">        delta_energy_poly : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2964</span>: <span class="sd">            Change in polymer elastic energy associated with the trial move</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2965</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2966</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_poly</span><span class="p">,</span> <span class="nf">dE_clashes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2967</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">ind0</span><span class="p">,</span> <span class="nf">indf</span><span class="p">,</span> <span class="nf">ind</span><span class="p">,</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2968</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2969</span>:         <span class="n">delta_energy_poly</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_poly = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2970</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2971</span>:         <span class="c"># Check Sterics: Compute pairwise distances between nucleosomes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">2972</span>:         <span class="c"># New steric clashes only occur for moves involving translations</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2973</span>:         <span class="k">if</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2974</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;slide&quot;</span> <span class="ow">or</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;end_pivot&quot;</span> <span class="ow">or</span></pre>
<pre class='cython code score-4 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_slide, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2974, __pyx_L1_error)</span>
  __pyx_t_12 = (__pyx_t_11 != 0);
  if (!__pyx_t_12) {
  } else {
    __pyx_t_10 = __pyx_t_12;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_end_pivot, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2974, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_12 != 0);
  if (!__pyx_t_11) {
  } else {
    __pyx_t_10 = __pyx_t_11;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2975</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;crank_shaft&quot;</span></pre>
<pre class='cython code score-2 '>  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_crank_shaft, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2975, __pyx_L1_error)</span>
  __pyx_t_12 = (__pyx_t_11 != 0);
  __pyx_t_10 = __pyx_t_12;
  __pyx_L4_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2976</span>:         <span class="p">):</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2977</span>:             <span class="n">ind0</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = 0;
    __pyx_t_7 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 2977, __pyx_L1_error)</span>
    }
    __pyx_v_ind0 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2978</span>:             <span class="n">indf</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">n_inds</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = (__pyx_v_n_inds - 1);
    __pyx_t_7 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 2978, __pyx_L1_error)</span>
    }
    __pyx_v_indf = ((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) ))) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2979</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">get_delta_distances</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_delta_distances(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2980</span>:             <span class="n">dE_clashes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_delta_steric_clashes</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_dE_clashes = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;eval_delta_steric_clashes(__pyx_v_self, __pyx_v_ind0, __pyx_v_indf, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2981</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="n">dE_clashes</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + __pyx_v_dE_clashes);
</pre><pre class="cython line score-0">&#xA0;<span class="">2982</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2983</span>:         <span class="k">if</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;change_binding_state&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_change_binding_state, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2983, __pyx_L1_error)</span>
  __pyx_t_12 = (__pyx_t_10 != 0);
  if (__pyx_t_12) {
/* … */
    goto __pyx_L7;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2984</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_12 = ((__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders &gt; 0) != 0);
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2985</span>:                 <span class="n">ind0</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = 0;
      __pyx_t_7 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2985, __pyx_L1_error)</span>
      }
      __pyx_v_ind0 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2986</span>:                 <span class="n">indf</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">n_inds</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = (__pyx_v_n_inds - 1);
      __pyx_t_7 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2986, __pyx_L1_error)</span>
      }
      __pyx_v_indf = ((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) ))) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2987</span>:                 <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binding_dE</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">,</span> <span class="n">n_inds</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.binding_dE(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_ind0, __pyx_v_indf, __pyx_v_n_inds));
</pre><pre class="cython line score-0">&#xA0;<span class="">2988</span>:                 <span class="c"># Compute change in reader protein interactions</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2989</span>:                 <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_binder_interactions</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;evaluate_binder_interactions(__pyx_v_self, 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2990</span>:         <span class="k">elif</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>  if (__pyx_t_12) {
/* … */
    goto __pyx_L7;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2991</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;slide&quot;</span> <span class="ow">or</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;end_pivot&quot;</span> <span class="ow">or</span></pre>
<pre class='cython code score-4 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_slide, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2991, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  if (!__pyx_t_11) {
  } else {
    __pyx_t_12 = __pyx_t_11;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_end_pivot, Py_EQ)); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2991, __pyx_L1_error)</span>
  __pyx_t_10 = (__pyx_t_11 != 0);
  if (!__pyx_t_10) {
  } else {
    __pyx_t_12 = __pyx_t_10;
    goto __pyx_L9_bool_binop_done;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2992</span>:             <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;crank_shaft&quot;</span></pre>
<pre class='cython code score-2 '>  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_crank_shaft, Py_EQ)); if (unlikely(__pyx_t_10 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2992, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 != 0);
  __pyx_t_12 = __pyx_t_11;
  __pyx_L9_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2993</span>:         <span class="p">):</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2994</span>:             <span class="n">ind0</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = 0;
    __pyx_t_7 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 2994, __pyx_L1_error)</span>
    }
    __pyx_v_ind0 = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2995</span>:             <span class="n">indf</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">n_inds</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = (__pyx_v_n_inds - 1);
    __pyx_t_7 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_inds.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
    if (unlikely(__pyx_t_7 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
      <span class='error_goto'>__PYX_ERR(0, 2995, __pyx_L1_error)</span>
    }
    __pyx_v_indf = ((*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) ))) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2996</span>:             <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_dE_poly</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.continuous_dE_poly(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_ind0, __pyx_v_indf));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2997</span>:         <span class="k">elif</span> <span class="n">move_name</span> <span class="o">==</span> <span class="s">&quot;tangent_rotation&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_move_name, __pyx_n_s_tangent_rotation, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_12 != 0);
  if (__pyx_t_11) {
/* … */
  }
  __pyx_L7:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2998</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_inds</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_n_inds;
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_i = __pyx_t_16;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2999</span>:                 <span class="n">ind</span> <span class="o">=</span> <span class="n">inds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>      __pyx_t_13 = __pyx_v_i;
      __pyx_t_7 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_inds.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_7 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_inds.shape[0])) __pyx_t_7 = 0;
      if (unlikely(__pyx_t_7 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_7);
        <span class='error_goto'>__PYX_ERR(0, 2999, __pyx_L1_error)</span>
      }
      __pyx_v_ind = (*((long *) ( /* dim=0 */ (__pyx_v_inds.data + __pyx_t_13 * __pyx_v_inds.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3000</span>:                 <span class="n">ind0</span> <span class="o">=</span> <span class="n">ind</span></pre>
<pre class='cython code score-0 '>      __pyx_v_ind0 = __pyx_v_ind;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3001</span>:                 <span class="n">indf</span> <span class="o">=</span> <span class="n">ind</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_indf = (__pyx_v_ind + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3002</span>:                 <span class="n">delta_energy_poly</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">continuous_dE_poly</span><span class="p">(</span><span class="n">ind0</span><span class="p">,</span> <span class="n">indf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_delta_energy_poly = (__pyx_v_delta_energy_poly + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.__pyx_base.continuous_dE_poly(((struct __pyx_obj_6chromo_8polymers_SSWLC *)__pyx_v_self), __pyx_v_ind0, __pyx_v_indf));
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3003</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3004</span>:         <span class="k">return</span> <span class="n">delta_energy_poly</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_poly;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3005</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3006</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">evaluate_binder_interactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_17evaluate_binder_interactions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_evaluate_binder_interactions(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  long __pyx_v_l;
  double __pyx_v_delta_energy_binding;
  double __pyx_v_n_pairs;
  double __pyx_v_n_pairs_trial;
  double __pyx_v_cutoff_distance;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("evaluate_binder_interactions", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_evaluate_binder_interactions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3006, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_17evaluate_binder_interactions)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3006, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3006, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.evaluate_binder_interactions", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_17evaluate_binder_interactions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_16evaluate_binder_interactions[] = "Evaluate change in energy associated with binding states.\n\n        Notes\n        -----\n        Pairwise distances should be updated before running this method.\n        To avoid double counting cross-interactions, the cross-interaction\n        energy associated with two binders should only be listed in the\n        properties of one of the binders. The cross-interaction energy should\n        be listed as 0 for the pair in the properties of the other binder.\n\n        Returns\n        -------\n        double\n            Change in energy associated with binding states and reader protein\n            interactions.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_17evaluate_binder_interactions(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("evaluate_binder_interactions (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_16evaluate_binder_interactions(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_16evaluate_binder_interactions(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("evaluate_binder_interactions", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_evaluate_binder_interactions(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3006, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.evaluate_binder_interactions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3007</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate change in energy associated with binding states.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3009</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3010</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3011</span>: <span class="sd">        Pairwise distances should be updated before running this method.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3012</span>: <span class="sd">        To avoid double counting cross-interactions, the cross-interaction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3013</span>: <span class="sd">        energy associated with two binders should only be listed in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3014</span>: <span class="sd">        properties of one of the binders. The cross-interaction energy should</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3015</span>: <span class="sd">        be listed as 0 for the pair in the properties of the other binder.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3017</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3018</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3019</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3020</span>: <span class="sd">            Change in energy associated with binding states and reader protein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3021</span>: <span class="sd">            interactions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3022</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3023</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">l</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3024</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_binding</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_binding = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3025</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">n_pairs</span><span class="p">,</span> <span class="nf">n_pairs_trial</span><span class="p">,</span> <span class="nf">cutoff_distance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3027</span>:         <span class="c"># Self interactions, same nucleosome</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3028</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3029</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3030</span>:                 <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3030, __pyx_L1_error)</span>}
      __pyx_t_12 = __pyx_v_j;
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3030, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3030, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3030, __pyx_L1_error)</span>
      }
      __pyx_v_n_pairs = __Pyx_div_long(((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_13)) ))) * ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_16)) ))) - 1)), 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">3031</span>:                 <span class="n">n_pairs_trial</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3032</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>}
      __pyx_t_16 = __pyx_v_j;
      __pyx_t_15 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>}
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_12 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3032, __pyx_L1_error)</span>
      }
      __pyx_v_n_pairs_trial = __Pyx_div_long(((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_15)) ))) * ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_12)) ))) - 1)), 2);
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3033</span>:                 <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-35 '>      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3033, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_delta_energy_binding = __pyx_t_5;
    }
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3034</span>:                     <span class="n">n_pairs_trial</span> <span class="o">-</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-5 '>      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_n_pairs_trial - __pyx_v_n_pairs));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3034, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">3035</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3036</span>:         <span class="c"># Self interaction, different nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3037</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3038</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3039</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = (__pyx_v_j + 1); __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3040</span>:                     <span class="n">cutoff_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_radius</span></pre>
<pre class='cython code score-16 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3040, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_radius);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3040, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3040, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_v_cutoff_distance = __pyx_t_5;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3041</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>}
        __pyx_t_12 = __pyx_v_j;
        __pyx_t_13 = __pyx_v_k;
        __pyx_t_14 = -1;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_self-&gt;distances_trial.shape[0];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_self-&gt;distances_trial.shape[1];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>
        }
        __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_12 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_13)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
        if (__pyx_t_20) {
/* … */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">3042</span>:                         <span class="n">n_pairs_trial</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3043</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>}
          __pyx_t_13 = __pyx_v_j;
          __pyx_t_12 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_13 &lt; 0) {
            __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
            if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_12 &lt; 0) {
            __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
            if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>
          }
          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_k;
          __pyx_t_16 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>
          }
          __pyx_v_n_pairs_trial = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_12)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_16)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3044</span>:                         <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3044, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
          __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3044, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3044, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3045</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span> <span class="o">*</span> <span class="n">n_pairs_trial</span></pre>
<pre class='cython code score-17 '>          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3045, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3045, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs_trial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3045, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3045, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3046</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_15 = __pyx_v_k;
        __pyx_t_14 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;distances.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;distances.shape[1];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
        }
        __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_16 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_15)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
        if (__pyx_t_20) {
/* … */
        }
      }
    }
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3047</span>:                         <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3047, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_j;
          __pyx_t_16 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3047, __pyx_L1_error)</span>
          }
          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3047, __pyx_L1_error)</span>}
          __pyx_t_12 = __pyx_v_k;
          __pyx_t_13 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_12 &lt; 0) {
            __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
            if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_13 &lt; 0) {
            __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
            if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3047, __pyx_L1_error)</span>
          }
          __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_16)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_13)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3048</span>:                         <span class="n">delta_energy_binding</span> <span class="o">-=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3048, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
          __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3048, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3048, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3049</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-17 '>          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3049, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3049, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3049, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3049, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3050</span>:         <span class="c"># Cross-interaction, same nucleosome</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3051</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3052</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3053</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = ((__pyx_v_j == __pyx_v_i) != 0);
      if (__pyx_t_20) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3054</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L17_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3055</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3056</span>:                     <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3056, __pyx_L1_error)</span>}
        __pyx_t_13 = __pyx_v_k;
        __pyx_t_12 = __pyx_v_i;
        __pyx_t_14 = -1;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3056, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3056, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_k;
        __pyx_t_15 = __pyx_v_j;
        __pyx_t_14 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3056, __pyx_L1_error)</span>
        }
        __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_12)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_15)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">3057</span>:                     <span class="n">n_pairs_trial</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3058</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3058, __pyx_L1_error)</span>}
        __pyx_t_15 = __pyx_v_k;
        __pyx_t_16 = __pyx_v_i;
        __pyx_t_14 = -1;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3058, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3058, __pyx_L1_error)</span>}
        __pyx_t_12 = __pyx_v_k;
        __pyx_t_13 = __pyx_v_j;
        __pyx_t_14 = -1;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3058, __pyx_L1_error)</span>
        }
        __pyx_v_n_pairs_trial = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_16)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_13)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3059</span>:                     <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>        __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3059, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
        __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3059, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3059, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_v_delta_energy_binding = __pyx_t_5;
      }
      __pyx_L17_continue:;
    }
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3060</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span></pre>
<pre class='cython code score-9 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3060, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3060, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3060, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3061</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span></pre>
<pre class='cython code score-5 '>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3062</span>:                         <span class="p">]</span> <span class="o">*</span> <span class="p">(</span></pre>
<pre class='cython code score-7 '>        __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3062, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3063</span>:                             <span class="n">n_pairs_trial</span> <span class="o">-</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-5 '>        __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_n_pairs_trial - __pyx_v_n_pairs));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3063, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-0">&#xA0;<span class="">3064</span>:                         <span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3065</span>:         <span class="c"># Cross-interaction, different nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3066</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3067</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3068</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = ((__pyx_v_j == __pyx_v_i) != 0);
      if (__pyx_t_20) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3069</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L24_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3070</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3071</span>:                     <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
        __pyx_t_22 = __pyx_t_21;
        for (__pyx_t_23 = (__pyx_v_k + 1); __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
          __pyx_v_l = __pyx_t_23;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3072</span>:                         <span class="n">cutoff_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_radius</span></pre>
<pre class='cython code score-16 '>          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3072, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_interaction_radius);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3072, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3072, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_v_cutoff_distance = __pyx_t_5;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3073</span>:                         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>          if (unlikely(!__pyx_v_self-&gt;distances_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3073, __pyx_L1_error)</span>}
          __pyx_t_13 = __pyx_v_k;
          __pyx_t_12 = __pyx_v_l;
          __pyx_t_14 = -1;
          if (__pyx_t_13 &lt; 0) {
            __pyx_t_13 += __pyx_v_self-&gt;distances_trial.shape[0];
            if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;distances_trial.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_12 &lt; 0) {
            __pyx_t_12 += __pyx_v_self-&gt;distances_trial.shape[1];
            if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;distances_trial.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3073, __pyx_L1_error)</span>
          }
          __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances_trial.data + __pyx_t_13 * __pyx_v_self-&gt;distances_trial.strides[0]) )) + __pyx_t_12)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
          if (__pyx_t_20) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">3074</span>:                             <span class="n">n_pairs_trial</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3075</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">states_trial</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3075, __pyx_L1_error)</span>}
            __pyx_t_12 = __pyx_v_k;
            __pyx_t_13 = __pyx_v_i;
            __pyx_t_14 = -1;
            if (__pyx_t_12 &lt; 0) {
              __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
              if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_13 &lt; 0) {
              __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
              if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3075, __pyx_L1_error)</span>
            }
            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3075, __pyx_L1_error)</span>}
            __pyx_t_16 = __pyx_v_l;
            __pyx_t_15 = __pyx_v_j;
            __pyx_t_14 = -1;
            if (__pyx_t_16 &lt; 0) {
              __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0];
              if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_15 &lt; 0) {
              __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1];
              if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3075, __pyx_L1_error)</span>
            }
            __pyx_v_n_pairs_trial = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_13)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states_trial.strides[0]) )) + __pyx_t_15)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3076</span>:                             <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>            __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3076, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
            __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3076, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3076, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3077</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span></pre>
<pre class='cython code score-9 '>            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3077, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3077, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3077, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3078</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span></pre>
<pre class='cython code score-5 '>            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3079</span>:                                 <span class="p">]</span> <span class="o">*</span> <span class="n">n_pairs_trial</span></pre>
<pre class='cython code score-12 '>            __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs_trial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3079, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3079, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3080</span>:                         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>          if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3080, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_k;
          __pyx_t_16 = __pyx_v_l;
          __pyx_t_14 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_self-&gt;distances.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_self-&gt;distances.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3080, __pyx_L1_error)</span>
          }
          __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_15 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_16)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
          if (__pyx_t_20) {
/* … */
          }
        }
      }
      __pyx_L24_continue:;
    }
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3081</span>:                             <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3081, __pyx_L1_error)</span>}
            __pyx_t_16 = __pyx_v_k;
            __pyx_t_15 = __pyx_v_i;
            __pyx_t_14 = -1;
            if (__pyx_t_16 &lt; 0) {
              __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
              if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_15 &lt; 0) {
              __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
              if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3081, __pyx_L1_error)</span>
            }
            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3081, __pyx_L1_error)</span>}
            __pyx_t_13 = __pyx_v_l;
            __pyx_t_12 = __pyx_v_j;
            __pyx_t_14 = -1;
            if (__pyx_t_13 &lt; 0) {
              __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
              if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_12 &lt; 0) {
              __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
              if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3081, __pyx_L1_error)</span>
            }
            __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_15)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_12)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3082</span>:                             <span class="n">delta_energy_binding</span> <span class="o">-=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>            __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3082, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
            __pyx_t_4 = <span class='py_c_api'>PyNumber_InPlaceSubtract</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3082, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3082, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3083</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span></pre>
<pre class='cython code score-9 '>            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3083, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3083, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3083, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3084</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span></pre>
<pre class='cython code score-5 '>            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3084, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3084, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3085</span>:                                 <span class="p">]</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-12 '>            __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3085, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3085, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3086</span>:         <span class="k">return</span> <span class="n">delta_energy_binding</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_binding;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3087</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3088</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">get_E_bind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-47 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_19get_E_bind(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_E_bind(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_k;
  long __pyx_v_l;
  double __pyx_v_delta_energy_binding;
  double __pyx_v_n_pairs;
  double __pyx_v_cutoff_distance;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_E_bind", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_get_E_bind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_19get_E_bind)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3088, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.get_E_bind", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_19get_E_bind(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_18get_E_bind[] = "Evaluate energy associated with current binding states.\n\n        Notes\n        -----\n        Pairwise distances should be updated before running this method.\n        To avoid double counting cross-interactions, the cross-interaction\n        energy associated with two binders should only be listed in the\n        properties of one of the binders. The cross-interaction energy should\n        be listed as 0 for the pair in the properties of the other binder.\n\n        Returns\n        -------\n        double\n            Change in energy associated with binding states and reader protein\n            interactions.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_19get_E_bind(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_E_bind (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_18get_E_bind(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_18get_E_bind(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_E_bind", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_get_E_bind(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.get_E_bind", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3089</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate energy associated with current binding states.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3091</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3092</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3093</span>: <span class="sd">        Pairwise distances should be updated before running this method.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3094</span>: <span class="sd">        To avoid double counting cross-interactions, the cross-interaction</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3095</span>: <span class="sd">        energy associated with two binders should only be listed in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3096</span>: <span class="sd">        properties of one of the binders. The cross-interaction energy should</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3097</span>: <span class="sd">        be listed as 0 for the pair in the properties of the other binder.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3099</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3100</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3101</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3102</span>: <span class="sd">            Change in energy associated with binding states and reader protein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3103</span>: <span class="sd">            interactions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3104</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3105</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">l</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3106</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">delta_energy_binding</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_delta_energy_binding = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3107</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">n_pairs</span><span class="p">,</span> <span class="nf">n_pairs_trial</span><span class="p">,</span> <span class="nf">cutoff_distance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3109</span>:         <span class="c"># Self interactions, same nucleosome</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3110</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3111</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3112</span>:                 <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2</span></pre>
<pre class='cython code score-14 '>      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3112, __pyx_L1_error)</span>}
      __pyx_t_12 = __pyx_v_j;
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_12 &lt; 0) {
        __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
        if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_13 &lt; 0) {
        __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
        if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3112, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3112, __pyx_L1_error)</span>}
      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = __pyx_v_i;
      __pyx_t_14 = -1;
      if (__pyx_t_15 &lt; 0) {
        __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
        if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
      if (__pyx_t_16 &lt; 0) {
        __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
        if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
      } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3112, __pyx_L1_error)</span>
      }
      __pyx_v_n_pairs = __Pyx_div_long(((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_13)) ))) * ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_16)) ))) - 1)), 2);
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3113</span>:                 <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
      __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3113, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_delta_energy_binding = __pyx_t_5;
    }
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3114</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-17 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3115</span>:         <span class="c"># Self interaction, different nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3116</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3117</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3118</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = (__pyx_v_j + 1); __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3119</span>:                     <span class="n">cutoff_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_radius</span></pre>
<pre class='cython code score-16 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3119, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_radius);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3119, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3119, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_v_cutoff_distance = __pyx_t_5;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3120</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>        if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3120, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_j;
        __pyx_t_15 = __pyx_v_k;
        __pyx_t_14 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;distances.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;distances.shape[1];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3120, __pyx_L1_error)</span>
        }
        __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_16 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_15)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
        if (__pyx_t_20) {
/* … */
        }
      }
    }
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3121</span>:                         <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3121, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_j;
          __pyx_t_16 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3121, __pyx_L1_error)</span>
          }
          if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3121, __pyx_L1_error)</span>}
          __pyx_t_13 = __pyx_v_k;
          __pyx_t_12 = __pyx_v_i;
          __pyx_t_14 = -1;
          if (__pyx_t_13 &lt; 0) {
            __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
            if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_12 &lt; 0) {
            __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
            if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3121, __pyx_L1_error)</span>
          }
          __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_15 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_16)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_12)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3122</span>:                         <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>          __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3122, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
          __pyx_t_2 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3122, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3122, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3123</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_energy</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-17 '>          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3123, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3123, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3123, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3123, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3124</span>:         <span class="c"># Cross-interaction, same nucleosome</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3125</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3126</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3127</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = ((__pyx_v_j == __pyx_v_i) != 0);
      if (__pyx_t_20) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3128</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L16_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3129</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3130</span>:                     <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>}
        __pyx_t_12 = __pyx_v_k;
        __pyx_t_13 = __pyx_v_i;
        __pyx_t_14 = -1;
        if (__pyx_t_12 &lt; 0) {
          __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
          if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_13 &lt; 0) {
          __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
          if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
        }
        if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>}
        __pyx_t_16 = __pyx_v_k;
        __pyx_t_15 = __pyx_v_j;
        __pyx_t_14 = -1;
        if (__pyx_t_16 &lt; 0) {
          __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
          if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
        } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
        if (__pyx_t_15 &lt; 0) {
          __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
          if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
        } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
        if (unlikely(__pyx_t_14 != -1)) {
          <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
          <span class='error_goto'>__PYX_ERR(0, 3130, __pyx_L1_error)</span>
        }
        __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_12 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_13)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_15)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3131</span>:                     <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>        __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
        __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3131, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_v_delta_energy_binding = __pyx_t_5;
      }
      __pyx_L16_continue:;
    }
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3132</span>:                         <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span></pre>
<pre class='cython code score-9 '>        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3132, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3133</span>:                             <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span></pre>
<pre class='cython code score-5 '>        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3133, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3134</span>:                         <span class="p">]</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-12 '>        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3134, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3134, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3135</span>:         <span class="c"># Cross-interaction, different nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3136</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3137</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders;
    __pyx_t_10 = __pyx_t_9;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_j = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3138</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = ((__pyx_v_j == __pyx_v_i) != 0);
      if (__pyx_t_20) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3139</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L23_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3140</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3141</span>:                     <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
        __pyx_t_22 = __pyx_t_21;
        for (__pyx_t_23 = (__pyx_v_k + 1); __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
          __pyx_v_l = __pyx_t_23;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3142</span>:                         <span class="n">cutoff_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">interaction_radius</span></pre>
<pre class='cython code score-16 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3142, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_interaction_radius);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3142, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3142, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          __pyx_v_cutoff_distance = __pyx_t_5;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3143</span>:                         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cutoff_distance</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>          if (unlikely(!__pyx_v_self-&gt;distances.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3143, __pyx_L1_error)</span>}
          __pyx_t_15 = __pyx_v_k;
          __pyx_t_16 = __pyx_v_l;
          __pyx_t_14 = -1;
          if (__pyx_t_15 &lt; 0) {
            __pyx_t_15 += __pyx_v_self-&gt;distances.shape[0];
            if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 0;
          } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;distances.shape[0])) __pyx_t_14 = 0;
          if (__pyx_t_16 &lt; 0) {
            __pyx_t_16 += __pyx_v_self-&gt;distances.shape[1];
            if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 1;
          } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;distances.shape[1])) __pyx_t_14 = 1;
          if (unlikely(__pyx_t_14 != -1)) {
            <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
            <span class='error_goto'>__PYX_ERR(0, 3143, __pyx_L1_error)</span>
          }
          __pyx_t_20 = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self-&gt;distances.data + __pyx_t_15 * __pyx_v_self-&gt;distances.strides[0]) )) + __pyx_t_16)) ))) &lt;= __pyx_v_cutoff_distance) != 0);
          if (__pyx_t_20) {
/* … */
          }
        }
      }
      __pyx_L23_continue:;
    }
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3144</span>:                             <span class="n">n_pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-14 '>            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3144, __pyx_L1_error)</span>}
            __pyx_t_16 = __pyx_v_k;
            __pyx_t_15 = __pyx_v_i;
            __pyx_t_14 = -1;
            if (__pyx_t_16 &lt; 0) {
              __pyx_t_16 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
              if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_15 &lt; 0) {
              __pyx_t_15 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
              if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3144, __pyx_L1_error)</span>
            }
            if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3144, __pyx_L1_error)</span>}
            __pyx_t_13 = __pyx_v_l;
            __pyx_t_12 = __pyx_v_j;
            __pyx_t_14 = -1;
            if (__pyx_t_13 &lt; 0) {
              __pyx_t_13 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0];
              if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_14 = 0;
            } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[0])) __pyx_t_14 = 0;
            if (__pyx_t_12 &lt; 0) {
              __pyx_t_12 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1];
              if (unlikely(__pyx_t_12 &lt; 0)) __pyx_t_14 = 1;
            } else if (unlikely(__pyx_t_12 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.shape[1])) __pyx_t_14 = 1;
            if (unlikely(__pyx_t_14 != -1)) {
              <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
              <span class='error_goto'>__PYX_ERR(0, 3144, __pyx_L1_error)</span>
            }
            __pyx_v_n_pairs = ((*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_16 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_15)) ))) * (*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.data + __pyx_t_13 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.states.strides[0]) )) + __pyx_t_12)) ))));
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3145</span>:                             <span class="n">delta_energy_binding</span> <span class="o">+=</span> <span class="w">\</span></pre>
<pre class='cython code score-23 '>            __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delta_energy_binding);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3145, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
            __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3145, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3145, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_v_delta_energy_binding = __pyx_t_5;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3146</span>:                                 <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cross_talk_interaction_energy</span><span class="p">[</span></pre>
<pre class='cython code score-9 '>            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3146, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_cross_talk_interaction_energy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3146, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3146, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3147</span>:                                     <span class="bp">self</span><span class="o">.</span><span class="n">binders</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">name</span></pre>
<pre class='cython code score-5 '>            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;binders, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3147, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3147, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3148</span>:                                 <span class="p">]</span> <span class="o">*</span> <span class="n">n_pairs</span></pre>
<pre class='cython code score-12 '>            __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_n_pairs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3148, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3148, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3149</span>:         <span class="k">return</span> <span class="n">delta_energy_binding</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_delta_energy_binding;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3150</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3151</span>:     <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_E</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-63 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_21compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static double __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_m1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED PyObject *__pyx_v_ri_0 = NULL;
  PyObject *__pyx_v_ro_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0 = NULL;
  PyObject *__pyx_v_t3o_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0 = NULL;
  PyObject *__pyx_v_t2o_0 = NULL;
  PyObject *__pyx_v_ri_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ro_1 = NULL;
  PyObject *__pyx_v_t3i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1 = NULL;
  PyObject *__pyx_v_t2i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1 = NULL;
  double __pyx_v_omega;
  double __pyx_v_E_elastic;
  double __pyx_v_E_sterics;
  double __pyx_v_E_interactions;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3151, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_21compute_E)) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3151, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_2); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3151, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_r = __pyx_t_5;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_21compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_20compute_E[] = "Compute the overall polymer energy at the current configuration.\n        \n        Notes\n        -----\n        This method loops over each bond in the polymer and calculates the \n        energy change of that bond.\n\n        Returns\n        -------\n        double\n            Configurational energy of the polymer.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_21compute_E(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_20compute_E(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_20compute_E(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E(__pyx_v_self, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3152</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3153</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3154</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3155</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3156</span>: <span class="sd">        This method loops over each bond in the polymer and calculates the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3157</span>: <span class="sd">        energy change of that bond.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3159</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3160</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3161</span>: <span class="sd">        double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3162</span>: <span class="sd">            Configurational energy of the polymer.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3163</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3164</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3165</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_m1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3166</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3167</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">,</span> <span class="n">t2_0</span><span class="p">,</span> <span class="n">t2_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3168</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3169</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3171</span>:         <span class="c"># Compute the elastic energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3172</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
  __pyx_t_7 = __pyx_t_6;
  for (__pyx_t_8 = 1; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3173</span>:             <span class="n">i_m1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_m1 = (__pyx_v_i - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">3174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3175</span>:             <span class="c"># Get the entry/exit positions and orientations!</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3176</span>:             <span class="n">ri_0</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_0, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_0, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_0, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_0, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_0, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_0, __pyx_t_12);
    __pyx_t_12 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3177</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i_m1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3178</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3178, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3178, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_2 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_11, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3178, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3179</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3179, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3179, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_9 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3179, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3180</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3180, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3180, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      }
    }
    __pyx_t_11 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_13, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_12, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_14 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_14 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_12, __pyx_t_2, __pyx_t_9, __pyx_t_11};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_14, 3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_12, __pyx_t_2, __pyx_t_9, __pyx_t_11};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_14, 3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_12) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_12); __pyx_t_12 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_14, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_14, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_14, __pyx_t_11);
      __pyx_t_2 = 0;
      __pyx_t_9 = 0;
      __pyx_t_11 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3177, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3176, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_11,&amp;__pyx_t_9,&amp;__pyx_t_2,&amp;__pyx_t_12};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3176, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_11,&amp;__pyx_t_9,&amp;__pyx_t_2,&amp;__pyx_t_12};
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_13); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_13), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3176, __pyx_L1_error)</span>
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3176, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3181</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3182</span>:             <span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_1, __pyx_t_9);
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_1, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_1, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_1, __pyx_t_12);
    __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_1, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3183</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3184</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3184, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3184, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3184, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3184, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_9 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3184, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_4, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 3184, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3185</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3185, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3185, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_9 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_11 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3186</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3186, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3186, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3186, __pyx_L1_error)</span>}
    __pyx_t_10.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_10.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_10, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3186, __pyx_L1_error)</span>
        }
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_10.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_9 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3186, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
    __pyx_t_10.memview = NULL;
    __pyx_t_10.data = NULL;
    __pyx_t_13 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_13)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_4 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_13, __pyx_t_9) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3186, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_14 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_14 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_12, __pyx_t_11, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_14, 3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_12, __pyx_t_11, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_14, 3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_14, __pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_14, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_14, __pyx_t_4);
      __pyx_t_12 = 0;
      __pyx_t_11 = 0;
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3183, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3182, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_9,&amp;__pyx_t_4,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3182, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_9,&amp;__pyx_t_4,&amp;__pyx_t_11,&amp;__pyx_t_12,&amp;__pyx_t_3};
      __pyx_t_13 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3182, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_15 = Py_TYPE(__pyx_t_13)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_15(__pyx_t_13); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_13), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3182, __pyx_L1_error)</span>
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3182, __pyx_L1_error)</span>
      __pyx_L8_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3187</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3188</span>:             <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2o_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3188, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3188, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3188, __pyx_L1_error)</span>
    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 3188, __pyx_L1_error)</span>
    __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_t_19, 0);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3189</span>:             <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 3189, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3189, __pyx_L1_error)</span>
    __pyx_t_17 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_t_19, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3189, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_19, 1);
    __pyx_t_19.memview = NULL;
    __pyx_t_19.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3190</span>:             <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3o_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3190, __pyx_L1_error)</span>
    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_t_17, __pyx_v_dr);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3191</span>:             <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3o_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3191, __pyx_L1_error)</span>
    __pyx_t_18 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_t_17, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3191, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __pyx_t_17 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3191, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3192</span>:             <span class="n">bend</span> <span class="o">=</span> <span class="n">t3i_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t3i_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_12) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3192, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_17;
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3193</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_20 = 0; __pyx_t_20 &lt; 3; __pyx_t_20+=1) {
      __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3194</span>:                 <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3o_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-42 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_t3o_0, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3194, __pyx_L1_error)</span>}
      __pyx_t_21 = __pyx_v_i_m1;
      __pyx_t_14 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3194, __pyx_L1_error)</span>
      }
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3194, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.data + __pyx_t_21 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_22 * __pyx_v_dr_perp.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_12); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3194, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_22 = __pyx_v_j;
      __pyx_t_14 = -1;
      if (__pyx_t_22 &lt; 0) {
        __pyx_t_22 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_22 &lt; 0)) __pyx_t_14 = 0;
      } else if (unlikely(__pyx_t_22 &gt;= __pyx_v_bend.shape[0])) __pyx_t_14 = 0;
      if (unlikely(__pyx_t_14 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_14);
        <span class='error_goto'>__PYX_ERR(0, 3194, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_22 * __pyx_v_bend.strides[0]) )) += __pyx_t_5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3195</span>:             <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">i_m1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.E_pair_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_omega, __pyx_v_i_m1));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3196</span>:         <span class="n">E_elastic</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_elastic = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3198</span>:         <span class="c"># Compute the energy change associated with sterics</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3199</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3200</span>:         <span class="c"># Compute pairwise distances between nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3201</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">get_distances</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_distances(__pyx_v_self, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">3202</span>:         <span class="c"># Evaluate the energy of steric clashes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3203</span>:         <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_E_steric_clashes</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;eval_E_steric_clashes(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3204</span>:         <span class="n">E_sterics</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_sterics = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3206</span>:         <span class="c"># Compute change in reader protein interactions</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3207</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3208</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_23 = ((__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders &gt; 0) != 0);
  if (__pyx_t_23) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3209</span>:             <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_E_bind</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_E_bind(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3210</span>:         <span class="n">E_interactions</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_interactions = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3212</span>:         <span class="c"># compute the total energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3213</span>:         <span class="n">E</span> <span class="o">=</span> <span class="n">E_elastic</span> <span class="o">+</span> <span class="n">E_sterics</span> <span class="o">+</span> <span class="n">E_interactions</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((__pyx_v_E_elastic + __pyx_v_E_sterics) + __pyx_v_E_interactions);
</pre><pre class="cython line score-0">&#xA0;<span class="">3214</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3215</span>:         <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_E;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3216</span>: </pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3217</span>:     <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">compute_E_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-58 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_23compute_E_detailed(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E_detailed(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_m1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED PyObject *__pyx_v_ri_0 = NULL;
  PyObject *__pyx_v_ro_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_0 = NULL;
  PyObject *__pyx_v_t3o_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_0 = NULL;
  PyObject *__pyx_v_t2o_0 = NULL;
  PyObject *__pyx_v_ri_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ro_1 = NULL;
  PyObject *__pyx_v_t3i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_1 = NULL;
  PyObject *__pyx_v_t2i_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_1 = NULL;
  double __pyx_v_omega;
  double __pyx_v_E_elastic;
  double __pyx_v_E_sterics;
  double __pyx_v_E_interactions;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E_detailed);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_23compute_E_detailed)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_2)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
        __pyx_r = ((PyObject*)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E_detailed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_23compute_E_detailed(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_22compute_E_detailed[] = "Compute the overall polymer energy at the current configuration.\n        \n        Notes\n        -----\n        This method loops over each bond in the polymer and calculates the \n        energy change of that bond. The method returns the energy as a\n        dictionary with the elastic, steric, and interaction components of\n        the total energy.\n\n        Returns\n        -------\n        Dict[str, float]\n            Dictionary of the elastic, steric, interaction, and total energy\n            of a configuration.\n        ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_23compute_E_detailed(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_22compute_E_detailed(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_22compute_E_detailed(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E_detailed(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E_detailed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3218</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3219</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3220</span>: <span class="sd">        Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3221</span>: <span class="sd">        -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3222</span>: <span class="sd">        This method loops over each bond in the polymer and calculates the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3223</span>: <span class="sd">        energy change of that bond. The method returns the energy as a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3224</span>: <span class="sd">        dictionary with the elastic, steric, and interaction components of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3225</span>: <span class="sd">        the total energy.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3227</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3228</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3229</span>: <span class="sd">        Dict[str, float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3230</span>: <span class="sd">            Dictionary of the elastic, steric, interaction, and total energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3231</span>: <span class="sd">            of a configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3232</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3233</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3234</span>:         <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_m1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3235</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3236</span>:         <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">,</span> <span class="n">t2_0</span><span class="p">,</span> <span class="n">t2_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3237</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3238</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3240</span>:         <span class="c"># Compute elastic energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3241</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads;
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 1; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3242</span>:             <span class="n">i_m1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_m1 = (__pyx_v_i - 1);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3243</span>:             <span class="n">ri_0</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_0, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_0, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_0, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_0, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_0, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_0, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3244</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i_m1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3245</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3245, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3245, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3245, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3245, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3245, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3245, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3246</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3246, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3246, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    __pyx_t_8 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_11, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3246, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3247</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i_m1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3247, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_m1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3247, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_10 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3247, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_2, __pyx_t_8, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_2, __pyx_t_8, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_11) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11); __pyx_t_11 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_13, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_13, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_13, __pyx_t_10);
      __pyx_t_2 = 0;
      __pyx_t_8 = 0;
      __pyx_t_10 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3244, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3243, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_2,&amp;__pyx_t_11};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3243, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_2,&amp;__pyx_t_11};
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3243, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_12); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_12), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3243, __pyx_L1_error)</span>
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3243, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3248</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3249</span>:             <span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_1, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_1, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_1, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_1, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_1, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3250</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3251</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3251, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3251, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    __pyx_t_11 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3251, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3252</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3252, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3252, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3252, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3253</span>:                     <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3253, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3253, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_4 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3253, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_13 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_11, __pyx_t_10, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_11, __pyx_t_10, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_13, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_13, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_13, __pyx_t_4);
      __pyx_t_11 = 0;
      __pyx_t_10 = 0;
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3250, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3249, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3249, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_3};
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3249, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_12); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_12), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3249, __pyx_L1_error)</span>
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3249, __pyx_L1_error)</span>
      __pyx_L8_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3254</span>:                 <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3255</span>:             <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2o_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 3255, __pyx_L1_error)</span>
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3255, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3255, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3255, __pyx_L1_error)</span>
    __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, 0);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3256</span>:             <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3256, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3256, __pyx_L1_error)</span>
    __pyx_t_16 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_t_18, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3256, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3257</span>:             <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3o_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3257, __pyx_L1_error)</span>
    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_t_16, __pyx_v_dr);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3258</span>:             <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3o_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3258, __pyx_L1_error)</span>
    __pyx_t_17 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_t_16, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3258, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __pyx_t_16 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3258, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3259</span>:             <span class="n">bend</span> <span class="o">=</span> <span class="n">t3i_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t3i_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3259, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3259, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3259, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3260</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_19 = 0; __pyx_t_19 &lt; 3; __pyx_t_19+=1) {
      __pyx_v_j = __pyx_t_19;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3261</span>:                 <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3o_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i_m1</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-42 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_t3o_0, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>}
      __pyx_t_20 = __pyx_v_i_m1;
      __pyx_t_13 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>
      }
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.data + __pyx_t_20 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_21 * __pyx_v_dr_perp.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3261, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_11); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_bend.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3261, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_21 * __pyx_v_bend.strides[0]) )) += __pyx_t_22;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3262</span>:             <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">i_m1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.E_pair_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_omega, __pyx_v_i_m1));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3263</span>:         <span class="n">E_elastic</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_elastic = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3264</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3265</span>:         <span class="c"># Compute the energy change associated with sterics</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3266</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3267</span>:         <span class="c"># Compute pairwise distances between nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3268</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">get_distances</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_distances(__pyx_v_self, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">3269</span>:         <span class="c"># Evaluate the energy of steric clashes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3270</span>:         <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_E_steric_clashes</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;eval_E_steric_clashes(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3271</span>:         <span class="n">E_sterics</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_sterics = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3273</span>:         <span class="c"># Compute change in reader protein interactions</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3274</span>:         <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3275</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_23 = ((__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders &gt; 0) != 0);
  if (__pyx_t_23) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3276</span>:             <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_E_bind</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_E_bind(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3277</span>:         <span class="n">E_interactions</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_interactions = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3279</span>:         <span class="c"># compute the total energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3280</span>:         <span class="n">E</span> <span class="o">=</span> <span class="n">E_elastic</span> <span class="o">+</span> <span class="n">E_sterics</span> <span class="o">+</span> <span class="n">E_interactions</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((__pyx_v_E_elastic + __pyx_v_E_sterics) + __pyx_v_E_interactions);
</pre><pre class="cython line score-0">&#xA0;<span class="">3281</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3282</span>:         <span class="k">return</span> <span class="p">{</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3283</span>:             <span class="s">&quot;elastic&quot;</span><span class="p">:</span> <span class="n">E_elastic</span><span class="p">,</span> <span class="s">&quot;steric&quot;</span><span class="p">:</span> <span class="n">E_sterics</span><span class="p">,</span></pre>
<pre class='cython code score-24 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_elastic);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_elastic, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_sterics);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_steric, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3284</span>:             <span class="s">&quot;interaction&quot;</span><span class="p">:</span> <span class="n">E_interactions</span><span class="p">,</span> <span class="s">&quot;total&quot;</span><span class="p">:</span> <span class="n">E</span></pre>
<pre class='cython code score-22 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_interactions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_interaction, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_total, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3283, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = ((PyObject*)__pyx_t_11);
  __pyx_t_11 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3285</span>:         <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3286</span>: </pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3287</span>:     <span class="k">cpdef</span> <span class="kt">dict</span> <span class="nf">compute_E_detailed_reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-58 '>static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_25compute_E_detailed_reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E_detailed_reverse(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self, int __pyx_skip_dispatch) {
  double __pyx_v_E;
  double __pyx_v_dr_par;
  long __pyx_v_i;
  long __pyx_v_j;
  long __pyx_v_i_p1;
  __Pyx_memviewslice __pyx_v_dr = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dr_perp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_bend = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_ri_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ro_0 = NULL;
  PyObject *__pyx_v_t3i_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3o_0 = NULL;
  PyObject *__pyx_v_t2i_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2o_0 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_ri_1 = NULL;
  PyObject *__pyx_v_ro_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t3i_1 = NULL;
  PyObject *__pyx_v_t3o_1 = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_t2i_1 = NULL;
  PyObject *__pyx_v_t2o_1 = NULL;
  double __pyx_v_omega;
  double __pyx_v_E_elastic;
  double __pyx_v_E_sterics;
  double __pyx_v_E_interactions;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed_reverse", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_E_detailed_reverse);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3287, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_25compute_E_detailed_reverse)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3287, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (!(likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "dict", Py_TYPE(__pyx_t_2)-&gt;tp_name), 0))) <span class='error_goto'>__PYX_ERR(0, 3287, __pyx_L1_error)</span>
        __pyx_r = ((PyObject*)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E_detailed_reverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ri_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ro_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t3o_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2i_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2o_1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_25compute_E_detailed_reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_6chromo_8polymers_28DetailedChromatinWithSterics_24compute_E_detailed_reverse[] = "Compute the overall polymer energy at the current configuration.\n\n            Notes\n            -----\n            This method computes the total energy of a configuration in the\n            opposite direction of `compute_E_detailed`. It is intended just\n            to show that the CHANGE in energy is dependent on the way that\n            energy is calculated. We need to calculate total energy with the\n            same indexing scheme that we use to calculate the change in energy\n            with each MC step.\n\n            Returns\n            -------\n            Dict[str, float]\n                Dictionary of the elastic, steric, interaction, and total energy\n                of a configuration.\n            ";
static PyObject *__pyx_pw_6chromo_8polymers_28DetailedChromatinWithSterics_25compute_E_detailed_reverse(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed_reverse (wrapper)", 0);
  __pyx_r = __pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_24compute_E_detailed_reverse(((struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_28DetailedChromatinWithSterics_24compute_E_detailed_reverse(struct __pyx_obj_6chromo_8polymers_DetailedChromatinWithSterics *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_E_detailed_reverse", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_6chromo_8polymers_28DetailedChromatinWithSterics_compute_E_detailed_reverse(__pyx_v_self, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.DetailedChromatinWithSterics.compute_E_detailed_reverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3288</span>: <span class="w">            </span><span class="sd">&quot;&quot;&quot;Compute the overall polymer energy at the current configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3289</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3290</span>: <span class="sd">            Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3291</span>: <span class="sd">            -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3292</span>: <span class="sd">            This method computes the total energy of a configuration in the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3293</span>: <span class="sd">            opposite direction of `compute_E_detailed`. It is intended just</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3294</span>: <span class="sd">            to show that the CHANGE in energy is dependent on the way that</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3295</span>: <span class="sd">            energy is calculated. We need to calculate total energy with the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3296</span>: <span class="sd">            same indexing scheme that we use to calculate the change in energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3297</span>: <span class="sd">            with each MC step.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3299</span>: <span class="sd">            Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3300</span>: <span class="sd">            -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3301</span>: <span class="sd">            Dict[str, float]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3302</span>: <span class="sd">                Dictionary of the elastic, steric, interaction, and total energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3303</span>: <span class="sd">                of a configuration.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3304</span>: <span class="sd">            &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3305</span>:             <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">dr_par</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3306</span>:             <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">i_p1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3307</span>:             <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">dr</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">bend</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3308</span>:             <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">r_0</span><span class="p">,</span> <span class="n">r_1</span><span class="p">,</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">t3_1</span><span class="p">,</span> <span class="n">t2_0</span><span class="p">,</span> <span class="n">t2_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3309</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3310</span>:             <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3312</span>:             <span class="c"># Compute elastic energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3313</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_beads</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_beads - 1);
  __pyx_t_6 = __pyx_t_5;
  for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
    __pyx_v_i = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3314</span>:                 <span class="n">i_p1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_i_p1 = (__pyx_v_i + 1);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3315</span>:                 <span class="n">ri_0</span><span class="p">,</span> <span class="n">ro_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t3o_0</span><span class="p">,</span> <span class="n">t2i_0</span><span class="p">,</span> <span class="n">t2o_0</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_0, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_0, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_0, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_0, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_0, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_0, __pyx_t_11);
    __pyx_t_11 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3316</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i_p1</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i_p1, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3317</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i_p1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_p1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3318</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i_p1</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_p1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    __pyx_t_8 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_11, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3319</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i_p1</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i_p1;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      }
    }
    __pyx_t_10 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_13 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_2, __pyx_t_8, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
      PyObject *__pyx_temp[4] = {__pyx_t_11, __pyx_t_2, __pyx_t_8, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    } else
    #endif
    {
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (__pyx_t_11) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11); __pyx_t_11 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_13, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_13, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2+__pyx_t_13, __pyx_t_10);
      __pyx_t_2 = 0;
      __pyx_t_8 = 0;
      __pyx_t_10 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3316, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_2,&amp;__pyx_t_11};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_3,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_8,&amp;__pyx_t_2,&amp;__pyx_t_11};
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_12); if (unlikely(!item)) goto __pyx_L5_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_12), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3320</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3321</span>:                 <span class="n">ri_1</span><span class="p">,</span> <span class="n">ro_1</span><span class="p">,</span> <span class="n">t3i_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">,</span> <span class="n">t2i_1</span><span class="p">,</span> <span class="n">t2o_1</span> <span class="o">=</span> <span class="w">\</span></pre>
<pre class='cython code score-6 '>    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ri_1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ro_1, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3i_1, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t3o_1, __pyx_t_10);
    __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2i_1, __pyx_t_11);
    __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2o_1, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3322</span>:                     <span class="bp">self</span><span class="o">.</span><span class="n">beads</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">update_configuration</span><span class="p">(</span></pre>
<pre class='cython code score-5 '>    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.beads, __pyx_v_i, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_update_configuration);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3323</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3323, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3323, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.r.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_4 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      }
    }
    __pyx_t_11 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_10, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 3323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3324</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t3</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]),</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t3.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3325</span>:                         <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span></pre>
<pre class='cython code score-127 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>}
    __pyx_t_9.data = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.data;
    __pyx_t_9.memview = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_9, 0);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>
        }
        __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_9.shape[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.shape[1];
__pyx_t_9.strides[0] = __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.t2.strides[1];
    __pyx_t_9.suboffsets[0] = -1;

__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
    __pyx_t_9.memview = NULL;
    __pyx_t_9.data = NULL;
    __pyx_t_12 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_4 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_12, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_13 = 0;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_13 = 1;
      }
    }
    #if CYTHON_FAST_PYCALL
    if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_11, __pyx_t_10, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    #if CYTHON_FAST_PYCCALL
    if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
      PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_11, __pyx_t_10, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_13, 3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    } else
    #endif
    {
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_3) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3); __pyx_t_3 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_13, __pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_13, __pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_13, __pyx_t_4);
      __pyx_t_11 = 0;
      __pyx_t_10 = 0;
      __pyx_t_4 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3322, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 6)) {
        if (size &gt; 6) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(6);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 5); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
        __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 4); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 5); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      {
        Py_ssize_t i;
        PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_3};
        for (i=0; i &lt; 6; i++) {
          PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(item);
          *(temps[i]) = item;
        }
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      PyObject** temps[6] = {&amp;__pyx_t_2,&amp;__pyx_t_8,&amp;__pyx_t_4,&amp;__pyx_t_10,&amp;__pyx_t_11,&amp;__pyx_t_3};
      __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = Py_TYPE(__pyx_t_12)-&gt;tp_iternext;
      for (index=0; index &lt; 6; index++) {
        PyObject* item = __pyx_t_14(__pyx_t_12); if (unlikely(!item)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_14(__pyx_t_12), 6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
      __pyx_t_14 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      __pyx_t_14 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
      __pyx_L8_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3326</span>:                     <span class="p">)</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3327</span>:                 <span class="n">omega</span> <span class="o">=</span> <span class="n">compute_twist_angle_omega</span><span class="p">(</span><span class="n">t2i_0</span><span class="p">,</span> <span class="n">t3i_0</span><span class="p">,</span> <span class="n">t2o_1</span><span class="p">,</span> <span class="n">t3o_1</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2i_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t2o_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3o_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3327, __pyx_L1_error)</span>
    __pyx_v_omega = __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_t_15, __pyx_t_16, __pyx_t_17, __pyx_t_18, 0);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_15, 1);
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3328</span>:                 <span class="n">dr</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">ro_1</span><span class="p">,</span> <span class="n">ri_0</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ro_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_18.memview)) __PYX_ERR(0, 3328, __pyx_L1_error)</span>
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_ri_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3328, __pyx_L1_error)</span>
    __pyx_t_16 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_t_18, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3328, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_18, 1);
    __pyx_t_18.memview = NULL;
    __pyx_t_18.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr, 1);
    __pyx_v_dr = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3329</span>:                 <span class="n">dr_par</span> <span class="o">=</span> <span class="n">vec_dot3</span><span class="p">(</span><span class="n">t3i_0</span><span class="p">,</span> <span class="n">dr</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3329, __pyx_L1_error)</span>
    __pyx_v_dr_par = __pyx_f_6chromo_4util_6linalg_vec_dot3(__pyx_t_16, __pyx_v_dr);
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3330</span>:                 <span class="n">dr_perp</span> <span class="o">=</span> <span class="n">vec_sub3</span><span class="p">(</span><span class="n">dr</span><span class="p">,</span> <span class="n">vec_scale3</span><span class="p">(</span><span class="n">t3i_0</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_v_t3i_0, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3330, __pyx_L1_error)</span>
    __pyx_t_17 = __pyx_f_6chromo_4util_6linalg_vec_scale3(__pyx_t_16, __pyx_v_dr_par);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 3330, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_16, 1);
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
    __pyx_t_16 = __pyx_f_6chromo_4util_6linalg_vec_sub3(__pyx_v_dr, __pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3330, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_17, 1);
    __pyx_t_17.memview = NULL;
    __pyx_t_17.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dr_perp, 1);
    __pyx_v_dr_perp = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3331</span>:                 <span class="n">bend</span> <span class="o">=</span> <span class="n">t3o_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></pre>
<pre class='cython code score-21 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_t3o_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      }
    }
    __pyx_t_1 = (__pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_16.memview)) __PYX_ERR(0, 3331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_bend, 1);
    __pyx_v_bend = __pyx_t_16;
    __pyx_t_16.memview = NULL;
    __pyx_t_16.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3332</span>:                 <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_19 = 0; __pyx_t_19 &lt; 3; __pyx_t_19+=1) {
      __pyx_v_j = __pyx_t_19;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3333</span>:                     <span class="n">bend</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t3i_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">dr_perp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-42 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_t3i_0, __pyx_v_j, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3333, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3333, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>}
      __pyx_t_20 = __pyx_v_i;
      __pyx_t_13 = -1;
      if (__pyx_t_20 &lt; 0) {
        __pyx_t_20 += __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0];
        if (unlikely(__pyx_t_20 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_20 &gt;= __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>
      }
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_dr_perp.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_dr_perp.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>
      }
      __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((*((double *) ( /* dim=0 */ (__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.data + __pyx_t_20 * __pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.eta.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_dr_perp.data + __pyx_t_21 * __pyx_v_dr_perp.strides[0]) )))));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3333, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3333, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_22 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_11); if (unlikely((__pyx_t_22 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_21 = __pyx_v_j;
      __pyx_t_13 = -1;
      if (__pyx_t_21 &lt; 0) {
        __pyx_t_21 += __pyx_v_bend.shape[0];
        if (unlikely(__pyx_t_21 &lt; 0)) __pyx_t_13 = 0;
      } else if (unlikely(__pyx_t_21 &gt;= __pyx_v_bend.shape[0])) __pyx_t_13 = 0;
      if (unlikely(__pyx_t_13 != -1)) {
        <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_13);
        <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>
      }
      *((double *) ( /* dim=0 */ (__pyx_v_bend.data + __pyx_t_21 * __pyx_v_bend.strides[0]) )) += __pyx_t_22;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3334</span>:                 <span class="n">E</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">E_pair_with_twist</span><span class="p">(</span><span class="n">bend</span><span class="p">,</span> <span class="n">dr_par</span><span class="p">,</span> <span class="n">dr_perp</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = (__pyx_v_E + ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;__pyx_base.__pyx_base.E_pair_with_twist(((struct __pyx_obj_6chromo_8polymers_SSTWLC *)__pyx_v_self), __pyx_v_bend, __pyx_v_dr_par, __pyx_v_dr_perp, __pyx_v_omega, __pyx_v_i));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3335</span>:             <span class="n">E_elastic</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_elastic = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3337</span>:             <span class="c"># Compute the energy change associated with sterics</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3338</span>:             <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3339</span>:             <span class="c"># Compute pairwise distances between nucleosomes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3340</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">get_distances</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_distances(__pyx_v_self, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">3341</span>:             <span class="c"># Evaluate the energy of steric clashes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3342</span>:             <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eval_E_steric_clashes</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;eval_E_steric_clashes(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3343</span>:             <span class="n">E_sterics</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_sterics = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3344</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3345</span>:             <span class="c"># Compute change in reader protein interactions</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3346</span>:             <span class="n">E</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3347</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_binders</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_23 = ((__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.num_binders &gt; 0) != 0);
  if (__pyx_t_23) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3348</span>:                 <span class="n">E</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_E_bind</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_v_E = ((struct __pyx_vtabstruct_6chromo_8polymers_DetailedChromatinWithSterics *)__pyx_v_self-&gt;__pyx_base.__pyx_base.__pyx_base.__pyx_base.__pyx_vtab)-&gt;get_E_bind(__pyx_v_self, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3349</span>:             <span class="n">E_interactions</span> <span class="o">=</span> <span class="n">E</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E_interactions = __pyx_v_E;
</pre><pre class="cython line score-0">&#xA0;<span class="">3350</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3351</span>:             <span class="c"># compute the total energy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3352</span>:             <span class="n">E</span> <span class="o">=</span> <span class="n">E_elastic</span> <span class="o">+</span> <span class="n">E_sterics</span> <span class="o">+</span> <span class="n">E_interactions</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = ((__pyx_v_E_elastic + __pyx_v_E_sterics) + __pyx_v_E_interactions);
</pre><pre class="cython line score-0">&#xA0;<span class="">3353</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3354</span>:             <span class="k">return</span> <span class="p">{</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3355</span>:                 <span class="s">&quot;elastic&quot;</span><span class="p">:</span> <span class="n">E_elastic</span><span class="p">,</span> <span class="s">&quot;steric&quot;</span><span class="p">:</span> <span class="n">E_sterics</span><span class="p">,</span></pre>
<pre class='cython code score-24 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_elastic);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_elastic, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_sterics);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_steric, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3356</span>:                 <span class="s">&quot;interaction&quot;</span><span class="p">:</span> <span class="n">E_interactions</span><span class="p">,</span> <span class="s">&quot;total&quot;</span><span class="p">:</span> <span class="n">E</span></pre>
<pre class='cython code score-22 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E_interactions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_interaction, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_total, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = ((PyObject*)__pyx_t_11);
  __pyx_t_11 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3357</span>:             <span class="p">}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3359</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3360</span>: <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">sin_func</span><span class="p">(</span><span class="n">double</span> <span class="n">x</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>static PyObject *__pyx_pw_6chromo_8polymers_1sin_func(PyObject *__pyx_self, PyObject *__pyx_arg_x); /*proto*/
static double __pyx_f_6chromo_8polymers_sin_func(double __pyx_v_x, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sin_func", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_1sin_func(PyObject *__pyx_self, PyObject *__pyx_arg_x); /*proto*/
static char __pyx_doc_6chromo_8polymers_sin_func[] = "Sine function to which the polymer will be initialized.\n\n    Parameters\n    ----------\n    x : double\n        Input to the shape function\n\n    Returns\n    -------\n    double\n        Output to the shape function\n    ";
static PyObject *__pyx_pw_6chromo_8polymers_1sin_func(PyObject *__pyx_self, PyObject *__pyx_arg_x) {
  double __pyx_v_x;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sin_func (wrapper)", 0);
  assert(__pyx_arg_x); {
    __pyx_v_x = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_x); if (unlikely((__pyx_v_x == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3360, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.sin_func", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_sin_func(__pyx_self, ((double)__pyx_v_x));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_sin_func(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sin_func", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_sin_func(__pyx_v_x, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.sin_func", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3361</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Sine function to which the polymer will be initialized.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3363</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3364</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3365</span>: <span class="sd">    x : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3366</span>: <span class="sd">        Input to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3368</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3369</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3370</span>: <span class="sd">    double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3371</span>: <span class="sd">        Output to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3372</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3373</span>:     <span class="k">return</span> <span class="mf">50</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">35</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (50.0 * sin((__pyx_v_x / 35.0)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3374</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3375</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3376</span>: <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">helix_parametric_x</span><span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>static PyObject *__pyx_pw_6chromo_8polymers_3helix_parametric_x(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static double __pyx_f_6chromo_8polymers_helix_parametric_x(double __pyx_v_t, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_x;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_x", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_3helix_parametric_x(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static char __pyx_doc_6chromo_8polymers_2helix_parametric_x[] = "Parametric equation for x-coordinates of a helix.\n\n    Parameters\n    ----------\n    t : double\n        Parameter input to the shape function\n\n    Returns\n    -------\n    double\n        Output to the shape function\n    ";
static PyObject *__pyx_pw_6chromo_8polymers_3helix_parametric_x(PyObject *__pyx_self, PyObject *__pyx_arg_t) {
  double __pyx_v_t;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_x (wrapper)", 0);
  assert(__pyx_arg_t); {
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_t); if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3376, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_x", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_2helix_parametric_x(__pyx_self, ((double)__pyx_v_t));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_2helix_parametric_x(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_x", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_helix_parametric_x(__pyx_v_t, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3376, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_x", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3377</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Parametric equation for x-coordinates of a helix.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3378</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3379</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3380</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3381</span>: <span class="sd">    t : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3382</span>: <span class="sd">        Parameter input to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3384</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3385</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3386</span>: <span class="sd">    double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3387</span>: <span class="sd">        Output to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3388</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3389</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">x</span> <span class="o">=</span> <span class="mf">60</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_x = (60.0 * cos(__pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3390</span>:     <span class="k">return</span> <span class="n">x</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_x;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3391</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3392</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3393</span>: <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">helix_parametric_y</span><span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>static PyObject *__pyx_pw_6chromo_8polymers_5helix_parametric_y(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static double __pyx_f_6chromo_8polymers_helix_parametric_y(double __pyx_v_t, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_y;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_y", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_5helix_parametric_y(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static char __pyx_doc_6chromo_8polymers_4helix_parametric_y[] = "Parametric equation for y-coordinates of a helix.\n\n    Parameters\n    ----------\n    t : double\n        Parameter input to the shape function\n\n    Returns\n    -------\n    double\n        Output to the shape function\n    ";
static PyObject *__pyx_pw_6chromo_8polymers_5helix_parametric_y(PyObject *__pyx_self, PyObject *__pyx_arg_t) {
  double __pyx_v_t;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_y (wrapper)", 0);
  assert(__pyx_arg_t); {
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_t); if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3393, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_y", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_4helix_parametric_y(__pyx_self, ((double)__pyx_v_t));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_4helix_parametric_y(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_y", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_helix_parametric_y(__pyx_v_t, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3393, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_y", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3394</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Parametric equation for y-coordinates of a helix.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3395</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3396</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3397</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3398</span>: <span class="sd">    t : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3399</span>: <span class="sd">        Parameter input to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3400</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3401</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3402</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3403</span>: <span class="sd">    double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3404</span>: <span class="sd">        Output to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3405</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3406</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">y</span> <span class="o">=</span> <span class="mf">60</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_y = (60.0 * sin(__pyx_v_t));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3407</span>:     <span class="k">return</span> <span class="n">y</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_y;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3409</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3410</span>: <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">helix_parametric_z</span><span class="p">(</span><span class="n">double</span> <span class="n">t</span><span class="p">):</span></pre>
<pre class='cython code score-21 '>static PyObject *__pyx_pw_6chromo_8polymers_7helix_parametric_z(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static double __pyx_f_6chromo_8polymers_helix_parametric_z(double __pyx_v_t, CYTHON_UNUSED int __pyx_skip_dispatch) {
  double __pyx_v_z;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_z", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_7helix_parametric_z(PyObject *__pyx_self, PyObject *__pyx_arg_t); /*proto*/
static char __pyx_doc_6chromo_8polymers_6helix_parametric_z[] = "Parametric equation for z-coordinates of a helix.\n\n    Parameters\n    ----------\n    t : double\n        Parameter input to the shape function\n\n    Returns\n    -------\n    double\n        Output to the shape function\n    ";
static PyObject *__pyx_pw_6chromo_8polymers_7helix_parametric_z(PyObject *__pyx_self, PyObject *__pyx_arg_t) {
  double __pyx_v_t;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_z (wrapper)", 0);
  assert(__pyx_arg_t); {
    __pyx_v_t = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_arg_t); if (unlikely((__pyx_v_t == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3410, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_z", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_6helix_parametric_z(__pyx_self, ((double)__pyx_v_t));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_6helix_parametric_z(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_t) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("helix_parametric_z", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_helix_parametric_z(__pyx_v_t, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3410, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.helix_parametric_z", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3411</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Parametric equation for z-coordinates of a helix.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3413</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3414</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3415</span>: <span class="sd">    t : double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3416</span>: <span class="sd">        Parameter input to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3418</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3419</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3420</span>: <span class="sd">    double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3421</span>: <span class="sd">        Output to the shape function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3422</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3423</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">z</span> <span class="o">=</span> <span class="mf">20</span> <span class="o">*</span> <span class="n">t</span></pre>
<pre class='cython code score-0 '>  __pyx_v_z = (20.0 * __pyx_v_t);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3424</span>:     <span class="k">return</span> <span class="n">z</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_z;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3426</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3427</span>: <span class="k">cpdef</span> <span class="kt">double</span> <span class="nf">compute_twist_angle_omega</span><span class="p">(</span></pre>
<pre class='cython code score-73 '>static PyObject *__pyx_pw_6chromo_8polymers_9compute_twist_angle_omega(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static double __pyx_f_6chromo_8polymers_compute_twist_angle_omega(__Pyx_memviewslice __pyx_v_t2_0, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_t2_1, __Pyx_memviewslice __pyx_v_t3_1, CYTHON_UNUSED int __pyx_skip_dispatch) {
  __Pyx_memviewslice __pyx_v_t1_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t1_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_omega;
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_twist_angle_omega", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("chromo.polymers.compute_twist_angle_omega", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t1_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t1_1, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6chromo_8polymers_9compute_twist_angle_omega(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6chromo_8polymers_8compute_twist_angle_omega[] = "Compute twist angle between two sets of orientation vectors.\n    \n    Parameters\n    ----------\n    t2_0, t3_0 : double[:] of shape (3,)\n        T2 and T3 orientation vectors of the first bead\n    t2_1, t3_1 : double[:] of shape (3,)\n        T2 and T3 orientation vectors of the second bead\n    \n    Returns\n    -------\n    double\n        Twist angle (in radians)\n    ";
static PyObject *__pyx_pw_6chromo_8polymers_9compute_twist_angle_omega(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_t2_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_0 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t2_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_t3_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_twist_angle_omega (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_t2_0,&amp;__pyx_n_s_t3_0,&amp;__pyx_n_s_t2_1,&amp;__pyx_n_s_t3_1,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t2_0)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t3_0)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_twist_angle_omega", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t2_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_twist_angle_omega", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_t3_1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_twist_angle_omega", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_twist_angle_omega") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_t2_0 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2_0.memview)) __PYX_ERR(0, 3428, __pyx_L3_error)</span>
    __pyx_v_t3_0 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3_0.memview)) __PYX_ERR(0, 3428, __pyx_L3_error)</span>
    __pyx_v_t2_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t2_1.memview)) __PYX_ERR(0, 3428, __pyx_L3_error)</span>
    __pyx_v_t3_1 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_t3_1.memview)) __PYX_ERR(0, 3428, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_twist_angle_omega", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.compute_twist_angle_omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6chromo_8polymers_8compute_twist_angle_omega(__pyx_self, __pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_t2_1, __pyx_v_t3_1);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6chromo_8polymers_8compute_twist_angle_omega(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_t2_0, __Pyx_memviewslice __pyx_v_t3_0, __Pyx_memviewslice __pyx_v_t2_1, __Pyx_memviewslice __pyx_v_t3_1) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_twist_angle_omega", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_t2_0.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("t2_0"); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_t3_0.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("t3_0"); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_t2_1.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("t2_1"); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_t3_1.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("t3_1"); <span class='error_goto'>__PYX_ERR(0, 3427, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_6chromo_8polymers_compute_twist_angle_omega(__pyx_v_t2_0, __pyx_v_t3_0, __pyx_v_t2_1, __pyx_v_t3_1, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3427, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("chromo.polymers.compute_twist_angle_omega", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_0, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t2_1, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_t3_1, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">3428</span>:     <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_0</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_0</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">t2_1</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">t3_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3429</span>: <span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3430</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute twist angle between two sets of orientation vectors.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3431</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3432</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3433</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3434</span>: <span class="sd">    t2_0, t3_0 : double[:] of shape (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3435</span>: <span class="sd">        T2 and T3 orientation vectors of the first bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3436</span>: <span class="sd">    t2_1, t3_1 : double[:] of shape (3,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3437</span>: <span class="sd">        T2 and T3 orientation vectors of the second bead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3438</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3439</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3440</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3441</span>: <span class="sd">    double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3442</span>: <span class="sd">        Twist angle (in radians)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3443</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3444</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">t1_0</span><span class="p">,</span> <span class="n">t1_1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3445</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">omega</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">3446</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3447</span>:     <span class="n">t1_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_10);
  __pyx_t_2 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_10, __pyx_t_11) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 3447, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_t1_0 = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3448</span>:         <span class="n">t2_0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_0</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3448, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3448, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3448, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3448, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_4 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_6 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_7 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_8 * __pyx_v_t3_0.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3448, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3449</span>:         <span class="n">t2_0</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_8 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3449, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3449, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3449, __pyx_L1_error)</span>
  }
  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3449, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_8 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_7 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_6 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_4 * __pyx_v_t3_0.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3449, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3450</span>:         <span class="n">t2_0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_0</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_0</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3450, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3450, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t2_0.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t2_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3450, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t3_0.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t3_0.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3450, __pyx_L1_error)</span>
  }
  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_4 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_6 * __pyx_v_t3_0.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_0.data + __pyx_t_7 * __pyx_v_t2_0.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_0.data + __pyx_t_8 * __pyx_v_t3_0.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3450, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-0">&#xA0;<span class="">3451</span>:     <span class="p">])</span></pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3452</span>:     <span class="n">t1_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_9);
  __pyx_t_3 = 0;
  __pyx_t_10 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
    }
  }
  __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_9, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_11, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 3452, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_t1_1 = __pyx_t_12;
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3453</span>:         <span class="n">t2_1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_1</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_8 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3453, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3453, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3453, __pyx_L1_error)</span>
  }
  __pyx_t_4 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3453, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_8 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_7 * __pyx_v_t3_1.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_6 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_4 * __pyx_v_t3_1.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3454</span>:         <span class="n">t2_1</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3454, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3454, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3454, __pyx_L1_error)</span>
  }
  __pyx_t_8 = 2;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3454, __pyx_L1_error)</span>
  }
  __pyx_t_10 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_4 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_6 * __pyx_v_t3_1.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_7 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_8 * __pyx_v_t3_1.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3454, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3455</span>:         <span class="n">t2_1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2_1</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t3_1</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_8 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_8 &lt; 0) {
    __pyx_t_8 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_8 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_8 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3455, __pyx_L1_error)</span>
  }
  __pyx_t_7 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_7 &lt; 0) {
    __pyx_t_7 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_7 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3455, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 1;
  __pyx_t_5 = -1;
  if (__pyx_t_6 &lt; 0) {
    __pyx_t_6 += __pyx_v_t2_1.shape[0];
    if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_6 &gt;= __pyx_v_t2_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3455, __pyx_L1_error)</span>
  }
  __pyx_t_4 = 0;
  __pyx_t_5 = -1;
  if (__pyx_t_4 &lt; 0) {
    __pyx_t_4 += __pyx_v_t3_1.shape[0];
    if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;
  } else if (unlikely(__pyx_t_4 &gt;= __pyx_v_t3_1.shape[0])) __pyx_t_5 = 0;
  if (unlikely(__pyx_t_5 != -1)) {
    <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);
    <span class='error_goto'>__PYX_ERR(0, 3455, __pyx_L1_error)</span>
  }
  __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>((((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_8 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_7 * __pyx_v_t3_1.strides[0]) )))) - ((*((double *) ( /* dim=0 */ (__pyx_v_t2_1.data + __pyx_t_6 * __pyx_v_t2_1.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_t3_1.data + __pyx_t_4 * __pyx_v_t3_1.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
</pre><pre class="cython line score-0">&#xA0;<span class="">3456</span>:     <span class="p">])</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3457</span>:     <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_arctan2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_t_17 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_17 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3457, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_omega = __pyx_t_17;
</pre><pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3458</span>:         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t2_0</span><span class="p">,</span> <span class="n">t1_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t1_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">)),</span></pre>
<pre class='cython code score-95 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_t2_0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_t1_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_13 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_13)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_10)) {
    PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_9, __pyx_t_3};
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_10)) {
    PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_9, __pyx_t_3};
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_10, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_14 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (__pyx_t_13) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_13); __pyx_t_13 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 0+__pyx_t_5, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_14, 1+__pyx_t_5, __pyx_t_3);
    __pyx_t_9 = 0;
    __pyx_t_3 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_t1_0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_t2_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_13 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_13)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_14, __pyx_t_9};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_13, __pyx_t_14, __pyx_t_9};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (__pyx_t_13) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_13); __pyx_t_13 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+__pyx_t_5, __pyx_t_14);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1+__pyx_t_5, __pyx_t_9);
    __pyx_t_14 = 0;
    __pyx_t_9 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-134" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3459</span>:         <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t1_0</span><span class="p">,</span> <span class="n">t1_1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t2_0</span><span class="p">,</span> <span class="n">t2_1</span><span class="p">))</span></pre>
<pre class='cython code score-134 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_t1_0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = __pyx_memoryview_fromslice(__pyx_v_t1_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_14 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_t_11, __pyx_t_9};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_15)) {
    PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_t_11, __pyx_t_9};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_15, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (__pyx_t_14) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_5, __pyx_t_11);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_5, __pyx_t_9);
    __pyx_t_11 = 0;
    __pyx_t_9 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_13, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_13 = __pyx_memoryview_fromslice(__pyx_v_t2_0, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_t2_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_14 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_t_13, __pyx_t_11};
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_9)) {
    PyObject *__pyx_temp[3] = {__pyx_t_14, __pyx_t_13, __pyx_t_11};
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_9, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  } else
  #endif
  {
    __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
    if (__pyx_t_14) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_14); __pyx_t_14 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0+__pyx_t_5, __pyx_t_13);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1+__pyx_t_5, __pyx_t_11);
    __pyx_t_13 = 0;
    __pyx_t_11 = 0;
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
  __pyx_t_15 = NULL;
  __pyx_t_5 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_15)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_3, __pyx_t_9};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_3, __pyx_t_9};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  } else
  #endif
  {
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (__pyx_t_15) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_15); __pyx_t_15 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0+__pyx_t_5, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1+__pyx_t_5, __pyx_t_9);
    __pyx_t_3 = 0;
    __pyx_t_9 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3457, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3460</span>:     <span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3461</span>:     <span class="k">return</span> <span class="n">omega</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_omega;
  goto __pyx_L0;
</pre></div></body></html>
